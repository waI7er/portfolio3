/*! For license information please see excelOnlineCalc.min.js.LICENSE.txt */
var excelOnlineCalc;!function(){var e={4035:function(e,t,r){"use strict";r.d(t,{h:function(){return n}});class n{static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=n.getTypeNameFor(e);return t?[t,...n.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const r=n.getTypeNameFor(e),i=n.getBaseTypesFor(e);for(const e of t){if(e===r)return!0;if(i.indexOf(e)>=0)return!0}return!1}static assign(e,t,r){if(r)for(const e of Object.keys(r))t[e]=r[e];return t.H_=e.H_,t}constructor(e){n.assign(n,this,e)}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},1592:function(e,t,r){"use strict";r.r(t),r.d(t,{ExcelFormulaCompletionAnnotation:function(){return i},ExcelFormulaCompletionSignal:function(){return s},FormulaCompletionBlockedAnnotation:function(){return o},FormulaCompletionFormulaAnnotation:function(){return a}});var n=r(4035);class i{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ExcelFormulaCompletion_ExcelFormulaCompletionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}constructor(e){n.h.assign(i,this,e)}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ExcelFormulaCompletion_FormulaCompletionFormulaAnnotation"}static getBaseTypes(){return["AugLoop_ExcelFormulaCompletion_ExcelFormulaCompletionAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}constructor(e){n.h.assign(a,this,e)}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class o{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ExcelFormulaCompletion_FormulaCompletionBlockedAnnotation"}static getBaseTypes(){return["AugLoop_ExcelFormulaCompletion_ExcelFormulaCompletionAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}constructor(e){n.h.assign(o,this,e)}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class s{static getTypeName(){return"AugLoop_ExcelFormulaCompletion_ExcelFormulaCompletionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[s.getTypeName()])}constructor(e){n.h.assign(s,this,e)}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},5528:function(e,t,r){"use strict";var n,i,a;r.r(t),r.d(t,{CalculatedCellSuggestion:function(){return m},CalculatedColumnSuggestion:function(){return d},DataTypeInstructionType:function(){return a},ExcelCurrencyFormat:function(){return u},ExcelDateOrder:function(){return s},ExcelIntelligenceCell:function(){return p},ExcelIntelligenceScenarioTypes:function(){return o},ExcelIntelligenceTableSignal:function(){return g},GeneratedFormulaSuggestion:function(){return c},PreviewMetadata:function(){return n},SuggestionResult:function(){return i}}),function(e){e.Success="Success",e.FetchingError="fetchingError",e.NotImplementedExcelFunction="notImplementedExcelFunction",e.CalcError="calcError",e.NotHybrid="notHybrid",e.NotSupported="notSupported",e.IncompleteDataError="incompleteDataError",e.ScratchpadError="scratchpadError"}(n||(n={})),function(e){e.InternalError="internalError",e.Success="success",e.NoSuggestion="noSuggestion",e.MultipleFormulas="multipleFormulas",e.NoCopilotLicense="noCopilotLicense",e.AuthFailure="authFailure",e.UserThrottled="userThrottled",e.HarmfulContent="harmfulContent",e.IrrelevantQuery="irrelevantQuery",e.LlmGeneralErrorFailure="llmGeneralErrorFailure"}(i||(i={})),function(e){e[e.Insertion=0]="Insertion",e[e.FromColumn=1]="FromColumn"}(a||(a={}));var o,s,u,l=r(4035);class c{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return l.h.matchesTypesFor(e,[c.getTypeName()])}constructor(e){l.h.assign(c,this,e)}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ExcelIntelligence_CalculatedColumnSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return l.h.matchesTypesFor(e,[d.getTypeName()])}constructor(e){l.h.assign(d,this,e)}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ExcelIntelligence_CalculatedCellSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return l.h.matchesTypesFor(e,[m.getTypeName()])}constructor(e){l.h.assign(m,this,e)}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class g{static getTypeName(){return"AugLoop_ExcelIntelligence_ExcelIntelligenceTableSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return l.h.matchesTypesFor(e,[g.getTypeName()])}constructor(e){l.h.assign(g,this,e)}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{static getTypeName(){return"AugLoop_ExcelIntelligence_ExcelIntelligenceCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}static typeGuard(e){return l.h.matchesTypesFor(e,[p.getTypeName()])}constructor(e){l.h.assign(p,this,e)}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()},function(e){e.ColumnSuggestion="ColumnSuggestion",e.CellSuggestion="CellSuggestion"}(o||(o={})),function(e){e.MonthDayYear="MonthDayYear",e.DayMonthYear="DayMonthYear",e.YearMonthDay="YearMonthDay",e.MonthYearDay="MonthYearDay",e.DayYearMonth="DayYearMonth",e.YearDayMonth="YearDayMonth"}(s||(s={})),function(e){e.Parenthesis="Parenthesis",e.Lead="Lead",e.Internal="Internal",e.Trail="Trail"}(u||(u={}))},7160:function(e,t,r){"use strict";var n,i,a;r.r(t),r.d(t,{FormulaByExampleAnnotation:function(){return l},FormulaByExampleInvocationMethod:function(){return i},FormulaByExamplePreviewAnnotation:function(){return c},FormulaByExampleResultKind:function(){return n},FormulaByExampleSignal:function(){return s},FormulaByExampleWarmUpAnnotation:function(){return d},FormulaByExampleWarmUpSignal:function(){return u},ValueType:function(){return a}}),function(e){e[e.Success=0]="Success",e[e.NoFormulas=1]="NoFormulas",e[e.Failed=2]="Failed"}(n||(n={})),function(e){e[e.Explicit=0]="Explicit",e[e.Implicit=1]="Implicit"}(i||(i={})),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.DateTime=2]="DateTime"}(a||(a={}));var o=r(4035);class s{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}constructor(e){o.h.assign(s,this,e)}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class u{static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}constructor(e){o.h.assign(u,this,e)}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}constructor(e){o.h.assign(l,this,e)}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExamplePreviewAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}constructor(e){o.h.assign(c,this,e)}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}constructor(e){o.h.assign(d,this,e)}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},7377:function(e,t,r){"use strict";function n(e,t,r){return u(e,1,t,r)}function i(e,t,r){return u(e,2,t,r)}function a(e,t,r){return u(e,3,t,r)}function o(e,t,r){return u(e,0,t,r)}function s(e,t,r){return u(e,4,t,r)}function u(e,t,r,n){return{name:e,dataType:t,value:r,classification:n||4}}var l,c,d,m,g,p,h;r.r(t),r.d(t,{Activity:function(){return P},App:function(){return _},Asha:function(){return B},AudienceGroup:function(){return w},CV:function(){return j},Contracts:function(){return f},Copilot:function(){return K},EnumObjects:function(){return de},Funnel:function(){return M},HealthQosError:function(){return x},Platform:function(){return N},Release:function(){return U},Result:function(){return I},Session:function(){return L},SimpleTelemetryLogger:function(){return le},SuppressNexus:function(){return se},TelemetryLogger:function(){return pe},TraceContext:function(){return Me},TraceFlags:function(){return me},TraceParent:function(){return Ne},TraceState:function(){return ke},User:function(){return O},UserAction:function(){return D},cloneEvent:function(){return ue},createTraceContext:function(){return we},getEffectiveEventFlags:function(){return Q},logError:function(){return z},logNotification:function(){return q},makeBooleanDataField:function(){return n},makeDoubleDataField:function(){return a},makeGuidDataField:function(){return s},makeInt64DataField:function(){return i},makeStringDataField:function(){return o},onNotification:function(){return H},parseTraceContext:function(){return De},sendHealthQosError:function(){return he}}),function(e){e.getFields=function(e,t){var r=[];return r.push(i("".concat(e,".Code"),t.code)),void 0!==t.type&&r.push(o("".concat(e,".Type"),t.type)),void 0!==t.tag&&r.push(i("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&r.push(n("".concat(e,".IsExpected"),t.isExpected)),r.push(o("zC.Activity.Result","Office.System.Result")),r}}(l||(l={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var r="Activity",a=[];return void 0!==t.cV&&a.push(o("".concat(r,".CV"),t.cV)),a.push(i("".concat(r,".Duration"),t.duration)),a.push(i("".concat(r,".Count"),t.count)),a.push(i("".concat(r,".AggMode"),t.aggMode)),void 0!==t.success&&a.push(n("".concat(r,".Success"),t.success)),void 0!==t.result&&a.push.apply(a,l.getFields("".concat(r,".Result"),t.result)),a.push(o("zC.Activity",e.contractName)),a}}(c||(c={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push(o("".concat(e,".Id"),t.id)),void 0!==t.version&&r.push(o("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push(o("".concat(e,".SessionId"),t.sessionId)),r}}(d||(d={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.alias&&r.push(o("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&r.push(o("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&r.push(o("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&r.push(o("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&r.push(o("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&r.push(n("".concat(e,".IsAnonymous"),t.isAnonymous)),r}}(m||(m={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push(o("".concat(e,".Name"),t.name)),void 0!==t.state&&r.push(o("".concat(e,".State"),t.state)),r}}(g||(g={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push(i("".concat(e,".Id"),t.id)),void 0!==t.name&&r.push(o("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&r.push(o("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&r.push(o("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&r.push(o("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&r.push(i("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),r}}(p||(p={})),(h||(h={})).getFields=function(e,t){var r=[];return r.push(o("".concat(e,".ErrorGroup"),t.errorGroup)),r.push(i("".concat(e,".Tag"),t.tag)),void 0!==t.code&&r.push(i("".concat(e,".Code"),t.code)),void 0!==t.id&&r.push(i("".concat(e,".Id"),t.id)),void 0!==t.count&&r.push(i("".concat(e,".Count"),t.count)),r};var f,S=c,v=l,y=h,F=g,b=d,C=p,k=m;function E(e,t){return e?e+"."+t:t}function A(e,t,r,n,i){void 0===i&&(i=4),n&&e.push(o("".concat(E(t,r)),n,i))}function T(e,t,r,i){"boolean"==typeof i&&e.push(n("".concat(E(t,r)),i))}function R(e,t,r,n){"number"==typeof n&&e.push(i("".concat(E(t,r)),n))}!function(e){var t,r;t=e.Office||(e.Office={}),(r=t.System||(t.System={})).Activity=S,r.Result=v,r.Error=y,r.Funnel=F,r.Host=b,r.User=k,r.UserAction=C}(f||(f={}));var N,I={getFields:function(e){var t="Activity.Result",r=[];return R(r,t,"Code",e.code),A(r,t,"Type",e.type),R(r,t,"Tag",e.tag),T(r,t,"IsExpected",e.isExpected),r.push(o("zC.Activity.Result","Office.System.Result")),r}},P={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return A(r,t,"CV",e.cV),R(r,t,"Duration",e.duration),R(r,t,"Count",e.count),R(r,t,"AggMode",e.aggMode),T(r,t,"Success",e.success),e.result&&r.push.apply(r,I.getFields(e.result)),r.push(o("zC.Activity",this.contractName)),r}},O={getFields:function(e){var t="User",r=[];return A(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),A(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),A(r,t,"TenantId",e.tenantId,1),A(r,t,"TenantGroup",e.tenantGroup,1),T(r,t,"IsAnonymous",e.isAnonymous),T(r,t,"IsSignedIn",e.isSignedIn),r}},M={getFields:function(e,t){var r=[];return A(r,e,"Name",t.name),A(r,e,"State",t.state),r}},D={getFields:function(e){var t="UserAction",r=[];return R(r,t,"Id",e.id),A(r,t,"Name",e.name),A(r,t,"CommandSurface",e.commandSurface),A(r,t,"ParentName",e.parentName),A(r,t,"TriggerMethod",e.triggerMethod),R(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(N||(N={}));var w,_={getFields:function(e){var t="App",r=[];return A(r,t,"Name",e.name,1),A(r,t,"Platform",e.platform,1),A(r,t,"Version",e.version,1),r}},L={getFields:function(e){var t="Session",r=[];return A(r,t,"Id",e.id,1),A(r,t,"EcsETag",e.ecsETag,1),r}},x={getFields:function(e){var t=[];return t.push(o("Pillar",e.pillar)),t.push(o("Veto",e.veto)),t.push(n("IsIntentional",e.isIntentional)),t.push(n("IsInternal",e.isInternal)),t.push(n("AlertOnPillar",e.alertOnPillar)),t.push(n("IsSessionEndingError",e.isSessionEndingError)),T(t,void 0,"InStaging",e.inStaging),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(w||(w={}));var K,B,W,U={getFields:function(e){var t=[];return A(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,r,n,i,a="Copilot";(i=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",i.IsSeen="IsSeen",i.IsTried="IsTried",i.IsKept="IsKept",i.IsRejected="IsRejected",(n=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",n.Commanding="Commanding",n.QAandSummaries="QA and Summaries",n.Collaboration="Collaboration",n.Suggestions="Suggestions",(r=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",r.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return A(t,a,"FeatureActionType",e.featureActionType),T(t,a,"IsUserInitiated",e.isUserInitiated),A(t,a,"FeatureName",e.featureName),A(t,a,"SubFeatureName",e.subFeatureName),A(t,a,"Capability",e.capability),T(t,a,"IsThumbsUp",e.isThumbsUp),A(t,a,"EntryPoint",e.entryPoint),A(t,a,"Verb",e.verb),A(t,a,"InteractionId",e.interactionId),A(t,a,"ConversationId",e.conversationId),t.push(o("zC.".concat(a),"Office.System.Copilot")),t}}(K||(K={})),function(e){var t,r="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return A(t,r,"EventType",e.eventType),A(t,r,"Pillar",e.pillar),A(t,r,"Scenario",e.scenario),A(t,r,"Veto",e.veto),A(t,r,"Error",e.error),T(t,r,"InStaging",e.inStaging),T(t,r,"IsSessionEndingError",e.isSessionEndingError),T(t,r,"IsIntentional",e.isIntentional),T(t,r,"IsInternal",e.isInternal),t.push(o("zC.".concat(r),"Office.System.Asha")),t}}(B||(B={}));var G,j=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),V=(G=[],{fireEvent:function(e){G.forEach((function(t){return t(e)}))},addListener:function(e){e&&G.push(e)}});function H(){return V}function q(e,t,r){V.fireEvent({level:e,category:t,message:r})}function z(e,t,r){q(0,e,(function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)}))}function Q(e){var t={costPriority:1,samplingPolicy:1,persistencePriority:1,dataCategories:0,diagnosticLevel:100};return e.eventFlags&&e.eventFlags.dataCategories||q(0,0,(function(){return"DataCategories"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}var $=function(e,t){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},$(e,t)},Y=function(){return Y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Y.apply(this,arguments)};function J(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}Object.create,Object.create;var X={};function Z(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?X[e]?(t.ariaTenantToken&&(X[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(X[e].dnmToken=t.dnmToken)):X[e]=t:q(0,0,(function(){return"Namespace: ".concat(e)}))}function ee(e,t){for(var r=e.length;r>0;){var n=e.substr(0,r);if(X[n]){var i=X[n];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var te=9007199254740991,re=-te,ne=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,ie=/^[a-zA-Z0-9_\.]{1,95}$/;function ae(e){return ie.test(e)}function oe(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!ae(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<re||e>te)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var se=-1;function ue(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Y({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var le=function(){function e(e,t,r){var n,i,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},e&&(this.telemetrySinks=e.telemetrySinks,(n=this.persistentDataFields).push.apply(n,e.persistentDataFields),this.config=Y(Y({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(i("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=ue(e),r=t.telemetryProperties;r.nexusTenantToken=se;var n=r.ariaTenantToken;n||ee(t.eventName,r)||n?this.sendTelemetryEventInternal(t,1):q(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var r=ue(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=ue(e),r=t.telemetryProperties,n=r.customerContentVersion;return(!n||n>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=ue(e),r=t.telemetryProperties;r.dnmToken||ee(t.eventName,r)||r.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):q(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):q(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void z(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(e){}}))}else q(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var r,n,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(o("OTelJS.Version","4.20.30")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(n=a.dataFields).push.apply(n,this.partAFields),e.eventContract=a}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!ne.test(t))throw new Error("Invalid eventName");var t,r=e.eventContract;if(r){if(r.name&&!ae(r.name))throw new Error("Invalid eventContract");oe(r.dataFields)}oe(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var n=r[t],i=n[0],a=n[1];this.sendTelemetryEventInternal(i,a)}},e.prototype.setTenantToken=function(e,t,r){Z(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){Z(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return ue(e)},e.prototype.getConfig=function(){return this.config},e}(),ce=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(ce=function(){return 1e3*Math.floor(window.performance.now())});var de,me,ge=function(e){var t,r=ce(),n=ue(e.telemetryEvent);return Y(Y({cv:e.parentCv.getNext()},n),{createChildActivity:function(t){return ge({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var n,i,a=this;if(!t){void 0===this.success&&void 0===this.result&&q(1,0,(function(){return"Activity does not have success or result set"}));var o=ce();t=!0;var s={duration:o-r,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},u=null!==(i=null===(n=this.eventContract)||void 0===n?void 0:n.dataFields)&&void 0!==i?i:[];return u.push.apply(u,P.getFields(s)),this.eventContract={name:P.contractName,dataFields:u},e.sendTelemetryEvent(this)}q(0,0,(function(){return"'".concat(a.eventName,"' already ended")}))}})},pe=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.baseCv=function(){if(!W){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));W=new j(e.join(""))}return W}(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}$(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.createActivity=function(e){return ge({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:P.contractName,dataFields:P.getFields(t)},dataFields:r,eventFlags:n})},t.prototype.sendError=function(e){var t=function(e){var t="Error",r=[];return r.push(o("".concat(t,".ErrorGroup"),e.errorGroup)),r.push(i("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push(i("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push(i("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push(i("".concat(t,".Count"),e.count)),r}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return ge({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(le);function he(e,t,r,n,i,a,o,s,u,l,c){n.forEach((function(n){e.sendTelemetryEvent({eventName:t.name+".Qos.Error."+r,eventFlags:{diagnosticLevel:110},dataFields:J(J([],x.getFields({veto:n,pillar:i,isIntentional:a,isInternal:o,alertOnPillar:s,isSessionEndingError:u,inStaging:l}),!0),c||[],!0),telemetryProperties:{ariaTenantToken:t.token,nexusTenantToken:se}})}))}!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(de||(de={})),function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(me||(me={}));var fe="[-_*/0-9a-z]",Se="[a-z]".concat(fe,"{0,255}"),ve="[0-9a-z]".concat(fe,"{0,240}"),ye="[a-z]".concat(fe,"{0,13}"),Fe="".concat(ve,"@").concat(ye),be=new RegExp("^(?:".concat(Se,"|").concat(Fe,")$")),Ce=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,ke=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!be.test(e)||!Ce.test(t))return!1;var r=this._listMemberMap;return r.has(e)&&r.delete(e),r.set(e,t),r.size>32&&r.delete(r.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var r=new e,n=t.split(","),i=!0;return n.reverse().forEach((function(e){var t=e.trim();if(t){var n=t.split("=");2===n.length&&r.set(n[0],n[1])||(q(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),i=!1)}})),i?r:void 0},e}(),Ee=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,Ae=function(e){return/^0+$/.test(e)},Te=/^([\da-f]{16})$/,Re=16,Ne=function(){function e(e,t,r){void 0===e&&(e=Pe()),void 0===t&&(t=Oe()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){return void 0===e&&(e=me.None),e&me.Sampled}(r)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return Ee.test(this.serialize())&&!Ae(this.traceId)&&!Ae(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&me.Sampled)===me.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|me.Sampled:this._traceFlags&~me.Sampled,!0)},e.prototype.updateParentId=function(e){return e?!(!Te.test(e)||Ae(e)||(this._parentId=e,0)):(this._parentId=Oe(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,r,n){var i=new e(t,r,n);return i.isValid()?i:void 0},e.createNew=function(t){return new e(Pe(),Oe(),t)},e.parse=function(t){var r=Ee.exec(t);if(r&&"ff"!==r[1]&&("00"!==r[1]||!r[5]))return e.create(r[2],r[3],parseInt(r[4],Re))},e}();function Ie(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var r=Array.from(t).map((function(e){return(256+e).toString(Re).slice(1)})).join("");return Ae(r)?r.slice(1)+"1":r}function Pe(){return Ie(16)}function Oe(){return Ie(8)}var Me=function(){function e(){}return e.getFields=function(e){var t="Event.",r=e.parent,n=e.state,a=n?n.serialize():void 0;return J([o(t+"TraceId",r.traceId),o(t+"TraceParentId",r.parentId),i(t+"TraceFlags",r.traceFlags)],a?[o(t+"TraceState",a)]:[],!0)},e}();function De(e,t){var r=Ne.parse(e);if(r){var n=void 0;return t&&(n=ke.parse(t)),n||(n=new ke),{parent:r,state:n}}}function we(e){return{parent:Ne.createNew(e),state:new ke}}},6677:function(e,t,r){"use strict";r.r(t),r.d(t,{clearImmediate:function(){return u},setImmediate:function(){return s}});let n=1;const i=new Map;let a,o=!1,s=(e,...t)=>(i.set(n,[e,t]),a(n),n++),u=e=>{i.delete(e)};function l(e){if(o)setTimeout(l,0,e);else{const t=i.get(e);if(t){o=!0;try{t[0](...t[1])}finally{u(e),o=!1}}}}const c="undefined"==typeof self?"undefined"==typeof global?void 0:global:self;c.setImmediate?(s=c.setImmediate,u=c.clearImmediate):c.importScripts?function(){const e=new MessageChannel;e.port1.onmessage=e=>{l(e.data)},a=t=>{e.port2.postMessage(t)}}():function(){const e=`setImmediate$${Math.random()}$`;window.addEventListener("message",(t=>{"string"==typeof t.data&&t.data.startsWith(e)&&l(+t.data.slice(e.length))})),a=t=>{window.postMessage(e+t,"*")}}()},4129:function(e,t){"use strict";function r(e,t,r){let n=0,i=e.length;for(;n<i;){const a=Math.floor((n+i)/2);r(e[a],t)<0?n=a+1:i=a}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.binsearch=function(e,t,n=void 0){return void 0===n&&(n=(e,t)=>e===t?0:e<t?-1:1),r(e,t,n)},t.strict_binsearch=function(e,t,n=void 0){const i=r(e,t,n);return i===e.length||0!==n(e[i],t)?-1:i}},6685:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Colorize=void 0,t.tuple=d,t.find_all_proposed_fixes=p,t.numComparator=f;const n=r(4129),i=r(1118),a=r(1121),o=r(3887),s=r(5560),u=r(7525),l=r(6349);function c(e,t){if("number"==typeof e)return e-t;for(let r=0;r<e.length;r+=1){const n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(...e){return e}class m{static setReportingThreshold(e){m.reportingThreshold=e}static getReportingThreshold(){return m.reportingThreshold}static setFormattingDiscount(e){m.formattingDiscount=e}static getFormattingDiscount(){return m.formattingDiscount}static process_formulas(e,t,r){(0,l.watchdog)("wd0xea1170");const n=JSON.stringify(i.ExcelUtils.baseVector()),a=(e,t)=>[e[0]+t[0],e[1]+t[1],e[2]+t[2]],o=[];for(let s=0;s<e.length;s++){(0,l.watchdog)("wd0xa1597b");const u=e[s];for(let c=0;c<u.length;c++){(0,l.watchdog)("wd0x0d7fc8");const d=u[c].toString();if(d.length>0){const u=i.ExcelUtils.all_dependencies(s,c,r+s,t+c,e),l=c+t+1,g=s+r+1;if(0===u.length)"="===d[0]&&o.push([[l,g,0],m.distinguishedZeroHash]);else{const e=u.reduce(a);if(JSON.stringify(e)===n)o.push([[l,g,0],e.toString()]);else{const t=this.hash_vector(e).toString();o.push([[l,g,0],t])}}}}}return o}static color_all_data(e){const t=[];for(const r of Object.keys(e)){(0,l.watchdog)("wd0xc22046");const e=r.split(","),n=Number(e[0]),i=Number(e[1]);t.push([[n,i,0],m.distinguishedZeroHash])}return t}static process_values(e,t,r,n){const i=[];for(let a=0;a<e.length;a++){(0,l.watchdog)("wd0x503d57");const o=e[a];for(let e=0;e<o.length;e++){(0,l.watchdog)("wd0x366ad1");const s=o[e].toString();if(s.length>0&&"="!==t[a][e][0]&&Number(s).toString()===s){const t=e+r+1,o=a+n+1;i.push([[t,o,1],m.distinguishedZeroHash])}}}return i}static identify_ranges(e,t){const r={};for(const t of e)(0,l.watchdog)("wd0x770d8c"),r[t[1]]=r[t[1]]||[],r[t[1]].push(t[0]);for(const e of Object.keys(r))(0,l.watchdog)("wd0x84ae4d"),r[e].sort(t);return r}static group_ranges(e,t){const r={};let n=0,i=1;t||(n=1,i=0);for(const t of Object.keys(e)){(0,l.watchdog)("wd0xa372ae"),r[t]=[];let a=e[t].shift(),o=a;for(const s of e[t])s[n]===o[n]&&s[i]===o[i]+1||(r[t].push([a,o]),a=s),o=s;r[t].push([a,o])}return r}static identify_groups(e){const t=this.identify_ranges(e,((e,t)=>e[0]===t[0]?e[1]-t[1]:e[0]-t[0])),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)}static processed_to_matrix(e,t,r,n,i){const a=new Array(e);for(let r=0;r<e;r++)a[r]=new Array(t).fill(0);for(const e of i){const[[t,i,o],s]=e,u=i-n-1,l=t-r-1;let c=Number(m.distinguishedZeroHash);1===o||(c=Number(s)),a[u][l]=c}return a}static stencilize(e){return a.Stencil.stencil_computation(e,((e,t)=>e*t),1)}static compute_stencil_probabilities(e,t,r){const n=new Array(e);for(let r=0;r<e;r++)n[r]=new Array(t).fill(0);let i=0;const a={};for(let n=0;n<e;n++)for(let e=0;e<t;e++)a[r[n][e]]=a[r[n][e]]+1||1,0!==r[n][e]&&(i+=1);for(let o=0;o<e;o++)for(let e=0;e<t;e++)n[o][e]=a[r[o][e]]/i;let o=0,s=0;for(let n=0;n<e;n++)for(let e=0;e<t;e++)r[n][e]>0&&(s+=a[r[n][e]]);for(let n=0;n<e;n++)for(let e=0;e<t;e++)a[r[n][e]]>0&&(o+=this.entropy(a[r[n][e]]/s));return Math.log2(i),n}static generate_suspicious_cells(e,t,r,n,i,a,o=.01){const s=[];let u=0,l=0;for(let c=0;c<e;c++)for(let e=0;e<t;e++){const t=e+r+1,d=c+n+1;a[c][e]>0&&(u+=i[c][e],l+=1,a[c][e]<=o&&0!==i[c][e]&&s.push([t,d,a[c][e]]))}const c=u/l;return s.sort(((e,t)=>Math.abs(t[2]-c)-Math.abs(e[2]-c))),s}static process_suspicious(e,t,r){(0,l.watchdog)("wd0x72fd38"),new u.Timer("process_suspicious");const[n,a]=i.ExcelUtils.extract_sheet_cell(e),o=i.ExcelUtils.cell_dependency(a,0,0);let s=[];t.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):s=m.process_formulas(t,o[0]-1,o[1]-1);let c=[],g=[];const p=r.length,h=r[0].length;if(r.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{const e=i.ExcelUtils.generate_all_references(t,o[0]-1,o[1]-1);c=m.color_all_data(e),g=m.process_values(r,t,o[0]-1,o[1]-1)}const f=m.identify_groups(c),S=m.identify_groups(s);let v=[];return r.length<1e4&&(v=m.find_suspicious_cells(p,h,o,t,s,g,1)),d(v,S,f,m.generate_proposed_fixes(S))}static entropy(e){return-e*Math.log2(e)}static entropydiff(e,t){const r=e+t;return-(this.entropy(e/r)+this.entropy(t/r))/Math.log2(r)}static fix_metric(e,t,r,n){const[i,a]=t,[o,u]=n,l=s.RectangleUtils.area([[i[0],i[1],0],[a[0],a[1],0]]),c=s.RectangleUtils.area([[o[0],o[1],0],[u[0],u[1],0]]),d=Math.min(l,c),m=Math.max(l,c),g=Math.min(r,e),p=Math.max(r,e);let h=Math.abs(p-g)/this.Multiplier;h<1&&(h=1);let f=(1+this.entropydiff(d,m))/(h*d);return f=-f,f}static count_proposed_fixes(e){let t=0;for(const r in e){const[n,i]=e[r][1],[a,o]=e[r][2];t+=s.RectangleUtils.diagonal([[n[0],n[1],0],[i[0],i[1],0]]),t+=s.RectangleUtils.diagonal([[a[0],a[1],0],[o[0],o[1],0]])}return t}static fix_proposed_fixes(e){const t={},r={};for(const n in e){if(e[n][1]>e[n][2]){const t=e[n][1];e[n][1]=e[n][2],e[n][2]=t}t[JSON.stringify(e[n][1])]=e[n],r[JSON.stringify(e[n][2])]=e[n]}const n=[],i={};for(const a in e){const o=e[a][0];if(-o<m.reportingThreshold/100)continue;const s=JSON.stringify(e[a][1]),u=JSON.stringify(e[a][2]);if(s in r||u in t){if(!i[s]&&s in r){const t=[-o*JSON.parse(r[s][0]),e[a][1],r[s][1]];n.push(t),i[s]=!0,i[u]=!0;continue}if(!i[u]&&u in t){const r=[-o*JSON.parse(t[u][0]),e[a][1],t[u][2]];n.push(r),i[u]=!0,i[s]=!0}}else n.push(e[a])}return n}static generate_proposed_fixes(e){const t=p(e);return t.sort(c),t}static merge_groups(e){for(const t of Object.keys(e)){(0,l.watchdog)("wd0x781a33");const r=e[t].slice();e[t]=this.merge_individual_groups(r)}return e}static merge_individual_groups(e){const t=new u.Timer("merge_individual_groups");let r=0;for(e=e.sort();;){(0,l.watchdog)("wd0x0a3668");let n=!1;const i={},a=[],o=e.slice();for(;o.length>0;){const e=o.shift();for(let t=0;t<o.length;t++)if((0,l.watchdog)("wd0x9cf1d5"),s.RectangleUtils.is_mergeable(e,o[t])){const r=JSON.stringify(e),u=JSON.stringify(o[t]);if(!(r in i)&&!(u in i)){a.push(s.RectangleUtils.bounding_box(e,o[t])),i[r]=!0,i[u]=!0,n=!0;break}}}for(let t=0;t<e.length;t++)(0,l.watchdog)("wd0x1bc2bb"),JSON.stringify(e[t])in i||a.push(e[t]);if(a.sort(),!n)return a;if(e=a.slice(),r++,r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}}static hash_vector(e){{const t=0,r=0,n=Math.abs(e[0]-t),i=Math.abs(e[1]-r),a=e[2];return this.Multiplier*(n+i+a)}}static adjust_proposed_fixes(e,t,r,n){return e.map((e=>{const i=e[0];if(100*-i<1)return null;const a=e[1].map((e=>e.toString().padStart(10,"0"))),o=e[2].map((e=>e.toString().padStart(10,"0"))),s=a<o?e[1]:e[2],u=a<o?e[2]:e[1],[[l,c],[m,g]]=s,[[p,h],[f,S]]=u,v=l-r-1,y=c-n-1,F=f-r-1,b=S-n-1;let C=!0;const k=JSON.stringify(t[y][v]);for(let e=y;e<=b;e++)for(let r=v;r<=F;r++)if(JSON.stringify(t[e][r])!==k){C=!1;break}return d(i,s,u,C)})).filter((e=>null!==e))}static find_suspicious_cells(e,t,r,n,i,a,o){return(0,l.watchdog)("wd0x8cabd6"),[]}}function g(e,t){const[r,n]=e,[i,a]=t;return r[0]!==i[0]?r[0]-i[0]:r[1]-i[1]}function p(e){let t=[];const r={};!function(e,t){for(const r of Object.keys(e))(0,l.watchdog)("wd0xa287cd"),t[r]=e[r].sort(g).map(((e,t,r)=>[e[0].map(((e,t,r)=>Number(e))),e[1].map(((e,t,r)=>Number(e)))]))}(e,r);const n={},i={};for(const t of Object.keys(e))(0,l.watchdog)("wd0xb02b87"),n[t]=r[t].map(((e,t,r)=>{const[n,i]=e;return n})),i[t]=r[t].map(((e,t,r)=>{const[n,i]=e;return i}));const a=function(e){const t={};for(const r of Object.keys(e)){let n=1e6,i=1e6,a=-1e6,o=-1e6;for(let t=0;t<e[r].length;t++){const s=e[r][t][0][0],u=e[r][t][1][0],l=e[r][t][0][1],c=e[r][t][1][1];u>a&&(a=u),s<n&&(n=s),c>o&&(o=c),l<i&&(i=l)}t[r]=[[n,i,0],[a,o,0]]}return t}(e),o=Object.keys(e);h(o,((e,t)=>a[e][0][0]-a[t][0][0]));const s=o.map(((e,t,r)=>a[e])),u=Object.keys(e);h(u,((e,t)=>a[e][0][1]-a[t][0][1]));const c=u.map(((e,t,r)=>a[e]));for(const d of Object.keys(e))for(let e=0;e<r[d].length;e++){(0,l.watchdog)("wd0xe37031");const m=v(d,r[d][e],0,o,u,n,i,a,s,c);t=t.concat(m)}return t=t.map(((e,t,r)=>f(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]])),t=function(e){const t={};return e.filter((e=>!(t[e]=e in t)))}(t),t}function h(e,t){const r=e.map(((e,t)=>({item:e,index:t}))).sort(((e,r)=>t(e.item,r.item)||e.index-r.index)).map((({item:e})=>e));for(let t=0;t<e.length;t+=1)e[t]=r[t];return e}function f(e,t){for(let r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function S(e,t,r,i){const a=e[0],o=e[1],s=t[0],u=t[1],l=[a-1,u,0],c=[s,o-1,0],d=[s+1,o,0],m=[a,u+1,0],g=[];let p=-1;if(p=(0,n.strict_binsearch)(i,l,f),-1!==p&&r[p][1]===o){const e=[r[p],i[p]];g.push(e)}if(p=(0,n.strict_binsearch)(i,c,f),-1!==p&&r[p][0]===a){const e=[r[p],i[p]];g.push(e)}if(p=(0,n.strict_binsearch)(r,d,f),-1!==p&&i[p][1]===u){const e=[r[p],i[p]];g.push(e)}if(p=(0,n.strict_binsearch)(r,m,f),-1!==p&&i[p][0]===s){const e=[r[p],i[p]];g.push(e)}return g}function v(e,t,r,i,a,o,s,u,l,c){const[d,g]=t;let p=[];const h=(0,n.binsearch)(l,t,((e,t)=>e[0][0]-t[0][0])),f=(0,n.binsearch)(c,t,((e,t)=>e[0][1]-t[0][1]));let v,y,F;h>f?(v=i,F=h,y=0):(v=a,F=f,y=1),F>0&&(F-=1);for(let r=F;r<v.length;r++){const n=v[r];if(n===e)continue;const i=u[n];if(0===y){if(g[0]+1<i[0][0])break}else if(g[1]+1<i[0][1])break;if(g[0]+1<i[0][0]||g[1]+1<i[0][1]||i[1][0]+1<d[0]||i[1][1]+1<d[1]);else{const r=S(d,g,o[n],s[n]);r.length>0&&(p=p.concat(r.map(((r,i,a)=>[m.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]))))}}return p}t.Colorize=m,m.reportingThreshold=35,m.suspiciousCellsReportingThreshold=85,m.formattingDiscount=50,m.formulasThreshold=1e4,m.valuesThreshold=1e4,m.Multiplier=1,m.distinguishedZeroHash="12345"},5211:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=function(e,t,r,u=1/0){t=t??n.Colorize.getFormattingDiscount(),r=r??n.Colorize.getReportingThreshold(),o.watchdog.arm(u);const l=e.worksheets.map((function(e){if((0,o.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};let u=e.usedRangeAddress;u=u.replace(/!(!+)/,"!");const l=new a.Timer("excelint"),[c,d,m,g]=n.Colorize.process_suspicious(u,e.formulas,e.values);(0,o.watchdog)("wd0x7919b4");const p=l.elapsedTime(),h=n.Colorize.adjust_proposed_fixes(g,e.styles,0,0),f=l.elapsedTime(),S=h.map((e=>{(0,o.watchdog)("wd0xfb8f16");const[i,a,s,u]=e;let l=-i;return u||(l*=(100-t)/100),100*l>=r?(0,n.tuple)(l,a,s,u):null})).filter((e=>null!==e)),v=(e,t)=>(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1),y=l.elapsedTime(),F=S.map((t=>{(0,o.watchdog)("wd0x2375dd");const r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",n=[],a=[],s=[],u=[],l=[],c=[],d=[],m=[],g=[],p=t[3],h=[v(...t[1]),v(...t[2])];for(let r=0;r<2;r++){const o=t[r+1][0],p=o[1]-1,h=o[0]-1,f=e.formulas[p][h],S=i.ExcelUtils.numeric_constants(f);l.push(S),c.push(c.reduce(((e,t)=>e+t),0));const v=i.ExcelUtils.all_cell_dependencies(f,h+1,p+1,!1);d.push(v.length);const y=i.ExcelUtils.formulaToR1C1(f,h+1,p+1),F=i.ExcelUtils.column_index_to_name(h+1)+(p+1)+":",b=F+y;s.push(y),u.push(b),n.push(f),a.push(F+f),m.push((f.match(/\$/g)||[]).length),g.push(v)}const f=Math.abs(c[0]-c[1]),S=[];for(let e=0;e<g.length;e++)if(g[e].length>0){if("vertical"===r&&0===g[e][0][0]&&-1===g[e][0][1]){S.push("recurrent-formula");break}if("horizontal"===r&&-1===g[e][0][0]&&0===g[e][0][1]){S.push("recurrent-formula");break}}d[0]!==d[1]&&S.push("different-referent-count"),l[0].length!==l[1].length&&(1===Math.abs(l[0].length-l[1].length)?S.push("one-extra-constant"):S.push("number-of-constants-mismatch")),l[0].length>0&&l[1].length>0&&(d[0]+d[1]===0?S.push("both-constants"):d[0]*d[1]==0&&S.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(g[0].sort())!==JSON.stringify(g[1].sort())&&S.push("r1c1-mismatch"),m[0]!==m[1]&&S.push("absolute-ref-mismatch");for(let e=0;e<g.length;e++)if(g[e].length>0&&g[e][0][0]*g[e][0][1]!=0){S.push("off-axis-reference");break}return 0===S.length&&S.push("unclassified"),{bin:S,direction:r,sameFormat:p,rangeSizes:h,numbers:c,sameConstants:l[0]===l[1],numeric_difference:f,magnitude_numeric_difference:0===f?0:Math.log10(f),formulas:a,r1c1formulas:u,dependence_vectors:g}})),b=l.elapsedTime(),C=e.formulas.flat().filter((e=>e.length>0)).length,k=e.values.flat().filter((e=>e.length>0)).length,E=e.values[0].length,A=e.values.length,T=A*E,R=S.map((e=>e[0])).reduce(((e,t)=>e+t),0);let N=S.map((e=>((0,o.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[])));const I=Array.from(new Set(N.flat(1).map((e=>JSON.stringify(e)))));N=I.map((e=>JSON.parse(e)));const P=l.elapsedTime(),O={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:S,exampleFixes:F,suspiciousRanges:S.length,weightedSuspiciousRanges:R,suspiciousCells:N.length,elapsedTimeSeconds:P/1e3,proposedFixesTimeSeconds:p/1e3,adjustProposedFixesTimeSeconds:(f-p)/1e3,adjustFormatProposedFixesTimeSeconds:(y-f)/1e3,exampleFixesTimeSeconds:(b-y)/1e3,numCountingTimeSeconds:(P-b)/1e3,columns:E,rows:A,totalCells:T,numFormulaCells:C,numValueCells:k};return{name:e.sheetName,out:O}})).filter((e=>null!==e.out)),c={};for(const{name:e,out:t}of l)c[e]=t;return{workbookName:e.workbookName,worksheets:c}};const n=r(6685),i=r(1118),a=r(7525),o=r(6349);function s(e,t){const[r,n]=e,[i,a]=t,o=[];for(let e=r;e<=i;e++)for(let t=n;t<=a;t++)o.push([e,t,0]);return o}},1118:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;const n=r(6349);class i{static column_name_to_index(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;let t=0;const r=e.split("");for(const e of r)t*=26,t+=e.charCodeAt(0)-"A".charCodeAt(0)+1;return t}static column_index_to_name(e){let t="";for(;e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")}static cell_dependency(e,t,r){(0,n.watchdog)("wd0x1a9bd3");{const t=i.cell_both_absolute.exec(e);if(t){const e=i.column_name_to_index(t[1]);let r=Number(t[2]);return t[2][0]>=" "&&(r=Number(t[2].charCodeAt(0)-16384)),[e,r,0]}}(0,n.watchdog)("wd0xa26bda");{const t=i.cell_col_absolute.exec(e);if(t){const e=i.column_name_to_index(t[1]);let n=Number(t[2]);return t[2][0]>=" "&&(n=Number(t[2].charCodeAt(0)-16384)),[e,n-r,0]}}(0,n.watchdog)("wd0x2a23e1");{const r=i.cell_row_absolute.exec(e);if(r){const e=i.column_name_to_index(r[1]);let n=Number(r[2]);return r[2][0]>=" "&&(n=Number(r[2].charCodeAt(0)-16384)),[e-t,n,0]}}(0,n.watchdog)("wd0x3ebc91");{const n=i.cell_both_relative.exec(e);if(n){const e=i.column_name_to_index(n[1]);let a=Number(n[2]);return n[2][0]>=" "&&(a=Number(n[2].charCodeAt(0)-16384)),[e-t,a-r,0]}}throw new Error("We should never get here.")}static toR1C1(e,t,r=!1){const n=i.cell_dependency(e,0,0),a=i.cell_dependency(t,0,0);let o="R",s="C";r&&(o="ρ",s="γ");const u=[];a.forEach(((e,t,r)=>{u.push(e-n[t])}));let l="";return i.cell_both_absolute.exec(t)?l=o+a[1]+s+a[0]:i.cell_col_absolute.exec(t)?(0===u[1]?l+=o:l+=o+"["+u[1]+"]",l+=s+a[0]):i.cell_row_absolute.exec(t)?(0===u[0]?l+=s:l+=s+"["+u[0]+"]",l=o+a[1]+l):(0===u[1]?l+=o:l+=o+"["+u[1]+"]",0===u[0]?l+=s:l+=s+"["+u[0]+"]"),l}static formulaToR1C1(e,t,r){let n=e.slice();const a=i.column_index_to_name(t)+r;let o;for(;o=i.range_pair.exec(n);)o&&(o[1],o[2],n=n.replace(o[0],i.toR1C1(a,o[1],!0)+":"+i.toR1C1(a,o[2],!0)));let s=null;for(;s=i.single_dep.exec(n);)if(s){const e=s[1];n=n.replace(s[0],i.toR1C1(a,e,!0))}return n=n.replace(/ρ/g,"R"),n=n.replace(/γ/g,"C"),n}static extract_sheet_cell(e){(0,n.watchdog)("wd0x012630");const t=i.sheet_plus_cell.exec(e);return t?[t[1],t[2],t[2]]:["","",""]}static all_cell_dependencies(e,t,r,a=!0){(0,n.watchdog)("wd0x2f82fe");let o=null;const s=[];if("string"!=typeof e)return null;for(e=(e=(e=(e=(e=(e=(e=e.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=i.range_pair.exec(e);)if((0,n.watchdog)("wd0x784918"),o){const n=o[1],a=i.cell_dependency(n,t,r),u=o[2],l=i.cell_dependency(u,t,r),c=l[0]-a[0]+1,d=l[1]-a[1]+1;for(let e=0;e<c;e++)for(let t=0;t<d;t++)s.push([e+a[0],t+a[1],0]);e=e.replace(o[0],"_")}let u=null;for(;u=i.single_dep.exec(e);)if((0,n.watchdog)("wd0x0fb232"),u){const n=u[1],a=i.cell_dependency(n,t,r);s.push(a),e=e.replace(u[0],"_")}if(a){let t=null;for(;t=i.number_dep.exec(e);)(0,n.watchdog)("wd0xd82ed1"),t&&(s.push([0,0,1]),e=e.replace(t[0],"_"))}return s}static numeric_constants(e){const t=[];if("string"!=typeof(e=e.slice()))return t;e=(e=(e=(e=(e=(e=(e=e.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");let r=null;for(;r=i.range_pair.exec(e);)r&&(e=e.replace(r[0],"_"));let n=null;for(;n=i.single_dep.exec(e);)n&&(e=e.replace(n[0],"_"));let a=null;for(;a=i.number_dep.exec(e);)a&&(t.push(parseFloat(a)),e=e.replace(a[0],"_"));return t}static baseVector(){return[0,0,0]}static all_dependencies(e,t,r,a,o){(0,n.watchdog)("wd0x961028");let s=[];if(e>=o.length||t>=o[0].length||e<0||t<0)return[];const u=o[e][t];return u.length>1&&"="===u[0]&&(s=i.all_cell_dependencies(u,a,r)),s}static generate_all_references(e,t,r){(0,n.watchdog)("wd0x6a6002");const a={};for(let o=0;o<e.length;o++){const s=e[o];for(let o=0;o<s.length;o++){(0,n.watchdog)("wd0x93d412");const u=s[o];if("="===u[0]){const o=i.all_cell_dependencies(u,0,0);for(const i of o)if((0,n.watchdog)("wd0x8a466e"),0===i[0]&&0===i[1]&&0!==i[2]);else{const n=i[0]-t-1,o=i[1]-r-1;{let t=!1;if(o>=e.length||n>=e[0].length||n<0||o<0)t=!0;else{const r=e[o][n];void 0!==r&&"="!==r[0]&&(t=!0)}t&&(a[i.join(",")]=!0)}}}}}return a}}t.ExcelUtils=i,i.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",i.sheet_re="[^\\!]+",i.sheet_plus_cell=new RegExp("("+i.sheet_re+")\\!("+i.general_re+")"),i.sheet_plus_range=new RegExp("("+i.sheet_re+")\\!("+i.general_re+"):("+i.general_re+")"),i.single_dep=new RegExp("("+i.general_re+")"),i.range_pair=new RegExp("("+i.general_re+"):("+i.general_re+")","g"),i.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),i.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),i.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),i.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),i.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),i.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),i.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),i.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),i.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),i.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),i.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),i.originalSheetSuffix="_EL"},6736:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(5211);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},1121:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0,t.InfoGain=class{static normalized_entropy(e){const t=e.reduce(((e,t)=>e+t),0);let r=0;for(let n=0;n<e.length;n++){const i=e[n]/t;0!==i&&(r-=i*Math.log2(i))}return r/Math.log2(t)}};class r{static initialize(){if(!r.initialized){if(r.stencil_right=r.stencil.filter((([e,t])=>e<=0)),r.stencil_left=r.stencil.filter((([e,t])=>e>=0)),r.stencil_top=r.stencil.filter((([e,t])=>t>=0)),r.stencil_bottom=r.stencil.filter((([e,t])=>t<=0)),r.stencil_topleft=r.stencil_top.filter((([e,t])=>e>=0)),r.stencil_topright=r.stencil_top.filter((([e,t])=>e<=0)),r.stencil_bottomleft=r.stencil_bottom.filter((([e,t])=>e>=0)),r.stencil_bottomright=r.stencil_bottom.filter((([e,t])=>e<=0)),r.reflectStencils){let e;e=r.stencil.filter((([e,t])=>e>0)).map((([e,t])=>[-e,t])),r.stencil_right=r.stencil_right.concat(e),e=r.stencil.filter((([e,t])=>e<0)).map((([e,t])=>[-e,t])),r.stencil_left=r.stencil_left.concat(e),e=r.stencil.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_top=r.stencil_top.concat(e),e=r.stencil.filter((([e,t])=>t>0)).map((([e,t])=>[e,-t])),r.stencil_bottom=r.stencil_bottom.concat(e),e=r.stencil_top.filter((([e,t])=>e<0)).map((([e,t])=>[-e,t])),r.stencil_topleft=r.stencil_topleft.concat(e),e=r.stencil_left.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_topleft=r.stencil_topleft.concat(e),r.stencil_topleft.splice(r.stencil_topleft.findIndex((e=>JSON.stringify(e)===JSON.stringify([1,1]))),1),e=r.stencil_top.filter((([e,t])=>e>0)).map((([e,t])=>[-e,t])),r.stencil_topright=r.stencil_topright.concat(e),e=r.stencil_right.filter((([e,t])=>t<0)).map((([e,t])=>[e,-t])),r.stencil_topright=r.stencil_topright.concat(e),r.stencil_topright.splice(r.stencil_topright.findIndex((e=>JSON.stringify(e)===JSON.stringify([-1,1]))),1),e=r.stencil_bottom.map((([e,t])=>[-e,t])).filter((([e,t])=>e>0)),r.stencil_bottomleft=r.stencil_bottomleft.concat(e),e=r.stencil_left.map((([e,t])=>[e,-t])).filter((([e,t])=>t<0)),r.stencil_bottomleft=r.stencil_bottomleft.concat(e),r.stencil_bottomleft.splice(r.stencil_bottomleft.findIndex((e=>JSON.stringify(e)===JSON.stringify([1,-1]))),1),e=r.stencil_bottom.map((([e,t])=>[-e,t])).filter((([e,t])=>e<0)),r.stencil_bottomright=r.stencil_bottomright.concat(e),e=r.stencil_right.map((([e,t])=>[e,-t])).filter((([e,t])=>t<0)),r.stencil_bottomright=r.stencil_bottomright.concat(e),r.stencil_bottomright.splice(r.stencil_bottomright.findIndex((e=>JSON.stringify(e)===JSON.stringify([-1,-1]))),1)}r.initialized=!0}}static apply_stencil(e,t,n,i,a,o){if(e.length!==r.stencil.length)throw Error("Length mismatched");let s=a;for(let r=0;r<e.length;r++){const[a,u]=e[r];s=o(s,t[n+u][i+a])}return s}static stencil_computation(e,t,n){r.initialize();const i=e.length,a=e[0].length,o=Array(i).fill(0).map((()=>Array(a).fill(0)));for(let s=1;s<a-1;s++)for(let a=1;a<i-1;a++)o[a][s]=r.apply_stencil(r.stencil,e,s,a,n,t);for(let s=1;s<a-1;s++)o[0][s]=r.apply_stencil(r.stencil_top,e,0,s,n,t),o[i-1][s]=r.apply_stencil(r.stencil_bottom,e,i-1,s,n,t);for(let s=1;s<i-1;s++)o[s][0]=r.apply_stencil(r.stencil_left,e,s,0,n,t),o[s][a-1]=r.apply_stencil(r.stencil_right,e,s,a-1,n,t);return o[0][0]=r.apply_stencil(r.stencil_topleft,e,0,0,n,t),o[0][a-1]=r.apply_stencil(r.stencil_topright,e,0,a-1,n,t),o[i-1][0]=r.apply_stencil(r.stencil_bottomleft,e,i-1,0,n,t),o[i-1][a-1]=r.apply_stencil(r.stencil_bottomright,e,i-1,a-1,n,t),o}}t.Stencil=r,r.reflectStencils=!0,r.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],r.stencil=r.ninePointStencil,r.initialized=!1},3887:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;class r{static clone(e){if(e){if(Array.isArray(e))return e.slice();if(e.constructor===Object){const t={};for(const n of Object.keys(e))t[n]=r.clone(e[n]);return t}return e}return null}}t.JSONclone=r},5560:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;class r{static is_adjacent(e,t){const[[r,n,i],[a,o,s]]=e,[[u,l,c],[d,m,g]]=t;return!(r-d>1||u-a>1||n-m>1||l-o>1)}static bounding_box(e,t){const[[r,n,i],[a,o,s]]=e,[[u,l,c],[d,m,g]]=t;return[[Math.min(r,u),Math.min(n,l),0],[Math.max(a,d),Math.max(o,m),0]]}static area(e){const[[t,r,n],[i,a,o]]=e;return(i-t+1)*(a-r+1)}static diagonal(e){const[[t,r,n],[i,a,o]]=e,s=i-t+1,u=a-r+1;return Math.sqrt(s*s+u*u)}static overlap(e,t){const[[r,n,i],[a,o,s]]=e,[[u,l,c],[d,m,g]]=t;let p=0,h=0;return p=a>d?d-r+1:a-u+1,h=o>m?m-n+1:o-l+1,p*h}static is_mergeable(e,t){return r.is_adjacent(e,t)&&r.area(e)+r.area(t)-r.overlap(e,t)===r.area(r.bounding_box(e,t))}}t.RectangleUtils=r},7525:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0,t.createPerf=i;const r=1e9,n=1e6;function i(){return"undefined"!=typeof process?{now:()=>{const[e,t]=process.hrtime();return(e*r+t)/n}}:"undefined"!=typeof performance?performance:Date}t.Timer=class{start(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS}split(e){const t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t}elapsedTime(){return this.perf.now()-this.startTimeMS}roundMe(e){return Math.round(100*e)/100}constructor(e){this.perf=i(),this.name=e,this.start()}}},6349:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;const n=(0,r(7525).createPerf)();t.watchdog=function(){let e=1/0;const t=(t="")=>{if(n.now()>e)throw new Error(`Time limit exceeded with message: ${t}`)};return t.arm=t=>{e=n.now()+t},t}()},2289:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LimitedSizeHotMap=void 0;class r extends Map{set(e,t){if(!this.query(e)&&this.size>=this.maxSize){const e=this.keys().next().value;this.delete(e)}return super.set(e,t)}query(e){if(this.has(e)){const t=this.get(e);return this.delete(e),this.set(e,t),!0}return!1}constructor(e){if(super(),this.maxSize=e,e<1)throw new Error("maxSize must be greater than 0")}}t.LimitedSizeHotMap=r},6005:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=void 0,t.anonymize=function(e){try{return String(JSON.stringify(a(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return`<error: ${String(JSON.stringify(e))}>`;const t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?`<error ${r}>`:`<error ${t}: ${r}>`}},t.anonymizeMagnitude=function(e){const t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))},t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(l,"d").replace(u,"w")};const n=r(1549);function i(e){return e}function a(e,r){if("string"==typeof r&&null!=o[r])return e;const n=function(e){if("object"==typeof e&&null!==e){const t=e.kind;if("string"==typeof t)return t}}(e);let i=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===i&&(i=s[function(e){const t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==i?i(e,r):"<unexpected>"}const o={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:i,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":`<symbol ${String(e)}>`},undefined:i,null:i,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";const t=e.name;return"string"==typeof t&&t.length>0?`<function ${t}>`:"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=a(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(a):"<unexpected>"}};t.kindAnonymizers=Object.create(null);const u=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),l=/[0-9]/g,c=/d/g},9003:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.StrictArray2D=void 0,t.array2DForall=function(e,t){for(let r=0;r<t.rows;r+=1)for(let n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){const n=(0,i.fastMin)(t.rows,r.rows),a=(0,i.fastMin)(t.cols,r.cols);for(let i=0;i<n;i+=1)for(let n=0;n<a;n+=1)if(!e(t.get(i,n),r.get(i,n)))return!1;return!0},t.jaggedArray=l,t.array2DToJaggedArray=function(e){return l(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,((t,r)=>e[r]))},t.colArray2D=function(e){return new s(e.length,1,((t,r)=>e[t]))},t.transposeArray2D=function(e){return new s(e.cols,e.rows,((t,r)=>e.get(r,t)))},t.transposeSparseArray2D=function(e){return new u(e.cols,e.rows,e.denseCols,e.denseRows,((t,r)=>e.get(r,t)),(()=>e.getSparse()))},t.sparseArray2DTo1D=function(e,t){const r=e.getSparse.bind(e);return(0,n.assertTrue)("calc.common.sparseArray2DTo1D",t?0===e.cols||e.rows>0:0===e.rows||e.cols>0),t?{length:e.cols,denseLength:e.denseCols,get:t=>e.get(0,t),getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:t=>e.get(t,0),getSparse:r}},t.broadcastArray=function(e,t,r,n,i,a){if(e===r&&t===n)return i;if(1===e&&1===t)return c(r,n,void 0===i[0]?a:i[0][0]);const o=[];let s;s=1===e?(e,r)=>r<t?i[0][r]:a:1===t?(t,r)=>t<e?i[t][0]:a:(r,n)=>r<e&&n<t?i[r][n]:a;for(let e=0;e<r;e+=1){o.push([]);for(let t=0;t<n;t+=1)o[e][t]=s(e,t)}return o},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,((e,t)=>t<r.cols?r.get(0,t):n)):1===r.cols?new s(e,t,((e,t)=>e<r.rows?r.get(e,0):n)):new s(e,t,((e,t)=>e<r.rows&&t<r.cols?r.get(e,t):n))};const n=r(532),i=r(4230);class a{get(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]}strict(){return this}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.elements[t][r])))}constructor(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);const i=r.length;i<e&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements.length >= ${e}; given ${i}`);for(let a=0;a<i;a+=1){const i=r[a].length;i<t&&(0,n.assertFalse)(`calc.common.StrictArray2D: expected elements[${a}].length >= ${e}; given ${i}`)}this.rows=e,this.cols=t,this.elements=r}}t.StrictArray2D=a;class o{get(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement}getSparse(){return this.sparseElement}strict(){return this}map(e){return new u(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseElements[t][r])),(()=>e(this.sparseElement)))}constructor(e,t,r,i,a,o){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",i,t+1);const s=a.length;s<r&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements.length >= ${r}; given ${s}`);for(let e=0;e<s;e+=1){const t=a[e].length;t<i&&(0,n.assertFalse)(`calc.common.StrictSparseArray2D: expected elements[${e}].length >= ${i}; given ${t}`)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseElements=a,this.sparseElement=o}}t.StrictSparseArray2D=o;class s{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)}strict(){const e=l(this.rows,this.cols,this.func);return new a(this.rows,this.cols,e)}map(e){return new s(this.rows,this.cols,((t,r)=>e(this.func(t,r))))}constructor(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}}t.NonstrictArray2D=s;class u{get(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()}getSparse(){return this.sparseFunc()}strict(){const e=l(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new o(this.rows,this.cols,this.denseRows,this.denseCols,e,t)}map(e){return new u(this.rows,this.cols,this.denseRows,this.denseCols,((t,r)=>e(this.denseFunc(t,r))),(()=>e(this.sparseFunc())))}constructor(e,t,r,i,a,o){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",i,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseFunc=a,this.sparseFunc=o}}function l(e,t,r){const n=[];for(let i=0;i<e;i+=1){const e=[];for(let n=0;n<t;n+=1)e[n]=r(i,n);n[i]=e}return n}function c(e,t,r){const n=[],i=[];for(let e=0;e<t;e+=1)i[e]=r;for(let t=0;t<e;t+=1)n[t]=i;return n}function d(e,t,r){return new s(e,t,((e,t)=>r))}t.NonstrictSparseArray2D=u},532:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=void 0,t.assertNever=function(e,r){const a=`${e}: code should be unreachable because a value has type 'never'; given ${(0,i.anonymize)(r)}`;return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,a)},t.assertFalse=c,t.assertTrue=function(e,t){t||c(`${e}: expected condition to be true`)},t.assertInteger=function(e,t){(0,a.isInteger)(t)||c(`${e}: expected integer; given ${(0,i.anonymize)(t)}`)},t.assertNatural=function(e,t){(!(0,a.isInteger)(t)||t<0)&&c(`${e}: expected natural number; given ${(0,i.anonymize)(t)}`)},t.assertPositiveInteger=function(e,t){(!(0,a.isInteger)(t)||t<=0)&&c(`${e}: expected positive integer; given ${(0,i.anonymize)(t)}`)},t.assertIndex=function(e,t,r){(!(0,a.isInteger)(t)||t<0||t>=r)&&c(`${e}: expected natural number less than ${(0,i.anonymize)(r)}; given ${(0,i.anonymize)(t)}`)},t.assertPositiveLength=function(e,t,r){(!(0,a.isInteger)(t)||t<=0||t>r)&&c(`${e}: expected positive integer at most ${(0,i.anonymize)(r)}; given ${(0,i.anonymize)(t)}`)};const n=r(5033),i=r(6005),a=r(1549);function o(e,t){return function(r,n,i,a){if(e(r,n,i,a),!i)throw new Error(`${t} ${r} ${n} ${a}`)}}function s(e){return{shipAssertTag:o(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:o(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function u(e){return(...t)=>{try{return e(...t)}catch{}}}class l{createBufferingCallback(e){return(...t)=>{this.callBuffer.length<this.callBufferCapacity&&this.callBuffer.push({method:e,args:t})}}invokeBufferedCalls(){if(0===this.callBuffer.length)return;const e=this.callBuffer;this.callBuffer=[];const r=`calc.common.DefaultLogger.invokeBufferedCalls: ${e.length} calls before initLogger`;t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,r);for(const r of e)t.ulsLogger.noThrowLogger[r.method](...r.args)}constructor(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}}function c(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new class{setLogger(e){const t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:u(e.shipAssertTag.bind(e)),assertTag:u(e.assertTag.bind(e)),traceTag:u(e.traceTag.bind(e)),debugTraceTag:u(e.debugTraceTag.bind(e)),dnmTraceTag:u(e.dnmTraceTag.bind(e))}}(e),t instanceof l&&t.invokeBufferedCalls()}constructor(){this.logger=new l,this.ULS=s(this.logger),this.noThrowLogger=this.logger}}},1713:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7259:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=void 0,t.asyncLoopDelayPromiseImpl=s,t.asyncLoopFactory=u;const n=r(4230),i=r(49),a=r(5336),o=r(9135);function s(e){return()=>new Promise((t=>e.setImmediate(t,void 0)))}function u(e){return(0,i.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTS.UseAsyncLoopImmediate")?function(e){return(t,r)=>{const i=r?.timeThreshold??10,o=r?.costThreshold??1,s={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},[u,[l,c]]=(0,a.newPromise)();let d=!0,m=(0,n.now)();return function r(){if(!d||!function(){try{let e=0;for(;e<o;){s.iterations+=1;const r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return c(e),!1}}())return l();const a=(0,n.now)();a-m<i?(Promise.resolve().then(r),s.microtaskContinues+=1):(e.setImmediate((()=>{m=(0,n.now)(),s.macrotaskTotalDelay+=m-a,r()})),s.macrotaskContinues+=1)}(),{promise:u,stop:function(){d=!1},stats:s}}}(e):(t=s(e),(e,r)=>{const i=r?.timeThreshold??10,o=r?.costThreshold??1,s={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},[u,[l,c]]=(0,a.newPromise)();let d=!0,m=t(),g=(0,n.now)();return function r(){if(!d||!function(){try{let t=0;for(;t<o;){s.iterations+=1;const r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return c(e),!1}}())return l();const a=(0,n.now)();a-g<i?(Promise.resolve().then(r),s.microtaskContinues+=1):(m.then((()=>{m=t(),g=(0,n.now)(),s.macrotaskTotalDelay+=g-a,r()})),s.macrotaskContinues+=1)}(),{promise:u,stop:function(){d=!1},stats:s}});var t}t.asyncLoop=u(o.defaultSetTimeoutInterface)},540:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},1093:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=function e(...t){if(0===t.length)return[[]];const[r,...n]=t,i=e(...n),a=[];for(const e of r)for(const t of i)a.push([e,...t]);return a}},6179:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.initCalcCalled=void 0,t.isCalcInit=function(){return p},t.getCalcAbsUrl=function(){return g},t.getCalcAbsUrlOrThrow=h,t.initCalc=function(e,t,r){f(e,t,r,void 0)},t.initCalcInThread=async function(e,t,r,n){f(function(e){const t=e=>`[${(new Date).toISOString()}] ${e}`;return{shipAssertTag(r,n,i,a){e.shipAssertTag(r,n,i,t(a))},assertTag(r,n,i,a){e.assertTag(r,n,i,t(a))},traceTag(r,n,i,a){e.traceTag(r,n,i,t(a))},debugTraceTag(r,n,i,a){e.debugTraceTag(r,n,i,t(a))},dnmTraceTag(r,n,i,a){e.dnmTraceTag(r,n,i,t(a))}}}((await a.Endpoint.createOutside(e)).post),(e=>!0===t[e]),r,n)},t.initCalcThread=async function(e){const t=h(),r=new MessageChannel,n={port:r.port1,options:{id:"WorkerThreadLogger"}},i={port:r.port2,options:{id:"WorkerThreadLogger"}};try{const[r]=await Promise.all([a.Endpoint.createInside(n,(()=>o.ulsLogger.noThrowLogger)),e.call.initCalcThreadInside.transfer([i.port],i,(0,s.getFeatures)(),t)]);return r}catch(e){throw n.port.close(),e}};const n=r(6533),i=r(5033),a=n.__importStar(r(7882)),o=r(532),s=r(49),u=r(7506),l=r(5336),c=r(3234),d=r(121);t.initCalcCalled=new l.ResolvablePromise,t.maxRetriesForLoadingScript=9;const m=/^(https)|(http)|(file):\/\//;let g,p=!1;function h(){if(null==g)throw new Error("initCalc was not passed calcAbsUrl");return g}function f(e,r,n,l){if(p){const e="calc.config.initCalc: Calc is already initialized";return void o.ulsLogger.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)}if(o.ulsLogger.setLogger(e),(0,c.initStopwatch)(e),(0,s.initFeatureConfiguration)(r),null!=n&&!m.test(n)){const e=`calc.config.initCalc: calcAbsUrl is not absolute: ${n}`;o.ulsLogger.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,e)}a.setConfig(l??{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError(e){const t={error:(0,d.messageFromError)(e),innerError:e.info.error?(0,d.messageFromError)(e.info.error):void 0},r=`calc.onWorkerError: ${JSON.stringify(t)}`;o.ulsLogger.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onCreateWorker(e){const t=`calc.onCreateWorker: ${JSON.stringify(e)}`;o.ulsLogger.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}),g=n,p=!0;const h=`calc.config.initCalc: package version ${u.packageVersion} (production) initialized`;o.ulsLogger.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,h),t.initCalcCalled.resolve(void 0)}},4230:function(e,t){"use strict";function r(){const e=Object.create(null);return e.___=void 0,delete e.___,e}function n(e){return Object.keys(e).map((e=>Number(e))).filter((e=>!isNaN(e)))}function i(e,t){for(const r of t)e.push(r);return e}function a(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.staticAssertIsOptional=void 0,t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=function(){return e=>e},t.identity=function(e){return e},t.makeStringMap=r,t.cloneStringMap=function(e){const t=r();for(const r in e)t[r]=e[r];return t},t.numEnumArray=n,t.numEnumMap=function(e,t){const r={};for(const i of n(e))r[i]=t(i);return r},t.strEnumArray=function(e){return Object.keys(e).map((e=>e)).map((t=>e[t])).sort()},t.safePush=i,t.safeConcat=function(e,t){const r=[];i(r,e);for(const e of t)i(r,e);return r},t.isDefined=a,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(a)},t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){const t={sensitivity:"accent"};try{const r=new Intl.Collator(function(e){const t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),t);return r.compare.bind(r)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return e=>e},t.singleton=function(e){class t{static instance(){return void 0===t.value&&(t.value=e()),t.value}instance(){return t.instance()}}return t.value=void 0,t},t.mapFromArrayOfPairs=function(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})},t.staticAssertIsOptional=e=>e,t.now="undefined"!=typeof performance&&null!=performance.now?()=>performance.now():()=>Date.now()},430:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootPointer=t.ArrayMapTree=void 0,t.floorToPowerOf2=i,t.enumerateInOrder=o,t.enumerateKeysInOrder=function(e,t){return o(e,t).map((([e])=>e))};const n=r(8159);function i(e){if(0===e)return 0;let t=e;return t=(t|t>>>1)>>>0,t=(t|t>>>2)>>>0,t=(t|t>>>4)>>>0,t=(t|t>>>8)>>>0,t=(t|t>>>16)>>>0,t+=1,t/2}class a{static create(e){return new a(e,[],[])}setValue(e,t){return this.setValues([[e,t]])}remove(e){return void 0===this.getKeyIndex(e)?this:this.filter((t=>t!==e))}getOrSetValue(e,t){const r=this.getKeyIndex(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,this.values[r]]}filter(e){const t=[];for(let r=0;r<this.keys.length;r+=1){const n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)}getCount(){return this.keys.length}getValue(e){const t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]}getEntry(e){const t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])}contains(e){return void 0!==this.getKeyIndex(e)}forEach(e){for(let t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0}setValues(e){const t=this.keys.map(((e,t)=>[e,this.values[t],t])),r=t.length;e.forEach((([e,n],i)=>t.push([e,n,i+r]))),t.sort((([e,,t],[r,,n])=>{const i=this.keyCompare(e,r);return 0!==i?i:t-n}));const n=[];let i;for(let e=0;e<t.length;e+=1){const[r,a]=t[e];void 0===i||0!==this.keyCompare(r,i)?(n.push([r,a]),i=r):n[n.length-1]=[r,a]}return this.ofSequence(n)}getKeyIndex(e){let r=t.RootPointer;for(;r>=0&&r<this.keys.length;){const t=this.keyCompare(e,this.keys[r]);if(0===t)return r;t<0?r=l(r):t>0&&(r=c(r))}}ofSequence(e){const r=e.slice();r.sort((([e],[t])=>this.keyCompare(e,t)));const n=new Array(r.length),i=new Array(r.length),o=function(e){const r=new Array(e);return u(t.RootPointer,r,0,e),r}(r.length);for(let e=0;e<r.length;e+=1){const[t,a]=r[o[e]];n[e]=t,i[e]=a}return new a(this.keyCompare,n,i)}constructor(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}}function o(e,t){const r=[];return s(e,t,r),r}function s(e,t,r){t<0||t>=e.keys.length||(s(e,l(t),r),r.push([e.keys[t],e.values[t]]),s(e,c(t),r))}function u(e,t,r,n){if(e>=t.length)return;const a=function(e){const t=i(e);return t/2-1<=e-t?t-1:e-t/2}(n);t[e]=r+a,u(l(e),t,r,a),u(c(e),t,r+a+1,n-a-1)}function l(e){return 2*e+1}function c(e){return 2*e+2}t.ArrayMapTree=a,t.RootPointer=0},2912:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0,t.BinaryHeap=class{insert(e){this.items.push(e);let t=this.getCount()-1;for(;t>0;){const r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e}peek(){return this.items[0]}removeMin(){const e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;let n=0;for(this.items[0]=t;n<r;){let e=n;const i=1+(n<<1),a=2+(n<<1);if(i<=r&&this.cmp(this.items[i],t)<0&&(e=i),a<=r&&this.cmp(this.items[a],e===i?this.items[e]:t)<0&&(e=a),n===e)break;this.items[n]=this.items[e],n=e}return this.items[n]=t,e}getCount(){return this.items.length}clear(){this.items.length=0}forEach(e){for(const t of this.items)if(!e(t))return}constructor(e){this.items=[],this.cmp=e}}},9668:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.empty=t.dense=t.SetKind=void 0,t.cacheKeySplitting=a,t.createFromKey=function(e){const t={...e,split:a(e.split,e.top)};return e=>o(t,S(t,t.top,e))},t.fromUntyped=o,t.union=s,t.unionUntyped=u,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:o(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=l,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||c(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=c,t.except=d,t.exceptUntyped=m,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:p(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=g,t.compareUntyped=p,t.lazy=S,t.symmetricDiff=function(e,t){return s(d(e,t),d(t,e))},t.complement=function(e){return d(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:F(e.root)},t.forEachKey=function(e,r){return e===t.empty||b(e.setOperations,e.root,r)},t.forEachKeyUntyped=b;const n=r(6533).__assign;var i;function a(e,t,r=10){return n=>{if(void 0!==n.split)return n.split;const i=e(n),a=n===t?0:n.depth;return void 0!==a&&a<r&&(n.split=i,i[0][0].depth=a+1,i[1][0].depth=a+1),i}}function o(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function s(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:o(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,r.root))}function u(e,r,n,i){if(i===t.empty)return n;if(i===t.dense)return i;if(n===t.empty)return i;if(n===t.dense)return n;if(n.isExact&&i.isExact){const a=function(e,r,n,i){const{key:a}=n,{key:o}=i,s=e.compare(a,o);if(void 0!==s)return s<0?i:n;const u=e.union(a,o);if(void 0!==u){const n=e.compare(u,r);return void 0!==n&&0===n?t.dense:v(e,r,u,!0)}}(e,r,n,i);if(void 0!==a)return a}const a=y(e,r,n),o=y(e,r,i),[[s],[l]]=e.split(r);return h(e,s,l,u(e,s,a.left,o.left),u(e,l,a.right,o.right))}function l(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return i;if(n===t.dense)return i;if(i===t.dense)return n;if(n.isExact&&i.isExact){const a=function(e,r,n,i){const{key:a}=n,{key:o}=i;if(!e.meets(a,o))return t.empty;const s=e.compare(a,o);if(void 0!==s)return s<0?n:i;const u=e.intersect(a,o);return void 0!==u?v(e,r,u,!0):void 0}(e,r,n,i);if(void 0!==a)return a}const a=y(e,r,n),o=y(e,r,i),[[s],[u]]=e.split(r);return h(e,s,u,l(e,s,a.left,o.left),l(e,u,a.right,o.right))}function c(e,r,n,i){if(n===t.empty||i===t.empty)return!1;if(n===t.dense||i===t.dense)return!0;if(n.isExact&&i.isExact)return e.meets(n.key,i.key);const a=y(e,r,n),o=y(e,r,i),[[s],[u]]=e.split(r);return c(e,s,a.left,o.left)||c(e,u,a.right,o.right)}function d(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?o(r.setOperations,m(r.setOperations,r.setOperations.top,e,r.root)):o(e.setOperations,m(e.setOperations,e.setOperations.top,e.root,r.root))}function m(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return n;if(i===t.dense)return t.empty;if(n===t.dense){const n=y(e,r,i),[[a],[o]]=e.split(r);return h(e,a,o,m(e,a,t.dense,n.left),m(e,o,t.dense,n.right))}if(n.isExact&&i.isExact){const t=function(e,t,r,n){const{key:i}=r,{key:a}=n;if(!e.meets(i,a))return r;const o=e.except(i,a);return void 0!==o?v(e,t,o,!0):void 0}(e,r,n,i);if(void 0!==t)return t}const a=y(e,r,n),o=y(e,r,i),[[s],[u]]=e.split(r);return h(e,s,u,m(e,s,a.left,o.left),m(e,u,a.right,o.right))}function g(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function p(e,r,n,i){if(n===i)return 0;if(n===t.empty)return-1;if(i===t.empty)return 1;if(n===t.dense)return i===t.dense?0:1;if(i===t.dense)return-1;if(n.isExact&&i.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,i);const a=y(e,r,n),o=y(e,r,i),[[s],[u]]=e.split(r),l=p(e,s,a.left,o.left);if(void 0===l)return;const c=p(e,u,a.right,o.right);return void 0!==c?g(l,c):void 0}function h(e,r,n,i,a){return i===t.empty?a===t.empty?t.empty:a===t.dense?f(i,a,void 0,!1,e.infimum(n,n),e.supremum(n,n)):f(i,a,void 0,!1,a.infimum,a.supremum):a===t.empty?i===t.dense?f(i,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):f(i,a,void 0,!1,i.infimum,i.supremum):i===t.dense?a===t.dense?t.dense:f(i,a,void 0,!1,e.combineInfima(e.infimum(r,r),a.infimum),e.combineSuprema(e.supremum(r,r),a.supremum)):a===t.dense?f(i,a,void 0,!1,e.combineInfima(i.infimum,e.infimum(n,n)),e.combineSuprema(i.supremum,e.supremum(n,n))):f(i,a,void 0,!1,e.combineInfima(i.infimum,a.infimum),e.combineSuprema(i.supremum,a.supremum))}function f(e,t,r,n,i,a){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:a}}function S(e,r,n){if(!e.meets(r,n))return t.empty;const i=e.compare(r,n);if(void 0!==i)return i<=0?t.dense:v(e,r,n,!0);const a=e.intersect(r,n);return void 0!==a?v(e,r,a,!0):v(e,r,n,!1)}function v(e,t,r,n){return f(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function y(e,r,i){if(void 0!==i.left)return i;const[[a],[o]]=e.split(r),s=h(e,a,o,S(e,a,i.key),S(e,o,i.key));if(s===t.empty||s===t.dense)throw new Error("incorrect set operations implementation");const u=s;return n(i,{left:u.left,right:u.right})}function F(e){return void 0===e||e===t.empty||e===t.dense?0:F(e.left)+F(e.right)+1}function b(e,r,n){return function r(i,a){if(a===t.empty)return!0;if(a===t.dense)return n(i);if(a.isExact)return n(a.key);const o=y(e,i,a),[[s],[u]]=e.split(i);return r(s,o.left)&&r(u,o.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(i||(t.SetKind=i={})),t.dense=i.Dense,t.empty=i.Empty},9556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedPareto=a,t.boundedParetoSplitter=o,t.boundedParetoSetOperations=function(e,t,r,a,s){const u=o(e,t,r);return{id:s,split:e=>u.split(e),canSplit:e=>u.canSplit(e),meets:n.ivlMeets,intersect:n.ivlMeet,union:(e,t)=>(0,n.ivlMeetsOrTouches)(e,t)?(0,n.ivlJoin)(e,t):void 0,except:n.ivlExcept,compare:n.ivlCompare,top:a,infimum:([e])=>e,supremum:([,e])=>e,combineInfima:(e,t)=>(0,i.fastMin)(e,t),combineSuprema:(e,t)=>(0,i.fastMax)(e,t)}};const n=r(9814),i=r(4230);function a(e,t,r){const n=t**e,i=1-(t/r)**e,a=r**e,o=a*n,s=a-n,u=-1/e;return{cdf:1===e?e=>(1-n/e)/i:t=>(1-n*t**-e)/i,invCdf:1===e?e=>1/((a-e*s)/o):e=>((a-e*s)/o)**u}}function o(e,t,r){const n=a(e,t,r);return{canSplit:([e,t])=>t-e>1,split([e,t]){const r=n.cdf(t),a=n.cdf(e+1),o=n.invCdf((r+a)/2),s=(0,i.fastMin)((0,i.fastMax)(Math.round(o),e+1),t-1);return[[[e,s],n.cdf(s)-n.cdf(e+1)],[[s,t],n.cdf(t)-n.cdf(s)]]}}}},4743:function(e,t){"use strict";function r(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0,t.Deque=class{getCount(){return this.count}maybeResize(){const e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(let t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0;return}const t=e>>4;if(t>=1&&this.count<t){for(let n=0;n<this.count;n+=1)this.values[r(this.front+n,t)]=this.values[r(this.front+n,e)];this.values.length=t,this.front=r(this.front,t)}}pushBack(e){this.maybeResize(),this.values[r(this.front+this.count,this.values.length)]=e,this.count+=1}pushFront(e){this.maybeResize();const t=r(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1}peekBack(){return this.values[r(this.front+this.count-1,this.values.length)]}peekFront(){return this.values[this.front]}peekPos(e){if(!(e<0||e>=this.count))return this.values[r(this.front+e,this.values.length)]}popBack(){const e=r(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t}popFront(){const e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=r(this.front+1,this.values.length),this.count-=1),e}forEach(e){const t=this.values.length;for(let n=0;n<this.count;n+=1)if(!e(this.values[r(this.front+n,t)]))return!1;return!0}constructor(){this.front=0,this.count=0,this.values=[void 0]}}},1615:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeDictionary=a,t.makeStringDict=function(){return a(i.identity)},t.makeNumberDict=function(){return a((e=>String(e)))};const n=r(8159),i=r(4230);function a(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,i.makeStringMap)(),keyToString:e,getCount(){return Object.keys(this.entries).length},getValue(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)?n.value:void 0},getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue(e,r){const a=this.keyToString(e),o=t(this.entries,a)?this.entries[a]:void 0;(0,i.isDefined)(o)?o.value=r:this.entries[a]=(0,n.entry)(e,r)},contains(e){const r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)},remove(e){const r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue(e,r){const a=this.keyToString(e),o=t(this.entries,a)?this.entries[a]:void 0;if((0,i.isDefined)(o))return o.value;const s=r();return delete this.entries[a],this.entries[a]=(0,n.entry)(e,s),s},forEach(e){for(const r in this.entries){const n=t(this.entries,r)?this.entries[r]:void 0;if((0,i.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}}},1795:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add(e){const t=this.keyToHash(e);if((0,i.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{const r=this.map[t];for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return;(0,n.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains(e){const t=this.keyToHash(e),r=this.map[t];if((0,i.isNone)(r))return!1;for(let t=0;t<r.length;t+=1)if(this.keyEquals(e,r[t]))return!0;return(0,n.logCollisionKey)(e),!1},forEach(e){Object.keys(this.map).forEach((t=>{this.map[Number(t)].forEach((t=>{e(t)}))}))},size(){return this.nelements},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,i.isNone)(r))return!1;const a=[];let o=!1;return r.forEach((t=>{this.keyEquals(e,t)?(this.nelements-=1,o=!0):a.push(t)})),this.map[t]=a,o||(0,n.logCollisionKey)(e),o}}};const n=r(4258),i=r(4230)},9023:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount(){return this.nentries},getValue(e){const t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry(e){const t=this.keyToHash(e),r=this.map[t];if(!(0,a.isNone)(r)){for(let t=0;t<r.length;t+=1){const n=r[t];if(this.keyEquals(e,n.key))return n}(0,i.logCollisionKey)(e)}},contains(e){return void 0!==this.getValue(e)},setValue(e,t){const r=this.keyToHash(e),a=this.map[r];if(null==a)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(let r=0;r<a.length;r+=1){const n=a[r];if(this.keyEquals(n.key,e))return void(n.value=t)}a.push((0,n.entry)(e,t)),this.nentries+=1,(0,i.logCollisionKey)(e)}},remove(e){const t=this.keyToHash(e),r=this.map[t];if((0,a.isNone)(r))return!1;const n=[];let o=!1;for(let t=0;t<r.length;t+=1){const i=r[t];this.keyEquals(e,i.key)?(this.nentries-=1,o=!0):n.push(i)}return this.map[t]=n,o||(0,i.logCollisionKey)(e),o},getOrSetValue(e,t){const r=this.keyToHash(e),o=this.map[r];if((0,a.isNone)(o)){const i=t();return this.map[r]=[(0,n.entry)(e,i)],this.nentries+=1,i}for(let t=0;t<o.length;t+=1){const r=o[t];if(this.keyEquals(e,r.key))return r.value}const s=t();return o.push((0,n.entry)(e,s)),this.nentries+=1,(0,i.logCollisionKey)(e),s},forEach(e){return Object.keys(this.map).every((t=>this.map[Number(t)].every((t=>e(t.key,t.value)))))},filter(e){const t=[];this.forEach(((r,n)=>(e(r,n)||t.push(r),!0)));for(const e of t)this.remove(e)}}};const n=r(8159),i=r(4258),a=r(4230)},4185:function(e,t){"use strict";function r(e,t,r,n,i){let a=t,o=t+r-1;for(;a<=o;){const t=a+(o-a>>>1),r=i(e[t],n);if(0===r)return t;r<0?a=t+1:o=t-1}return~a}Object.defineProperty(t,"__esModule",{value:!0}),t.Histogram=void 0,t.linearBuckets=function(e,t,r){const n=(t-e)/(r-1),i=[];for(let t=e,a=0;a<r;t+=n,a+=1)i.push(t);return i},t.exponentialBuckets=function(e,t,r){const n=Math.log(e),i=(Math.log(t)-n)/(r-1),a=[];for(let e=0,t=0;t<r;e+=i,t+=1)a.push(Math.exp(n+e));return a},t.binarySearch=r,t.Histogram=class{addSample(e){let t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1}reset(){const e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e}constructor(e){this.buckets=e,this.createSampleCounts=()=>new Array(this.buckets.length+1).fill(0),this.sampleCounts=this.createSampleCounts(),this.findBucket=(()=>{const e=(e,t)=>e-t,t=this.buckets.length;return n=>r(this.buckets,0,t,n,e)})()}}},2935:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=t.rTree=t.RingBuffer=t.rbTree=t.RedBlackMapTree=t.productSet=t.PriorityQueue=t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=t.makeHashTable=t.makeHashSet=t.makeNumberDict=t.makeStringDict=t.makeDictionary=t.Deque=t.bspSplit=t.bspSet=t.BinaryHeap=t.ArrayMapTree=void 0;const n=r(6533);var i=r(430);Object.defineProperty(t,"ArrayMapTree",{enumerable:!0,get:function(){return i.ArrayMapTree}});var a=r(2912);Object.defineProperty(t,"BinaryHeap",{enumerable:!0,get:function(){return a.BinaryHeap}}),t.bspSet=n.__importStar(r(9668)),t.bspSplit=n.__importStar(r(9556));var o=r(4743);Object.defineProperty(t,"Deque",{enumerable:!0,get:function(){return o.Deque}});var s=r(1615);Object.defineProperty(t,"makeDictionary",{enumerable:!0,get:function(){return s.makeDictionary}}),Object.defineProperty(t,"makeStringDict",{enumerable:!0,get:function(){return s.makeStringDict}}),Object.defineProperty(t,"makeNumberDict",{enumerable:!0,get:function(){return s.makeNumberDict}});var u=r(1795);Object.defineProperty(t,"makeHashSet",{enumerable:!0,get:function(){return u.makeHashSet}});var l=r(9023);Object.defineProperty(t,"makeHashTable",{enumerable:!0,get:function(){return l.makeHashTable}});var c=r(4185);Object.defineProperty(t,"Histogram",{enumerable:!0,get:function(){return c.Histogram}}),Object.defineProperty(t,"linearBuckets",{enumerable:!0,get:function(){return c.linearBuckets}}),Object.defineProperty(t,"exponentialBuckets",{enumerable:!0,get:function(){return c.exponentialBuckets}}),Object.defineProperty(t,"binarySearch",{enumerable:!0,get:function(){return c.binarySearch}});var d=r(9814);Object.defineProperty(t,"ivlJoin",{enumerable:!0,get:function(){return d.ivlJoin}}),Object.defineProperty(t,"ivlMeet",{enumerable:!0,get:function(){return d.ivlMeet}}),Object.defineProperty(t,"ivlDistance",{enumerable:!0,get:function(){return d.ivlDistance}}),Object.defineProperty(t,"ivlMeets",{enumerable:!0,get:function(){return d.ivlMeets}}),Object.defineProperty(t,"ivlMeetsOrTouches",{enumerable:!0,get:function(){return d.ivlMeetsOrTouches}}),Object.defineProperty(t,"ivlExcept",{enumerable:!0,get:function(){return d.ivlExcept}}),Object.defineProperty(t,"ivlCompare",{enumerable:!0,get:function(){return d.ivlCompare}});var m=r(1624);Object.defineProperty(t,"PriorityQueue",{enumerable:!0,get:function(){return m.PriorityQueue}}),t.productSet=n.__importStar(r(9610));var g=r(317);Object.defineProperty(t,"RedBlackMapTree",{enumerable:!0,get:function(){return g.RedBlackMapTree}}),t.rbTree=n.__importStar(r(6135));var p=r(7151);Object.defineProperty(t,"RingBuffer",{enumerable:!0,get:function(){return p.RingBuffer}}),t.rTree=n.__importStar(r(6881));var h=r(8159);Object.defineProperty(t,"makeEmptyTable",{enumerable:!0,get:function(){return h.makeEmptyTable}}),Object.defineProperty(t,"entry",{enumerable:!0,get:function(){return h.entry}})},9814:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlJoin=function(e,t){const[r,i]=e,[a,o]=t;return[(0,n.fastMin)(r,a),(0,n.fastMax)(i,o)]},t.ivlMeet=function(e,t){const[r,i]=e,[a,o]=t;return[(0,n.fastMax)(r,a),(0,n.fastMin)(i,o)]},t.ivlDistance=function(e,t){const[r,i]=e,[a,o]=t;return.5*(0,n.fastAbs)(r+i-(a+o))},t.ivlMeets=function(e,t){const[r,i]=e,[a,o]=t;return(0,n.fastMax)(r,a)<(0,n.fastMin)(i,o)},t.ivlMeetsOrTouches=function(e,t){const[r,i]=e,[a,o]=t;return(0,n.fastMax)(r,a)<=(0,n.fastMin)(i,o)},t.ivlExcept=function(e,t){const[r,n]=e,[i,a]=t;return r<i&&a>=n?[r,i]:r>=i&&a<n?[a,n]:void 0},t.ivlCompare=function(e,t){const[r,n]=e,[i,a]=t;return r===i&&n===a?0:r>=i&&n<=a?-1:r<=i&&n>=a?1:void 0};const n=r(4230)},1624:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;const n=r(2912);t.PriorityQueue=class{peek(){const e=this.heap.peek();if(void 0!==e)return e[0]}enqueue(e){this.max+=1,this.heap.insert([e,this.max])}push(e){this.min-=1,this.heap.insert([e,this.min])}pop(){const e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]}getCount(){return this.heap.getCount()}clear(){this.heap.clear()}constructor(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((([t,r],[n,i])=>{const a=e(t,n);return 0!==a?a:r-i}))}}},9610:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductSetSerializer=t.symmetricDiffProduct=t.complementProduct=t.createFromProduct=void 0,t.project=y,t.unionProduct=A,t.intersectProduct=function(e,t){if(e===n.empty)return e;if(t===n.empty)return t;if(e===n.dense)return t;if(t===n.dense)return e;const r={...e.productOperations,...t.productOperations},i=T(r,e.root,t.root,o(r));return i===n.empty?i:d(r,i)},t.exceptProduct=N,t.compareProduct=function(e,t){if(e===t)return 0;if(e===n.empty)return-1;if(t===n.empty)return 1;if(e===n.dense)return t===n.dense?0:1;if(t===n.dense)return-1;const r={...e.productOperations,...t.productOperations};return I(r,e.root,t.root,o(r))},t.meetsProduct=function(e,t){if(e===n.empty||t===n.empty)return!1;if(e===n.dense||t===n.dense)return!0;const r={...e.productOperations,...t.productOperations};return P(r,e.root,t.root,o(r))},t.getSubspaces=function(e){if(e===n.empty||e===n.dense)return[];const t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,t,...r){const i=y(e,...r);if(i===n.empty)return!0;if(i===n.dense)return t(g.denseProduct(r));const{productOperations:a,root:o}=i;return function e(n){return n.isSubspace?t(g.fromUntypedProduct(a,n.bounds,r)):e(n.left)&&e(n.right)}(o)},t.getSubspaceCount=function(e){return e===n.empty||e===n.dense?0:l(e.root)},t.productSetSerializer=function(e){return new _(e)};const n=r(9668),i=([e],[t])=>{return(r=String(e))<(n=String(t))?-1:r>n?1:0;var r,n},a={},o=e=>{const t=[];for(const r of Object.keys(e)){const n=r;t.push([n,e[n].id])}const r=function(e){let t="";for(const r of e)t+=String(r[0]),t+="\0",t+=String(r[1]),t+="\0";return t}(t.sort(i));let n=a[r];return void 0===n&&(n={box:{},probabilities:{},depth:1},a[r]=n),n};function s(e){return Object.getOwnPropertyNames(e).length>0}function u(e){return s(e)?{isSubspace:!0,bounds:e}:n.dense}function l(e){return e.isSubspace?1:e.subspaceCount}const c=(e,t,r)=>({isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:l(e)+l(t)});function d(e,t){if(t===n.dense)return t;if(t.isSubspace){let r=!1;for(const n of Object.keys(t.bounds))if(Object.prototype.hasOwnProperty.call(e,n)){r=!0;break}if(!r)return n.dense}return{productOperations:e,root:t}}function m(e){return void 0===e?n.dense:e}const g={unzip(e){const t={},r={};for(const i of Object.keys(e)){const a=i;if(Object.prototype.hasOwnProperty.call(e,a)){const i=e[a];if(i===n.empty)return n.empty;if(i===n.dense)continue;t[a]=i.setOperations,r[a]=i.root}}return d(t,u(r))},combineProduct(e,t,r,i){const a={};for(const o of Object.keys(e)){const s=o;if(Object.prototype.hasOwnProperty.call(e,s)){const o=i(e[s],e[s].top,m(t[s]),m(r[s]));if(o===n.empty)return n.empty;if(o===n.dense)continue;a[s]=o}}return a},restrict(e,...t){const r={};for(const n of t)if(Object.prototype.hasOwnProperty.call(e,n)){const t=e[n];r[n]=t}return r},fromUntypedProduct(e,t,r){const i={};for(const a of r){const r=t[a];i[a]=(0,n.fromUntyped)(e[a],void 0!==r?r:n.dense)}return i},denseProduct(e){const t={};for(const r of e)t[r]=n.dense;return t}};function p(e,t,r){const i=g.combineProduct(e,t,r,n.unionUntyped);if(i===n.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return i}function h(e,t,r){let i=0;for(const a of Object.keys(e)){const o=a;if(Object.prototype.hasOwnProperty.call(e,o)){const a=m(t[o]),s=m(r[o]),u=e[o];if(i=(0,n.combineCmp)(i,(0,n.compareUntyped)(u,u.top,a,s)),void 0===i)return}}return i}t.createFromProduct=g.unzip.bind(g);const f=(()=>{const e={};return(t,r,i)=>{if(r===e.left&&i===e.right)return e.res;e.left=r,e.right=i;const a=h(t,r.bounds,i.bounds);if(void 0!==a)return e.res=a<=0?i:r;let o;const s=Object.keys(t);for(const a of s)if(Object.prototype.hasOwnProperty.call(t,a)&&0!==(0,n.compareUntyped)(t[a],t[a].top,m(r.bounds[a]),m(i.bounds[a]))){if(void 0!==o)return e.res=void 0;o=a}if(void 0!==o){const a=(0,n.unionUntyped)(t[o],t[o].top,m(r.bounds[o]),m(i.bounds[o]));if(a===n.empty)return e.res=n.empty;if(a===n.dense){const{[o]:t,...n}=r.bounds;return e.res=u(n)}const s={...r.bounds,[o]:a};return e.res=u(s)}return e.res=void 0}})();function S(e,t,r){if(r===n.empty)return t;if(r===n.dense)return r;if(t===n.empty)return r;if(t===n.dense)return t;if(!t.isSubspace||!r.isSubspace)return c(t,r,p(e,t.bounds,r.bounds));const i=f(e,t,r);return void 0!==i?i:c(t,r,p(e,t.bounds,r.bounds))}function v(e,t,r,...i){if(t===n.empty||t===n.dense)return t;if(t.isSubspace)return u(g.restrict(t.bounds,...i));const[a,o]=F(e,r),[s,l]=C(e,t,a,o);return S(e,v(e,s,a,...i),v(e,l,o,...i))}function y(e,...t){if(e===n.dense||e===n.empty)return e;const r=g.restrict(e.productOperations,...t);if(!s(r))return n.dense;const i=v(r,e.root,o(r),...t);return i===n.empty?i:d(r,i)}function F(e,t){if(void 0!==t.children)return t.children;const{box:r,probabilities:i}=t;let a,o,s=0;const u=Object.keys(e);for(const t of u)if(Object.prototype.hasOwnProperty.call(e,t)){const u=i[t],l=e[t];if(void 0===u){a=t,o=l.top;break}if(u>s){const e=m(r[t]);if(e===n.empty)throw new Error("the key split can never return empty");let i=l.top;if(e!==n.dense){if(!e.isExact)throw new Error("the key can always be represented exactly");i=e.key}if(!l.canSplit(i))continue;a=t,s=u,o=i}}if(void 0===a||void 0===o)throw new Error("there has to be at least one dimension");const l=e[a],[[c,d],[g,p]]=l.split(o),h=[{box:{...r,[a]:(0,n.lazy)(l,l.top,c)},probabilities:{...i,[a]:d},depth:t.depth+1},{box:{...r,[a]:(0,n.lazy)(l,l.top,g)},probabilities:{...i,[a]:p},depth:t.depth+1}];return t.depth<10&&(t.children=h),h}function b(e,t,r,i){if(t===n.empty)return[n.empty,n.empty];if(t===n.dense)return[u(r),u(i)];const a=h(e,t.bounds,r);if(void 0!==a&&a<=0)return[t,n.empty];const o=g.combineProduct(e,t.bounds,r,n.intersectUntyped);if(o===n.empty)return[n.empty,t];const s=g.combineProduct(e,t.bounds,i,n.intersectUntyped);if(t.isSubspace)return[u(o),s===n.empty?n.empty:u(s)];const[l,c]=b(e,t.left,r,i),[d,m]=b(e,t.right,r,i);return[S(e,l,d),S(e,c,m)]}const C=(e,t,{box:r},{box:n})=>b(e,t,r,n);function k(e,t,r,i,a){const[o,s]=F(e,i),[u,l]=C(e,t,o,s),[c,d]=C(e,r,o,s),m=a(e,u,c,o);return m===n.dense?n.dense:S(e,m,a(e,l,d,s))}function E(e,t,r,i){if(r===n.empty)return t;if(t===n.empty)return r;if(t===n.dense)return t;if(r===n.dense)return r;if(t.isSubspace&&r.isSubspace){const n=f(e,t,r);if(void 0!==n)return n}return k(e,t,r,i,E)}function A(e,t){if(t===n.empty)return e;if(t===n.dense)return t;if(e===n.empty)return t;if(e===n.dense)return e;const r={...e.productOperations,...t.productOperations},i=E(r,e.root,t.root,o(r));return i===n.empty?i:d(r,i)}function T(e,t,r,i){if(t===n.empty||r===n.empty)return n.empty;if(t===n.dense)return r;if(r===n.dense)return t;if(t.isSubspace&&r.isSubspace){const i=g.combineProduct(e,t.bounds,r.bounds,n.intersectUntyped);return i===n.empty?n.empty:u(i)}return k(e,t,r,i,T)}function R(e,t,r,i){if(t===n.empty)return t;if(r===n.dense)return n.empty;if(r===n.empty)return t;if(t===n.dense)return k(e,t,r,i,R);if(t.isSubspace&&r.isSubspace){const i=function(e,t,r){const i=h(e,t.bounds,r.bounds);if(0===i||-1===i)return n.empty;let a;const o=Object.keys(e);for(const i of o)if(Object.prototype.hasOwnProperty.call(e,i)){const o=(0,n.compareUntyped)(e[i],e[i].top,m(t.bounds[i]),m(r.bounds[i]));if(void 0===o||o>0){if(void 0!==a)return;a=i}}if(void 0!==a){const i=(0,n.exceptUntyped)(e[a],e[a].top,m(t.bounds[a]),m(r.bounds[a]));if(i===n.empty)return n.empty;if(i===n.dense){const{[a]:e,...r}=t.bounds;return u(r)}return u({...t.bounds,[a]:i})}}(e,t,r);if(void 0!==i)return i}return k(e,t,r,i,R)}function N(e,t){if(e===n.empty)return e;if(t===n.empty)return e;if(t===n.dense)return n.empty;if(e===n.dense){const e=R(t.productOperations,n.dense,t.root,o(t.productOperations));return e===n.empty?e:d(t.productOperations,e)}const r={...e.productOperations,...t.productOperations},i=R(r,e.root,t.root,o(r));return i===n.empty?i:d(r,i)}function I(e,t,r,i){if(t===r)return 0;if(t===n.empty)return-1;if(r===n.empty)return 1;if(t===n.dense)return r===n.dense?0:1;if(r===n.dense)return-1;if(t.isSubspace&&r.isSubspace)return h(e,t.bounds,r.bounds);const[a,o]=F(e,i),[s,u]=C(e,t,a,o),[l,c]=C(e,r,a,o),d=I(e,s,l,a);return void 0!==d?(0,n.combineCmp)(d,I(e,u,c,o)):void 0}function P(e,t,r,i){if(t===n.empty||r===n.empty)return!1;if(t===n.dense||r===n.dense)return!0;if(!function(e,t,r){for(const i of Object.keys(e)){const a=i;if(Object.prototype.hasOwnProperty.call(e,a)){const i=m(t[a]),o=m(r[a]),s=e[a];if(!(0,n.meetsUntyped)(s,s.top,i,o))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;const[a,o]=F(e,i),[s,u]=C(e,t,a,o),[l,c]=C(e,r,a,o);return P(e,s,l,a)||P(e,u,c,o)}t.complementProduct=e=>N(n.dense,e),t.symmetricDiffProduct=(e,t)=>A(N(e,t),N(t,e));class O{putBack(e){this.cursor-=1,this.buffer[this.cursor]=e}pick(){return this.buffer[this.cursor]}get length(){return this.buffer.length-this.cursor}get empty(){return 0===this.length}pop(){const e=this.pick();return this.cursor+=1,e}constructor(e=[]){this.buffer=e,this.cursor=0}}class M{constructor(){this.size=0,this.clear=()=>{},this.get=()=>{},this.set=()=>this}}function D(e,t){return function(r,n,...i){const a=t.get(r);void 0===a?(e(r,n,...i),t.set(r,t.size)):n.push("__cached__",a)}}function w(e,t){return function(r,...n){if("__cached__"===r.pick()){r.pop();const e=r.pop();return t[e]}const i=e(r,...n);return t.push(i),i}}class _{getDims(e){return Object.keys(e)}serialize(e){this.cached.clear();const t=[];t.push(e.length);for(const r of e)this.serializeProductSetCached(r,t);return JSON.stringify(t)}deserialize(e){this.cache.length=0;const t=new O(JSON.parse(e)),r=t.pop(),n=[];for(let e=0;e<r;e+=1){const e=this.deserializeProductSetCached(t);n.push(e)}return n}static normalizeKey(e){if(Array.isArray(e))return[...e];if("object"==typeof e){const t={...e};return delete t.depth,delete t.split,t}return e}constructor(e){this.globalProductOperations=e,this.cached="undefined"!=typeof Map?new Map:new M,this.cache=[],this.serializers={},this.serializeProductSet=(e,t)=>{if(e===n.empty||e===n.dense)return void t.push(e);const r=e,i=this.getDims(r.productOperations);t.push(i),this.serializeUntypedSparseProductCached(r.root,t,i)},this.deserializeProductSet=e=>{const t=e.pop();if(t===n.empty||t===n.dense)return t;e.putBack(t);const r={},i=e.pop();for(const e of i){const t=this.globalProductOperations[e];r[e]=t}return{productOperations:r,root:this.deserializeUntypedSparseProductCached(e,i)}},this.serializeUntypedSparse=(e,t,r)=>{t.push(e?.isExact),t.push(this.serializers[r].serializeBound(e?.infimum)),t.push(this.serializers[r].serializeBound(e?.supremum));const i=_.normalizeKey(e?.key);t.push(this.serializers[r].serializeKey(i));for(const i of[e?.left,e?.right])null==i||i===n.empty||i===n.dense?t.push(i):(t.push("us"),this.serializeUntypedSparseCached(i,t,r))},this.deserializeUntypedSparse=(e,t)=>{const r=e.pop(),n=this.serializers[t].deserializeBound(e.pop()),i=this.serializers[t].deserializeBound(e.pop()),a=this.serializers[t].deserializeKey(e.pop()),[o,s]=["left","right"].map((r=>{const n=e.pop();return"us"===n?this.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:i,isExact:r,key:a,left:o,right:s}},this.serializeUntypedSparseProduct=(e,t,r)=>{t.push(e.isSubspace);for(const n of r){const r=e.bounds[n];this.serializeUntypedSparseCached(r,t,n)}e.isSubspace||(this.serializeUntypedSparseProductCached(e.left,t,r),this.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=(e,t)=>{const r=e.pop(),n={};for(const r of t){const t=this.deserializeUntypedSparseCached(e,r);n[r]=t}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:this.deserializeUntypedSparseProductCached(e,t),right:this.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=D(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=w(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=D(this.serializeProductSet,this.cached),this.deserializeProductSetCached=w(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=D(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=w(this.deserializeUntypedSparseProduct,this.cache);for(const t in e){const r={serializeKey:e[t].serializeKey??(e=>JSON.stringify(e)),deserializeKey:e[t].deserializeKey??(e=>JSON.parse(e)),serializeBound:e[t].serializeBound??(e=>JSON.stringify(e)),deserializeBound:e[t].deserializeBound??(e=>JSON.parse(e))};this.serializers[t]=r}}}t.ProductSetSerializer=_},6881:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=void 0,t.copyExcept=a;const n=r(8159),i=r(4230);function a(e,t,r){if(void 0!==r){const n=e.slice();return n[t]=r,n}const n=e.slice(0,-1);return t<e.length-1&&(n[t]=e[e.length-1]),n}var o,s;function u(e,t,r){return{kind:e,key:t,value:r}}function l(e,t){return u(o.Ptr,e,t)}function c(e,t){return u(o.Leaf,e,t)}function d(e,t){return u(o.Branch,e,t)}!function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(o||(t.RTKind=o={})),function(e){e[e.NotFound=1]="NotFound",e[e.Removed=2]="Removed",e[e.Delete=3]="Delete"}(s||(s={}));class m{static create(e,t,r,n,i=2){const a=i>1?Math.ceil(i):1;return new m({keyJoin:e,keyMeets:t,keyCompare:r,keyDistance:n,minChildren:a,maxChildren:2*a,keyGe:function(e,t){const n=r(e,t);return void 0!==n&&n>=0},keyLe:function(e,t){const n=r(e,t);return void 0!==n&&n<=0}},void 0,0)}getCount(){return this.count}get bounds(){return this.root?.key}getValue(e){if(void 0!==this.root)return function t(r,n){const i=r.keyCompare(n.key,e);if(n.kind===o.Ptr)return 0===i?n.value:void 0;if(!(void 0===i||i<0))for(const e of n.value){const n=t(r,e);if(void 0!==n)return n}}(this.lattice,this.root)}getEntry(e){const t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)}setValue(e,t,r=(e=>!0)){const n=S(this.lattice,this.root,e,r,t);return void 0!==n?n===this.root?this:new m(this.lattice,n,this.count):new m(this.lattice,f(this.lattice,this.root,l(e,t)),this.count+1)}filter(e){let t=new m(this.lattice,void 0,0);return this.forEach(((r,n)=>(e(r,n)&&(t=t.setValue(r,n)),!0))),t}contains(e,t=(e=>!0)){return void 0!==S(this.lattice,this.root,e,t)}getOrSetValue(e,t){const r=this.getValue(e);if(void 0===r){const r=t();return[this.setValue(e,r),r]}return[this,r]}forEach(e){return g(this.root,e)}forEachGe(e,t){return g(this.root,t,(t=>this.lattice.keyGe(t,e)),(t=>this.lattice.keyGe(t,e)))}forEachLe(e,t){return g(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyLe(t,e)))}forEachMeets(e,t){return g(this.root,t,(t=>this.lattice.keyMeets(t,e)),(t=>this.lattice.keyMeets(t,e)))}remove(e){if(null==this.root)return this;const t=[],r=this.lattice,n=(u,l)=>{const m=r.keyCompare(u.key,e);if(void 0===m||m<0)return(0,i.pair)(u,s.NotFound);if(u.kind===o.Leaf){const n=u.value;for(let o=0;o<n.length;o+=1)if(0===r.keyCompare(n[o].key,e)){const e=a(n,o);if(e.length<l){const r=c(u.key,e);return t.push(r),(0,i.pair)(r,s.Delete)}return(0,i.pair)(c(p(r,e),e),s.Removed)}}else{const e=u.value;for(let o=0;o<e.length;o+=1){const[c,m]=n(e[o],r.minChildren);if(m===s.Delete){const n=a(e,o);if(n.length>=l)return(0,i.pair)(d(p(r,n),n),s.Removed);const c=d(u.key,n);return t.push(c),(0,i.pair)(c,s.Delete)}if(m===s.Removed)return(0,i.pair)(d(u.key,a(e,o,c)),s.Removed)}}return(0,i.pair)(u,s.NotFound)},u=this.root.kind===o.Leaf?1:2,[h,S]=n(this.root,u);if(h===this.root)return this;let v=S===s.Delete?void 0:h;for(let e=0;e<t.length;e+=1)g(t[e],((e,t)=>(v=f(this.lattice,v,l(e,t)),!0)));return new m(this.lattice,v,this.count-1)}constructor(e,t,r){this.lattice=e,this.root=t,this.count=r}}function g(e,t,r,n){const i=void 0!==r?r:()=>!0,a=void 0!==n?n:()=>!0;if(null==e)return!0;const s=e=>{if(!i(e.key))return!0;if(e.kind===o.Leaf){const r=e.value;for(let e=0;e<r.length;e+=1){const n=r[e];if(a(n.key)&&!t(n.key,n.value))return!1}}else{const t=e.value;for(let e=0;e<t.length;e+=1)if(!s(t[e]))return!1}return!0};return s(e)}function p(e,t){let r=t[0].key;for(let n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function h(e,t,r){const[n,a]=function(e,t){const[r,n]=function(e,t){let r=0,n=1,a=e.keyDistance(t[0].key,t[1].key);for(let i=2;i<t.length;i+=1)for(let o=0;o<i;o+=1){const s=e.keyDistance(t[o].key,t[i].key);s>a&&(r=o,n=i,a=s)}return(0,i.pair)(r,n)}(e,t),a=t[r].key,o=t[n].key,s=[];for(let r=0;r<t.length;r+=1){const n=t[r];s.push([n,e.keyDistance(a,n.key)-e.keyDistance(o,n.key)])}s.sort(((e,t)=>e[1]-t[1]));let u=e.minChildren;for(;u<t.length-e.minChildren&&s[u][1]<0;u+=1);const l=[],c=[];for(let e=0;e<u;e+=1)l.push(s[e][0]);for(let e=u;e<t.length;e+=1)c.push(s[e][0]);return(0,i.pair)(l,c)}(e,r);return(0,i.pair)(u(t,p(e,n),n),u(t,p(e,a),a))}function f(e,t,r){if(null==t)return c(r.key,[r]);const[n,a]=function t(n){if(n.kind===o.Leaf){const t=[...n.value,r];if(t.length>e.maxChildren){const[r,a]=h(e,n.kind,t);return(0,i.pair)(c(r.key,r.value),a)}return(0,i.pair)(c(e.keyJoin(n.key,r.key),t),void 0)}const a=n.value.slice(),s=function(e,t,r){let n=0,i=e.keyDistance(t[0].key,r),a=t[0].value.length;for(let o=1;o<t.length;o+=1){const s=t[o],u=e.keyDistance(s.key,r);(u<i||u===i&&s.value.length<a)&&(n=o,i=u,a=s.value.length)}return n}(e,a,r.key),[u,l]=t(a[s]);if(a[s]=u,null!=l&&(a.push(l),a.length>e.maxChildren)){const[t,r]=h(e,n.kind,a);return(0,i.pair)(d(t.key,t.value),r)}return(0,i.pair)(d(e.keyJoin(n.key,r.key),a),void 0)}(t);return null!=a?d(e.keyJoin(n.key,a.key),[n,a]):n}function S(e,t,r,n,i){if(void 0!==t)return function t(n){if(n.kind!==o.Leaf)for(let i=0;i<n.value.length;i+=1){const o=n.value[i];if(e.keyMeets(o.key,r)){const e=t(o);if(void 0!==e)return d(n.key,a(n.value,i,e))}}else for(let e=0;e<n.value.length;e+=1){const t=s(n.value[e]);if(void 0!==t)return c(n.key,a(n.value,e,t))}}(t);function s(t){if(0===e.keyCompare(t.key,r))return void 0!==i&&t.value!==i&&n(t.value)?l(t.key,i):t}}t.RTree=m},317:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;const n=r(6135);class i{static create(e){return new i(n.emptyUntyped,0,e)}getCount(){return this.count}getValue(e){const t=(0,n.findUntyped)(this,e,this.root);return t?.value}getEntry(e){return(0,n.findUntyped)(this,e,this.root)}contains(e){return void 0!==this.getValue(e)}forEach(e){return(0,n.forEachUntyped)(e,this.root)}setValue(e,t){return new i((0,n.insertUntyped)(this,e,t,this.root),this.contains(e)?this.count:this.count+1,this.keyCompare)}remove(e){return this.contains(e)?new i((0,n.removeUntyped)(this,e,this.root),this.count-1,this.keyCompare):this}getOrSetValue(e,t){const r=this.getValue(e);if(void 0!==r)return[this,r];const a=t();return[new i((0,n.insertUntyped)(this,e,a,this.root),this.count+1,this.keyCompare),a]}filter(e){let t=n.emptyUntyped,r=0;return this.forEach(((i,a)=>(e(i,a)&&(t=(0,n.insertUntyped)(this,i,a,t),r+=1),!1))),new i(t,r,this.keyCompare)}constructor(e,t,r){this.root=e,this.count=t,this.keyCompare=r}}t.RedBlackMapTree=i},6135:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyUntyped=t.Color=void 0,t.fromUntyped=d,t.isLeaf=m,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=y,t.find=function(e,t){return y(t.ops,e,t.root)},t.forEachUntyped=F,t.forEach=function(e,t){return F(e,t.root)},t.insertUntyped=E,t.insert=function(e,t,r){return d(r.ops,E(r.ops,e,t,r.root))},t.removeUntyped=R,t.remove=function(e,t){return d(t.ops,R(t.ops,e,t.root))};const n=r(532);var i,a;!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(i||(t.Color=i={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(a||(a={}));const o=i.Red,s=i.Black,u=a.DoubleBlack,l={c:s,l:void 0,r:void 0},c={c:u,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function m(e){return void 0===e.l}function g(e){return e.c===o}function p(e){return e.c===s&&void 0!==e.l}function h(e){return e.c===s&&void 0===e.l}function f(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function S(e,{l:t,key:r,value:n,r:i}){return f(e,t,r,n,i)}function v(e){return m(e)?l:S(s,e)}function y(e,t,r){if(m(r))return;const n=e.keyCompare(t,r.key);return n<0?y(e,t,r.l):n>0?y(e,t,r.r):r}function F(e,t){return!!m(t)||!!F(e,t.l)&&!!e(t.key,t.value)&&F(e,t.r)}function b(e,t,r,n,i){if(e===s){if(g(t)&&g(t.l))return f(o,S(s,t.l),t.key,t.value,f(s,t.r,r,n,i));if(g(i)&&g(i.r))return f(o,f(s,t,r,n,i.l),i.key,i.value,S(s,i.r));if(g(t)&&g(t.r))return f(o,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,i));if(g(i)&&g(i.l))return f(o,f(s,t,r,n,i.l.l),i.l.key,i.l.value,f(s,i.l.r,i.key,i.value,i.r))}if(e===u){if(g(i)&&g(i.l))return f(s,f(s,t,r,n,i.l.l),i.l.key,i.l.value,f(s,i.l.r,i.key,i.value,i.r));if(g(t)&&g(t.r))return f(s,f(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,f(s,t.r.r,r,n,i))}return f(e,t,r,n,i)}function C(e,t,r,i,a){return e===o&&t.c===u&&p(a)?b(s,f(o,v(t),r,i,a.l),a.key,a.value,a.r):e===o&&p(t)&&a.c===u?b(s,t.l,t.key,t.value,f(o,t.r,r,i,v(a))):e===s&&t.c===u&&p(a)?b(u,f(o,v(t),r,i,a.l),a.key,a.value,a.r):e===s&&p(t)&&a.c===u?b(u,t.l,t.key,t.value,f(o,t.r,r,i,v(a))):e===s&&t.c===u&&g(a)&&p(a.l)?f(s,b(s,f(o,v(t),r,i,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===s&&g(t)&&p(t.r)&&a.c===u?f(s,t.l,t.key,t.value,b(s,t.r.l,t.r.key,t.r.value,f(o,t.r.r,r,i,v(a)))):((0,n.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==u&&a.c!==u),f(e,t,r,i,a))}function k(e,t,r,n){if(m(n))return f(o,l,t,r,l);const i=e.keyCompare(t,n.key);return i<0?b(n.c,k(e,t,r,n.l),n.key,n.value,n.r):i>0?b(n.c,n.l,n.key,n.value,k(e,t,r,n.r)):f(n.c,n.l,t,r,n.r)}function E(e,t,r,n){return function(e){return!g(e)||e.l.c!==o&&e.r.c!==o?e:S(s,e)}(k(e,t,r,n))}function A(e,t,r){if(m(r))return r;if(r.c===o&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?l:r;if(r.c===s&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&g(r.l)&&h(r.l.l)&&h(r.l.r)&&h(r.r)){const n=e.keyCompare(t,r.key);return n<0?f(s,A(e,t,r.l),r.key,r.value,l):n>0?r:f(s,l,r.l.key,r.l.value,l)}const i=e.keyCompare(t,r.key);if(i<0)return C(r.c,A(e,t,r.l),r.key,r.value,r.r);if(i>0)return C(r.c,r.l,r.key,r.value,A(e,t,r.r));(0,n.assertTrue)("calc.common.rbTree.rem: expected node",!m(r.r));const[a,u,d]=T(r.r);return C(r.c,r.l,a,u,d)}function T(e){if(e.c===o&&h(e.l)&&h(e.r))return[e.key,e.value,l];if(e.c===s&&h(e.l)&&h(e.r))return[e.key,e.value,c];if(e.c===s&&h(e.l)&&g(e.r))return[e.key,e.value,S(s,e.r)];(0,n.assertTrue)("calc.common.rbTree.remMin: expected node",!m(e.l));const[t,r,i]=T(e.l);return[t,r,C(e.c,i,e.key,e.value,e.r)]}function R(e,t,r){const i=A(e,t,function(e){return p(e)&&e.l.c===s&&e.r.c===s?S(o,e):e}(r));return(0,n.assertTrue)("calc.common.rbTree.remove: expected R|B",i.c===o||i.c===s),i}t.emptyUntyped=l},7151:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0,t.RingBuffer=class{count(){return this.counter}isEmpty(){return 0===this.counter}enqueue(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity}dequeue(){if(this.isEmpty())return;const e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}executeOnEveryElement(e){for(let t=0;t<this.counter;t++){const r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n&&!e(n))return!1}return!0}constructor(e=1/0){this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}}},8159:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyTable=function(){return r},t.entry=function(e,t){return{key:e,value:t}};const r={getCount:()=>0,getValue:()=>{},getEntry:()=>{},contains:()=>!1,forEach:()=>!0}},4258:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=function(e){!function(e){const t=a[e];a[e]=(void 0===t?0:t)+1,o+=1,o%100==0&&(i.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,`calc.common.hashUtils.logCollision: ${JSON.stringify(a)}.`),a={})}(function(e){return"object"==typeof e?null===e?"null":`Object {${Object.keys(e)}}`:typeof e}(e))};const n=r(5033),i=r(532);let a={},o=0},49:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.FeatureName=void 0,t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=l,t.getFeatures=function(){const e={};for(const t in o){const r=o[t];null!=r&&(e[r]=l(r))}return e};const n=r(5033),i=r(246),a=r(532);var o;!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(o||(t.FeatureName=o={}));let s=e=>{const t=`calc.common.isFeatureEnabledCallback: called with ${e} before initCalc`;return a.ulsLogger.ULS.traceTag(526989323,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,t),!1};const u={};function l(e){return void 0===u[e]&&(u[e]=s(e)),u[e]}t.getTypedFeatureGate=(0,i.makeGetTypedFeatureGate)({Number_Of_Times_Test_Was_Executed:1,"Microsoft.Office.Excel.TestBooleanFeatureGate":!1,"Microsoft.Office.Excel.TestStringFeatureGate":"","Microsoft.Office.Excel.TestNumericFeatureGate":0,"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonSyntaxHighlightingEnabled":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.x10PythonTooltipEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!0,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.FileOptimization":!1,"Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension":0,"Microsoft.Office.Excel.FormulaByExampleConditionals":!1,"Microsoft.Office.Excel.FormulaByExampleReferenceRowFormula":!1,"Microsoft.Office.Excel.GotoCtrlClick":!1,"Microsoft.Office.Excel.CalcEtaLambda":!1,"Microsoft.Office.Excel.EtaReducedLambdas":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1,"Microsoft.Office.Excel.InCellControlsAutodetection":!1,"Microsoft.Office.Excel.InCellControlsAutodetectionWin32":!1,"Microsoft.Office.Excel.DropdownAutodetection":!1,"Microsoft.Office.Excel.FormulaAuthoringWithNameManager":!1,"Microsoft.Office.Excel.GetLocalePluginEnabled":!1,"Microsoft.Office.Excel.CalculatedColumnFromHeader":!1,"Microsoft.Office.Excel.ValueErrorHighlightPlugin":!1,"Microsoft.Office.Excel.FormulaByExampleLearnFromOneExample":!1,"Microsoft.Office.Excel.X10FBEDesktopPluginEnabled":!0,"Microsoft.Office.Excel.FormulaGenerationCopilotAutoCompleteEntry":!1,"Microsoft.Office.Excel.FormulaAuthoringCopilotIPE":!1,"Microsoft.Office.Excel.AugLoop.FormulaByExampleScratchpadPreview":!1,"Microsoft.Office.Excel.AutoCompleteUserDefinedEnum":!1,"Microsoft.Office.Excel.FormulaCompletionPluginEnabled":!1,"Microsoft.Office.Excel.FormulaCompletionStartDelta":500});var c=r(246);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,i.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","Microsoft.Office.Excel.X10IntelligentPythonWP5","OfficeVSO:8575821_x10MapGetRichValueFieldListContext","Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions","OfficeVSO:9214272_FormulaRepairSuggestionsLimit2RatherThan1","Microsoft.Office.Excel.Parser2024","OfficeVSO:9429166_addRepairDiagnostics","OfficeVSO:9510546_X10FBEDesktopPluginChangeGate","OfficeVSO:9506075_ImportRangeWithOnlySheetIdFix","OfficeVSO:9538069_NamedRangeBrokenLinksFix","Microsoft.Office.Excel.CalcTS.UseAsyncLoopImmediate","OfficeVSO:9617414_ShadowEvalPoundErrors","OfficeVSO:9646883_NameManager-FG-Removal","OfficeVSO:9674315_FBEGenerateExplanationInPlugin","OfficeVSO:9683390_FormulaByExamplePlugin","OfficeVSO:9848728_refactorFormulaCopilotIPERequest","OfficeVSO:9766399_FBEAshaVetos"])},9684:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=function(e,t,r=(()=>""),n=(()=>1)){const i=[e],a=new Set(i);for(let e=0;e<i.length;e+=1)for(const r of t(i[e]))a.has(r)||(a.add(r),i.push(r));a.clear(),i.reverse();const o=new Map,s=[],u=new Map,l=[];i.forEach(((e,i)=>{const a=t(e).map((e=>o.get(e)));if(a.some((e=>void 0===e)))throw new Error("Circular references in the tree");const c=a.map((e=>s[e])),d=function(e){let t=u.get(e);return void 0!==t||(t=u.size,u.set(e,t)),t}(c.join("/")+"/"+r(e));if(s.push(d),void 0===l[d]){const t=c.map((e=>l[e])),r=t.map((e=>e.size)).reduce(((e,t)=>e+t),n(e)),i=t.map((e=>e.depth)).reduce(((e,t)=>Math.max(e,t)),0)+1;l[d]={subtrees:[e],size:r,depth:i}}else l[d].subtrees.push(e);o.set(e,i)}));for(const e of l)e.subtrees.reverse();const c=new Array(i.length);for(const e of l)c[c.length-o.get(e.subtrees[0])-1]=e;return c.filter((e=>void 0!==e))}},2369:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=function(e){let t=r;const n=e.length;for(let r=0;r<n;r+=1)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0};const r=2166136261},7506:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="12.3.34"},6913:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.result=t.ulsStopwatchFactory=t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=t.mixin=t.LimitedSizeHotMap=t.JSF32=t.fnv1a=t.findIsomorphicSubtrees=t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.isFeatureEnabled=t.FeatureName=t.initCalcInThread=t.initCalcThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=t.combinations=t.codePoint=t.asyncLoop=t.asyncLoopFactory=t.asyncLoopDelayPromiseImpl=t.PackageName=void 0;const n=r(6533),i=r(736);t.PackageName="excel-online-calc-common",n.__exportStar(r(6005),t),n.__exportStar(r(9003),t),n.__exportStar(r(532),t),n.__exportStar(r(1713),t);var a=r(7259);Object.defineProperty(t,"asyncLoopDelayPromiseImpl",{enumerable:!0,get:function(){return a.asyncLoopDelayPromiseImpl}}),Object.defineProperty(t,"asyncLoopFactory",{enumerable:!0,get:function(){return a.asyncLoopFactory}}),Object.defineProperty(t,"asyncLoop",{enumerable:!0,get:function(){return a.asyncLoop}}),t.codePoint=n.__importStar(r(540));var o=r(1093);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return o.combinations}});var s=r(6179);Object.defineProperty(t,"initCalcCalled",{enumerable:!0,get:function(){return s.initCalcCalled}}),Object.defineProperty(t,"maxRetriesForLoadingScript",{enumerable:!0,get:function(){return s.maxRetriesForLoadingScript}}),Object.defineProperty(t,"isCalcInit",{enumerable:!0,get:function(){return s.isCalcInit}}),Object.defineProperty(t,"getCalcAbsUrl",{enumerable:!0,get:function(){return s.getCalcAbsUrl}}),Object.defineProperty(t,"getCalcAbsUrlOrThrow",{enumerable:!0,get:function(){return s.getCalcAbsUrlOrThrow}}),Object.defineProperty(t,"initCalc",{enumerable:!0,get:function(){return s.initCalc}}),Object.defineProperty(t,"initCalcThread",{enumerable:!0,get:function(){return s.initCalcThread}}),Object.defineProperty(t,"initCalcInThread",{enumerable:!0,get:function(){return s.initCalcInThread}}),n.__exportStar(r(4230),t),n.__exportStar(r(2935),t);var u=r(49);Object.defineProperty(t,"FeatureName",{enumerable:!0,get:function(){return u.FeatureName}}),Object.defineProperty(t,"isFeatureEnabled",{enumerable:!0,get:function(){return u.isFeatureEnabled}}),Object.defineProperty(t,"getTypedFeatureGate",{enumerable:!0,get:function(){return u.getTypedFeatureGate}}),Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return u.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return u.setFeatureGateDictionaryGetter}}),Object.defineProperty(t,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return u.isTypedChangeGateEnabled}});var l=r(9684);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return l.findIsomorphicSubtrees}});var c=r(2369);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return c.fnv1a}});var d=r(9551);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return d.JSF32}});var m=r(2289);Object.defineProperty(t,"LimitedSizeHotMap",{enumerable:!0,get:function(){return m.LimitedSizeHotMap}});var g=r(3856);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return g.mixin}}),n.__exportStar(r(1549),t),n.__exportStar(r(5336),t),n.__exportStar(r(736),t),n.__exportStar(r(5171),t),n.__exportStar(r(6929),t);var p=r(9135);Object.defineProperty(t,"setImmediateUnified",{enumerable:!0,get:function(){return p.setImmediateUnified}}),Object.defineProperty(t,"clearTimerUnified",{enumerable:!0,get:function(){return p.clearTimerUnified}}),Object.defineProperty(t,"defaultSetTimeoutInterface",{enumerable:!0,get:function(){return p.defaultSetTimeoutInterface}});var h=r(3234);Object.defineProperty(t,"ulsStopwatchFactory",{enumerable:!0,get:function(){return h.ulsStopwatchFactory}}),n.__exportStar(r(2142),t),n.__exportStar(r(121),t),n.__exportStar(r(6083),t),t.result={isSuccess:i.isSuccess}},9551:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;const r=(e,t)=>(e<<t|e>>>32-t)>>>0;t.JSF32=class{next(){return this.nextU32()*(1/4294967296)}nextU32(){const e=this.x[0]-r(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^r(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0}constructor(e){this.x=new Uint32Array([4058668781,e,e,e]);for(let e=0;e<20;e+=1)this.nextU32()}}},3856:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=function(e,t,r){return class extends e{constructor(...e){super(...e);const n=t(this);for(const e of r)Object.defineProperty(this,e,{value:n[e].bind(n),enumerable:!1,configurable:!1})}}}},1549:function(e,t){"use strict";function r(e){try{return e()}catch{return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=void 0,t.arrayFill=function(e,t){for(let r=0;r<e.length;r+=1)e[r]=t;return e},t.objectValues=function(e){const t=[];for(const r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t},t.isInteger="function"==typeof Number.isInteger&&r((()=>Number.isInteger(1)&&!Number.isInteger(1.1)))?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,t.stringStartsWith="function"==typeof"".startsWith&&r((()=>"ab".startsWith("a")&&!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)))?(e,t,r=0)=>e.startsWith(t,r):(e,t,r=0)=>r+t.length<=e.length&&e.substring(r,r+t.length)===t,t.stringEndsWith="function"==typeof"".endsWith&&r((()=>"ab".endsWith("b")&&!"ab".endsWith("a")))?(e,t)=>e.endsWith(t):(e,t)=>t.length<=e.length&&e.substring(e.length-t.length,e.length)===t,t.repeat="function"==typeof"".repeat&&r((()=>"aaa"==="a".repeat(3)))?(e,t)=>e.repeat(t):(e,t)=>Array(t+1).join(e),t.mathLog2=Math.log2??(e=>Math.log(e)*Math.LOG2E)},5336:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaybeThenable=t.ResolvablePromiseWithTimeout=t.ResolvablePromiseWithLimitedSubscribers=t.ResolvablePromiseWithSyncValue=t.ResolvablePromise=void 0,t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.newPromise=function(){let e;return[new Promise(((t,r)=>e=[t,r])),e]},t.promiseLoop=function(e,t){let r;return new Promise(((n,i)=>{Promise.resolve(t).then((function t(a){if(void 0!==a){r=a;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))},t.isThenable=u,t.bindMaybeThenable=function(e,t,r){return u(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e};const n=r(532),i=r(4230);class a{then(e,t){return this.promise.then(e,t)}toPromise(){return this.promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}constructor(){this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}}t.ResolvablePromise=a;class o extends a{getCurrentValue(){return this.value}resolve(e){return u(e)||this.isUninitialized&&(this.value=e,this.isUninitialized=!1),super.resolve(e)}constructor(){super(),this.value=void 0,this.isUninitialized=!0,super.then((e=>this.value=e))}}t.ResolvablePromiseWithSyncValue=o;class s extends o{static makeAssertMessage(e){return`ResolvablePromiseWithBoundedSubscribers should not pass a limited amount of ${e} active subscribers when not settled`}settle(){this.isSettled=!0}then(e,t){return(0,n.assertTrue)(s.makeAssertMessage(this.limit),this.isSettled||this.currentSubscribers++<this.limit),super.then(e,t)}constructor(e){super(),this.limit=e,this.currentSubscribers=0,this.isSettled=!1,super.then(this.settle.bind(this),this.settle.bind(this))}}function u(e){return(0,i.isDefined)(e)&&"function"==typeof e.then}t.ResolvablePromiseWithLimitedSubscribers=s,t.ResolvablePromiseWithTimeout=class extends a{constructor(e,t){super(),t.setTimeout((()=>{const e=new Error("Promise timeout");e.name="TimeoutError",this.reject(e)}),e)}},t.MaybeThenable={all(e){const t=new Array(e.length),r=new a;let n=0;return e.forEach(((i,a)=>{u(i)?i.then((i=>{t[a]=i,++n===e.length&&r.resolve(t)}),(e=>{r.reject(e)})):t[a]=i})),r},any(e){const t=new a;return e.forEach(((e,r)=>{u(e)?e.then((e=>{t.resolve({result:e,resolvedIndex:r})}),(e=>{t.reject(e)})):t.resolve({result:e,resolvedIndex:r})})),t}}},736:function(e,t){"use strict";var r,n;function i(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=t.successUndefined=t.ResultKind=void 0,t.success=i,t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},t.javaScriptError=function(e){return{kind:n.JavaScriptError,error:e}},function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r||(t.ResultKind=r={})),t.successUndefined=i(void 0),function(e){e.JavaScriptError="JavaScriptError"}(n||(t.ReasonKind=n={}))},5171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.breakTransition=t.nextTransition=t.TransitionKind=void 0,t.callMachineTransition=o,t.nextOnSuccessReceiver=function(){return s};const n=r(736);var i;function a(e,t,r){return{kind:e,machine:t,receiver:r}}function o(e,t){return a(i.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(i||(t.TransitionKind=i={})),t.nextTransition=a(i.Next,void 0,void 0),t.breakTransition=a(i.Break,void 0,void 0);const s={receiveResult:e=>(0,n.isSuccess)(e)?t.nextTransition:e};class u extends Error{constructor(e,t){super("Cycle detected: tried to call an already-running Machine"),this.machine=e,this.stackDepth=t}}t.MachineCycle=u;class l{static resetStats(){l.maxStackDepth=0,l.numPauses=0,l.numCycles=0}pushFrame(e){const t=this.stack.length,r=e.machine;if(!0===r.runStatus)throw l.numCycles+=1,new u(r,t);!1===r.runStatus&&(r.runStatus=!0),this.stack.push(e),l.maxStackDepth<t+1&&(l.maxStackDepth=t+1)}advanceTopFrame(){const e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()}step(){this.numSteps+=1;const e=this.transition;try{switch(e.kind){case i.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case i.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case i.Break:return this.transition=t.nextTransition,e;default:const r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,n.failure)((0,n.javaScriptError)(e)),t.nextTransition}}run(e=(()=>!1)){if(this.result)return this.result;try{for(;;){const t=this.step();if(t.kind===i.Break)return t;if(t.kind!==i.Next)return this.result=t;if(e())return l.numPauses+=1,t}}catch(e){return this.result=(0,n.failure)((0,n.javaScriptError)(e))}}runToResult(){for(;;){const e=this.run();if(e.kind!==i.Break)return e}}constructor(e){this.numSteps=0,this.stack=[];try{this.pushFrame(o(e,{receiveResult:e=>e})),this.transition=t.nextTransition}catch(e){this.transition=(0,n.failure)((0,n.javaScriptError)(e))}}}t.MachineRuntime=l,l.maxStackDepth=0,l.numPauses=0,l.numCycles=0,t.AllMachine=class{next(){return this.values.length<this.machines.length?o(this.machines[this.values.length],this):(0,n.success)(this.values)}receiveResult(e){return(0,n.isSuccess)(e)?(this.values.push(e.value),this.next()):e}constructor(e){this.machines=e,this.runStatus=!1,this.values=[]}},t.VoidMachine=class{next(){return o(this.machine,this)}receiveResult(e){return(0,n.isSuccess)(e)?n.successUndefined:e}constructor(e){this.machine=e,this.runStatus=!1}}},6929:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;const n=r(5171),i=r(736);class a{setState(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e}next(){return this.transition instanceof a?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition}receiveResult(e){let t;try{if((0,i.isSuccess)(e)){if(!this.onFulfilled)return this.setState(e,void 0,void 0);t=this.onFulfilled(e.value)}else{if(!this.onRejected)return this.setState(e,void 0,void 0);t=this.onRejected(e.reason)}}catch(e){return this.setState((0,i.failure)((0,i.javaScriptError)(e)),void 0,void 0)}return t instanceof a?(this.setState(t.transition,t.onFulfilled,t.onRejected),t.setState(this,void 0,void 0),this.next()):this.setState((0,i.success)(t),void 0,void 0)}bind(e){return new a(this,e,void 0)}catch(e){return new a(this,void 0,e)}finally(e){return new a(this,(t=>(e(),t)),(t=>(e(),a.reject(t))))}static all(e){return a.fromMachine(new n.AllMachine(e.map(a.resolve)))}settle(){return new n.MachineRuntime(this).runToResult()}static settleOrThrow(e){const t=e.settle();if((0,i.isSuccess)(t))return t.value;throw t.reason.error}constructor(e,t,r){this.transition=e,this.onFulfilled=t,this.onRejected=r,this.runStatus=!(e instanceof a||e.kind===n.TransitionKind.CallMachine)&&e}}t.Pledge=a,a.resolve=e=>e instanceof a?e:new a((0,i.success)(e),void 0,void 0),a.reject=e=>new a((0,i.failure)(e),void 0,void 0),a.undefinedPledge=a.resolve(void 0),a.fromMachine=e=>{if(e instanceof a)return e;const t=new a(a.undefinedPledge,void 0,void 0);return t.transition=(0,n.callMachineTransition)(e,t),t},a.try=e=>a.undefinedPledge.bind(e),a.RepeatMachine=class{next(){const e=this.onLoop(this.accum);return e instanceof a?(0,n.callMachineTransition)(e,this):this.receiveSuccess(e)}receiveResult(e){return(0,i.isSuccess)(e)?this.receiveSuccess(e.value):e}receiveSuccess(e){return void 0===e?(0,i.success)(this.accum):(this.accum=e,n.nextTransition)}constructor(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}},a.repeat=(e,t)=>a.resolve(t).bind((t=>a.fromMachine(new a.RepeatMachine(e,t))))},9135:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=void 0,t.setImmediateUnified=s,t.clearTimerUnified=u;const n=r(6677),i=r(532),{setImmediate:a,clearImmediate:o}=void 0!==globalThis.setImmediateNode&&void 0!==globalThis.clearImmediateNode?{setImmediate:globalThis.setImmediateNode,clearImmediate:globalThis.clearImmediateNode}:{setImmediate:n.setImmediate,clearImmediate:n.clearImmediate};function s(e,...t){return{kind:"Immediate",timer:a(e,...t)}}function u(e){switch(e.kind){case"Immediate":o(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,i.assertNever)("unknown timer.kind",e)}}t.defaultSetTimeoutInterface={setImmediate:s,setTimeout:function(e,t,...r){return{kind:"Timeout",timer:setTimeout(e,t,...r)}},clearImmediate:u,clearTimeout:u}},3234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsStopwatchFactory=void 0,t.initStopwatch=function(e){i.ULS=e};const n=r(5033),i={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((e=>i.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)))},2142:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHighSurrogate=s,t.isLowSurrogate=u,t.isAnySurrogate=l,t.surrogatePairToCodePoint=c,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);const t=e-65536;return String.fromCharCode(t>>10|i,1023&t|a)},t.scanCodePoints=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n>=e.length)return;s(e.charCodeAt(n))&&n+1<e.length&&u(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){let n=t;for(let t=0;t<r;t+=1){if(n-1<0)return;u(e.charCodeAt(n-1))&&n-2>=0&&s(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){let n=0;for(let i=t;i<r;n+=1)s(e.charCodeAt(i))&&i+1<r&&u(e.charCodeAt(i+1))?i+=2:i+=1;return n},t.stringCodePointAt=d,t.numCodeUnits=m,t.codePointIterator=function*(e,t=0){let r=t;for(;r<e.length;){const t=d(e,r);yield t,r+=m(t)}},t.forEachClassInterval=g,t.makeIsInClass=function(e){const t=function(e){const t=[];for(let e=0;e<512;++e)t.push([]);return g(e,((e,r)=>{const i=r-1>>p;for(let a=e>>p;a<=i;++a){const i=a<<p,o=a+1<<p;t[a].push((0,n.fastMax)(e,i),(0,n.fastMin)(r,o))}})),t}(e);return e=>{if(e<0||e>65535)return!1;const r=t[e>>>p];for(let t=0;t<r.length;t+=2){const n=r[t],i=r[t+1];if(e>=n&&e<i)return!0}return!1}};const n=r(4230),i=55296,a=56320,o=65533;function s(e){return(64512&e)===i}function u(e){return(64512&e)===a}function l(e){return 55296==(63488&e)}function c(e,t){if(s(e)&&u(t))return 65536+((1023&e)<<10|1023&t)}function d(e,t){const r=e.charCodeAt(t);return l(r)?t+1>=e.length?o:c(r,e.charCodeAt(t+1))??o:r}function m(e){return e>=65536?2:1}function g(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(let r=0;r<e.length;r+=2)t(e[r],e[r+1])}const p=7},121:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.partialArray=function(e){const t=[];return Object.keys(e).map(Number).forEach((r=>t[r]=e[r])),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);const t=e,r=String(t.name),i=String(t.message);if(null!=t.stack){const e=String(t.stack);return e.indexOf(i)>=0&&e.indexOf(r)>=0?e:`${r}: ${i}\n${e}`}return i.indexOf(r)>=0?i:`${r}: ${i}`},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;const r=e;return r.message=`${t} ${String(r.message)}`,r};const n=r(6005)},6083:function(e,t){"use strict";function r(){return e=>function(e){const t=class{constructor(e){this.obj=e}};for(const r of e)t.prototype[r]=function(...e){const t=this.obj[r](...e);return Promise.resolve(t)};return t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsyncClass=r,t.wrapIntoAsync=function(e,t){return new(r()(t))(e)}},5218:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2381:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6533);n.__exportStar(r(5218),t),n.__exportStar(r(5066),t),n.__exportStar(r(6501),t)},5066:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(r||(t.CurrencyFormat=r={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(n||(t.DateOrder=n={}))},6501:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5665:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=function(e,t,r,i){const a=t.originGridCell.value;if((0,c.isGridCellEqual)(a,r))return(0,n.success)(i);try{const o=(0,d.reduceBottomUp)(new f(p.bind(void 0,e.config.refStyle,a,r),e,t,i.annotations),i);return(0,n.success)({...i,node:o})}catch(e){if(e instanceof h)return(0,n.failure)(e.reason);throw e}};const n=r(6913),i=r(3949),a=r(1211),o=r(1982),s=r(9209),u=r(7089),l=r(4052),c=r(6234),d=r(6426);function m(e,t,r,n){if(r.kind===o.PosKind.Abs)return r;const i=(0,a.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,o.pos)(o.PosKind.Rel,i)}function g(e,t,r,n){const a=m(t.row,r.row,n.row,s.sheetRows),u=m(t.col,r.col,n.col,s.sheetCols),l=(0,i.canonicaliseBrackets)(e,a)||(0,i.canonicaliseBrackets)(e,u);return(0,o.cellRefSingle)(a,u,l,n.label)}function p(e,t,r,n){switch(n.kind){case o.CellRefKind.Error:case o.CellRefKind.Bad:return n;case o.CellRefKind.Single:return g(e,t,r,n);case o.CellRefKind.Range:{const i=g(e,t,r,n.ref1),a=g(e,t,r,n.ref2);return i===n.ref1&&a===n.ref2?n:(0,o.cellRefRange)(i,a,n.label)}case o.CellRefKind.Row:{const a=m(t.row,r.row,n.row1,s.sheetRows),u=m(t.row,r.row,n.row2,s.sheetRows),l=(0,i.canonicaliseBrackets)(e,a)||(0,i.canonicaliseBrackets)(e,u);return(0,o.cellRefRow)(a,u,l,n.label)}case o.CellRefKind.Col:{const a=m(t.col,r.col,n.col1,s.sheetCols),u=m(t.col,r.col,n.col2,s.sheetCols),l=(0,i.canonicaliseBrackets)(e,a)||(0,i.canonicaliseBrackets)(e,u);return(0,o.cellRefCol)(a,u,l,n.label)}}}const h=(0,c.createFailureErrorClass)("TransformRefsError");class f extends d.IdentityVisitor{nameNode(e,t,r){const i=(0,o.nameNode)(e,t,r),{headResolved:a,fieldsResolved:s}=this.resolver.resolveDottedName(this.locals,i,this.annotations),c=(0,o.flattenNameParts)(e).parts;if((0,u.canDenoteCellRef)(this.locals,t,c)){const[e,i,...u]=c;if(a.kind===l.ResolvedKind.ResolvedCellRef){(0,n.assertTrue)("calc.analyze.adjustFormulaOrigin: all flattened field parts resolved",c.length===1+s.length);const l=this.fn(e.ref);if(l.kind===o.CellRefKind.Single||l.kind===o.CellRefKind.Row||l.kind===o.CellRefKind.Col){const n=(e,t)=>(0,o.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);return(0,o.nameNode)(u.reduce(n,n((0,o.cellRefNamePart)(l,e.asWhole,e.label,e.qualifiedLabel),i)),t,r)}const d=(e,{rhs:t,qualifiedLabel:r})=>(0,o.fieldRefNode)(e,t,r);return u.reduce(d,d((0,o.cellRefNode)(l,a.node.qualifier,a.node.label),i))}if(a.resolution.kind!==n.ResultKind.Success&&a.resolution.reason.kind!==l.ResolveReasonKind.NoOriginSheet&&a.resolution.reason.kind!==l.ResolveReasonKind.InvalidQualifier)throw new h(a.resolution.reason)}return i}cellRefNode(e,t,r){return(0,o.cellRefNode)(this.fn(e),t,r)}constructor(e,t,r,n){super(),this.fn=e,this.locals=r,this.annotations=n,this.resolver=(0,u.createResolver)(t)}}},2986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=function(e,t,r,a){const l=[];return(0,s.reduceTopDown_Pledge)(new u(e,l,(r??[]).reduce(((t,r)=>{const n=(0,o.getBoundName)(e,r.whole);return t.setValue(n,r)}),n.RedBlackMapTree.create(e.stringCompareCI))),t),l[t.label]=(0,i.formulaRootAnnotation)(r,a),l};const n=r(6913),i=r(1982),a=r(2371),o=r(6234),s=r(6426);class u extends s.PledgeReducer{appNode(e,t,r,a){return n.Pledge.try((()=>(e.kind===i.NodeKind.Name&&(this.annotations[e.label]=i.appHeadNameAnnotation),super.appNode(e,t,r,a))))}letNode(e,t,r,i){const o=e.id===a.WorksheetFuncId.LETREC||e.id!==a.WorksheetFuncId.LET&&(0,n.assertFalse)("calc.lang.buildAnnotations"),u=this.bindNames(t),l=u[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>o?n.Pledge.all(t.map((({binder:e})=>n.Pledge.try((()=>(0,s.visitFormulaNode)(l,e.arg)))))):n.Pledge.all(t.map((({binder:e},t)=>{const r=u[t];return n.Pledge.try((()=>(0,s.visitFormulaNode)(r,e.arg)))}))))).bind((e=>void 0===r?void 0:(0,s.visitFormulaNode)(l,r.arg))).bind((e=>n.Pledge.all(i.map((e=>n.Pledge.try((()=>(0,s.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}lambdaNode(e,t,r,i){const a=this.bindNames(t),o=a[t.length];return this.lazyVisitAppHeadNode(e).bind((e=>n.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return n.Pledge.resolve(void 0);const r=a[t],i=e.arg.def;return n.Pledge.try((()=>(0,s.visitFormulaNode)(r,i.rhs)))}))))).bind((e=>void 0===r?void 0:(0,s.visitFormulaNode)(o,r.arg))).bind((e=>n.Pledge.all(i.map((e=>n.Pledge.try((()=>(0,s.visitFormulaNode)(this,e.arg)))))))).bind((e=>{}))}bindNames(e){const t=[this];return e.reduce(((e,{name:r})=>{if(void 0===r.arg.wholeName)return t.push(new u(this.localeInfo,this.annotations,e)),e;const n=(0,o.getBoundName)(this.localeInfo,r.arg.wholeName),a=e.setValue(n,r.arg);return t.push(new u(this.localeInfo,this.annotations,a)),this.annotations[r.arg.label]=(0,i.localNameDeclAnnotation)(n,r.arg.wholeName),a}),this.names),t}nameNode(e,t,r){return n.Pledge.try((()=>{if(void 0===t){const t=(0,i.headNamePart)(e),r=this.names.getEntry((0,o.getBoundName)(this.localeInfo,t.asWhole));void 0===r||(r.value.kind===i.NodeKind.ContextName?this.annotations[t.label]=(0,i.localNameUseAnnotation)(r.key,r.value.whole,r.value.label):(this.annotations[t.label]=(0,i.localNameUseAnnotation)(r.key,r.value.wholeName,r.value.label),this.annotations[r.value.label].uses.push({label:t.label})))}return super.nameNode(e,t,r)}))}constructor(e,t,r){super(s.voidVisitor),this.localeInfo=e,this.annotations=t,this.names=r}}},3949:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=void 0,t.columnName=d,t.canonicaliseBrackets=function(e,t){return e===a.RefStyle.R1C1&&t.kind===a.PosKind.Rel&&0!==t.index},t.resolvePosition=m,t.formatRow=p,t.formatCol=h,t.formatCellPos=F,t.canonicaliseCellPos=function(e,r,n,i){const a=(0,t.canonicaliseRow)(e.row,r,i),o=(0,t.canonicaliseCol)(e.col,n,i);return void 0===a||void 0===o?void 0:{row:a,col:o}},t.formatRangePos=b,t.canonicaliseRangePos=function(e,r,n,i,a,s){const u=S(e.row,r,i,o.sheetRows,s),l=S(e.col,n,a,o.sheetCols,s);if(void 0===u||void 0===l)return;const[c,d,m,g]=u,[p,h,f,v]=l,y=(0,t.canonicaliseRow)(e.row,c,s),F=(0,t.canonicaliseCol)(e.col,p,s),b=(0,t.canonicaliseRow)(e.row,d,s),C=(0,t.canonicaliseCol)(e.col,h,s);return void 0!==y&&void 0!==F&&void 0!==b&&void 0!==C?0===f&&v===o.sheetCols-1&&n.kind===a.kind?{row1:y,row2:b,col1:void 0,col2:void 0}:0===m&&g===o.sheetRows-1&&r.kind===i.kind?{col1:F,col2:C,row1:void 0,row2:void 0}:{row1:y,col1:F,row2:b,col2:C}:void 0},t.shouldQuoteQualifier=T,t.formatQualifier=R,t.quoteQualifier=N,t.formatGridRange=function(e,t,r=a.RefStyle.A1,i,s){const u=1===t.cols&&1===t.rows?F(e,r,(0,o.gridCell)(0,0),(0,a.pos)(a.PosKind.Rel,t.row),(0,a.pos)(a.PosKind.Rel,t.col),!1):b(e,r,(0,o.gridCell)(0,0),(0,a.pos)(a.PosKind.Rel,t.row),(0,a.pos)(a.PosKind.Rel,t.col),(0,a.pos)(a.PosKind.Rel,t.row+t.rows-1),(0,a.pos)(a.PosKind.Rel,t.col+t.cols-1),!1);if((0,n.assertTrue)("calc.lang.formatGridRange",void 0!==u),void 0===i&&void 0===s)return u;if(void 0===i||void 0===s)return R(e,r,i??s)+"!"+u;const l=i+":"+s;return(T(e,r,i)||T(e,r,s)?N(l):l)+"!"+u},t.formatName=function(e,t,r=a.RefStyle.A1,n){return void 0===n?t:R(e,r,n)+"!"+t};const n=r(6913),i=r(1211),a=r(1982),o=r(9209),s=(0,a.pos)(a.PosKind.Abs,0),u=(0,a.pos)(a.PosKind.Abs,o.sheetRows-1),{codePointCapitalA:l,codePointFullStop:c}=n.codePoint;function d(e){let t=e+1,r="";for(;t>0;){const e=(t-1)%26;r=String.fromCharCode(l+e)+r,t=Math.floor((t-e)/26)}return r}function m(e,t,r,n){if(t.kind===a.PosKind.Abs)return t.index;if(n)return(0,i.wrapPosition)(e,t.index,r);const o=e+t.index;return 0<=o&&o<r?o:void 0}function g(e,t,r,n,i,o){const s=m(r,n,i,o);if(void 0===s)return;if(n.kind===a.PosKind.Abs)return t+(s+1).toFixed();const u=s-r;return 0===u?t:t+e.rcLeftBracket+u.toFixed()+e.rcRightBracket}function p(e,t,r,n,i){return t===a.RefStyle.A1?function(e,t,r){const n=m(e,t,o.sheetRows,r);if(void 0===n)return;const i=(n+1).toFixed();return t.kind===a.PosKind.Abs?"$"+i:i}(r,n,i):g(e,e.rowLetter,r,n,o.sheetRows,i)}function h(e,t,r,n,i){return t===a.RefStyle.A1?function(e,t,r){const n=m(e,t,o.sheetCols,r);if(void 0===n)return;const i=d(n);return t.kind===a.PosKind.Abs?"$"+i:i}(r,n,i):g(e,e.columnLetter,r,n,o.sheetCols,i)}function f(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;const i=m(t,r,e,n);if(void 0===i)return;const o=i-t;return o===r.index?r:(0,a.pos)(a.PosKind.Rel,o)}function S(e,t,r,n,i){const a=m(e,t,n,i),o=m(e,r,n,i);if(void 0!==a&&void 0!==o)return a<=o?[t,r,a,o]:[r,t,o,a]}function v(e,t,r,n,i,o,s,u,l){const c=S(o,s,u,r,l);if(void 0===c)return;const[d,m,g,p]=c;if(void 0!==t&&0===g&&p===r-1&&s.kind===u.kind)return t(n,i,l);const h=e(n,i,o,d,l);if(void 0===h)return;if(i===a.RefStyle.R1C1&&d.kind===m.kind&&d.index===m.index)return h;const f=e(n,i,o,m,l);return void 0!==f?h+":"+f:void 0}function y(e,t,r,n,i,a){const o=S(r,n,i,t,a);if(void 0===o)return;const[s,u,l,c]=o;if(void 0!==e&&0===l&&c===t-1&&n.kind===i.kind)return e;const d=f(t,r,s,a),m=f(t,r,u,a);return void 0!==d&&void 0!==m?[!1,d,m]:void 0}function F(e,t,r,n,i,o){const s=p(e,t,r.row,n,o),u=h(e,t,r.col,i,o);if(void 0!==s&&void 0!==u)return t===a.RefStyle.A1?u+s:s+u}function b(e,r,n,i,a,s,u,l){const c=S(n.row,i,s,o.sheetRows,l),d=S(n.col,a,u,o.sheetCols,l);if(void 0===c||void 0===d)return;const[m,g,p,h]=c,[f,v,y,b]=d;if(0===y&&b===o.sheetCols-1&&a.kind===u.kind)return(0,t.formatRowRange)(e,r,n.row,m,g,l);if(0===p&&h===o.sheetRows-1&&i.kind===s.kind)return(0,t.formatColRange)(e,r,n.col,f,v,l);const C=F(e,r,n,m,f,l),k=F(e,r,n,g,v,l);return void 0!==C&&void 0!==k?C+":"+k:void 0}function C(e,t){return t===c||e.isIdentContinue(t)}t.canonicaliseRow=f.bind(void 0,o.sheetRows),t.canonicaliseCol=f.bind(void 0,o.sheetCols),t.formatRowRange=v.bind(void 0,p,void 0,o.sheetRows),t.formatColRange=v.bind(void 0,h,((e,r,n)=>(0,t.formatRowRange)(e,r,0,s,u,n)),o.sheetCols),t.canonicaliseRowRange=y.bind(void 0,void 0,o.sheetRows),t.canonicaliseColRange=y.bind(void 0,[!0,s,u],o.sheetCols);const k=/'/g;function E(e,t){if(0===t.length)return!1;let r=0;const i=(0,n.stringCodePointAt)(t,r);if(!e.isIdentStart(i))return!1;r+=(0,n.numCodeUnits)(i);for(const i of(0,n.codePointIterator)(t,r))if(!C(e,i))return!1;return!0}const A=(0,o.gridCell)(0,0);function T(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;const o=(0,i.parseCellRef)(e,t,A,r,0);if(void 0!==o)if(o.refStyle===a.RefStyle.A1){const{i:t}=o;if(t>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,t)))return!0}else if(!(0,i.isR1C1IdentStart)(o.row,o.col))return!0;return!E(e,r)&&!function(e,t){let r=0;if(!(0,n.stringStartsWith)(t,e.leftBracket,r))return!1;if(r+=e.leftBracket.length,r===t.length)return!1;const i=(0,n.stringCodePointAt)(t,r);if(!C(e,i))return!1;for(r+=(0,n.numCodeUnits)(i);;){if((0,n.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;const i=(0,n.stringCodePointAt)(t,r);if(!C(e,i))return!1;r+=(0,n.numCodeUnits)(i)}const a=t.indexOf(":",r);return a<0?E(e,t.substring(r)):E(e,t.substring(r,a))&&E(e,t.substring(a+1))}(e,r)&&!function(e,t){const r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&t.substring(0,r)===e.leftBracket&&t.substring(t.length-n)===e.rightBracket&&E(e,t.substring(r,t.length-n))}(e,r)}function R(e,t,r){return T(e,t,r)?N(r):r}function N(e){return`'${e.replace(k,"''")}'`}},1211:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialPos=void 0,t.isR1C1IdentStart=M,t.parseCellRef=function(e,t,r,a,o){const s=function(e,t,r,a,o){const{col:s,row:u}=r,[l,c,d]=E(e,s,u,T,A,a,o),m="object"==typeof c&&c.kind===i.PosKind.Abs||c===O.A1BadDollar||"object"==typeof l&&l.kind===i.PosKind.Abs||l===O.A1BadDollar;if(null!=c&&null!=l||m||(null!=c||null!=l)&&(o-1>=0&&a.charCodeAt(o-1)===v||d<a.length&&a.charCodeAt(d)===v)){if(d<a.length&&e.isIdentContinue((0,n.stringCodePointAt)(a,d)))return;if(t!==i.RefStyle.A1&&!m)return;return{refStyle:i.RefStyle.A1,row:c,col:l,i:d}}}(e,t,r,a,o);return void 0!==s?s:function(e,t,r,a,o){const{col:s,row:u}=r;let l=!1,[c,d,m]=E(e,u,s,R,N,a,o);if(null!=c||null!=d||"R"===e.rowLetter&&"C"===e.columnLetter||(l=!0,[c,d,m]=E(e,u,s,I,P,a,o)),(null!=c||null!=d)&&(m>=a.length||!M(c,d)||!e.isIdentContinue((0,n.stringCodePointAt)(a,m))))return{refStyle:i.RefStyle.R1C1,row:c,col:d,i:m,enLocale:l}}(e,0,r,a,o)},t.parseGridCellA1=function(e,t){const[r,n,i]=E(e,0,0,T,A,t,0);return"object"==typeof r&&"object"==typeof n&&i===t.length?(0,o.gridCell)(n.index,r.index):void 0},t.parseGridRangeA1=function(e,t){const[r,i,a]=E(e,0,0,T,A,t,0);if("object"!=typeof r||"object"!=typeof i)return;if(a===t.length)return(0,o.gridCell)(i.index,r.index);if(t.charCodeAt(a)!==v)return;const[s,u,l]=E(e,0,0,T,A,t,a+1);if("object"!=typeof s||"object"!=typeof u)return;if(l!==t.length)return;const c=(0,n.fastMin)(i.index,u.index),d=(0,n.fastMin)(r.index,s.index);return(0,o.gridRange)(c,d,(0,n.fastMax)(i.index,u.index)+1-c,(0,n.fastMax)(r.index,s.index)+1-d)},t.parseQualifier=function(e){const t=e.lastIndexOf("!");if(t<0||0===t||t===e.length-1)return;const r=e.substring(0,t),i=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:i};if(!(0,n.stringStartsWith)(r,"'")||!(0,n.stringEndsWith)(r,"'"))return;const a=[];for(let e=1;e<r.length-1;++e){const t=r.charAt(e);if("'"===t){if(e+1>=r.length-1||"'"!==r.charAt(e+1))return;a.push(t),++e}else a.push(t)}return{qualifier:a.join(""),unqualified:i}},t.wrapPosition=D;const n=r(6913),i=r(1982),a=r(4704),o=r(9209),s=o.sheetRows,u=s.toString(10).length,l=o.sheetCols,c=l.toString(26).length,d=l.toString(10).length,{codePointCapitalA:m,codePointCapitalZ:g,codePointSmallA:p,codePointSmallZ:h,codePointPlusSign:f,codePointMinusSign:S,codePointColon:v}=n.codePoint;function y(e){return e>=p&&e<=h||e>=m&&e<=g}function F(e){return 1+(e>=p?e-p:e-m)}function b(e,t,r,a){return function(o,s,u,l,c){const[d,m]=function(e,t){return(0,n.stringStartsWith)(e,"$",t)?[i.PosKind.Abs,t+1]:[i.PosKind.Rel,t]}(u,l),[g,p]=e(o,r,u,m);if(p>m){if(g<1||g>t)return d===i.PosKind.Abs||(!0===a?"object"==typeof c&&c.kind===i.PosKind.Abs||c===O.A1BadDollar:(0,n.stringStartsWith)(u,"$",p))?[O.A1BadDollar,!0,p]:void 0;const e=d===i.PosKind.Rel?g-s:g;return[(0,i.pos)(d,e-1),d===i.PosKind.Abs,p]}return d!==i.PosKind.Abs||!0!==a&&p!==u.length&&o.isNumeral((0,n.stringCodePointAt)(u,p))?[void 0,!1,l]:[O.A1BadDollar,!0,p]}}function C(e,t,r){return D(e,t,r)-e}function k(e,t,r,o){return function(s,u,l,c){const d=t?e?"R":s.rowLetter:e?"C":s.columnLetter;if(c>=l.length||0!==s.stringCompareCI(d,l[c]))return[void 0,!1,c];let m=c+d.length;const[g,p]=(0,a.parseUint)(s,o,l,m);if(p>m&&g>=1&&g<=r)return[(0,i.pos)(i.PosKind.Abs,g-1),!1,p];if((0,n.stringStartsWith)(l,s.rcLeftBracket,m)){if(m+=s.rcLeftBracket.length,(0,n.stringStartsWith)(l,s.rcRightBracket,m))return[(0,i.pos)(i.PosKind.Rel,C(u,0,r)),!0,m+s.rcRightBracket.length];let e=1;const t=l.charCodeAt(m);t===f?m+=1:t===S&&(e=-1,m+=1);const[c,d]=(0,a.parseUint)(s,o,l,m);if(d>m&&c<r&&(0,n.stringStartsWith)(l,s.rcRightBracket,d))return[(0,i.pos)(i.PosKind.Rel,C(u,c*e,r)),!0,d+s.rcRightBracket.length]}return[O.RCNoNum,!1,c+d.length]}}function E(e,t,r,n,i,a,o){const s=n(e,t,a,o,void 0);if(null==s)return[void 0,void 0,o];const[u,l,c]=s;if(c>o){const t=i(e,r,a,c,u);if(null==t)return l?[u,void 0,c]:[void 0,void 0,o];const[n,,s]=t;return s>c?[u,n,s]:[u,void 0,c]}const d=i(e,r,a,o,u);if(null==d)return[void 0,void 0,o];const[m,,g]=d;return g>o?[void 0,m,g]:[void 0,void 0,o]}const A=b(a.parseUint,s,u,!0),T=b(((e,t,r,i)=>function(e,t,r){let i=0,a=r;const o=(0,n.fastMin)(t.length,r+e);for(;a<o;a+=1){const e=t.charCodeAt(a);if(!y(e))break;i=26*i+F(e)}return a===o&&a<t.length&&y(t.charCodeAt(a))?[0,r]:[i,a]}(t,r,i)),l,c,!1),R=k(!1,!0,s,u),N=k(!1,!1,l,d),I=k(!0,!0,s,u),P=k(!0,!1,l,d);var O;function M(e,t){return"object"!=typeof e&&"object"!=typeof t}function D(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(O||(t.SpecialPos=O={}))},6836:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.LCID=t.Country=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=t.PictureSingle=t.PictureSpecial=t.PictureDbnum=t.PictureColor=void 0,t.calcConfig=function(e,t=s.RefStyle.A1,r=l.xlMathpack,n=!1,i=!0,a=o.tzUTC,u=o.xlDatepack){return{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:a,datepack:u}},t.localeInfo=g,t.isNumeral=f,t.getOrdinal=S,t.getNumberShape=v,t.isIdentStart=F,t.isIdentContinue=b,t.englishWorksheetFuncIdToName=function(e){const t=E()[e];return void 0===t?`wsf:${e}`:t},t.englishErrorTypeToName=function(e){const r=t.englishErrorNames[e];return void 0===r?`error.type:${e}`:r},t.englishOperatorIdToName=function(e){if(e===d.OperatorId.Isect)return" ";if(e===d.OperatorId.Union)return",";const t=d.operatorStrings[e];return void 0===t?`op:${e}`:t},t.operatorIdToName=function(e,t,r){return t===d.OperatorId.Isect?r:t===d.OperatorId.Union?e.listSeparator:d.operatorStrings[t]},t.getEnglishWorksheetFuncIdToName=E,t.createWorksheetFuncNameCallbacks=A,t.createIsThousandsPositionCallback=function(e){if(0===e.length||0===e[0])return()=>!1;if(2===e.length&&0===e[1]){const t=e[0];return e=>e>0&&e%t==0}const t=0===e[e.length-1]&&e.length>=2;return r=>{if(r<=0)return!1;let n=r;for(let t=0;t<e.length&&(n-=e[t],!(n<=0));t+=1);return n>0&&t?n%e[e.length-2]==0:0===n}},t.getEnglishLocaleInfo=function(){return null==T&&(T=function(){const e=E(),r=(0,n.makeStringCompareCI)("en-US"),{getWorksheetFuncId:i,getWorksheetFuncName:a}=A(r,e);return g(i,a,f,S,v,(e=>e>0&&e%3==0),F,b,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",h.USA,{primary:"en-US",userDefault:"en-US",instLang:"en-US",userCurrent:"en-US"},p.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,c.CurrencyFormat.Paren,!0,!1,"$",2,c.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),T};const n=r(6913);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return n.ulsLogger}});const i=r(5033);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}});const a=r(1633);Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return a.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return a.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return a.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return a.PictureSpecial}});const o=r(8179),s=r(1982),u=r(8061),l=r(7185),c=r(6481),d=r(6654),m=r(1973);function g(e,t,r,n,i,a,o,s,u,l,c,d,m,g,p,h,f,S,v,y,F,b,C,k,E,A,T,R,N,I,P,O,M,D,w,_,L,x,K,B,W,U,G,j,V,H,q,z,Q,$,Y,J,X,Z,ee,te,re,ne,ie,ae,oe,se,ue,le,ce,de,me,ge,pe){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:a,isIdentStart:o,isIdentContinue:s,stringCompareCI:u,errorNames:l,specialRefNames:c,trueName:d,falseName:m,rowLetter:g,columnLetter:p,leftBrace:h,rightBrace:f,leftBracket:S,rightBracket:v,rcLeftBracket:y,rcRightBracket:F,decimalSeparator:b,listSeparator:C,columnSeparator:k,rowSeparator:E,thousandsSeparator:A,statementSeparator:T,lcid:R,cultureTag:N,country:I,isThai:P,isEastAsia:O,isKorea:M,isJapan:D,isChinaT:w,isChinaS:_,isComplexScript:L,numberDecimals:x,isExpSepBySpace:K,fractionSeparator:B,isPercentSepBySpace:W,currencyFormat:U,isCurrencySymbolLead:G,isCurrencySepBySpace:j,currencySymbol:V,currencyDecimals:H,dateOrder:q,dateSeparator:z,dateAltSeparator:Q,year4Digits:$,month2Digits:Y,day2Digits:J,longDateFormat:X,timeSeparator:Z,timeAltSeparator:ee,hour2Digits:te,clock24Hour:re,isAMPMSepBySpace:ne,ampmSymbols:ie,dayNameShort:ae,dayNameLong:oe,monthNameShort:se,monthNameLong:ue,pictureSpecial:le,pictureSingle:ce,pictureColor:de,pictureDbnum:me,sysDateFormat:ge,sysTimeFormat:pe}}var p,h;function f(e){const t=0|e;if(t<128)return t>=48&&t<58;const r=15&t;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 4960:return r>=9;case 4976:return r<=1;default:return!1}}function S(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,n.assertFalse)("calc.config.getOrdinal"),15&t;const r=15&t;let i;switch(2147483632&t){case 1632:case 1776:case 3664:case 3792:case 3872:case 4160:case 6112:case 6160:i=r;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:i=r-6;break;case 4960:i=r-8;break;case 4976:i=r+8;break;default:return(0,n.assertFalse)("calc.config.getOrdinal")}return(i<0||i>9||4968===t)&&(0,n.assertFalse)("calc.config.getOrdinal"),i}function v(e){const t=0|e;if(t<128)return(t<48||t>=58)&&(0,n.assertFalse)("calc.config.getNumberShape"),c.NumberShape.ASCII;switch(f(t)||(0,n.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return c.NumberShape.ArabicIndic;case 1776:return c.NumberShape.ExtendedArabicIndic;case 2400:return c.NumberShape.Devanagari;case 2528:return c.NumberShape.Bengali;case 2656:return c.NumberShape.Gurmukhi;case 2784:return c.NumberShape.Gujarati;case 2912:return c.NumberShape.Oriya;case 3040:return c.NumberShape.Tamil;case 3168:return c.NumberShape.Telugu;case 3296:return c.NumberShape.Kannada;case 3424:return c.NumberShape.Malayalam;case 3664:return c.NumberShape.Thai;case 3792:return c.NumberShape.Lao;case 3872:return c.NumberShape.Tibetan;case 4160:return c.NumberShape.Myanmar;case 4960:case 4976:return c.NumberShape.Ethiopic;case 6112:return c.NumberShape.Khmer;case 6160:return c.NumberShape.Mongolian;default:return(0,n.assertFalse)("calc.config.getNumberShape")}}!function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(p||(t.Country=p={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.Indonesia=1057]="Indonesia",e[e.EnglishIndonesia=14345]="EnglishIndonesia",e[e.EnglishIndia=16393]="EnglishIndia",e[e.Singapore=4100]="Singapore",e[e.EnglishSingapore=18441]="EnglishSingapore",e[e.Serbia=9242]="Serbia",e[e.Mexico=2058]="Mexico",e[e.Ireland=6153]="Ireland",e[e.EnglishZimbabwe=12297]="EnglishZimbabwe",e[e.Belgium=2067]="Belgium",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(h||(t.LCID=h={}));const y=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,0,0,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0]);function F(e){const t=0|e;return t>=0&&t<128?y[t]>=2:(0,u.isIdentStart)(t)}function b(e){const t=0|e;return t>=0&&t<128?y[t]>=1:(0,u.isIdentContinue)(t)}let C;t.englishErrorNames=(0,n.partialArray)({[m.ErrorType.NULL]:"#NULL!",[m.ErrorType.DIV0]:"#DIV/0!",[m.ErrorType.VALUE]:"#VALUE!",[m.ErrorType.REF]:"#REF!",[m.ErrorType.NAME]:"#NAME?",[m.ErrorType.NUM]:"#NUM!",[m.ErrorType.NA]:"#N/A",[m.ErrorType.GETTING_DATA]:"#GETTING_DATA",[m.ErrorType.SPILL]:"#SPILL!",[m.ErrorType.CONNECT]:"#CONNECT!",[m.ErrorType.BLOCKED]:"#BLOCKED!",[m.ErrorType.UNKNOWN]:"#UNKNOWN!",[m.ErrorType.FIELD]:"#FIELD!",[m.ErrorType.CALC]:"#CALC!",[m.ErrorType.BUSY]:"#BUSY!",[m.ErrorType.EXTERNAL]:"#EXTERNAL!"}),t.englishSpecialRefNames=(0,n.partialArray)({[s.SpecialRefId.All]:"#All",[s.SpecialRefId.Data]:"#Data",[s.SpecialRefId.Headers]:"#Headers",[s.SpecialRefId.Totals]:"#Totals",[s.SpecialRefId.ThisRow]:"#This Row"}),t.englishPictureSpecial=(0,n.partialArray)({[a.PictureSpecial.AP1]:"AM/PM",[a.PictureSpecial.AP2]:"A/P",[a.PictureSpecial.AP3]:"上午/下午",[a.PictureSpecial.General]:"General",[a.PictureSpecial.Currency]:"$"}),t.englishPictureSingle=(0,n.partialArray)({[a.PictureSingle.Sep]:";",[a.PictureSingle.Hash]:"#",[a.PictureSingle.Zero]:"0",[a.PictureSingle.Decimal]:".",[a.PictureSingle.Percent]:"%",[a.PictureSingle.Comma]:",",[a.PictureSingle.Colon]:":",[a.PictureSingle.DateSep]:"/",[a.PictureSingle.Slash]:"/",[a.PictureSingle.Space]:" ",[a.PictureSingle.Minus]:"-",[a.PictureSingle.Plus]:"+",[a.PictureSingle.OpenParen]:"(",[a.PictureSingle.CloseParen]:")",[a.PictureSingle.Backslash]:"\\",[a.PictureSingle.Star]:"*",[a.PictureSingle.Year]:"y",[a.PictureSingle.Month]:"m",[a.PictureSingle.Day]:"d",[a.PictureSingle.Hour]:"h",[a.PictureSingle.Minute]:"m",[a.PictureSingle.Second]:"s",[a.PictureSingle.E]:"E",[a.PictureSingle.APDelim]:"/",[a.PictureSingle.Quote]:'"',[a.PictureSingle.ColorStart]:"[",[a.PictureSingle.ColorEnd]:"]",[a.PictureSingle.Text]:"@",[a.PictureSingle.Question]:"?",[a.PictureSingle.Underscore]:"_",[a.PictureSingle.Reign]:"r",[a.PictureSingle.LocDay]:"a",[a.PictureSingle.Era]:"g",[a.PictureSingle.EraYear]:"e",[a.PictureSingle.BidiDate]:"B",[a.PictureSingle.BidiNum]:"N",[a.PictureSingle.DayTh]:"ว",[a.PictureSingle.MonthTh]:"ด",[a.PictureSingle.YearTh]:"ป",[a.PictureSingle.EngYearTh]:"b",[a.PictureSingle.ThYear]:"ค",[a.PictureSingle.HourTh]:"ช",[a.PictureSingle.MinuteTh]:"น",[a.PictureSingle.SecondTh]:"ท",[a.PictureSingle.ZeroTh]:"๐"}),t.englishPictureColor=(0,n.partialArray)({[a.PictureColor.Black]:"Black",[a.PictureColor.White]:"White",[a.PictureColor.Red]:"Red",[a.PictureColor.Green]:"Green",[a.PictureColor.Blue]:"Blue",[a.PictureColor.Yellow]:"Yellow",[a.PictureColor.Magenta]:"Magenta",[a.PictureColor.Cyan]:"Cyan",[a.PictureColor.Color]:"Color"}),t.englishPictureDbnum=(0,n.partialArray)({[a.PictureDbnum.DBNUM1]:"DBNum1",[a.PictureDbnum.DBNUM2]:"DBNum2",[a.PictureDbnum.DBNUM3]:"DBNum3",[a.PictureDbnum.DBNUM4]:"DBNum4"}),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM";const k=/_/g;function E(){if(null==C){C=[];for(const e of(0,n.numEnumArray)(d.WorksheetFuncId)){const t=(0,d.getWorksheetFuncEnglishName)(e)??d.WorksheetFuncId[e].replace(k,".");C[e]=t}}return C}function A(e,t){const r=function(e,t){const r=[];return t.forEach(((e,t)=>{null!=e&&r.push([e,t])})),n.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:e=>r.getValue(e),getWorksheetFuncName(e){const r=t[e];return null==r?(0,n.assertFalse)(`calc.config.getWorksheetFuncName: unknown function ID ${e}`):r}}}let T},8179:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;const n=r(6913),i=r(5984),a=r(1973);var o=i.dtr.Rounding;t.Rounding=o;var s,u=i.dtr.TimeDivision;t.TimeDivision=u,t.tzData=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i}))),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.dateTime=i.dtr.dtr,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(s||(t.TimeGranularity=s={})),t.xlDatepack={fromNum:function(e,t,r){return i.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){const r=i.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):a.numErrorOper},toNumWithDuration:function(e,t,r,n){const o=i.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof o?e.mathpack.fromNumber(o):a.numErrorOper},daysPerMonth:i.dtr.daysPerMonth,toDays:function(e,t){return i.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return i.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return i.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},1982:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.errorQualifier=function(e=0){return{kind:o.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.relativeQualifier=function(e=0){return{kind:o.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.documentQualifier=function(e,t,r=!1,n=0){return{kind:o.Document,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,document:e,path:t}},t.sheetQualifier=function(e,t,r=!1,n=0){return{kind:o.Sheet,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,sheet:e,document:t}},t.identQualifier=function(e,t=!1,r=0){return{kind:o.Ident,isQuoted:t,isClosed:!0,isTerminated:!0,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,n=!1,i=0){return{kind:o.SheetRange,isQuoted:n,isClosed:!0,isTerminated:!0,label:i,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t=!1,r=!0,n=!0,i=0){return{kind:o.Bad,isQuoted:t,isClosed:r,isTerminated:n,label:i,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e=0){return{kind:s.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r=!1,n=0){return{kind:s.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r=0){const n=e.isBracketed||t.isBracketed;return{kind:s.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r=!1,n=0){return{kind:s.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r=!1,n=0){return{kind:s.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t=!1,r=0){return{kind:s.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:n??A(e)}},t.singleLineComment=function(e,t=0){return{kind:l.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t=!0,r=0){return{kind:l.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,i,a,o){return(0,n.assertNatural)("calc.lang.formulaSpan",e),(0,n.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,n.assertFalse)(`calc.lang.formulaSpan: expected end >= ${e}; given ${t}`),{start:e,end:t,pre:r,post:i,preComments:a,postComments:o}},t.localNameUseAnnotation=function(e,t,r){return{kind:c.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r=[]){return{kind:c.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:c.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t=!0,r=0){return{kind:d.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t=!0,r=0){return{kind:d.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r=!0,n=0){return{kind:d.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=v,t.indexedArg=y,t.varNode=function(e,t=0){return{kind:d.Var,label:t,name:e,wholeName:e.whole}},t.letVar=F,t.letNode=function(e,t,r,n=[],i=!0,a=0){const o=t.map(((e,t)=>{return r=e,Array.isArray(r)?F(y(e[0],2*t),y(e[1],2*t+1)):e;var r})).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&f(r)?y(r,2*o.length):r,u=v(o,s,n);return{kind:d.Let,label:a,head:e,args:u,isClosed:i,vars:o,body:s,badArgs:n}},t.flattenLambdaArgs=b,t.paramName=function(e,t,r=!0,n=0){return{kind:d.ParamName,label:n,name:e,isBracketed:t,isClosed:r}},t.paramDefault=function(e,t=0){return{kind:d.ParamDef,label:t,rhs:e}},t.paramNode=function(e,t,r=0){return{kind:d.Param,label:r,name:e,wholeName:e.name.kind===d.Ident?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}},t.lambdaParam=C,t.lambdaNode=function(e,t,r,n=[],i=!0,a=0){const o=t.map(((e,t)=>f(e)?C(y(e,t)):e)).sort(((e,t)=>e.name.index-t.name.index)),s=void 0!==r&&f(r)?y(r,o.length):r,u=b(o,s,n);return{kind:d.Lambda,label:a,head:e,args:u,isClosed:i,params:o,body:s,badArgs:n}},t.operatorNode=function(e,t=0){return{kind:d.Operator,label:t,id:e}},t.wsfNode=function(e,t,r=0){return{kind:d.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t=!0,r=0){return{kind:d.Paren,label:r,node:e,isClosed:t}},t.nameNode=function(e,t,r=0){return{kind:d.Name,label:r,whole:e.asWhole,parts:e,qualifier:t}},t.identNamePart=function(e,t=!0,r=0,n=0){return{kind:m.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}},t.cellRefNamePart=function(e,t,r=0,n=0){return{kind:m.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r=!0,i=0,a=0){return(0,n.assertTrue)("calc.lang.fieldRefNamePart",t.isClosed&&!t.isBracketed),{kind:m.FieldRefNamePart,label:i,qualifiedLabel:a,asWhole:e.asWhole+"."+(t.field.kind===d.Ident?t.field.whole:t.field.chars),canDenoteNamedObject:r,lhs:e,rhs:t}},t.flattenNameParts=function(e){const t=[e];let r=t[0];for(;r.kind===m.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){let t=e;for(;t.kind===m.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t=0){return{kind:d.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r=0){return{kind:d.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r=0){return{kind:d.FieldRef,label:r,lhs:e,rhs:t}},t.fieldRef=function(e,t=!1,r=!0,n=!1,i=0){return{kind:d.FieldRefRHS,label:i,field:e,isBracketed:t,isClosed:r,shouldBeBracketed:n}},t.structRefNode=function(e,t,r=0){return{kind:d.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t=!1,r=!0,n=0){return{kind:p.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t=!1,r=!0,n=0){return{kind:p.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r=0){return{kind:p.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t=0){const r={[g.All]:!1,[g.Data]:!1,[g.Headers]:!1,[g.Totals]:!1,[g.ThisRow]:!1},n=[];for(const t of e)switch(t.kind){case p.SpecialRef:r[t.id]=!0;break;case p.ColumnRef:case p.RangeOpRef:n.push(t)}return{kind:p.CommaOpRef,label:t,refs:e,specialRefs:r,columnRefs:n}},t.thisRowOpRef=function(e,t=0){return{kind:p.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e=0){return{kind:p.MissingRef,label:e}},t.badRef=function(e,t=!1,r=!0,n=0){return{kind:p.BadRef,chars:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t=!0,r=0){return{kind:d.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.identNode=function(e,t=0){return{kind:d.Ident,label:t,whole:e}},t.missingNode=function(e="",t=0){return{kind:d.Missing,label:t,chars:e}},t.badCharsNode=function(e,t,r=0){return{kind:d.BadChars,label:r,type:e,chars:t}},t.badSequenceNode=function(e,t,r=0){return{kind:d.BadSequence,label:r,type:e,contents:t}},t.getDepthUpperBound=A;const n=r(6913);var i,a,o,s,u,l,c,d,m,g,p,h;function f(e){return void 0!==e.kind}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(i||(t.RefStyle=i={})),function(e){e.Comments="Comments",e.Statements="Statements"}(a||(t.SyntaxFeature=a={})),function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(o||(t.QualifierKind=o={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(s||(t.CellRefKind=s={})),function(e){e.Abs="Abs",e.Rel="Rel"}(u||(t.PosKind=u={})),function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(l||(t.CommentKind=l={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(c||(t.AnnotationKind=c={})),t.appHeadNameAnnotation={kind:c.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(d||(t.NodeKind=d={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(m||(t.NamePartKind=m={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(g||(t.SpecialRefId=g={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(p||(t.StructRefKind=p={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"}(h||(t.BadType=h={}));const S=e=>{const t=[];for(const{arg:r,index:i}of e)(0,n.assertIndex)("calc.lang.flattenNumberedArgs: idx",i,e.length),(0,n.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[i]),t[i]=r;return t};function v(e,t,r){return S((0,n.safeConcat)([...void 0===t?[]:[t],...r],e.map((({name:e,binder:t})=>[e,t]))))}function y(e,t){return(0,n.assertNatural)("calc.lang.indexedArg: index",t),{arg:e,index:t}}function F(e,t){return{name:e,binder:t}}function b(e,t,r=[]){return S([...e.map((e=>e.name)),...void 0===t?[]:[t],...r])}function C(e){return{name:e}}const k=50;function E(e,t){if(t>k)return 1/0;switch(e.kind){case d.Array:{let r=0;for(const i of e.nodes)for(const e of i)r=(0,n.fastMax)(r,E(e,t+1));return r+1}case d.Param:return void 0===e.def?1:E(e.def.rhs,t+1)+1;case d.Let:case d.Lambda:case d.App:{let r=E(e.head,t+1);for(const i of e.args)r=(0,n.fastMax)(r,E(i,t+1));return r+1}case d.Paren:return E(e.node,t+1)+1;case d.FieldRef:return E(e.lhs,t+1)+1;case d.Var:case d.Name:case d.CellRef:case d.StructRef:case d.Literal:case d.Operator:case d.WSF:case d.Missing:case d.BadChars:return 1;case d.BadSequence:{let r=0;for(const i of e.contents)r=(0,n.fastMax)(r,E(i,t+1));return r+1}default:return(0,n.assertNever)("calc.lang.getDepthUpperBound",e)}}function A(e){return E(e,0)}},8061:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentContinue=t.isIdentStart=void 0;const n=r(6913);t.isIdentStart=(0,n.makeIsInClass)([65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,697,699,706,711,712,713,716,717,718,720,722,728,732,733,734,736,741,750,751,880,884,886,888,890,894,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1316,1329,1367,1369,1370,1377,1416,1488,1515,1520,1523,1569,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2308,2362,2365,2366,2384,2385,2392,2402,2417,2419,2427,2432,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3134,3160,3162,3168,3170,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3333,3341,3342,3345,3346,3369,3370,3386,3389,3390,3424,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3806,3840,3841,3904,3912,3913,3949,3976,3980,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5109,5121,5741,5743,5751,5761,5787,5792,5867,5870,5873,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6264,6272,6313,6314,6315,6400,6429,6480,6510,6512,6517,6528,6570,6593,6600,6656,6679,6917,6964,6981,6988,7043,7073,7086,7088,7168,7204,7245,7248,7258,7294,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8208,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8232,8240,8241,8242,8244,8245,8246,8251,8252,8305,8306,8308,8309,8319,8320,8321,8325,8336,8341,8450,8452,8453,8454,8455,8456,8457,8468,8469,8471,8473,8478,8481,8483,8484,8485,8486,8487,8488,8489,8490,8494,8495,8506,8508,8512,8517,8522,8526,8527,8531,8533,8539,8543,8544,8585,8592,8602,8658,8659,8660,8661,8704,8705,8706,8708,8711,8713,8715,8716,8719,8720,8721,8722,8725,8726,8730,8731,8733,8737,8739,8740,8741,8742,8743,8749,8750,8751,8756,8760,8764,8766,8776,8777,8780,8781,8786,8787,8800,8802,8804,8808,8810,8812,8814,8816,8834,8836,8838,8840,8853,8854,8857,8858,8869,8870,8895,8896,8978,8979,9312,9398,9424,9450,9472,9548,9552,9589,9601,9616,9618,9622,9632,9634,9635,9642,9650,9652,9654,9656,9660,9662,9664,9666,9670,9673,9675,9676,9678,9682,9698,9702,9711,9712,9733,9735,9737,9738,9742,9744,9756,9757,9758,9759,9792,9793,9794,9795,9824,9826,9827,9830,9831,9835,9836,9838,9839,9840,11264,11311,11312,11359,11360,11376,11377,11390,11392,11493,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12288,12292,12293,12312,12317,12320,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12544,12549,12590,12593,12687,12704,12728,12784,12829,12832,12842,12849,12851,12857,12858,12896,12924,12927,12928,12963,12969,13059,13060,13069,13070,13076,13077,13080,13081,13090,13092,13094,13096,13099,13100,13110,13111,13115,13116,13129,13131,13133,13134,13137,13138,13143,13144,13179,13183,13184,13189,13192,13259,13261,13268,13269,13271,13272,13273,13275,13278,13312,19894,19968,40900,40960,42125,42240,42509,42512,42528,42538,42540,42560,42592,42594,42607,42624,42648,42786,42888,42891,42893,43003,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43274,43302,43312,43335,43520,43561,43584,43587,43588,43596,44032,55204,57344,63561,63744,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511]),t.isIdentContinue=(0,n.makeIsInClass)([48,58,63,64,65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,888,890,894,900,903,904,907,908,909,910,930,931,1316,1329,1367,1369,1370,1377,1416,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1520,1523,1536,1540,1542,1545,1547,1548,1550,1563,1567,1568,1569,1631,1632,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2305,2362,2364,2382,2384,2389,2392,2404,2406,2416,2417,2419,2427,2432,2433,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2555,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2930,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3073,3076,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3162,3168,3172,3174,3184,3192,3200,3202,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3330,3332,3333,3341,3342,3345,3346,3369,3370,3386,3389,3397,3398,3401,3402,3406,3415,3416,3424,3428,3430,3446,3449,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3770,3771,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3806,3840,3844,3859,3898,3902,3912,3913,3949,3953,3973,3974,3980,3984,3992,3993,4029,4030,4045,4046,4048,4096,4170,4176,4250,4254,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4959,4961,4969,4989,4992,5018,5024,5109,5121,5741,5743,5751,5760,5787,5792,5867,5870,5873,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6264,6272,6315,6400,6429,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6570,6576,6602,6608,6618,6624,6684,6912,6988,6992,7002,7009,7037,7040,7083,7086,7098,7168,7224,7232,7242,7245,7294,7424,7655,7678,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8192,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8241,8242,8244,8245,8246,8251,8252,8260,8261,8274,8275,8287,8293,8298,8306,8308,8317,8319,8333,8336,8341,8352,8374,8400,8433,8448,8528,8531,8585,8592,9001,9003,9192,9216,9255,9280,9291,9312,9886,9888,9917,9920,9924,9985,9989,9990,9994,9996,10024,10025,10060,10061,10062,10063,10067,10070,10071,10072,10079,10081,10088,10102,10133,10136,10160,10161,10175,10176,10181,10183,10187,10188,10189,10192,10214,10224,10627,10649,10712,10716,10748,10750,11085,11088,11093,11264,11311,11312,11359,11360,11376,11377,11390,11392,11499,11517,11518,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12288,12312,12317,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12544,12549,12590,12593,12687,12688,12728,12736,12772,12784,12831,12832,12868,12880,13055,13056,19894,19904,40900,40960,42125,42128,42183,42240,42509,42512,42540,42560,42592,42594,42611,42620,42622,42623,42648,42752,42893,43003,43052,43072,43124,43136,43205,43216,43226,43264,43311,43312,43348,43520,43575,43584,43598,43600,43610,44032,55204,57344,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65063,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65279,65280,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},2371:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;const n=r(1813);var i;!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.PERCENTOF=646]="PERCENTOF",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e._FF=672]="_FF",e[e.FIELDFUNCTION=673]="FIELDFUNCTION",e[e.TRANSLATE=674]="TRANSLATE",e[e.DETECTLANGUAGE=675]="DETECTLANGUAGE",e[e.REGEXTEST=676]="REGEXTEST",e[e.REGEXREPLACE=677]="REGEXREPLACE",e[e.REGEXEXTRACT=678]="REGEXEXTRACT",e[e.TRIMRANGE=679]="TRIMRANGE",e[e.IMPORTCSV=680]="IMPORTCSV",e[e.IMPORTTEXT=681]="IMPORTTEXT",e[e._TRO_TRAILING=682]="_TRO_TRAILING",e[e._TRO_LEADING=683]="_TRO_LEADING",e[e._TRO_ALL=684]="_TRO_ALL",e[e.TESTFUNCTIONBEGIN=685]="TESTFUNCTIONBEGIN",e[e.GRF=686]="GRF",e[e.RICHERROR=687]="RICHERROR",e[e.COUNTER=688]="COUNTER",e[e.BROKENRECORD=689]="BROKENRECORD",e[e.STREAM=690]="STREAM",e[e.GETRICHERRORS=691]="GETRICHERRORS",e[e.DBGSTAT=692]="DBGSTAT",e[e.RICHNUMBER=693]="RICHNUMBER",e[e.RICHERNUMBER=694]="RICHERNUMBER",e[e.DBGWRITE=695]="DBGWRITE",e[e.TEST=696]="TEST",e[e.AAC=697]="AAC",e[e.AWC=698]="AWC",e[e.PARSEDEXPRESSION=699]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=700]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=701]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=702]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=703]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=704]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=705]="ARRAYVALUE",e[e.RECORD=706]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=707]="DISPLAYSTRING_GENERALTEST",e[e.LAMBDADOC=708]="LAMBDADOC",e[e.REFIDENTITY=709]="REFIDENTITY",e[e.PQEVALUATE=710]="PQEVALUATE",e[e.REFTYPE=711]="REFTYPE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(i||(t.WorksheetFuncId=i={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[672,"_FF"],[682,"_TRO_TRAILING"],[683,"_TRO_LEADING"],[684,"_TRO_ALL"],[700,"AGE_CONTACTTEST"],[701,"FIRSTNAME_CONTACTTEST"],[702,"FULLNAME_CONTACTTEST"],[703,"LASTNAME_CONTACTTEST"],[704,"TRANSLATENAME_CONTACTTEST"],[707,"DISPLAYSTRING_GENERALTEST"]].reduce(((e,t)=>(e[t[0]]=t[1],e)),[]);const a=[];t.worksheetFuncTypes=[[1,255,a,[57],a,1,0,32],[1,3,[36,831,831],a,a,823,0,64],[1,1,[271],a,a,4,0,64],[1,1,[271],a,a,4,0,64],[1,255,a,[305],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[0,1,[16],a,a,33,0,0],[0,1,[16],a,a,33,0,0],[0,0,a,a,a,3,0,32],[2,255,[1],[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,2,[1,1],a,a,2,0,64],[1,3,[1,65,4],a,a,2,0,64],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[0,0,a,a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,3,[263,48,48],a,a,263,0,0],[2,4,[48,1,1,1],a,a,311,0,0],[2,2,[2,1],a,a,2,0,64],[3,3,[2,1,1],a,a,2,0,64],[1,1,[2],a,a,1,0,64],[1,1,[7],a,a,1,0,64],[0,0,a,a,a,4,0,32],[0,0,a,a,a,4,0,32],[1,255,a,[52],a,4,0,32],[1,255,a,[52],a,4,0,32],[1,1,[4],a,a,4,0,32],[2,2,[1,1],a,a,1,0,0],[3,3,[16,83,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[1,255,a,[49],a,1,0,32],[3,3,[16,19,18],a,a,1,0,0],[2,2,[263,2],a,a,2,0,64],[1,4,[48,112,84,84],a,a,32,0,0],[1,4,[48,112,112,84],a,a,32,0,0],[1,4,[48,112,84,84],a,a,32,0,0],[1,4,[48,112,112,84],a,a,32,0,0],[1,1,[16],a,a,512,0,2],[0,1,[4],a,a,512,0,2],[0,1,[575],a,a,512,0,2],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,6,[1,1,1,1,1,1],a,a,1,0,0],[3,3,[48,1,1],a,a,1,0,32],[1,2,[48,1],a,a,1,0,0],[0,0,a,a,a,1,16383,0],[2,3,[263,305,17],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,2,[1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[0,0,a,a,a,1,16383,0],[1,1,[16],a,a,1,0,0],[1,1,[48],a,a,1,0,0],[1,1,[48],a,a,1,0,0],[3,5,[16,65,65,65,65],a,a,16,16383,0],[2,2,[2,16],a,a,16,0,2],[2,2,[16,16],a,a,2,0,2],[0,3,[66,81,16],a,a,4,0,2],[2,3,[2,2,1],a,a,1,0,64],[1,1,[39],a,a,32,0,0],[0,2,[1,24],a,a,4,0,2],[0,0,a,a,a,4,0,2],[1,1,[303],a,a,1,0,0],[0,1,[4],a,a,4,0,2],[1,2,[2,63],a,a,4,0,2],[0,0,a,a,a,50,0,2],[1,1,[16],a,a,47,0,2],[0,2,[65,66],a,a,32,0,2],[4,5,[87,117,117,1,117],a,a,4,0,4],[0,2,[1,66],a,a,32,0,2],[0,0,a,a,a,16,0,2],[0,0,a,a,a,16,0,2],[0,1,[1],a,a,4,0,2],[2,2,[1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,255,[33],[831],a,823,0,0],[3,4,[263,49,49,4],a,a,295,0,0],[3,4,[263,49,49,4],a,a,295,0,0],[0,2,[66,65],a,a,32,0,2],[1,7,[2,65,66,67,65,65,2],a,a,575,0,2],[1,1,[63],a,a,4,0,64],[1,1,[18],a,a,2,0,2],[1,2,[2,4],a,a,6,0,2],[2,2,[16,47],a,a,4,0,2],[1,2,[1,1],a,a,1,0,0],[1,4,[2,1,4,4],a,a,7,0,2],[1,1,[1],a,a,2,0,64],[1,1,[2],a,a,2,0,64],[1,1,[2],a,a,2,0,64],[1,1,[2],a,a,2,0,64],[1,2,[2,9],a,a,2,0,64],[1,2,[2,9],a,a,2,0,64],[2,2,[258,258],a,a,4,0,64],[1,1,[2],a,a,2,0,64],[4,4,[2,1,1,2],a,a,2,0,64],[3,4,[2,2,2,2],a,a,2,0,64],[1,1,[2],a,a,1,0,0],[0,3,[66,65,66],a,a,32,0,2],[0,1,[2],a,a,2,0,2],[2,3,[2,2,1],a,a,1,0,64],[1,2,[2,16],a,a,303,16383,0],[1,1,[271],a,a,4,0,64],[1,1,[399],a,a,4,0,64],[1,1,[399],a,a,4,0,64],[1,1,[399],a,a,4,0,64],[1,1,[23],a,a,2,0,0],[1,1,[23],a,a,1,0,0],[1,2,[2,1],a,a,1,0,2],[1,1,[1],a,a,1,0,2],[1,1,[1],a,a,1,0,2],[1,1,[1],a,a,2,0,2],[2,2,[1,1],a,a,2,0,2],[2,2,[1,2],a,a,1,0,2],[2,2,[1,2],a,a,1,0,2],[1,2,[1,1],a,a,1,0,2],[1,1,[3],a,a,1,0,64],[1,1,[3],a,a,1,0,64],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,1],a,a,1,0,0],[4,5,[1,1,1,1,1],a,a,1,0,0],[1,3,[2,66,65],a,a,2,0,2],[1,2,[16,4],a,a,2,0,2],[1,2,[2,4],a,a,16,0,2],[1,2,[2,4],a,a,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],a,3,0,2],[1,255,[3],[127],a,575,0,2],[0,1,[3],a,a,1,0,2],[2,4,[3,115,83,3],a,a,1,0,2],[3,5,[3,83,115,83,3],a,a,1,0,2],[4,5,[3,3,3,4,3],a,a,4,0,2],[4,5,[3,3,3,4,3],a,a,4,0,2],[4,5,[3,3,3,3,3],a,a,4,0,2],[0,1,[3],a,a,4,0,2],[2,3,[3,3,3],a,a,4,0,2],[3,4,[3,3,3,3],a,a,4,0,2],[1,3,[1,67,66],a,a,1,0,2],[1,1,[52],a,a,36,0,2],[1,1,[2],a,a,2,0,64],[1,1,[32],a,a,1,0,0],[1,1,[32],a,a,32,0,0],[2,2,[32,32],a,a,32,0,0],[0,2,[2,2],a,a,32,0,2],[4,6,[1,1,1,1,1,1],a,a,1,0,0],[4,6,[1,1,1,1,1,1],a,a,1,0,0],[1,255,a,[121],a,1,0,32],[0,2,[1,16],a,a,4,0,2],[3,4,[2,1,1,1],a,a,512,0,2],[1,1,[4],a,a,512,0,2],[0,0,a,a,a,512,0,2],[0,0,a,a,a,512,0,2],[2,2,[2,2],a,a,1,0,2],[2,2,[1,2],a,a,32,0,2],[3,3,[1,18,18],a,a,4,0,2],[2,2,[1,2],a,a,4,0,2],[1,1,[1],a,a,4,0,2],[0,1,[1],a,a,512,0,2],[0,1,[2],a,a,4,0,2],[0,4,[3,3,3,3],a,a,3,0,2],[1,255,a,[113],a,1,0,32],[1,1,[1],a,a,1,0,0],[1,2,[1,16],a,a,47,0,2],[1,1,[1],a,a,47,0,2],[1,2,[1,2],a,a,47,0,2],[1,2,[1,2],a,a,63,0,2],[3,3,[16,19,18],a,a,1,0,0],[1,1,[143],a,a,4,0,64],[0,3,[82,65,65],a,a,2,0,2],[0,4,[66,82,17,17],a,a,1,0,2],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[1,2,[1,1],a,a,1,0,0],[1,1,[143],a,a,4,0,64],[3,3,[16,83,18],a,a,1,0,0],[1,1,[3],a,a,4,0,2],[1,1,[3],a,a,4,0,2],void 0,void 0,[1,2,[1,1],a,a,2,0,192],[2,3,[2,2,1],a,a,1,0,192],[2,3,[2,2,1],a,a,1,0,192],[4,4,[2,1,1,2],a,a,2,0,192],[1,2,[2,9],a,a,2,0,192],[1,2,[2,9],a,a,2,0,192],[3,3,[2,1,1],a,a,2,0,192],[1,1,[2],a,a,1,0,192],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[1,1,[2],a,a,2,0,192],[1,1,[2],a,a,2,0,192],[2,3,[1,16,4],a,a,1,0,32],void 0,void 0,[2,5,[1,65,65,68,66],a,a,2,0,0],[2,3,[1,1,4],a,a,1,0,0],[0,0,a,a,a,1,16383,0],[5,7,[1,1,1,1,1,1,4],a,a,1,0,0],[0,0,a,a,a,512,0,2],[1,1,[12],a,a,512,0,2],[0,0,a,a,a,512,0,2],[1,3,[2,82,84],a,a,512,0,2],[1,255,a,[49],a,1,0,32],[1,255,a,[32],a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[16,19,18],a,a,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],a,a,2,0,2],[0,1,[4],a,a,4,0,2],[0,0,a,a,a,16,0,2],[0,2,[2,2],a,a,4,0,2],[0,3,[2,2,2],a,a,4,0,2],[2,5,[2,23,23,23,23],a,a,2,0,66],[2,4,[2,1,1,2],a,a,1,0,2],[1,4,[2,66,65,65],a,a,1,0,2],[1,1,[2],a,a,3,16383,0],[0,0,a,a,a,2,0,2],[1,5,[1,2,1,1,1],a,a,47,0,2],[4,5,[1,1,1,1,1],a,a,1,0,0],[0,1,[4],a,a,512,0,2],void 0,void 0,[0,1,[1],a,a,512,0,2],[2,2,[48,48],a,a,32,0,32],[0,2,[66,96],a,a,2,0,2],[1,1,[2],a,a,4,0,2],[1,255,[17],[127],a,575,0,192],[1,1,[3],a,a,4,0,2],[1,1,[2],a,a,63,0,2],[1,2,[1,3],a,a,47,0,2],[1,3,[1,3,1],a,a,47,0,2],[1,3,[2,66,4],a,a,4,0,2],[1,1,[15],a,a,1,0,0],[0,1,[2],a,a,4,0,2],[0,1,[2],a,a,4,0,2],[0,2,[99,66],a,a,4,0,2],[3,3,[3,1,4],a,a,4,0,2],[3,3,[3,1,4],a,a,4,0,2],[2,3,[2,3,66],a,a,1,0,2],[1,2,[1,2],a,a,35,0,2],[1,255,a,[49],a,1,0,32],[3,5,[1,1,1,65,65],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,5,[1,1,1,65,65],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[4,4,[1,1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[3,3,[1,32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[4,4,[32,32,1,1],a,a,1,0,0],[3,4,[32,32,1,65],a,a,1,0,0],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[2,3,[49,1,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,3,[49,1,65],a,a,1,0,32],[1,255,a,[32],a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[1,1],a,a,1,0,0],void 0,[3,4,[2,1,1,1],a,a,1,0,130],[2,3,[2,1,1],a,a,1,0,130],[1,255,a,[2],a,2,0,64],[2,2,[1,1],a,a,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],a,a,2,0,2],[1,2,[1,2],a,a,35,0,2],[1,3,[1,66,2],a,a,35,0,2],[1,4,[1,66,66,2],a,a,7,0,2],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,255,[1],[16],a,1,0,0],[2,3,[16,15,16],a,a,1,0,64],[2,2,[16,15],a,a,1,0,64],[1,1,[16],a,a,1,0,0],[1,2,[1,2],a,a,19,0,2],[1,1,[33],a,a,33,0,2],[4,4,[1,1,1,1],a,a,1,0,0],[3,3,[1,1,2],a,a,1,0,128],[1,1,[1],a,a,2,0,192],[2,2,[1,1],a,a,2,0,192],[1,2,[1,5],a,a,2,0,0],[0,4,[66,66,66,65],a,a,6,0,2],[0,5,[66,66,66,66,65],a,a,6,0,2],[1,2,[1,2],a,a,19,0,2],[2,255,[18,18],[2,79],a,15,0,0],[1,2,[2,39],a,a,39,0,0],[1,1,[16],a,a,2,0,128],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,1,[1],a,a,2,0,64],[1,1,[1],a,a,2,0,192],[1,1,[3],a,a,2,0,192],[1,1,[1],a,a,2,0,192],[1,1,[1],a,a,2,0,192],[1,1,[1],a,a,2,0,192],[1,1,[2],a,a,1,0,192],[1,1,[2],a,a,4,0,192],[1,1,[1],a,a,1,0,192],[1,1,[1],a,a,1,0,192],[1,1,[1],a,a,1,0,192],[3,255,[2,2],[2],a,2,0,0],[1,255,[2],[50],a,15,0,0],[2,3,[2,50,2],a,a,10,0,0],[3,3,[2,2,2],a,a,15,0,0],[3,4,[2,2,1,2],a,a,10,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,3,[95,95,95],a,a,9,0,0],[1,255,a,[127],a,9,0,0],[1,255,a,[127],a,9,0,0],[4,4,[95,95,95,127],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,3,[127,127,95],a,a,9,0,0],[3,3,[95,127,127],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[6,7,[95,95,95,95,95,95,95],a,a,9,0,0],[6,7,[95,95,95,95,95,95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[6,6,[95,95,95,95,95,95],a,a,9,0,0],[6,6,[95,95,95,95,95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,3,[95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[7,8,[95,95,95,95,95,95,95,95],a,a,9,0,0],[7,8,[95,95,95,95,95,95,95,95],a,a,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],a,a,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,16383,0],[1,2,[95,95],a,a,9,0,0],[6,7,[95,95,95,95,95,95,95],a,a,9,0,128],[6,7,[95,95,95,95,95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[6,8,[95,95,95,95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[2,3,[95,95,127],a,a,9,0,0],[2,3,[95,95,127],a,a,9,0,0],[1,255,a,[127],a,9,0,0],[1,255,a,[127],a,9,0,0],[1,255,a,[127],a,9,0,0],[2,2,[95,127],a,a,9,0,0],[3,4,[2,2,1,2],a,a,10,0,0],[2,5,[2,50,2,1,2],a,a,10,0,64],[1,1,[2],a,a,9,0,0],[2,2,[47,575],a,a,303,0,0],[2,255,a,[16,15],a,1,0,64],[3,255,[16],[16,15],a,1,0,64],[2,3,[16,15,16],a,a,1,0,64],[3,255,[16],[16,15],a,1,0,64],[3,254,[1,1,48,17],[16],a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,254,a,[32],a,32,0,32],[1,254,a,[32],a,1,0,32],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,3,[49,1,65],a,a,1,0,32],[2,3,[49,1,65],a,a,1,0,32],[3,3,[1,1,4],a,a,1,0,0],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,3,[1,16,4],a,a,1,0,32],[2,3,[1,16,4],a,a,1,0,32],[1,254,a,[49],a,1,0,32],[1,254,a,[49],a,1,0,32],[3,3,[1,1,4],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[1,254,a,[49],a,1,0,32],[1,254,a,[49],a,1,0,32],[4,4,[1,1,1,4],a,a,1,0,0],[2,4,[95,95,75,127],a,a,9,0,0],[2,4,[95,95,75,127],a,a,9,0,0],[2,2,[1,1],a,a,1,0,128],[1,2,[1,65],a,a,1,0,128],void 0,[4,6,[1,1,1,4,65,65],a,a,1,0,0],[3,5,[1,1,1,65,65],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[5,5,[1,1,1,1,4],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[2,2,[1,4],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[4,4,[32,32,1,1],a,a,1,0,0],[2,3,[49,1,1],a,a,1,0,32],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[1],a,a,1,0,0],[1,2,[1,65],a,a,1,0,128],[1,2,[1,65],a,a,1,0,128],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[1,254,a,[52],a,4,0,32],[3,3,[1,1,1],a,a,1,0,0],[2,3,[1,1,65],a,a,2,0,0],[2,2,[2,1],a,a,1,0,0],[2,2,[3,3],a,a,1,0,64],[3,4,[1,1,1,65],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,254,a,[49],a,1,0,32],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,2,0,0],[1,1,[2],a,a,1,0,0],[1,1,[1],a,a,32,0,0],[1,1,[2],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,3,[2,66,66],a,a,1,0,0],[0,1,[50],a,a,1,16383,32],[0,1,[48],a,a,1,16383,32],[1,1,[16],a,a,2,16383,0],[1,1,[16],a,a,4,0,0],[2,2,[47,575],a,a,303,0,0],[1,3,[1,65,65],a,a,1,0,0],[1,3,[1,65,65],a,a,1,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[2,2],a,a,47,0,64],[1,1,[2],a,a,10,0,64],[1,1,[2],a,a,10,0,64],[3,6,[1,48,48,65,65,65],a,a,1,0,0],[3,7,[1,48,48,65,65,65,65],a,a,1,0,0],[2,4,[48,48,65,65],a,a,1,0,0],[3,3,[1,32,32],a,a,1,0,0],[3,6,[48,48,1,65,65,65],a,a,1,0,0],[3,254,[16],[16,15],a,1,0,64],[3,254,[16],[16,15],a,1,0,64],[3,254,[114,68],[114],a,2,0,96],[1,254,a,[114],a,2,0,96],[2,254,a,[44,575],a,831,0,64],[3,254,[47],[575,575],[575],831,0,64],[1,1,[1527],a,a,1503,0,233],[2,254,a,[113,113],a,1,0,33],[1,1,[16],a,a,48,0,41],[2,3,[271,2,4],a,a,303,0,105],[2,2,[271,2],a,a,303,0,97],[2,3,[48,48,111],a,a,303,0,65],[1,4,[160,96,96,4],a,a,32,0,65],[1,3,[160,4,4],a,a,32,0,65],[2,2,[2,256],a,a,1,0,80],[3,3,[2,49,1],a,a,1,0,48],[3,3,[2,49,1],a,a,1,0,48],[2,254,[2],[49],a,1,0,48],[2,7,[34,2,65,65,65,74,68],a,a,1,0,65],[1,3,[2,65,65],a,a,2,0,65],[2,6,[2,34,65,65,65,74],a,a,2,0,65],[2,6,[2,34,65,65,65,74],a,a,2,0,65],[2,6,[2,98,98,68,65,495],a,a,32,0,65],[1,4,[32,96,96,4],a,a,32,0,81],[2,2,[4,16],a,a,32,0,49],[2,4,[391,48,65,65],a,a,1,0,65],[3,6,[391,48,48,511,65,65],a,a,319,0,65],[2,254,[160],[160,65],a,32,0,65],[0,5,[65,65,65,65,68],a,a,32,16383,1],[1,4,[65,65,65,65],a,a,32,0,1],[2,254,[258,1,65,65,65],[65],a,32,0,97],[2,3,[32,1,463],a,a,32,0,65],[1,254,a,[48],a,32,0,33],[1,254,a,[48],a,32,0,33],[2,254,[48],[33],a,32,0,1],[2,254,[48],[33],a,32,0,1],[3,254,a,[319,319],[319],319,0,1],[1,254,a,[319],a,319,0,1],[3,3,[65,65,319],a,a,32,0,1],[1,254,a,[319],a,319,0,1],[1,1,[271],a,a,4,0,1],[1,1,[271],a,a,9,0,1],[0,0,a,a,a,319,0,1],[2,2,[49,49],a,a,9,0,1],[1,2,[399,1],a,a,2,0,65],[1,2,[32,1],a,a,2,0,65],[2,2,[15,2],a,a,256,0,97],[1,3,[48,65,68],a,a,32,0,97],[1,3,[48,65,68],a,a,32,0,97],[2,3,[32,1,463],a,a,32,0,65],[2,254,[48],[319],a,32,0,65],[3,3,[511,48,271],a,a,319,0,65],[3,3,[511,48,271],a,a,32,0,65],[1,2,[48,271],a,a,32,0,65],[1,2,[48,271],a,a,32,0,65],[1,1,[1535],a,a,4,0,65],[2,4,[32,65,65,495],a,a,32,0,65],[2,3,[48,65,65],a,a,48,0,65],[2,3,[48,65,65],a,a,48,0,65],[2,254,[1,1],[447],a,303,0,97],void 0,[1,5,[2,66,65,65,65],a,a,264,0,65],[2,2,[15,2],a,a,271,0,97],[3,8,[112,96,96,65,65,96,96,65],a,a,32,0,65],[4,11,[112,112,96,96,65,65,96,65,96,96,65],a,a,32,0,65],[1,1,[2],a,a,264,0,9],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[3,254,[256,2,4],[47],a,303,0,105],[2,254,[256,2],[47],a,303,0,97],[1,3,[2,2,2],a,a,2,0,97],[1,1,[2],a,a,2,0,97],[2,3,[2,2,1],a,a,4,0,65],[3,5,[2,2,2,1,1],a,a,2,0,65],[2,4,[2,2,1,1],a,a,34,0,65],[1,3,[48,65,65],a,a,16,0,65],[1,3,[2,1,2],a,a,32,0,65],[1,5,[2,35,1,2,1],a,a,32,0,65],[1,1,[16],a,a,16,0,73],[1,1,[16],a,a,16,0,73],[1,1,[16],a,a,16,0,73],[0,0,a,a,a,1,0,1],[1,2,[287,2],a,a,288,0,97],[1,2,[1,1],a,a,10,0,97],[0,0,a,a,a,1,0,1],[3,254,[47],[2,47],a,47,0,97],[0,1,[1],a,a,1,0,1],[0,1,[1],a,a,32,0,1],[1,2,[2,1],a,a,47,0,1],[1,1,[1],a,a,264,0,97],[1,1,[1],a,a,264,0,97],[2,2,[2,47],a,a,47,0,1],[1,254,[2],[1151],a,1087,0,96],[1,254,[1],[1151],a,1087,0,0],[1,254,[1],[1151],a,1087,0,0],[1,1,[16],a,a,32,0,1],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[2,2,[256,2],a,a,2,0,97],[1,1,[32],a,a,256,0,97],[3,254,[15],[2,47],a,303,0,97],[1,1,[256],a,a,2,0,97],[4,254,[256,66,66,66],[66,96],a,319,0,1],[1,1,[48],a,a,16,0,97],[2,2,[2,2],a,a,34,0,65],[1,1,[16],a,a,2,0,97],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,a,[319,319],[319],319,0,1],[3,254,[15],[2,303],a,303,0,97]].map((e=>void 0===e?void 0:(0,n.functionType)(...e)))},6592:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.createResolver=t.resolveGridRef=t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.relabelFormula=t.createPrinter=t.anonymizeFormula=t.xlMathpack=t.ieeeMathpack=t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=t.buildAnnotations=t.adjustFormulaOrigin=t.PackageName=void 0,t.value=t.types=t.testUtil=t.signature=t.printServiceTypes=t.printService=t.mathpackXL=t.location=t.formulaModule=t.config=t.reducePledge=t.reduceBottomUp=t.PledgeReducer=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=void 0;const n=r(6533);t.PackageName="excel-online-calc-lang";var i=r(5665);Object.defineProperty(t,"adjustFormulaOrigin",{enumerable:!0,get:function(){return i.adjustFormulaOrigin}});var a=r(2986);Object.defineProperty(t,"buildAnnotations",{enumerable:!0,get:function(){return a.buildAnnotations}});var o=r(3949);Object.defineProperty(t,"columnName",{enumerable:!0,get:function(){return o.columnName}}),Object.defineProperty(t,"canonicaliseBrackets",{enumerable:!0,get:function(){return o.canonicaliseBrackets}}),Object.defineProperty(t,"resolvePosition",{enumerable:!0,get:function(){return o.resolvePosition}}),Object.defineProperty(t,"formatRow",{enumerable:!0,get:function(){return o.formatRow}}),Object.defineProperty(t,"formatCol",{enumerable:!0,get:function(){return o.formatCol}}),Object.defineProperty(t,"canonicaliseRow",{enumerable:!0,get:function(){return o.canonicaliseRow}}),Object.defineProperty(t,"canonicaliseCol",{enumerable:!0,get:function(){return o.canonicaliseCol}}),Object.defineProperty(t,"formatRowRange",{enumerable:!0,get:function(){return o.formatRowRange}}),Object.defineProperty(t,"formatColRange",{enumerable:!0,get:function(){return o.formatColRange}}),Object.defineProperty(t,"canonicaliseRowRange",{enumerable:!0,get:function(){return o.canonicaliseRowRange}}),Object.defineProperty(t,"canonicaliseColRange",{enumerable:!0,get:function(){return o.canonicaliseColRange}}),Object.defineProperty(t,"formatCellPos",{enumerable:!0,get:function(){return o.formatCellPos}}),Object.defineProperty(t,"canonicaliseCellPos",{enumerable:!0,get:function(){return o.canonicaliseCellPos}}),Object.defineProperty(t,"formatRangePos",{enumerable:!0,get:function(){return o.formatRangePos}}),Object.defineProperty(t,"canonicaliseRangePos",{enumerable:!0,get:function(){return o.canonicaliseRangePos}}),Object.defineProperty(t,"shouldQuoteQualifier",{enumerable:!0,get:function(){return o.shouldQuoteQualifier}}),Object.defineProperty(t,"formatQualifier",{enumerable:!0,get:function(){return o.formatQualifier}}),Object.defineProperty(t,"quoteQualifier",{enumerable:!0,get:function(){return o.quoteQualifier}}),Object.defineProperty(t,"formatGridRange",{enumerable:!0,get:function(){return o.formatGridRange}}),Object.defineProperty(t,"formatName",{enumerable:!0,get:function(){return o.formatName}});var s=r(1211);Object.defineProperty(t,"SpecialPos",{enumerable:!0,get:function(){return s.SpecialPos}}),Object.defineProperty(t,"isR1C1IdentStart",{enumerable:!0,get:function(){return s.isR1C1IdentStart}}),Object.defineProperty(t,"parseCellRef",{enumerable:!0,get:function(){return s.parseCellRef}}),Object.defineProperty(t,"parseGridCellA1",{enumerable:!0,get:function(){return s.parseGridCellA1}}),Object.defineProperty(t,"parseGridRangeA1",{enumerable:!0,get:function(){return s.parseGridRangeA1}}),Object.defineProperty(t,"parseQualifier",{enumerable:!0,get:function(){return s.parseQualifier}}),Object.defineProperty(t,"wrapPosition",{enumerable:!0,get:function(){return s.wrapPosition}}),n.__exportStar(r(6836),t),n.__exportStar(r(8179),t),n.__exportStar(r(1982),t);var u=r(4704);Object.defineProperty(t,"isSpace",{enumerable:!0,get:function(){return u.isSpace}}),Object.defineProperty(t,"isLineBreak",{enumerable:!0,get:function(){return u.isLineBreak}}),Object.defineProperty(t,"parseUint",{enumerable:!0,get:function(){return u.parseUint}}),Object.defineProperty(t,"parseNumberLiteral",{enumerable:!0,get:function(){return u.parseNumberLiteral}}),Object.defineProperty(t,"parseSignedLiteral",{enumerable:!0,get:function(){return u.parseSignedLiteral}}),n.__exportStar(r(9209),t),n.__exportStar(r(1133),t);var l=r(7197);Object.defineProperty(t,"ieeeMathpack",{enumerable:!0,get:function(){return l.ieeeMathpack}});var c=r(7185);Object.defineProperty(t,"xlMathpack",{enumerable:!0,get:function(){return c.xlMathpack}}),n.__exportStar(r(6481),t);var d=r(2184);Object.defineProperty(t,"anonymizeFormula",{enumerable:!0,get:function(){return d.anonymizeFormula}}),Object.defineProperty(t,"createPrinter",{enumerable:!0,get:function(){return d.createPrinter}}),n.__exportStar(r(719),t);var m=r(865);Object.defineProperty(t,"relabelFormula",{enumerable:!0,get:function(){return m.relabelFormula}});var g=r(7089);Object.defineProperty(t,"canDenoteLocalName",{enumerable:!0,get:function(){return g.canDenoteLocalName}}),Object.defineProperty(t,"canDenoteUserDefinedFunc",{enumerable:!0,get:function(){return g.canDenoteUserDefinedFunc}}),Object.defineProperty(t,"canDenoteCellRef",{enumerable:!0,get:function(){return g.canDenoteCellRef}}),Object.defineProperty(t,"resolveGridRef",{enumerable:!0,get:function(){return g.resolveGridRef}}),Object.defineProperty(t,"createResolver",{enumerable:!0,get:function(){return g.createResolver}}),n.__exportStar(r(4052),t),n.__exportStar(r(9798),t),n.__exportStar(r(6654),t),n.__exportStar(r(7325),t),n.__exportStar(r(1813),t),n.__exportStar(r(6234),t),n.__exportStar(r(1973),t);var p=r(6426);Object.defineProperty(t,"visitFormulaNode",{enumerable:!0,get:function(){return p.visitFormulaNode}}),Object.defineProperty(t,"visitOperatorNode",{enumerable:!0,get:function(){return p.visitOperatorNode}}),Object.defineProperty(t,"visitWSFNode",{enumerable:!0,get:function(){return p.visitWSFNode}}),Object.defineProperty(t,"visitAppHeadNode",{enumerable:!0,get:function(){return p.visitAppHeadNode}}),Object.defineProperty(t,"visitQualifier",{enumerable:!0,get:function(){return p.visitQualifier}}),Object.defineProperty(t,"visitCellRef",{enumerable:!0,get:function(){return p.visitCellRef}}),Object.defineProperty(t,"bindVisitor",{enumerable:!0,get:function(){return p.bindVisitor}}),Object.defineProperty(t,"IdentityVisitor",{enumerable:!0,get:function(){return p.IdentityVisitor}}),Object.defineProperty(t,"identityVisitor",{enumerable:!0,get:function(){return p.identityVisitor}}),Object.defineProperty(t,"ConstVisitor",{enumerable:!0,get:function(){return p.ConstVisitor}}),Object.defineProperty(t,"constVisitor",{enumerable:!0,get:function(){return p.constVisitor}}),Object.defineProperty(t,"voidVisitor",{enumerable:!0,get:function(){return p.voidVisitor}}),Object.defineProperty(t,"DelegatingVisitor",{enumerable:!0,get:function(){return p.DelegatingVisitor}}),Object.defineProperty(t,"BinaryVisitor",{enumerable:!0,get:function(){return p.BinaryVisitor}}),Object.defineProperty(t,"binaryVisitor",{enumerable:!0,get:function(){return p.binaryVisitor}}),Object.defineProperty(t,"ComposeVisitor",{enumerable:!0,get:function(){return p.ComposeVisitor}}),Object.defineProperty(t,"composeVisitor",{enumerable:!0,get:function(){return p.composeVisitor}}),Object.defineProperty(t,"depthVisitor",{enumerable:!0,get:function(){return p.depthVisitor}}),Object.defineProperty(t,"ZipVisitor",{enumerable:!0,get:function(){return p.ZipVisitor}}),Object.defineProperty(t,"zipVisitor",{enumerable:!0,get:function(){return p.zipVisitor}}),Object.defineProperty(t,"PledgeReducer",{enumerable:!0,get:function(){return p.PledgeReducer}}),Object.defineProperty(t,"reduceBottomUp",{enumerable:!0,get:function(){return p.reduceBottomUp}}),Object.defineProperty(t,"reducePledge",{enumerable:!0,get:function(){return p.reducePledge}}),t.config=n.__importStar(r(6836)),t.formulaModule=n.__importStar(r(1982)),t.location=n.__importStar(r(9209)),t.mathpackXL=n.__importStar(r(7185)),t.printService=n.__importStar(r(2184)),t.printServiceTypes=n.__importStar(r(719)),t.signature=n.__importStar(r(6654)),t.testUtil=n.__importStar(r(8335)),t.types=n.__importStar(r(1813)),t.value=n.__importStar(r(1973))},4704:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSpace=d,t.isLineBreak=function(e){return e===s},t.parseUint=m,t.parseNumberLiteral=p,t.parseSignedLiteral=function(e,t,r,n,i){let a=n,o=!1;if(a<r.length){const e=r.charCodeAt(a);if((e===l||e===u)&&(o=e===u,a+=1,i))for(;a<r.length&&d(r.charCodeAt(a));)a+=1}const s=p(e,t,r,a,!1,!1,!1);return void 0===s?.value?[t.zero,n]:(a=s.i,[o?t.neg(s.value):s.value,a])};const n=r(6913),i=r(6481),a=r(6234),{codePointSpace:o,codePointLF:s,codePointMinusSign:u,codePointPlusSign:l,codePointSlash:c}=n.codePoint;function d(e){return e===o||e===s}function m(e,t,r,i){(0,n.assertIndex)("calc.parse.parseUint",t,16);let a=0,o=i,s=r.length;for(;o<s;){const i=(0,n.stringCodePointAt)(r,o);if(!e.isNumeral(i))break;const u=e.getOrdinal(i);0===a&&0!==u&&(s=(0,n.fastMin)(s,o+t)),a=10*a+u,o+=(0,n.numCodeUnits)(i)}return o===s&&o<r.length&&e.isNumeral((0,n.stringCodePointAt)(r,o))?[0,i]:[a,o]}function g(e,t,r,i){let o=i;const[s,u]=m(e,5,r,o);if(u===o)return!1;if(s>32767)return!1;if(o=u,!(o<r.length&&r.charCodeAt(o)===c))return!1;o+=1;const[l,d]=m(e,5,r,o);if(d===o)return!1;if(l>32767)return!1;if(o=d,0===l)return[!1,0,o];const g=t.div(t.fromNumber(s),t.fromNumber(l));return(0,n.assertTrue)("calc.lang.tryTokenizeFrac",(0,a.isNumberOper)(g)),[g,l,o]}function p(e,t,r,o,s,c,p){let h,f,S,v=o,y=0,F="",b=!1,C=!1,k=0,E=0,A=i.NumberShape.ASCII;if(!((0,n.stringStartsWith)(r,e.decimalSeparator,o)||o<r.length&&e.isNumeral((0,n.stringCodePointAt)(r,o))))return;const T=()=>{if((c||s&&r.indexOf("%",v)>=0)&&(y-=2,void 0!==h)){const e=t.div(h,t.fromNumber(100));(0,n.assertTrue)("calc.lang.parseNumberLiteral",(0,a.isNumberOper)(e)),h=e,S=i.KnownFormat.Pct}if((0,n.fastAbs)(y)>=309)return{value:void 0,i:v,consumedThousands:b,consumedDecimal:C,numDigDec:k,numShape:A,format:S};let o=t.parse(e,!0,y,F);if(void 0!==h){const e=t.add(o,h);(0,n.assertTrue)("calc.lang.parseNumberLiteral",(0,a.isNumberOper)(e)),o=e}return{value:o,i:v,consumedThousands:b,consumedDecimal:C,numDigDec:k,numShape:A,format:S}};for(;v<r.length;){const t=(0,n.stringCodePointAt)(r,v);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;(f=e.getNumberShape(t))!==i.NumberShape.ASCII&&(A=f),v+=(0,n.numCodeUnits)(t)}if(p){const n=g(e,t,r,v);if(!1!==n){const[e,t,r]=n;return v=r,!1===e?{value:void 0,i:v,consumedThousands:b,consumedDecimal:C,numDigDec:k,numShape:A,format:S}:(S=t>=10?i.KnownFormat.FractBond:i.KnownFormat.Fract,h=e,T())}}let R=v;for(;v<r.length;){const t=(0,n.stringCodePointAt)(r,v);if(e.isNumeral(t))y+=1,(f=e.getNumberShape(t))!==i.NumberShape.ASCII&&(A=f),v+=(0,n.numCodeUnits)(t);else{if(!(s&&y>0&&(0,n.stringStartsWith)(r,e.thousandsSeparator,v)))break;b=!0,v+=e.thousandsSeparator.length}}if(F+=r.substring(R,v),b){const t=function(e,t,r){let i=r,a="";for(let r=0;r<t.length;){const o=(0,n.stringCodePointAt)(t,r);if(e.isNumeral(o)){const e=(0,n.numCodeUnits)(o);a+=t.substring(r,r+e),r+=e,i-=1}else{if(0===i||!e.isThousandsPosition(i))return;r+=e.thousandsSeparator.length}}return a}(e,F,y);if(void 0===t)return;F=t}if(o<v&&v<r.length&&d(r.charCodeAt(v))){const n=g(e,t,r,v+1);if(!1!==n){const[e,t,r]=n;return v=r,!1===e?{value:void 0,i:v,consumedThousands:b,consumedDecimal:C,numDigDec:k,numShape:A,format:S}:(S=t>=10?i.KnownFormat.FractBond:i.KnownFormat.Fract,h=e,T())}}let N=!1;if((0,n.stringStartsWith)(r,e.decimalSeparator,v)&&(N=v===o,C=!0,v+=e.decimalSeparator.length),0===y)for(;v<r.length;){const t=(0,n.stringCodePointAt)(r,v);if(!e.isNumeral(t))break;if(0!==e.getOrdinal(t))break;y-=1,(f=e.getNumberShape(t))!==i.NumberShape.ASCII&&(A=f),E+=1,v+=(0,n.numCodeUnits)(t)}for(R=v;v<r.length;){const t=(0,n.stringCodePointAt)(r,v);if(!e.isNumeral(t))break;(f=e.getNumberShape(t))!==i.NumberShape.ASCII&&(A=f),k+=1,v+=(0,n.numCodeUnits)(t)}if(F+=r.substring(R,v),k>0&&(k+=E),N&&v<=o+e.decimalSeparator.length)return;const I=function(e,t,r){let i=r;if(i<t.length&&0===e.stringCompareCI("E",t.substring(i,i+1)))i+=1;else{if(!(0,n.stringStartsWith)(t,"**",i))return[0,r];i+=2}let a=!1;if(i<t.length){const e=(0,n.stringCodePointAt)(t,i);((a=e===u)||e===l)&&(i+=(0,n.numCodeUnits)(e))}if(i>=t.length||!e.isNumeral((0,n.stringCodePointAt)(t,i)))return!1;const[o,s]=m(e,10,t,i);return s!==i&&!(o>2147483647)&&[a?-o:o,s]}(e,r,v);if(!1!==I){const[e,t]=I;y+=e,t!==v&&(S=i.KnownFormat.Exp),v=t}return!1===I?{value:void 0,i:v,consumedThousands:b,consumedDecimal:C,numDigDec:k,numShape:A,format:S}:T()}},9209:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.sheetCols=t.sheetRows=t.NameSource=t.LexicalKind=void 0,t.lexicalSourceCell=o,t.lexicalSourceRange=s,t.lexicalSourceGrid=function(e,t){switch(e){case i.Cell:return h(t)?o(t):(0,n.assertFalse)("calc.lang.lexicalSourceGrid: expected cell");case i.Range:return s(t)}},t.lexicalSourceName=function(e){return{kind:i.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:i.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:i.UDF,udf:e}},t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=u,t.sheetIndex=l,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=c,t.gridRange=function(e,r,i,a){return(0,n.assertIndex)("calc.lang.gridRange",e,t.sheetRows),(0,n.assertIndex)("calc.lang.gridRange",r,t.sheetCols),(0,n.assertPositiveLength)("calc.lang.gridRange",i,t.sheetRows-e),(0,n.assertPositiveLength)("calc.lang.gridRange",a,t.sheetCols-r),c(e,r,i,a)},t.gridCell=function(e,r){return(0,n.assertIndex)("calc.lang.gridCell",e,t.sheetRows),(0,n.assertIndex)("calc.lang.gridCell",r,t.sheetCols),c(e,r,1,1)},t.documentScope=m,t.nameScope=function(e,t){return void 0===t?m(e):l(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=g,t.isGridCell=p,t.isSheetGridRange=function(e){return g(e.sheet)},t.isSheetGridCell=h;const n=r(6913);var i,a;function o(e){return{kind:i.Cell,range:e}}function s(e){return{kind:i.Range,range:e}}function u(e,t,r){return{document:e,index:t,index2:r}}function l(e,t){return u(e,t,t)}function c(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function d(e,t){return{sheet:e,range:t}}function m(e){return{document:e,index:void 0}}function g(e){return e.index===e.index2}function p(e){return 1===e.rows&&1===e.cols}function h(e){return p(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(i||(t.LexicalKind=i={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(a||(t.NameSource=a={})),t.sheetRows=1<<20,t.sheetCols=16384,t.sheetGridCube=d,t.sheetGridRange=d,t.sheetGridCell=d,t.originCell=d},1133:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=void 0,t.formatScientificLeft=function(e,t){if(t<=1)return t;const r=e%t;return 0===r?t:r<0?r+t:r};const n=r(6913);t.numberComponents=(0,n.typedInstanceCreator)()(((e,t,r)=>({sign:e,mantissa:t,exponent:r})))},7197:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;const n=r(6913),i=r(1133),a=r(1813),o=r(1973),{codePointDigitZero:s}=n.codePoint;function u(e){return{kind:a.OperKind.Number,_valueIEEE:e}}const l=u(0),c=u(1),d=u(Math.PI);function m(e){return isFinite(e)?u(e):o.numErrorOper}function g(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return r<n?-1:r>n?1:0}function p(e,t){const r=void 0===t?e.toExponential():e.toExponential(t),i=r.indexOf("e"),a=!(0,n.stringStartsWith)(r,"-"),o=r.substring(a?0:1,i).replace(".",""),u=parseInt(r.substring(i+1),10)+1;return function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==s)return!1;return!0}(o)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:o,exponent:u}}const h=["0","1","2","3","4","5","6","7","8","9"];function f(e){const{_valueIEEE:t}=e;return u(t<0?Math.ceil(t):Math.floor(t))}function S(e){const{_valueIEEE:t}=e;return u(Math.floor(t))}function v(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:l,one:c,pi:d,add:(e,t)=>m(e._valueIEEE+t._valueIEEE),sub:(e,t)=>m(e._valueIEEE-t._valueIEEE),mul:(e,t)=>m(e._valueIEEE*t._valueIEEE),div:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t;return 0===n?o.div0ErrorOper:m(r/n)},power:function(e,t){const{_valueIEEE:r}=e,{_valueIEEE:n}=t,i=r**n;return isFinite(i)?u(i):isNaN(i)?o.div0ErrorOper:o.numErrorOper},percent:e=>u(e._valueIEEE/100),neg:e=>u(-e._valueIEEE),compare:g,formatGeneral:function({decimalSeparator:e},t,r){const{_valueIEEE:n}=t;let i=String(n).replace("e","E");return"."!==e&&(i=i.replace(".",e)),i},formatFixed:function(e,t,r){const{_valueIEEE:n}=e;let{sign:a,mantissa:o,exponent:s}=p(n),u=r+(s+t);if(0===u){const e=parseFloat("5e"+String(s-1));if(Math.abs(n)>=e)return(0,i.numberComponents)(a,"1",s+t+1)}if(u<1)return(0,i.numberComponents)(!0,"",0);u<=21&&(({sign:a,mantissa:o,exponent:s}=p(n,u-1)),u=r+(s+t));const l=o.substring(0,u);return(0,i.numberComponents)(a,l,0===l.length?0:s+t)},formatScientific:function(e,t,r){const{_valueIEEE:a}=e;let{sign:o,mantissa:s,exponent:u}=p(a),l=(0,i.formatScientificLeft)(u,t),c=l+r;if((0,n.assertTrue)("calc.lang.ieeeFormatScientific",c>0),0===c){const e=parseFloat("5e"+String(u-1));if(Math.abs(a)>=e)return(0,i.numberComponents)(o,"",u+1)}if(c<1)return(0,i.numberComponents)(!0,"",0);c<=21&&(({sign:o,mantissa:s,exponent:u}=p(a,c-1)),l=(0,i.formatScientificLeft)(u,t),c=l+r);const d=s.substring(0,c);return(0,i.numberComponents)(o,d,0===d.length?0:u)},parse:function(e,t,r,i){return u(Number((t?"":"-")+"0."+function({getOrdinal:e},t){let r="";for(const i of(0,n.codePointIterator)(t))r+=h[e(i)];return r}(e,i)+"E"+String(r)))},trunc:f,ceil:function(e){const{_valueIEEE:t}=e;return u(Math.ceil(t))},floor:S,abs:e=>u(Math.abs(e._valueIEEE)),cond:e=>g(e,l),cond2:g,fromNumber:u,toNumber:e=>e._valueIEEE,sqrt:e=>m(Math.sqrt(e._valueIEEE)),exp:e=>m(Math.exp(e._valueIEEE)),ln:e=>m(Math.log(e._valueIEEE)),log:e=>m(Math.log(e._valueIEEE)/Math.LN10),sin:e=>u(Math.sin(e._valueIEEE)),cos:e=>u(Math.cos(e._valueIEEE)),tan:e=>u(Math.tan(e._valueIEEE)),asin:e=>m(Math.asin(e._valueIEEE)),acos:e=>m(Math.acos(e._valueIEEE)),atan:e=>m(Math.atan(e._valueIEEE)),atan2:(e,t)=>u(Math.atan2(t._valueIEEE,e._valueIEEE)),mod:(e,t)=>u(e._valueIEEE%t._valueIEEE),round:function(e,t){const{_valueIEEE:r}=e;if(0===r)return l;const{exponent:n}=p(r),i=f(t)._valueIEEE+n;if(0===i){const e=parseFloat("5e"+String(n-1));if(Math.abs(r)>=e)return m((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return i<1?l:i>21?e:m(parseFloat(r.toExponential(i-1)))},roundUp:function(e,t){const{_valueIEEE:r}=e;if(0===r)return l;const{sign:n,mantissa:i,exponent:a}=p(r),o=f(t)._valueIEEE+a;return o<1?m(parseFloat((n?"":"-")+"10e"+String(a-1-o))):o>21?e:m(parseFloat((n?"":"-")+function(e,t){if(e.length<=t)return v(e);const r=e.substring(0,t);let n=0;for(let e=r.length-1;e>=0&&r.charCodeAt(e)-s==9;e-=1)n+=1;return n===r.length?"10":v(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(i,o)+"e"+String(a-1)))},roundDown:function(e,t){const{_valueIEEE:r}=e;if(0===r)return l;const{sign:n,mantissa:i,exponent:a}=p(r),o=f(t)._valueIEEE+a;if(o<1)return l;if(o>21)return e;const s=i.substring(0,o);return m(parseFloat((n?"":"-")+v(s)+"e"+String(a-1)))},tenTo:function(e){return(0,n.assertInteger)("calc.lang.ieeeTenTo",e),m(Math.pow(10,e))},checkAlmostCancellation:(e,t)=>t,fix:function(e){const{_valueIEEE:t}=e,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){const t=f(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){const t=S(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:n.identity}},7185:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;const n=r(6913),i=r(5984),a=r(1813),o=r(1973);function s(e){return{kind:a.OperKind.Number,_valueXL:e}}const u=s(i.mathpack.zero()),l=s(i.mathpack.one()),c=s(i.mathpack.pi());function d(e){return 0!=(e.num&i.mathpack.MathErrorNum.DivBy0)?o.div0ErrorOper:o.numErrorOper}function m(e){return t=>(0,n.assertFalse)(`calc.lang.${e}: error ${JSON.stringify(t)}`)}function g(e,t,r){return n=>{const i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function p(e,t,r){return(n,i)=>{const a=e(n._valueXL,i._valueXL);return"number"==typeof a?t(a):r(a)}}const h=p(((e,t)=>i.mathpack.equal(t,2)?i.mathpack.mul(e,e):i.mathpack.power(e,t)),s,d),f=g((e=>i.mathpack.div(e,100)),s,m("xlPercent")),S=g(i.mathpack.ceil,s,m("xlCeil")),v=g(i.mathpack.floor,s,m("xlFloor")),y=g(i.mathpack.cond,n.identity,m(`xlCond, isSupported = ${(0,i.isSupported)()}`)),F=p(i.mathpack.cond2,n.identity,m("xlCond2")),b=g(i.mathpack.sfix,n.identity,m("xlSfix")),C=g(i.mathpack.viewRound,s,m("xlViewRound"));t.xlMathpack={zero:u,one:l,pi:c,add:p(i.mathpack.add,s,d),sub:p(i.mathpack.sub,s,d),mul:p(i.mathpack.mul,s,d),div:p(i.mathpack.div,s,d),power:h,percent:f,neg:function(e){return 0!==y(e)?s(i.mathpack.neg(e._valueXL)):e},compare:(e,t)=>i.mathpack.compare(e._valueXL,t._valueXL),formatGeneral:function(e,t,r){const{_valueXL:a}=t,o=i.mathpack.formatGeneral(e,a,r);return"string"!=typeof o?(0,n.assertFalse)(`calc.lang.xlFormatGeneral: error ${JSON.stringify(o)}`):o},formatFixed:function(e,t,r){const{_valueXL:a}=e,o=i.mathpack.formatFixed(a,t,r);return"object"!=typeof o?(0,n.assertFalse)(`calc.lang.xlFormatFixed: error ${JSON.stringify(o)}`):o},formatScientific:function(e,t,r){const{_valueXL:a}=e,o=i.mathpack.formatScientific(a,t,r);return"object"!=typeof o?(0,n.assertFalse)(`calc.lang.xlFormatScientific: error ${JSON.stringify(o)}`):o},parse:function(e,t,r,a){const o=i.mathpack.pack(e,t,r,a);return"number"!=typeof o?(0,n.assertFalse)(`calc.lang.xlParse: error ${JSON.stringify(o)}`):s(o)},trunc:e=>s(i.mathpack.trunc(e._valueXL)),ceil:S,floor:v,abs:e=>s(i.mathpack.abs(e._valueXL)),cond:y,cond2:F,fromNumber:function(e){return(0,n.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),s(e)},toNumber:function(e){const{_valueXL:t}=e;return(0,n.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:g(i.mathpack.sqrt,s,d),exp:g(i.mathpack.exp,s,d),ln:g(i.mathpack.ln,s,d),log:g(i.mathpack.log,s,d),sin:g(i.mathpack.sin,s,d),cos:g(i.mathpack.cos,s,d),tan:g(i.mathpack.tan,s,d),asin:g(i.mathpack.asin,s,d),acos:g(i.mathpack.acos,s,d),atan:g(i.mathpack.atan,s,d),atan2:p(i.mathpack.atan2,s,d),mod:p(i.mathpack.mod,s,d),round:p(i.mathpack.round,s,d),roundUp:p(i.mathpack.roundUp,s,d),roundDown:p(i.mathpack.roundDown,s,d),tenTo:function(e){(0,n.assertInteger)("calc.lang.xlTenTo",e);const t=i.mathpack.tenTo(e);return"number"==typeof t?s(t):d(t)},checkAlmostCancellation:function(e,t){const{_valueXL:r}=e,{_valueXL:n}=t;return i.mathpack.exp32(r)-i.mathpack.exp32(n)>=52428800?u:t},fix:e=>i.mathpack.fix(e._valueXL),lfix:e=>i.mathpack.lfix(e._valueXL),sfix:b,viewRound:C}},6481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0;var n,i,a,o=r(2381);Object.defineProperty(t,"CurrencyFormat",{enumerable:!0,get:function(){return o.CurrencyFormat}}),Object.defineProperty(t,"DateOrder",{enumerable:!0,get:function(){return o.DateOrder}}),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(n||(t.NumberShape=n={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(i||(t.Calendar=i={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text",e[e.USCoCurrency=-1037]="USCoCurrency",e[e.USCoCurrencyDec=-1039]="USCoCurrencyDec",e[e.NoComFixed0_Tha=-2036]="NoComFixed0_Tha",e[e.NoComFixed_Tha=-2037]="NoComFixed_Tha",e[e.Fixed0_Tha=-2038]="Fixed0_Tha",e[e.Fixed_Tha=-2039]="Fixed_Tha",e[e.CoCurrency_Tha=-2041]="CoCurrency_Tha",e[e.CoCurrencyDec_Tha=-2043]="CoCurrencyDec_Tha",e[e.Pct0_Tha=-2044]="Pct0_Tha",e[e.Pct_Tha=-2045]="Pct_Tha",e[e.MMDDYY_Tha=-2048]="MMDDYY_Tha",e[e.DDMMMYY_Tha=-2049]="DDMMMYY_Tha",e[e.DDMMM_Tha=-2050]="DDMMM_Tha",e[e.MMMYY_Tha=-2051]="MMMYY_Tha",e[e.HHMM_Tha=-2052]="HHMM_Tha",e[e.HHMMSS_Tha=-2053]="HHMMSS_Tha",e[e.MDYHMS_Tha=-2054]="MDYHMS_Tha",e[e.AbsHMMSS_Tha=-2055]="AbsHMMSS_Tha",e[e.MMSS_Tha=-2056]="MMSS_Tha",e[e.SS0_Tha=-2057]="SS0_Tha",e[e.DMBB_Tha=-2058]="DMBB_Tha"}(a||(t.KnownFormat=a={}))},2184:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormula=function(e,t,r){try{const i=r.kind===s.LexicalKind.Cell||r.kind===s.LexicalKind.Range?(0,u.printLocalsGrid)(r,(0,g.sheetGridRangeAnchor)(r.range)):r.kind===s.LexicalKind.NameManager?(0,u.printLocalsName)(r,v):(0,n.assertNever)("calc.lang.anonymizeFormula",r),l=_((0,u.createSimplePrintGlobals)((0,a.calcConfig)((0,a.getEnglishLocaleInfo)(),o.RefStyle.A1,e.mathpack)),i,t,!0);if(l.kind===n.ResultKind.Success)return l.value.formula;if(l.reason.kind===n.ReasonKind.JavaScriptError)throw l.reason.error}catch(e){const t="calc.lang.anonymizeFormula: Format failed: "+(0,n.messageFromError)(e);n.ulsLogger.ULS.traceTag(507381981,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t)}return(0,n.anonymize)(t)},t.createPrinter=function(e){const t=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e),getNamedRanges:e.getNamedRanges?.bind(e)??B.getNamedRanges}}(e);return{printFormula:(t,r)=>{const i=_(e,t,r);return(0,n.isSuccess)(i)?(0,n.success)(i.value.formula):i},printFormulaEx:(t,r)=>_(e,t,r),printRange:(e,r,i)=>function(e,t,r,i=(0,n.makeEmptyTable)()){try{const a=t.originSheet.value;if(!(0,g.isDocumentLocEqual)(a.document,r.sheet.document))throw new w((0,g.notImplemented)(["printRange cross-document"]));return(0,n.success)(function(e,t,r,i){const a=t.originSheet.value,u=e.getNamedRanges(r);if(!(0,n.isSuccess)(u))throw new w(u.reason);if(0===u.value.length)return;const l=e=>void 0!==e.index&&(void 0===a.index||!(0,g.isSheetIndexEqual)(e,a)),c=u.value.filter((({scope:e})=>void 0===e.index?(0,g.isDocumentLocEqual)(e.document,r.sheet.document):(0,g.isSheetIndexEqual)(e,r.sheet))).filter((({scope:t,name:r})=>{if(void 0!==t.index||void 0===a.index)return!0;const i=a,o=e.getNameLoc(i,r,s.NameSource.Plain);if(!(0,n.isSuccess)(o))throw new w(o.reason);return null==o.value})).filter((({scope:e,name:t})=>l(e)||!i.contains(t)));if(0===c.length)return;const d=1===c.length?c[0]:[...c].sort(((t,r)=>e.config.localeInfo.stringCompareCI(t.name,r.name)))[0];let m;if(l(d.scope)){const t=e.getSheetName(d.scope.document,d.scope.index);if(!(0,n.isSuccess)(t))throw new w(t.reason);m=(0,o.sheetQualifier)(t.value)}return(0,o.nameNode)((0,o.identNamePart)(d.name),m)}(e,t,r,i)??function(e,t,{sheet:r,range:i}){const a=e.getContainingTable((0,s.sheetGridCell)(r,(0,g.gridRangeAnchor)(i)));if(!(0,n.isSuccess)(a))throw new w(a.reason);if(null==a.value)return;const u=a.value,l=K(e.getStructRefSpecialRef(u,o.SpecialRefId.All));if(!(0,n.isSuccess)(l))throw new w(l.reason);const c=l.value.range,d=l.value.sheet,m=(0,g.gridRangeCompare)(c,i);if(void 0===m||m<0)return;const p=K(e.getStructRefSpecialRef(u,o.SpecialRefId.Data));if(!(0,n.isSuccess)(p))throw new w(p.reason);const h=p.value.range,f=t.originGridCell.value,S=t.originSheet.value,v=void 0!==S.index&&(0,g.isSheetIndexEqual)(S,d)&&(0,g.gridRangeIsects)(c,f)?void 0:(0,o.nameNode)((0,o.identNamePart)(u.name)),y=v??(0,o.nameNode)((0,o.identNamePart)(u.name)),F=h.cols>1&&i.col===h.col&&i.cols===h.cols,b=()=>{const t=K(e.getStructRefColumn(u,i.col));if(!(0,n.isSuccess)(t))throw new w(t.reason);if(1===i.cols)return(0,o.columnRef)(t.value.name);const r=K(e.getStructRefColumn(u,i.col+i.cols-1));if(!(0,n.isSuccess)(r))throw new w(r.reason);return(0,o.rangeOpRef)((0,o.columnRef)(t.value.name),(0,o.columnRef)(r.value.name))};if(i.row===c.row&&i.rows===c.rows)return(0,o.structRefNode)(y,(0,o.structRef)(F?(0,o.specialRef)(o.SpecialRefId.All):(0,o.commaOpRef)([(0,o.specialRef)(o.SpecialRefId.All,!0),b()])));if(1===i.rows&&i.row===f.row&&i.row>=h.row&&i.row<h.row+h.rows)return(0,o.structRefNode)(1===i.cols?v:y,(0,o.structRef)((0,o.thisRowOpRef)(F?void 0:b())));if(i.row===h.row&&i.rows===h.rows)return F?(0,o.structRefNode)(y,(0,o.structRef)(void 0)):(0,o.structRefNode)(1===i.cols?v:y,(0,o.structRef)(b()));const C=i.row===c.row&&i.row+i.rows===h.row,k=i.row===h.row+h.rows&&i.row+i.rows===c.row+c.rows;if(C||k){const e=(0,o.specialRef)(C?o.SpecialRefId.Headers:o.SpecialRefId.Totals,!F);return(0,o.structRefNode)(y,(0,o.structRef)(F?e:(0,o.commaOpRef)([e,b()])))}const E=i.row===c.row&&c.row<h.row&&i.row+i.rows===h.row+h.rows,A=i.row===h.row&&c.row+c.rows>h.row+h.rows&&i.row+i.rows===c.row+c.rows;if(E||A){const e=(0,o.specialRef)(E?o.SpecialRefId.Headers:o.SpecialRefId.Data,!0),t=(0,o.specialRef)(E?o.SpecialRefId.Data:o.SpecialRefId.Totals,!0);return(0,o.structRefNode)(y,(0,o.structRef)(F?(0,o.commaOpRef)([e,t]):(0,o.commaOpRef)([e,t,b()])))}}(e,t,r)??function(e,t,r){const i=t.originSheet.value,a=function(e,t,r){if(0===r.col&&r.cols===s.sheetCols)return function(e,t,r){return(0,o.cellRefRow)(L(e,t),L(e,t+r-1))}(e,r.row,r.rows);if(0===r.row&&r.rows===s.sheetRows)return function(e,t,r){return(0,o.cellRefCol)(L(e,t),L(e,t+r-1))}(t,r.col,r.cols);const n=x(e,t,(0,g.gridRangeAnchor)(r));if((0,s.isGridCell)(r))return n;const i=x(e,t,(0,s.gridCell)(r.row+r.rows-1,r.col+r.cols-1));return(0,o.cellRefRange)(n,i)}(t.printRowsAsAbsoluteReferences?void 0:t.originGridCell.value.row,t.printColsAsAbsoluteReferences?void 0:t.originGridCell.value.col,r.range);let u;if(void 0===i.index||!(0,g.isSheetIndexEqual)(i,r.sheet)){const t=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,n.isSuccess)(t))throw new w(t.reason);u=(0,o.sheetQualifier)(t.value)}return(0,o.cellRefNode)(a,u)}(e,t,r))}catch(e){return e instanceof w?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)(e))}}(t,e,r,i)}};const n=r(6913),i=r(3949),a=r(6836),o=r(1982),s=r(9209),u=r(719),l=r(7089),c=r(4052),d=r(6654),m=r(1813),g=r(6234),p=r(1973),h=r(6426),f=/'/g,S=/"/g,v=(0,s.sheetGridCell)((0,s.sheetIndex)((0,s.documentLoc)(void 0,"Book1"),0),(0,s.gridCell)(0,0));function y(e){if(!(0,n.isSuccess)(e)&&e.reason.kind!==c.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==c.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==c.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==c.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==c.ResolveReasonKind.EmptyIntersection)throw new D(e.reason)}var F;function b(e){const t=[],r=[];for(const i of e)i.length>0&&(0,n.numCodeUnits)((0,n.stringCodePointAt)(i,0))===i.length?t[(0,n.stringCodePointAt)(i,0)]=!0:r.push(i);return(e,i)=>{const a=(0,n.stringCodePointAt)(e,i);if(!0===t[a])return!0;for(const t of r)if((0,n.stringStartsWith)(e,t,i))return!0;return!1}}function C(e,t){let r="";for(let i=0;i<e.length;){t(e,i)&&(r+="'");const a=(0,n.stringCodePointAt)(e,i);r+=(0,n.stringFromCodePoint)(a),i+=(0,n.numCodeUnits)(a)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(F||(F={}));class k{constructor(e){this.str=e,this.append=A,this.length=e.length}}class E{constructor(e,t){this.lhs=e,this.rhs=t,this.append=A,this.length=e.length+t.length}}function A(e){return new E(this,"string"==typeof e?new k(e):e)}function T(e,t){return 0===e.length?new k(""):e.reduce(((e,r)=>e.append(t).append(r)))}const R={pre:"",preComments:void 0},N={pre:" ",preComments:void 0},I={post:"",postComments:void 0},P={literalNode:(e,t,r)=>r,arrayNode:(e,t,r)=>r,appNode:(e,t,r,n)=>n,letNode:(e,t,r,n,i,a)=>a,lambdaNode:(e,t,r,n,i,a)=>a,parenNode:(e,t,r)=>r,nameNode:(e,t,r)=>r,cellRefNode:(e,t,r)=>r,fieldRefNode:(e,t,r)=>r,structRefNode:(e,t,r)=>r,missingNode:(e,t)=>t,badSequenceNode:(e,t,r)=>r,badCharsNode:(e,t,r)=>r,operatorNode:(e,t)=>t,wsfNode:(e,t,r)=>r},O={...(0,h.constVisitor)(void 0),operatorNode:e=>e};class M{print(){const e=new h.ComposeVisitor(new h.ZipVisitor({str:this,label:P,op:O}),(e=>(this.record(e.label,e.str),e))),t=(0,h.reduceBottomUp)(e,this.root),r=new k("=").append(this.recordPrePost(t.label,this.pre(t.label,R),t.str,this.postIfComments(t.label)));return this.printRope(r)}pre(e,t){return this.anonymize?t:this.spans[e]??t}post(e,t){return this.anonymize?t:this.spans[e]??t}preIfComments(e){if(this.anonymize)return R;const t=this.spans[e];return null!=t?.preComments&&t.preComments.length>0?t:R}postIfComments(e){if(this.anonymize)return I;const t=this.spans[e];return null!=t?.postComments&&t.postComments.length>0?t:I}printRef(e,t){let r=new k("");switch(e.kind){case o.StructRefKind.SpecialRef:{(t===F.Original&&e.isBracketed||t===F.Bracketed)&&(r=r.append(this.localeInfo.leftBracket));const n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new D((0,g.internal)("No locale data for specialRefName"));r=r.append(n),(t===F.Original&&e.isBracketed&&e.isClosed||t===F.Bracketed)&&(r=r.append(this.localeInfo.rightBracket));break}case o.StructRefKind.ColumnRef:{const i=0===e.name.length||(0,n.stringStartsWith)(e.name," ")||(0,n.stringEndsWith)(e.name," ");(t===F.Original&&e.isBracketed||t===F.Bracketed||t===F.Unbracketed&&i)&&(r=r.append(this.localeInfo.leftBracket));const a=C(e.name,this.isStructRefEscapable);r=r.append(this.anon(a)),(t===F.Original&&e.isBracketed&&e.isClosed||t===F.Bracketed||t===F.Unbracketed&&i)&&(r=r.append(this.localeInfo.rightBracket));break}case o.StructRefKind.RangeOpRef:r=r.append(this.printRef(e.lhs,t===F.Original?t:F.Bracketed)).append(":").append(this.printRef(e.rhs,t===F.Original?t:F.Bracketed));break;case o.StructRefKind.MissingRef:break;case o.StructRefKind.BadRef:e.isBracketed&&(r=r.append(this.localeInfo.leftBracket)),r=r.append(this.anon(e.chars)),e.isBracketed&&e.isClosed&&(r=r.append(this.localeInfo.rightBracket))}return this.record(e.label,r)}printThisRowOpRef(e,t){let r=new k("@");return e&&(r=e.kind===o.StructRefKind.ColumnRef?r.append(this.printRef(e,e.isClosed?function(e,t){for(let r=0;r<e.length;){if(t(e,r))return!0;r+=(0,n.numCodeUnits)((0,n.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?F.Bracketed:F.Unbracketed:F.Original)):r.append(this.printRef(e,(0,g.isRangeOpClosed)(e)&&(0,g.isRangeOpNoMissing)(e)?F.Bracketed:F.Original))),this.record(t,r)}printApplication(e,t,r,n){const i=t.map(((e,t,r)=>this.recordPrePost(e.label,this.pre(e.label,0===t||0===e.str.length?R:N),e.str,t===r.length-1?this.post(e.label,I):this.postIfComments(e.label))));return e.str.append("(").append(T(i,this.localeInfo.listSeparator)).append(r?")":"")}printCellRef({ref:e,qualifier:t}){return(void 0!==t?this.recordPrePost(t.label,R,(0,h.visitQualifier)(this,t).str,this.postIfComments(t.label)):new k("")).append((0,h.visitCellRef)(this,e).str)}printName({qualifier:e,parts:t},r){const n=void 0!==e?this.recordPrePost(e.label,R,(0,h.visitQualifier)(this,e).str,this.postIfComments(e.label)):new k("");let i=new k("");for(const e of(0,o.flattenNameParts)(t).parts){let t;if(e.kind===o.NamePartKind.FieldRefNamePart){const r=e.rhs.field;t=this.record(e.rhs.label,new k(".").append(this.record(r.label,this.anon(r.kind===o.NodeKind.Ident?r.whole:r.chars))))}else t=e.kind===o.NamePartKind.CellRefNamePart&&r===c.ResolvedKind.ResolvedCellRef?this.printCellRef((0,o.cellRefNode)(e.ref,void 0,e.label)):new k(this.anon(e.asWhole));i=this.record(e.label,i.append(t)),this.recordQualified(e.qualifiedLabel,n,i)}return n.append(i)}printUnrecordedDocQual(e){if(void 0===e)return e;const{path:t,document:r}=e;return this.anon((t??"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket)}printParamNameIdent(e){return e.kind===o.NodeKind.Ident?this.record(e.label,this.anon((0,g.getBoundName)(this.localeInfo,e.whole))):this.recordPrePost(e.label,this.pre(e.label,R),this.anon(e.chars),this.post(e.label,I))}printParamName(e){return this.record(e.label,new k(e.isBracketed?this.localeInfo.leftBracket:"").append(this.printParamNameIdent(e.name)).append(e.isBracketed&&e.isClosed?this.localeInfo.rightBracket:""))}record(e,t){const r="string"==typeof t?new k(t):t;return this.labelToRope[e]={ropeStart:r,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0},r}recordQualified(e,t,r){this.labelToRope[e]={ropeStart:t,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0}}recordPrePost(e,{pre:t,preComments:r},n,{post:i,postComments:a}){const o="string"==typeof n?new k(n):n,s=new k(t),u=new k(i);return this.labelToRope[e]={ropeStart:o,ropeEnd:o,startOffset:0,endOffset:0,pre:t,post:i,preComments:r,postComments:a},r&&this.recordComments(r,s,this.spans[e].start-t.length),a&&this.recordComments(a,u,this.spans[e].end),s.append(o).append(u)}recordComments(e,t,r){for(const n of e){const e=this.spans[n.label];if(null==e)return;this.labelToRope[n.label]={ropeStart:t,ropeEnd:t,startOffset:e.start-r,endOffset:e.end-r-t.length,pre:"",post:"",preComments:void 0,postComments:void 0}}}printRope(e){const{str:t,ropeToSpan:r}=function(e){const t=new Map,r=[];let n=0;const i=[e];for(;i.length>0;){const e=i.pop();t.set(e,{start:n,end:n+e.length}),e instanceof E?i.push(e.rhs,e.lhs):(r.push(e.str),n+=e.str.length)}return{str:r.join(""),ropeToSpan:t}}(e),n=[];for(const e of Object.keys(this.labelToRope).map(Number)){const{ropeStart:t,ropeEnd:i,startOffset:a,endOffset:s,pre:u,post:l,preComments:c,postComments:d}=this.labelToRope[e],{start:m}=r.get(t),{end:g}=r.get(i);n[e]=(0,o.formulaSpan)(m+a,g+s,u,l,c,d)}return{formula:t,spans:n}}literalNode(e,t,r){switch(e.kind){case m.OperKind.String:return new k('"'+this.anon(e.value).replace(S,'""')+'"');case m.OperKind.Boolean:return new k(e.value?this.localeInfo.trueName:this.localeInfo.falseName);case m.OperKind.Number:const t=21;return new k(this.anon(this.mathpack.formatGeneral(this.localeInfo,e,t)));case m.OperKind.Missing:return new k("");case m.OperKind.Error:const r=this.localeInfo.errorNames[e.type];if(null==r)throw new D((0,g.internal)(`No locale data for error type ${e.type}`));return new k(r);default:return(0,n.assertNever)("calc.lang.printFormula",e)}}missingNode(e,t){return new k(this.anon(e))}arrayNode(e,t,r){return new k(this.localeInfo.leftBrace).append(T(e.map((e=>T(e.map((e=>this.recordPrePost(e.label,this.preIfComments(e.label),e.str,this.postIfComments(e.label)))),this.localeInfo.columnSeparator))),this.localeInfo.rowSeparator)).append(t?this.localeInfo.rightBrace:"")}appNode(e,t,r,i){if(void 0!==e.op){if(1===t.length){const r=t[0];switch(e.op){case d.OperatorId.Percent:return r.str.append(this.recordPrePost(e.label,this.pre(e.label,R),e.str,I));case d.OperatorId.Pound:return r.str.append(this.recordPrePost(e.label,this.preIfComments(e.label),e.str,I));default:return this.recordPrePost(e.label,R,e.str,this.post(e.label,I)).append(r.str)}}if(2===t.length){const[r,n]=t;let i=" ",a=" ";switch(e.op){case d.OperatorId.Range:i=a="";break;case d.OperatorId.Isect:a="";break;case d.OperatorId.Union:i=""}return r.str.append(this.recordPrePost(e.label,this.pre(e.label,{pre:i}),e.str,this.post(e.label,{post:a}))).append(n.str)}return(0,n.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r,i)}letNode(e,t,r,n,i,a){const s=t.map((({name:e,binder:t})=>(0,o.letVar)((0,o.indexedArg)({str:this.record(e.arg.label,this.record(e.arg.name.label,this.anon((0,g.getBoundName)(this.localeInfo,e.arg.wholeName)))),label:e.arg.label,op:void 0},e.index),t)));return this.printApplication(e,(0,o.flattenLetArgs)(s,r,n),i,a)}lambdaNode(e,t,r,n,i,a){const s=t.map((({name:e})=>{const t=this.printParamName(e.arg.name),r=void 0===e.arg.def?new k(""):this.recordPrePost(e.arg.def.label,this.pre(e.arg.def.label,N),new k(":=").append(this.recordPrePost(e.arg.def.rhs.label,this.pre(e.arg.def.rhs.label,0===e.arg.def.rhs.str.length?R:N),e.arg.def.rhs.str,I)),I);return(0,o.lambdaParam)((0,o.indexedArg)({str:t.append(r),label:e.arg.label,op:void 0},e.index))}));return this.printApplication(e,(0,o.flattenLambdaArgs)(s,r,n),i,a)}parenNode(e,t,r){return new k("(").append(this.recordPrePost(e.label,this.pre(e.label,R),e.str,this.post(e.label,I))).append(t?")":"")}nameNode(e,t,r){const{headResolved:n,node:i}=this.resolver.resolveDottedName(this.locals,(0,o.nameNode)(e,t,r),this.annotations);return y(n.resolution),this.printName(i,n.kind)}cellRefNode(e,t,r){const{node:n,resolution:i}=this.resolver.resolveCellRef(this.locals,(0,o.cellRefNode)(e,t,r));return y(i),this.printCellRef(n)}fieldRefNode(e,t,r){const n=t.shouldBeBracketed,i=t.isBracketed||n?this.localeInfo.leftBracket:"",a=t.isBracketed&&t.isClosed||n?this.localeInfo.rightBracket:"",s=this.record(t.field.label,this.anon(t.field.kind===o.NodeKind.Ident?C(t.field.whole,this.isFieldRefEscapable):t.field.chars)),u=t.field.kind!==o.NodeKind.Ident?this.pre(t.label,R):this.preIfComments(t.label);return e.str.append(this.recordPrePost(t.label,u,new k("."+i).append(s).append(a),this.post(t.label,I)))}structRefNode(e,t,r){const{node:n,table:i,resolution:a}=this.resolver.resolveStructRef(this.locals,(0,o.structRefNode)(e,t,r));y(a);const s=n.rhs.innerRef;let u=void 0===n.lhs?void 0:this.record(n.lhs.label,this.printName(n.lhs,c.ResolvedKind.ResolvedName));if(void 0!==u||void 0===i||!n.rhs.isClosed||s?.kind===o.StructRefKind.ColumnRef||s?.kind===o.StructRefKind.ThisRowOpRef&&s.ref?.kind===o.StructRefKind.ColumnRef||(u=new k(i.name)),void 0===s&&n.rhs.isClosed&&void 0!==u)return u;let l=new k(this.localeInfo.leftBracket);switch(s?.kind){case o.StructRefKind.ColumnRef:case o.StructRefKind.SpecialRef:if(s.kind===o.StructRefKind.SpecialRef&&s.id===o.SpecialRefId.ThisRow&&s.isClosed){l=l.append(this.printThisRowOpRef(void 0,s.label));break}l=l.append(this.printRef(s,s.isClosed?F.Unbracketed:F.Original));break;case o.StructRefKind.RangeOpRef:{const e=(0,g.isRangeOpClosed)(s)&&(0,g.isRangeOpNoMissing)(s)?F.Bracketed:F.Original;l=l.append(this.printRef(s,e));break}case o.StructRefKind.CommaOpRef:{const e=(0,g.isCommaOpRefWellFormed)(s)&&(0,g.isCommaOpClosed)(s)&&(0,g.isCommaOpNoBadOrMissing)(s);if(e&&s.specialRefs[o.SpecialRefId.ThisRow]){l=l.append(this.printThisRowOpRef(0===s.columnRefs.length?void 0:s.columnRefs[0],s.label));break}const t=e?(0,g.normalizeCommaOpRef)(s):s.refs,r=e?1===t.length?F.Unbracketed:F.Bracketed:F.Original;l=l.append(this.record(s.label,T(t.map((e=>this.printRef(e,r))),this.localeInfo.listSeparator)));break}case o.StructRefKind.ThisRowOpRef:l=l.append(this.printThisRowOpRef(s.ref,s.label));break;case o.StructRefKind.BadRef:l=l.append(this.printRef(s,F.Original))}return n.rhs.isClosed&&(l=l.append(this.localeInfo.rightBracket)),(u??new k("")).append(this.record(n.rhs.label,l))}badSequenceNode(e,t,r){return T(t.map((e=>this.recordPrePost(e.label,this.pre(e.label,R),e.str,this.post(e.label,I)))),"")}badCharsNode(e,t,r){return new k(this.anon(t))}operatorNode(e,t){const r=(0,a.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new D((0,g.internal)("Invalid operator"));return new k(r)}wsfNode(e,t,r){return new k(this.localeInfo.getWorksheetFuncName(e))}cellRefError(e){const t=this.localeInfo.errorNames[p.ErrorType.REF];if(null==t)throw new D((0,g.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}cellRefSingle(e,t,r,n){const a=(0,i.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefRange(e,t,r){const n=(0,i.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==n?{str:this.record(r,this.anon(n)),label:r}:this.cellRefError(r)}cellRefRow(e,t,r,n){const a=(0,i.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefCol(e,t,r,n){const a=(0,i.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==a?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)}cellRefBad(e,t,r){return{str:this.record(r,this.anon(e)),label:r}}errorQualifier(e){const t=this.localeInfo.errorNames[p.ErrorType.REF];if(null==t)throw new D((0,g.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}}relativeQualifier(e){return{str:this.record(e,"!"),label:e}}documentQualifier(e,t,r,n){return{str:this.record(n,(0,i.quoteQualifier)(this.printUnrecordedDocQual((0,o.documentQualifier)(e,t)))+"!"),label:n}}sheetQualifier(e,t,r,n){let a=this.printUnrecordedDocQual(t),o=this.anon(e);const s=(0,i.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(a??"")+o);return s&&(a=a?.replace(f,"''"),o=o.replace(f,"''")),{str:this.record(n,new k(s?"'":"").append(void 0===a?new k(""):this.record(t.label,a)).append(o).append(s?"'":"").append("!")),label:n}}identQualifier(e,t,r){return{str:this.record(r,(0,i.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"),label:r}}sheetRangeQualifier(e,t,r,n,a){let o=this.printUnrecordedDocQual(r),s=this.anon(e),u=this.anon(t);const l=(0,i.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(o??"")+s)||(0,i.shouldQuoteQualifier)(this.localeInfo,this.refStyle,u);return l&&(o=o?.replace(f,"''"),s=s.replace(f,"''"),u=u.replace(f,"''")),{str:this.record(a,new k(l?"'":"").append(void 0===o?new k(""):this.record(r.label,o)).append(s).append(":").append(u).append(l?"'":"").append("!")),label:a}}badQualifier(e,t,r,n,i){return{str:this.record(i,this.anon(e)),label:i}}constructor(e,t,r,i){this.root=r,this.anonymize=i,this.labelToRope=[],this.anon=e=>this.anonymize?(0,n.anonymizeFormulaString)(e):e,this.locals=t,this.localeInfo=t.config?.localeInfo??e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=t.config?.refStyle??e.config.refStyle,this.resolver=(0,l.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;const a=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],o=[...a,"\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"];this.isStructRefEscapable=b(a),this.isStructRefBracketedThisRef=b(o),this.isFieldRefEscapable=b(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}}const D=(0,g.createFailureErrorClass)("PrintFormulaError"),w=(0,g.createFailureErrorClass)("PrintRangeError");function _(e,t,r,i=!1){try{return(0,n.success)(new M(e,t,r,i).print())}catch(e){return e instanceof D?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)(e))}}function L(e,t){return void 0===e?(0,o.pos)(o.PosKind.Abs,t):(0,o.pos)(o.PosKind.Rel,t-e)}function x(e,t,r){return(0,o.cellRefSingle)(L(e,r.row),L(t,r.col))}function K(e){return(0,n.isSuccess)(e)?((0,n.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,n.success)(e.value)):e.reason.kind===c.ResolveReasonKind.InvalidStructRef?(0,n.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,n.failure)(e.reason)}const B={getNamedRanges:()=>(0,n.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}},719:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSimplePrintGlobals=function(e){return new o(e)},t.printLocalsGrid=function(e,t,r){return{config:r??void 0,lexicalSource:e,originGridCell:(0,n.success)(t.range),originSheet:(0,n.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printRowsAsAbsoluteReferences:!1,printColsAsAbsoluteReferences:!1}},t.printLocalsName=function(e,t,r){return{config:r??void 0,lexicalSource:e,originGridCell:(0,n.success)(t.range),originSheet:(0,n.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printRowsAsAbsoluteReferences:!0,printColsAsAbsoluteReferences:!0}};const n=r(6913),i=r(9209),a=r(6234);class o{getDocumentLoc(e,t){return(0,n.success)((0,i.documentLoc)(e,t))}getSheetIndex(e,t){return(0,n.success)(t)}getSheetName(e,t){return(0,n.success)(t)}getNameLoc(e,t){return(0,n.success)(t.indexOf(".")>=0?void 0:(0,i.nameLoc)(e,t))}getUserDefinedFuncLoc(e,t){return(0,n.success)([])}getSheetRangeIndexes(e){if(void 0===e.index)return(0,n.failure)((0,a.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));const t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,n.success)((0,i.sheetRangeIndexes)(t,0))}getContainingTable(e){return n.successUndefined}getStructRefColumn(e,t){return n.successUndefined}getStructRefSpecialRef(e,t){return n.successUndefined}getNamedRanges(e){return(0,n.success)([])}constructor(e){this.config=e}}},865:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=function(e,t=function(){let e=1;return()=>e++}()){const{spans:r,annotations:a,depthUpperBound:o}=e,s=[],u=[],l=[],c=[];function d(e){const n=t(),i=r[e];null!=i&&(s[n]=i);const o=a[e];return null!=o&&(u[n]=o),l[e]=n,c[n]=e,n}function m(e){return{...e,label:d(e.label)}}function g(e){if(e.kind===n.CellRefKind.Range){const t=e;return(0,n.cellRefRange)(g(t.ref1),g(t.ref2),d(e.label))}return{...e,label:d(e.label)}}function p(e){return null!=e?(0,n.documentQualifier)(e.document,e.path,e.isQuoted,d(e.label)):void 0}function h(e){return(0,n.fieldRef)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.field),e.isBracketed,e.isClosed,e.shouldBeBracketed,d(e.label))}function f(e){switch(e?.kind){case void 0:return;case n.StructRefKind.SpecialRef:return(0,n.specialRef)(e.id,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.ColumnRef:return(0,n.columnRef)(e.name,e.isBracketed,e.isClosed,d(e.label));case n.StructRefKind.RangeOpRef:return(0,n.rangeOpRef)(f(e.lhs),f(e.rhs),d(e.label));case n.StructRefKind.CommaOpRef:return(0,n.commaOpRef)(e.refs.map(f),d(e.label));case n.StructRefKind.ThisRowOpRef:return(0,n.thisRowOpRef)(void 0!==e.ref?f(e.ref):void 0,d(e.label));case n.StructRefKind.MissingRef:return(0,n.missingRef)(d(e.label));case n.StructRefKind.BadRef:return(0,n.badRef)(e.chars,e.isBracketed,e.isClosed,d(e.label))}}function S(e,t,r){return(0,n.nameNode)(function(e){const t=(0,n.flattenNameParts)(e),r=(e,{rhs:t,canDenoteNamedObject:r,label:i,qualifiedLabel:a})=>(0,n.fieldRefNamePart)(e,h(t),r,d(i),d(a));if(t.kind===n.NamePartKind.IdentNamePart){const[e,...i]=t.parts,a=(0,n.identNamePart)(e.asWhole,e.canDenoteNamedObject,d(e.label),d(e.qualifiedLabel));return i.reduce(r,a)}const[i,a,...o]=t.parts,s=(0,n.cellRefNamePart)(g(i.ref),i.asWhole,d(i.label),d(i.qualifiedLabel));return o.reduce(r,r(s,a))}(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?{...e,document:p(e.document),label:d(e.label)}:{...e,label:d(e.label)}}(t),d(r))}function v({whole:e,label:t}){return(0,n.identNode)(e,d(t))}const y={literalNode:(e,t,r)=>(0,n.literalNode)(e,t,d(r)),arrayNode:(e,t,r)=>(0,n.arrayNode)(e,t,d(r)),appNode:(e,t,r,i)=>(0,n.appNode)(e,t,r,d(i)),letNode:(e,t,r,i,a,o)=>(0,n.letNode)(e,t.map((({name:e,binder:t})=>(0,n.letVar)((0,n.indexedArg)(function({name:e,label:t}){return(0,n.varNode)(v(e),d(t))}(e.arg),e.index),t))),r,i,a,d(o)),lambdaNode:(e,t,r,i,a,o)=>(0,n.lambdaNode)(e,t.map((({name:e})=>(0,n.lambdaParam)((0,n.indexedArg)(function(e){const t=(0,n.paramName)(function(e){switch(e.kind){case n.NodeKind.Ident:return v(e);case n.NodeKind.Missing:return(0,n.missingNode)(e.chars,d(e.label));case n.NodeKind.BadChars:return(0,n.badCharsNode)(e.type,e.chars,d(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,d(e.name.label)),r=void 0===e.def?void 0:(0,n.paramDefault)(e.def.rhs,d(e.def.label));return(0,n.paramNode)(t,r,d(e.label))}(e.arg),e.index)))),r,i,a,d(o)),parenNode:(e,t,r)=>(0,n.parenNode)(e,t,d(r)),nameNode:(e,t,r)=>S(e,t,r),cellRefNode:(e,t,r)=>(0,n.cellRefNode)(g(e),function(e){if(null!=e)return e.kind===n.QualifierKind.Sheet||e.kind===n.QualifierKind.SheetRange?{...e,document:p(e.document),label:d(e.label)}:{...e,label:d(e.label)}}(t),d(r)),fieldRefNode:(e,t,r)=>(0,n.fieldRefNode)(e,h(t),d(r)),structRefNode(e,t,r){return(0,n.structRefNode)(void 0===e?void 0:function({parts:e,qualifier:t,label:r}){return S(e,t,r)}(e),(i=t,(0,n.structRef)(f(i.innerRef),i.isClosed,d(i.label))),d(r));var i},missingNode:(e,t)=>(0,n.missingNode)(e,d(t)),badSequenceNode:(e,t,r)=>(0,n.badSequenceNode)(e,t,d(r)),badCharsNode:(e,t,r)=>(0,n.badCharsNode)(e,t,d(r)),operatorNode:(e,t)=>(0,n.operatorNode)(e,d(t)),wsfNode:(e,t,r)=>(0,n.wsfNode)(e,t,d(r))},F=(0,n.formula)((0,i.reduceBottomUp)(y,e),s,u,o);for(const e of Object.keys(u)){const t=Number(e),r=u[t];switch(r?.kind){case n.AnnotationKind.LocalNameUse:u[t]=(0,n.localNameUseAnnotation)(r.name,r.whole,l[r.label]);break;case n.AnnotationKind.LocalNameDecl:u[t]=(0,n.localNameDeclAnnotation)(r.name,r.whole,r.uses.map((({label:e})=>({label:l[e]}))))}}for(const e of Object.keys(s).map(Number)){const t=s[e],r=t?.preComments,n=t?.postComments;(r||n)&&(s[e]={...t,preComments:r?r.map(m):void 0,postComments:n?n.map(m):void 0})}return{formula:F,oldToNewLabel:l,newToOldLabel:c}};const n=r(1982),i=r(6426)},7089:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteLocalName=p,t.canDenoteUserDefinedFunc=h,t.canDenoteCellRef=f,t.resolveGridRef=b,t.createResolver=function(e){function t(t,r){if(void 0===r){const e=t.originSheet;return(0,n.isSuccess)(e)?[r,(0,n.success)(e.value.document)]:[r,e]}const i=e.getDocumentLoc(r.path,r.document);if(!(0,n.isSuccess)(i))return[r,i];if((0,n.isNone)(i.value))return[r,(0,n.failure)((0,s.invalidQualifier)(s.InvalidQualifierReason.UndefinedDocument))];const o=null==r.path?void 0:i.value.path,u=i.value.name;return[(0,a.documentQualifier)(u,o,r.isQuoted,r.label),(0,n.success)(i.value)]}function r(t,r){if(c(r))return[t,r];const i=l(e.getSheetIndex(r.value,t));if(!(0,n.isSuccess)(i))return[t,i];if((0,n.isNone)(i.value))return[t,(0,n.failure)((0,s.invalidQualifier)(s.InvalidQualifierReason.UndefinedSheetName))];const a=e.getSheetName(r.value,i.value);return(0,n.isSuccess)(a)?[a.value,(0,n.success)((0,o.sheetIndex)(r.value,i.value))]:[t,a]}function i(e,n){const[i,o]=t(e,n.document),[s,u]=r(n.sheet,o);return[(0,a.sheetQualifier)(s,i,n.isQuoted,n.label),u]}function d(l,d){const{qualifier:m,ref:g}=d,p=b(l,g);let h,f,S;if(void 0===m||m.kind===a.QualifierKind.Relative){h=m;const e=l.originSheet;if((0,n.isSuccess)(e)){const t=e.value;f=void 0===t.index?(0,n.failure)((0,s.noOriginSheet)(t)):(0,n.success)(t)}else f=e}else[h,f]=function(l,d){switch(d.kind){case a.QualifierKind.Error:return[d,n.successUndefined];case a.QualifierKind.Sheet:return i(l,d);case a.QualifierKind.SheetRange:return function(i,s){const[l,d]=t(i,s.document),[m,g]=r(s.sheet1,d),[p,h]=r(s.sheet2,d);let f,S=m,v=p;if(c(d))f=d;else if(c(g))f=g;else if(c(h))f=h;else{if((0,u.isSheetIndexEqual)(g.value,h.value))return[(0,a.sheetQualifier)(S,l,s.isQuoted,s.label),(0,n.success)((0,o.sheetIndex)(d.value,g.value.index))];{const t=e.getSheetRangeIndexes(g.value),r=e.getSheetRangeIndexes(h.value);(0,n.isSuccess)(t)?(0,n.isSuccess)(r)?r.value.position<t.value.position&&(S=p,v=m):f=r:f=t,f=(0,n.success)((0,o.sheetRange)(d.value,g.value.index,h.value.index))}}return[(0,a.sheetRangeQualifier)(S,v,l,s.isQuoted,s.label),f]}(l,d);case a.QualifierKind.Document:return[d,(0,n.failure)((0,s.invalidQualifier)(s.InvalidQualifierReason.SheetRangeName))];case a.QualifierKind.Bad:return[d,(0,n.failure)((0,s.invalidQualifier)(s.InvalidQualifierReason.BadQualifier))];default:return(0,n.assertNever)("calc.lang.Resolver.resolveCellRefQualifier",d)}}(l,m);return S=c(p)?p:c(f)?f:(0,n.success)((0,o.sheetGridCube)(f.value,p.value)),(0,s.resolvedCellRef)((0,a.cellRefNode)(g,h,d.label),S)}function S(r,u,d){const{qualifier:m,parts:g}=u;let p,h,f;const S=[];if(void 0===m||m.kind===a.QualifierKind.Relative){const e=r.originSheet;if(!(0,n.isSuccess)(e))return(0,s.resolvedName)(u,e,u.qualifier?.kind,S);const t=e.value;if(d!==o.NameSource.StructRef&&void 0===t.index)return(0,s.resolvedName)(u,(0,n.failure)((0,s.noOriginSheet)(t)),u.qualifier?.kind,S);p=m,f=m?.kind,h=(0,n.success)(t)}else[p,f,h]=function(e,r){switch(r.kind){case a.QualifierKind.Document:{const[i,a]=t(e,r);return[i,i.kind,c(a)?a:(0,n.success)((0,o.documentScope)(a.value))]}case a.QualifierKind.Sheet:{const[t,n]=i(e,r);return[t,t.kind,n]}case a.QualifierKind.SheetRange:return[r,r.kind,(0,n.failure)((0,s.invalidQualifier)(s.InvalidQualifierReason.SheetRangeName))];case a.QualifierKind.Ident:{const u=(0,a.sheetQualifier)(r.name,void 0,r.isQuoted,r.label),[l,d]=i(e,u);if(!(0,n.isSuccess)(d)&&d.reason.kind!==s.ResolveReasonKind.InvalidQualifier)return[r,r.kind,d];if((0,n.isSuccess)(d)&&void 0!==d.value)return[(0,a.identQualifier)(l.sheet,l.isQuoted,l.label),l.kind,d];const m=(0,a.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[g,p]=t(e,m);return c(p)?[r,r.kind,p]:[(0,a.identQualifier)(g.document,g.isQuoted,g.label),g.kind,(0,n.success)((0,o.documentScope)(p.value))]}case a.QualifierKind.Bad:return[r,r.kind,(0,n.failure)((0,s.invalidQualifier)(s.InvalidQualifierReason.BadQualifier))];default:return(0,n.assertNever)("calc.lang.Resolver.resolveNameQualifier",r)}}(r,m);d===o.NameSource.StructRef&&(0,n.isSuccess)(h)&&void 0!==h.value.index&&(h=(0,n.success)((0,o.documentScope)(h.value.document)));let v,y=g;return c(h)?v=h:(S.push((0,o.nameLoc)(h.value,g.asWhole)),v=l(e.getNameLoc(h.value,g.asWhole,d)),(0,n.isSuccess)(v)&&void 0===v.value&&void 0!==h.value.index&&(h=(0,n.success)((0,o.documentScope)(h.value.document)),S.push((0,o.nameLoc)(h.value,g.asWhole)),v=l(e.getNameLoc(h.value,g.asWhole,d))),c(v)||(y=(0,a.identNamePart)(v.value.name,g.canDenoteNamedObject,g.label,g.qualifiedLabel))),(0,s.resolvedName)((0,a.nameNode)(y,p,u.label),v,f,S)}function v(t,r,i=!1){const u=e.getStructRefColumn(t,r.name);if(!(0,n.isSuccess)(u))return{kind:a.StructRefKind.ColumnRef,innerRef:r,resolution:u};const l=u.value;if((0,n.isNone)(l))return{kind:a.StructRefKind.ColumnRef,innerRef:r,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.UndefinedColumnName))};let c=l.range.range;return i&&(c=(0,o.gridRange)(c.row-(l.hasHeadersRow?1:0),c.col,c.rows+(l.hasHeadersRow?1:0)+(l.hasTotalsRow?1:0),c.cols)),{kind:a.StructRefKind.ColumnRef,innerRef:(0,a.columnRef)(l.name,r.isBracketed,r.isClosed,r.label),resolution:(0,n.success)((0,o.sheetGridRange)(l.range.sheet,c))}}function y(t,r,i){if(i===a.SpecialRefId.ThisRow){if(!(0,n.isSuccess)(t.originGridCell))return t.originGridCell;const e=y(t,r,a.SpecialRefId.Data);if(c(e))return e;const i=e.value.range,u=t.originGridCell.value.row;return u<i.row||u>=i.row+i.rows?(0,n.failure)(s.emptyIntersection):(0,n.success)((0,o.sheetGridRange)(e.value.sheet,(0,o.gridRange)(u,i.col,1,i.cols)))}return l(e.getStructRefSpecialRef(r,i))}function F(e,t,r){switch(t.kind){case a.StructRefKind.ColumnRef:return v(e,t,r);case a.StructRefKind.MissingRef:return{kind:a.StructRefKind.MissingRef,innerRef:t,resolution:n.successUndefined}}}function C(e,t,r=!1){const{innerRef:i,resolution:l}=F(e,t.lhs,r),{innerRef:c,resolution:d}=F(e,t.rhs,r),m=(0,a.rangeOpRef)(i,c,t.label);if(!(0,n.isSuccess)(l)&&l.reason.kind!==s.ResolveReasonKind.InvalidStructRef)return{kind:a.StructRefKind.RangeOpRef,innerRef:m,resolution:l};if(!(0,n.isSuccess)(d)&&d.reason.kind!==s.ResolveReasonKind.InvalidStructRef)return{kind:a.StructRefKind.RangeOpRef,innerRef:m,resolution:d};if(!(0,n.isSuccess)(l))return{kind:a.StructRefKind.RangeOpRef,innerRef:m,resolution:l};if(!(0,n.isSuccess)(d))return{kind:a.StructRefKind.RangeOpRef,innerRef:m,resolution:d};let g,p;if(void 0!==l.value)g=l.value.sheet,p=(0,u.gridRangeJoinOpt)(l.value.range,d.value?.range);else{if(void 0===d.value)return{kind:a.StructRefKind.RangeOpRef,innerRef:m,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOp))};g=d.value.sheet,p=d.value.range}return{kind:a.StructRefKind.RangeOpRef,innerRef:m,resolution:(0,n.success)((0,o.sheetGridRange)(g,p))}}function k(r,i){const{qualifier:l,parts:d}=i,m=r.config?.localeInfo??e.config.localeInfo;let g,p,h,f;if(void 0===l){const e=r.originSheet;if(!(0,n.isSuccess)(e))return(0,s.resolvedUserDefinedFunc)(i,e,[],d.asWhole);g=l,p=(0,n.success)(e.value.document)}else[g,p]=function(e,r){switch(r.kind){case a.QualifierKind.Document:return t(e,r);case a.QualifierKind.Ident:{const n=(0,a.documentQualifier)(r.name,void 0,r.isQuoted,r.label),[i,o]=t(e,n);return[(0,a.identQualifier)(i.document,i.isQuoted,i.label),o]}default:return(0,n.assertNever)("calc.lang.Resolver.resolveUserDefinedFuncQualifier",r)}}(r,l);let S=d.asWhole;if(c(p))f=p,h=[];else{S=(0,u.getUserDefinedFuncName)(m,d.asWhole);const t=e.getUserDefinedFuncLoc(p.value,S);h=[(0,o.userDefinedFuncLoc)(p.value,S)],f=(0,n.isSuccess)(t)?0!==t.value.length?t:n.successUndefined:t}return(0,s.resolvedUserDefinedFunc)((0,a.nameNode)((0,a.identNamePart)(S,d.canDenoteNamedObject,d.label,d.qualifiedLabel),g,i.label),f,h,S)}return{resolveGridRef:b,resolveCellRef:d,resolveName:S,resolveStructRef:function(t,r){const{lhs:i,rhs:l}=r;let d,m,g=i;if(void 0!==i){const{node:e,resolution:a,precedents:u}=S(t,i,o.NameSource.StructRef),l=a;if(!(0,n.isSuccess)(l))return(0,s.resolvedStructRef)(r,void 0,l,u);if((0,n.isNone)(l.value))return(0,s.resolvedStructRef)(r,void 0,(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.UndefinedTableName)),u);g=e,d=l.value,m=u}else{const{originGridCell:i,originSheet:a}=t;if(!(0,n.isSuccess)(i))return(0,s.resolvedStructRef)(r,void 0,i,[]);if(!(0,n.isSuccess)(a))return(0,s.resolvedStructRef)(r,void 0,a,[]);if(void 0===a.value.index)return(0,s.resolvedStructRef)(r,void 0,(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOriginSheet)),[]);const u=e.getContainingTable((0,o.sheetGridCell)(a.value,i.value));if(!(0,n.isSuccess)(u))return(0,s.resolvedStructRef)(r,void 0,u,[]);if((0,n.isNone)(u.value))return(0,s.resolvedStructRef)(r,void 0,(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.MissingTableName)),[]);d=u.value,m=[d]}const{structRef:p,resolution:h}=function(e,t,r){switch(r.innerRef?.kind){case a.StructRefKind.ColumnRef:{const{innerRef:e,resolution:n}=v(t,r.innerRef);return{structRef:(0,a.structRef)(e,r.isClosed,r.label),resolution:n}}case a.StructRefKind.RangeOpRef:{const{innerRef:e,resolution:n}=C(t,r.innerRef);return{structRef:(0,a.structRef)(e,r.isClosed,r.label),resolution:n}}case void 0:return{structRef:r,resolution:y(e,t,a.SpecialRefId.Data)};case a.StructRefKind.SpecialRef:return{structRef:r,resolution:y(e,t,r.innerRef.id)};case a.StructRefKind.CommaOpRef:{const{commaOpRef:i,resolution:l}=function(e,t,r){const i=r.refs.map((r=>function(e,t,r){switch(r.kind){case a.StructRefKind.ColumnRef:return v(t,r,!0);case a.StructRefKind.SpecialRef:return{kind:a.StructRefKind.SpecialRef,innerRef:r,resolution:y(e,t,r.id)};case a.StructRefKind.RangeOpRef:return C(t,r,!0);case a.StructRefKind.MissingRef:return{kind:a.StructRefKind.MissingRef,innerRef:r,resolution:n.successUndefined};case a.StructRefKind.BadRef:return{kind:a.StructRefKind.BadRef,innerRef:r,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOp))}}}(e,t,r))),l=(0,a.commaOpRef)(i.map((e=>e.innerRef)),r.label);for(const{resolution:e}of i)if(!(0,n.isSuccess)(e)&&e.reason.kind!==s.ResolveReasonKind.InvalidStructRef)return{commaOpRef:l,resolution:e};const c=[];for(const e of i){if(!(0,n.isSuccess)(e.resolution)||e.kind===a.StructRefKind.BadRef)return{commaOpRef:l,resolution:e.resolution};c.push((e.kind===a.StructRefKind.SpecialRef||(e.kind,a.StructRefKind.MissingRef),{kind:e.kind,resolution:e.resolution}))}if(!(0,u.isCommaOpRefWellFormed)(r))return{commaOpRef:l,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOp))};let d,m;for(const e of c)e.kind===a.StructRefKind.SpecialRef&&(d=(0,u.gridRangeJoinOpt)(d,e.resolution.value?.range),void 0===m&&(m=e.resolution.value?.sheet));if(void 0===d||void 0===m)return{commaOpRef:l,resolution:n.successUndefined};for(const e of c)if(e.kind!==a.StructRefKind.SpecialRef&&e.kind!==a.StructRefKind.MissingRef&&(d=(0,u.gridRangeIsect)(d,e.resolution.value.range),void 0===d))return{commaOpRef:l,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOp))};return{commaOpRef:l,resolution:(0,n.success)((0,o.sheetGridRange)(m,d))}}(e,t,r.innerRef);return{structRef:(0,a.structRef)(i,r.isClosed,r.label),resolution:l}}case a.StructRefKind.ThisRowOpRef:{const i=y(e,t,a.SpecialRefId.ThisRow);if(c(i)||void 0===r.innerRef.ref)return{structRef:r,resolution:i};const{innerRef:l,resolution:d}=r.innerRef.ref.kind===a.StructRefKind.ColumnRef?v(t,r.innerRef.ref):C(t,r.innerRef.ref),m=(0,a.thisRowOpRef)(l,l.label);if(c(d))return{structRef:(0,a.structRef)(m,r.isClosed,r.label),resolution:d};const g=(0,u.gridRangeIsect)(i.value.range,d.value.range);return g?{structRef:(0,a.structRef)(m,r.isClosed,r.label),resolution:(0,n.success)((0,o.sheetGridRange)(i.value.sheet,g))}:{structRef:r,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOp))}}case a.StructRefKind.BadRef:return{structRef:r,resolution:(0,n.failure)((0,s.invalidStructRef)(s.InvalidStructRefReason.InvalidOp))}}}(t,d,l);return(0,s.resolvedStructRef)(h.kind===n.ResultKind.Failure&&h.reason.kind!==s.ResolveReasonKind.EmptyIntersection?r:(0,a.structRefNode)(g,p,r.label),d,h,m)},resolveUserDefinedFunc:k,resolveDottedName:function(t,r,i){const l=r.parts,c=r.qualifier,v={names:new Array,udfs:new Array},y=i[r.label],F=y?.kind===a.AnnotationKind.AppHeadName,b=(0,a.flattenNameParts)(l).parts,C=(0,a.nameNode)((0,a.identNamePart)(l.asWhole,l.canDenoteNamedObject,l.label,l.qualifiedLabel),c,r.label);if(p(c,b)){const[e,...t]=b,o=function(e,t){const r=t[e.label],i=r?.kind===a.AnnotationKind.LocalNameUse?r:void 0;return(0,s.resolvedLocalName)((0,a.nameNode)((0,a.identNamePart)(i?.name??e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,n.success)(i))}(e,i);if(void 0!==o.resolution.value)return(0,s.resolvedDottedName)((0,a.nameNode)(t.reduce(g,o.node.parts),c,r.label),o,t.map(m),v)}let E;const A=()=>{if(!E)return!1;const e=E.headResolved.resolution;return e.kind!==n.ResultKind.Success&&e.reason.kind!==s.ResolveReasonKind.InvalidQualifier||e.kind===n.ResultKind.Success&&void 0!==e.value};if(l.canDenoteNamedObject){const e=S(t,C,F?o.NameSource.AppHead:o.NameSource.Plain);if((0,n.safePush)(v.names,e.precedents),E=(0,s.resolvedDottedName)(e.node,e,[],v),A())return E}if(h(F,c,l)){const e=k(t,C);if((0,n.safePush)(v.udfs,e.precedents),E=(0,s.resolvedDottedName)(e.node,e,[],v),A())return E}if(f(t,c,b)){const[e,...i]=b,o=null!=c&&c.kind===a.QualifierKind.Ident?(0,a.sheetQualifier)(c.name,void 0,c.isQuoted,c.label):c,u=d(t,(0,a.cellRefNode)(e.ref,o,e.qualifiedLabel)),g=u.node.qualifier;return(0,n.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't generate ErrorQualifier",g?.kind!==a.QualifierKind.Error),(0,n.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't touch ref",u.node.ref===e.ref),E=(0,s.resolvedDottedName)((0,a.nameNode)(l,g,r.label),u,i.map(m),v),E}if((0,u.isUnqualifiedNameNode)(r)&&(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const i=function(t,r){const i=t.config?.localeInfo??e.config.localeInfo,o=(0,u.getEtaFuncId)(i,r.whole),l=r.parts;return(0,s.resolvedWorksheetFunc)((0,a.nameNode)((0,a.identNamePart)(void 0!==o?i.getWorksheetFuncName(o):l.asWhole,l.canDenoteNamedObject,l.label,l.qualifiedLabel),void 0,l.qualifiedLabel),(0,n.success)(o))}(t,r);if(void 0!==i.resolution.value)return(0,s.resolvedDottedName)(i.node,i,[],v)}return void 0!==E?E:(0,s.resolvedDottedName)(r,(0,s.resolvedNever)(C),[],v)}}};const n=r(6913),i=r(3949),a=r(1982),o=r(9209),s=r(4052),u=r(6234);function l(e){return(0,n.isSuccess)(e)&&(0,n.isNone)(e.value)?n.successUndefined:e}function c(e){return!(0,n.isSuccess)(e)||void 0===e.value}const d=e=>e.rhs.field.kind===a.NodeKind.Ident,m=e=>e.rhs.field.whole,g=(e,t)=>(0,a.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel);function p(e,t){const[r,...n]=t;return r.kind===a.NamePartKind.IdentNamePart&&null==e&&n.every(d)}function h(e,t,r){return r.canDenoteNamedObject&&e&&(void 0===t||t.kind===a.QualifierKind.Document||t.kind===a.QualifierKind.Ident)}function f(e,t,r){const[n,...i]=r;return n.kind===a.NamePartKind.CellRefNamePart&&(null==t&&e.allowUnqualifiedCell||null!=t&&t.kind!==a.QualifierKind.Document)&&i.every(d)}function S(e,t,r,o,s){return r.kind===a.PosKind.Abs?(0,n.success)(r.index):(0,n.isSuccess)(e)?(0,n.success)((0,i.resolvePosition)(t(e.value),r,o,s)):e}const v=({row:e})=>e,y=({col:e})=>e;function F(e,t,r){const i=S(e,v,t.row,o.sheetRows,r),a=S(e,y,t.col,o.sheetCols,r);return(0,n.isSuccess)(i)?(0,n.isSuccess)(a)?void 0===i.value||void 0===a.value?n.successUndefined:(0,n.success)((0,o.gridCell)(i.value,a.value)):a:i}function b(e,t){if(t.kind===a.CellRefKind.Error)return n.successUndefined;const r=e.originGridCell,i=e.wrapCellReferences;switch(t.kind){case a.CellRefKind.Single:return F(r,t,i);case a.CellRefKind.Range:{const e=F(r,t.ref1,i),a=F(r,t.ref2,i);return(0,n.isSuccess)(e)?(0,n.isSuccess)(a)?void 0===e.value||void 0===a.value?n.successUndefined:(0,n.success)((0,u.gridCellRange)(e.value,a.value)):a:e}case a.CellRefKind.Row:{const e=S(r,v,t.row1,o.sheetRows,i),a=S(r,v,t.row2,o.sheetRows,i);return(0,n.isSuccess)(e)?(0,n.isSuccess)(a)?void 0===e.value||void 0===a.value?n.successUndefined:(0,n.success)((0,u.gridCellRange)((0,o.gridCell)(e.value,0),(0,o.gridCell)(a.value,o.sheetCols-1))):a:e}case a.CellRefKind.Col:{const e=S(r,y,t.col1,o.sheetCols,i),a=S(r,y,t.col2,o.sheetCols,i);return(0,n.isSuccess)(e)?(0,n.isSuccess)(a)?void 0===e.value||void 0===a.value?n.successUndefined:(0,n.success)((0,u.gridCellRange)((0,o.gridCell)(0,e.value),(0,o.gridCell)(o.sheetRows-1,a.value))):a:e}case a.CellRefKind.Bad:return(0,n.failure)((0,s.invalidCellRef)(s.InvalidCellRefReason.BadCellRef));default:return(0,n.assertNever)("calc.lang.Resolver.resolveGridRef",t)}}},4052:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedWorksheetFunc=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.InvalidStructRefReason=t.InvalidCellRefReason=t.InvalidQualifierReason=t.ResolveReasonKind=void 0,t.resolveLocalsGrid=function(e){return{originGridCell:(0,n.success)(e.range),originSheet:(0,n.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.noOriginSheet=function(e){return{kind:i.NoOriginSheet,origin:e}},t.invalidQualifier=function(e){return{kind:i.InvalidQualifier,reason:e}},t.invalidCellRef=function(e){return{kind:i.InvalidCellRef,reason:e}},t.invalidStructRef=function(e){return{kind:i.InvalidStructRef,reason:e}};const n=r(6913);var i,a,o,s,u;!function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(i||(t.ResolveReasonKind=i={})),function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(a||(t.InvalidQualifierReason=a={})),function(e){e.BadCellRef="BadCellRef"}(o||(t.InvalidCellRefReason=o={})),function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(s||(t.InvalidStructRefReason=s={})),t.emptyIntersection={kind:i.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedWorksheetFunc="ResolvedWorksheetFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(u||(t.ResolvedKind=u={})),t.resolvedName=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedName,node:e,resolution:t,qualifierResolution:r,precedents:n}))),t.resolvedCellRef=(0,n.typedInstanceCreator)()(((e,t)=>({kind:u.ResolvedCellRef,node:e,resolution:t}))),t.resolvedUserDefinedFunc=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}))),t.resolvedWorksheetFunc=(0,n.typedInstanceCreator)()(((e,t)=>({kind:u.ResolvedWorksheetFunc,node:e,resolution:t}))),t.resolvedLocalName=(0,n.typedInstanceCreator)()(((e,t)=>({kind:u.ResolvedLocalName,node:e,resolution:t}))),t.resolvedStructRef=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}))),t.resolvedNever=(0,n.typedInstanceCreator)()((e=>({kind:u.ResolvedNever,node:e,resolution:n.successUndefined}))),t.resolvedDottedName=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:u.ResolvedDottedName,node:e,headResolved:t,fieldsResolved:r,precedents:n})))},9798:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=function(){return n.rTree.RTree.create(i.gridRangeJoin,i.gridRangeIsects,i.gridRangeCompare,a)};const n=r(6913),i=r(6234);function a(e,t){const{row:r,col:i,rows:a,cols:o}=e,{row:s,col:u,rows:l,cols:c}=t;return(0,n.fastAbs)(r-s+.5*(a-l))+(0,n.fastAbs)(i-u+.5*(o-c))}},6654:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operatorStrings=t.OperatorId=t.unknownFunctionType=t.WorksheetFuncId=void 0,t.higherOrderFunctionType=function(){const e=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean|a.OperKind.Rich|a.OperKind.Error|a.OperKind.Blank|((0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaCellValues)?0:a.OperKind.Range)|((0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaArrayLifting)?0:a.OperKind.Array),t=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean|a.OperKind.Rich|a.OperKind.Error|a.OperKind.Blank|a.OperKind.Missing|a.OperKind.Array|a.OperKind.Range;return(0,a.functionType)(1,255,[e],[t],[],a.SignatureType.All,a.SpecialPrecs.None,a.FunctionFlags.Allow3dRef|a.FunctionFlags.AllowLStrs)},t.getOperatorType=function(e){const r=S[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=v,t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},t.isVolatileFunc=function(e){return 0!=(v(e).staticPrecs&(a.SpecialPrecs.Time|a.SpecialPrecs.Calc))};const n=r(6913),i=r(2371);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});const a=r(1813);var o;t.unknownFunctionType=(0,a.functionType)(0,254,[],[a.SignatureType.All],[],a.SignatureType.All,a.SpecialPrecs.All,a.FunctionFlags.AllowLStrs),function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(o||(t.OperatorId=o={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];const s=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean|a.OperKind.Blank,u=a.OperKind.Number|a.OperKind.String|a.OperKind.Boolean|a.OperKind.Blank,l=(0,a.functionType)(2,2,[a.OperKind.Number,a.OperKind.Number],[],[],a.OperKind.Number,a.SpecialPrecs.None,a.FunctionFlags.None),c=(0,a.functionType)(1,1,[a.OperKind.Number],[],[],a.OperKind.Number,a.SpecialPrecs.None,a.FunctionFlags.None),d=(0,a.functionType)(1,1,[s],[],[],s,a.SpecialPrecs.None,a.FunctionFlags.AllowLStrs),m=(0,a.functionType)(2,2,[a.OperKind.String,a.OperKind.String],[],[],a.OperKind.String,a.SpecialPrecs.None,a.FunctionFlags.AllowLStrs),g=(0,a.functionType)(2,2,[u,u],[],[],a.OperKind.Boolean,a.SpecialPrecs.None,a.FunctionFlags.AllowLStrs),p=(0,a.functionType)(2,2,[a.OperKind.Range,a.OperKind.Range],[],[],a.OperKind.Range,a.SpecialPrecs.AllCells,a.FunctionFlags.None),h=(0,a.functionType)(2,2,[a.OperKind.Range,a.OperKind.Range],[],[],a.OperKind.Range,a.SpecialPrecs.None,a.FunctionFlags.None),f=(0,a.functionType)(2,2,[a.OperKind.Boolean,a.OperKind.Boolean],[],[],a.OperKind.Boolean,a.SpecialPrecs.None,a.FunctionFlags.None),S=[];function v(e){const r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType}function y(e,t){const r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}S[o.Add]=l,S[o.Sub]=l,S[o.Mul]=l,S[o.Div]=l,S[o.Pow]=l,S[o.Percent]=c,S[o.Neg]=c,S[o.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],S[o.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],S[o.Pos]=d,S[o.Concat]=m,S[o.Eq]=g,S[o.Ne]=g,S[o.Lt]=g,S[o.Le]=g,S[o.Gt]=g,S[o.Ge]=g,S[o.Range]=p,S[o.Isect]=h,S[o.Union]=h,S[o.And]=f,S[o.Or]=f,S[o.Xor]=f,S[o.Min]=l,S[o.Max]=l,y(i.WorksheetFuncId.ROW,a.SpecialPrecs.OwnRow),y(i.WorksheetFuncId.COLUMN,a.SpecialPrecs.OwnCol),y(i.WorksheetFuncId.SHEET,a.SpecialPrecs.OwnDocSheets),y(i.WorksheetFuncId.SHEETS,a.SpecialPrecs.OwnDocSheets),y(i.WorksheetFuncId.OFFSET,a.SpecialPrecs.AllCells),y(i.WorksheetFuncId.INDIRECT,a.SpecialPrecs.AllCells),y(i.WorksheetFuncId.SUMIF,a.SpecialPrecs.AllCells),y(i.WorksheetFuncId.AVERAGEIF,a.SpecialPrecs.AllCells),y(i.WorksheetFuncId.LOOKUP,a.SpecialPrecs.AllCells),y(i.WorksheetFuncId.ADDRESS,a.SpecialPrecs.RefStyle),y(i.WorksheetFuncId.FORMULATEXT,a.SpecialPrecs.RefStyle),y(i.WorksheetFuncId.NOW,a.SpecialPrecs.Time),y(i.WorksheetFuncId.TODAY,a.SpecialPrecs.Time),y(i.WorksheetFuncId.RAND,a.SpecialPrecs.Calc),y(i.WorksheetFuncId.RANDBETWEEN,a.SpecialPrecs.Calc),y(i.WorksheetFuncId.RANDARRAY,a.SpecialPrecs.Calc),y(i.WorksheetFuncId.SUBTOTAL,a.SpecialPrecs.CellProps),y(i.WorksheetFuncId.CELL,a.SpecialPrecs.CellProps|a.SpecialPrecs.AllCells),y(i.WorksheetFuncId.INFO,a.SpecialPrecs.None)},7325:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;const n=r(6913);var i,a,o,s,u,l,c;!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(i||(t.FontUnderline=i={})),(0,n.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(a||(t.FontVerticalAlignment=a={})),(0,n.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(o||(t.FillKind=o={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(s||(t.PatternType=s={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(u||(t.BorderLineType=u={})),(0,n.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(l||(t.HorizontalAlignment=l={})),(0,n.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(c||(t.VerticalAlignment=c={})),(0,n.staticAssertSame)()},8335:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sheet1=t.sheet1Name=t.document1=void 0,t.createSingleRange=function(e,r){const i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)};const n=r(9209);t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0)},1813:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0,t.functionType=function(e,t,r,i,a,o,s,u){if((0,n.assertNatural)("calc.lang.functionType",t),(0,n.assertIndex)("calc.lang.functionType",e,t+1),0===i.length?0!==a.length:a.length>=i.length){const e=JSON.stringify(a);(0,n.assertFalse)(`calc.lang.functionType: expected tailTypes.length < restTypes.length; given ${e}`)}if(0===i.length&&r.length+a.length<t){const e=JSON.stringify(r);(0,n.assertFalse)(`calc.lang.functionType: expected headTypes.length + tailTypes.length >= ${t}; given ${e}`)}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:i,tailTypes:a,returnType:o,staticPrecs:s,flags:u}};const n=r(6913);var i,a,o,s;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(i||(t.OperKind=i={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(a||(t.SignatureType=a={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(o||(t.SpecialPrecs=o={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.Chart=4]="Chart",e[e.OnlyParsedDuringLoad=8]="OnlyParsedDuringLoad",e[e.Internal=16]="Internal",e[e.Allow3dRef=32]="Allow3dRef",e[e.AllowLStrs=64]="AllowLStrs",e[e.HiddenFromUI=128]="HiddenFromUI"}(s||(t.FunctionFlags=s={}))},6234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=t.LangReasonKind=void 0,t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,a.isGridCell)(e))return t(e,0,0);const{row:r,rows:n,col:i,cols:o}=e;for(let e=0;e<n;e+=1)for(let n=0;n<o;n+=1)if(!t((0,a.gridCell)(r+e,i+n),e,n))return!1;return!0},t.forEachTileInRange=function(e,t,r){const{row:i,rows:o,col:s,cols:u}=e;(0,n.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,n.assertIndex)("calc.lang.forEachTileInRange",i,a.sheetRows),(0,n.assertIndex)("calc.lang.forEachTileInRange",s,a.sheetCols),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",o,a.sheetRows-i),(0,n.assertPositiveLength)("calc.lang.forEachTileInRange",u,a.sheetCols-s);for(let e=i;e<i+o;e+=t)for(let l=s;l<s+u;l+=t)if(!r((0,a.unsafeGridRange)(e,l,(0,n.fastMin)(t,o+i-e),(0,n.fastMin)(t,u+s-l))))return!1;return!0},t.gridRangeJoin=u,t.gridRangeJoinOpt=function(e,t){return e?t?u(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,n.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(u)},t.gridRangeIsect=function(e,t){const{row:r,col:i,rows:o,cols:s}=e,{row:u,col:l,rows:c,cols:d}=t,m=(0,n.fastMax)(r,u),g=(0,n.fastMax)(i,l),p=(0,n.fastMin)(r+o,u+c)-m,h=(0,n.fastMin)(i+s,l+d)-g;return p<=0||h<=0?void 0:(0,a.unsafeGridRange)(m,g,p,h)},t.gridRangeIsects=function(e,t){const{row:r,col:i,rows:a,cols:o}=e,{row:s,col:u,rows:l,cols:c}=t;return(0,n.fastMax)(r,s)<(0,n.fastMin)(r+a,s+l)&&(0,n.fastMax)(i,u)<(0,n.fastMin)(i+o,u+c)},t.gridCellImplicitIsect=function(e,t){const{row:r,col:n}=e,{row:i,col:o,rows:s,cols:u}=t,l=i<=r&&r<i+s,c=o<=n&&n<o+u;return l&&c?(0,a.gridCell)(r,n):l&&1===u?(0,a.gridCell)(r,o):c&&1===s?(0,a.gridCell)(i,n):1===u&&1===s?(0,a.gridCell)(i,o):void 0},t.gridRangeCompare=function(e,t){const{row:r,col:n,rows:i,cols:a}=e,{row:o,col:s,rows:u,cols:l}=t,c=r+i,d=o+u,m=n+a,g=s+l;return r===o&&c===d&&n===s&&m===g?0:r<=o&&c>=d&&n<=s&&m>=g?1:r>=o&&c<=d&&n>=s&&m<=g?-1:void 0},t.gridRangeExcept=function(e,t){const r=[e.row,e.row+e.rows],i=[e.col,e.col+e.cols],o=[t.row,t.row+t.rows],s=[t.col,t.col+t.cols],u=(0,n.ivlCompare)(r,o),l=(0,n.ivlCompare)(i,s);if(void 0!==u&&u<=0){const t=(0,n.ivlExcept)(i,s);if(void 0!==t)return(0,a.gridRange)(e.row,t[0],e.rows,t[1]-t[0])}if(void 0!==l&&l<=0){const t=(0,n.ivlExcept)(r,o);if(void 0!==t)return(0,a.gridRange)(t[0],e.col,t[1]-t[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.gridRangeAnchorHash=function(e){return a.sheetCols*e.row+e.col},t.isDocumentLocEqual=l,t.isSheetIndexEqual=c,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return{...e,__isRange:!1}},t.isNameScopeEqual=function(e,t){return l(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=d,t.isGridRangeEqual=m,t.isSheetGridCellEqual=function(e,t){return c(e.sheet,t.sheet)&&d(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return c(e.sheet,t.sheet)&&m(e.range,t.range)},t.gridRangeAnchor=g,t.sheetGridRangeAnchor=function(e){return(0,a.isSheetGridCell)(e)?e:(0,a.sheetGridCell)(e.sheet,g(e.range))},t.gridCellRange=function(e,t){const{row:r,col:i}=e,{row:o,col:s}=t;return(0,a.unsafeGridRange)((0,n.fastMin)(r,o),(0,n.fastMin)(i,s),Math.abs(o-r)+1,Math.abs(s-i)+1)},t.getArguments=function(e){return 0===function(e){return 1===e.length&&h(e[0])?0:e.length}(e)?p:e},t.isOperatorNode=function(e){return e.kind===i.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===i.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===i.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=function(e){return e.kind===i.NodeKind.Missing},t.isMissingLiteralNode=h,t.isNumberLiteralNode=function(e){return e.kind===i.NodeKind.Literal&&S(e.oper)},t.isBooleanLiteralNode=f,t.getArgType=function({maxArgs:e,headTypes:t,restTypes:r,tailTypes:i},a,o){if((0,n.assertPositiveInteger)("calc.runtime.getArgType: n",o),(0,n.assertIndex)("calc.runtime.getArgType: i",a,o),a>=e)return s.SignatureType.None;if(a<t.length)return t[a];if(0===r.length)return s.SignatureType.None;if(a<t.length+r.length)return r[a-t.length];const u=(o-t.length)%r.length;return u>i.length?s.SignatureType.None:a>=o-u?i[a-(o-u)]:r[(a-t.length)%r.length]},t.isValidArgsLength=function({minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i},a){return!(a<e||a>t)&&(a<=r.length+n.length||0!==n.length&&(a-r.length)%n.length<=i.length)},t.shouldFieldRefBeBracketed=function(e,t,r){if(0===r.length)return!1;if(t.field.kind!==i.NodeKind.Ident)return!1;let n=e;for(;n.kind===i.NodeKind.App&&n.head.kind===i.NodeKind.Operator;){const e=n.head.id;if(e!==o.OperatorId.Range&&e!==o.OperatorId.Isect||2!==n.args.length)break;n=n.args[1]}return f(n)||n.kind===i.NodeKind.Name||n.kind===i.NodeKind.CellRef},t.isNumberOper=S,t.isStringOper=function(e){return e.kind===s.OperKind.String},t.isBooleanOper=v,t.isErrorOper=function(e){return e.kind===s.OperKind.Error},t.isRangeOper=function(e){return e.kind===s.OperKind.Range},t.isArrayOper=function(e){return e.kind===s.OperKind.Array},t.isMissingOper=y,t.isBlankOper=function(e){return e.kind===s.OperKind.Blank},t.isRichOper=function(e){return e.kind===s.OperKind.Rich},t.isPrimitiveOper=function(e){return 0!=(e.kind&F)},t.isWriteOper=function(e){return 0!=(e.kind&b)},t.isReadOperEqual=function e(t,r,i,a){if(i.kind!==r.kind)return!1;switch(i.kind){case s.OperKind.Boolean:case s.OperKind.String:return i.value===r.value;case s.OperKind.Number:return 0===t.cond2(i,r);case s.OperKind.Error:return i.type===r.type;case s.OperKind.Rich:return a;case s.OperKind.Array:const o=r;if(i.cols!==o.cols||i.rows!==o.rows)return!1;for(let r=0;r<i.rows;r+=1){const n=i.opers[r],s=o.opers[r];for(let r=0;r<i.cols;r+=1)if(!e(t,s[r],n[r],a))return!1}return!0;case s.OperKind.Blank:return!0;default:return(0,n.assertNever)("calc.lang.readOperEq",i)}},t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e,...r){return 0===e.length&&(0,n.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){const t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t},t.getWorksheetFuncId=function(e,t){let r=t;return r.length>k.length&&0===e.stringCompareCI(r.substring(0,k.length),k)&&(r=r.substring(k.length),r.length>E.length&&0===e.stringCompareCI(r.substring(0,E.length),E)&&(r=r.substring(E.length))),e.getWorksheetFuncId(r)},t.getUserDefinedFuncName=function(e,t){let r=t;return r.length>A.length&&0===e.stringCompareCI(r.substring(0,A.length),A)&&(r=r.substring(A.length)),r},t.getEtaFuncId=function(e,t){let r=t;return r.length>T.length&&0===e.stringCompareCI(r.substring(0,T.length),T)&&(r=r.substring(T.length)),e.getWorksheetFuncId(r)},t.getBoundName=function(e,t){let r=t;return r.length>R.length&&0===e.stringCompareCI(r.substring(0,R.length),R)?r=r.substring(R.length):r.length>N.length&&0===e.stringCompareCI(r.substring(0,N.length),N)&&(r=r.substring(N.length)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(I)&&function({specialRefs:e}){const t=Object.keys(e).reduce(((t,r)=>t+(e[Number(r)]?1:0)),0);return 1===t||2===t&&e[i.SpecialRefId.Data]&&(e[i.SpecialRefId.Headers]||e[i.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(O)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(P)},t.isRangeOpClosed=function(e){return O(e.lhs)&&O(e.rhs)},t.isRangeOpNoMissing=function(e){return!P(e.lhs)&&!P(e.rhs)},t.normalizeCommaOpRef=function(e){const t={},r=[];for(const n of e.refs)n.kind!==i.StructRefKind.SpecialRef?r.push(n):void 0===t[n.id]&&(t[n.id]=!0,r.push(n));return r.sort(w),r},t.applyComparison=function(e,t){switch(e){case o.OperatorId.Eq:return 0===t;case o.OperatorId.Ne:return 0!==t;case o.OperatorId.Lt:return t<0;case o.OperatorId.Gt:return t>0;case o.OperatorId.Le:return t<=0;case o.OperatorId.Ge:return t>=0}};const n=r(6913),i=r(1982),a=r(9209),o=r(6654),s=r(1813);function u(e,t){const{row:r,col:i,rows:o,cols:s}=e,{row:u,col:l,rows:c,cols:d}=t,m=(0,n.fastMin)(r,u),g=(0,n.fastMin)(i,l),p=(0,n.fastMax)(r+o,u+c)-m,h=(0,n.fastMax)(i+s,l+d)-g;return(0,a.unsafeGridRange)(m,g,p,h)}function l(e,t){return e===t||e.name===t.name&&e.path===t.path}function c(e,t){return l(e.document,t.document)&&e.index===t.index}function d(e,t){return e.row===t.row&&e.col===t.col}function m(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function g(e){return(0,a.isGridCell)(e)?e:(0,a.unsafeGridRange)(e.row,e.col,1,1)}const p=[];function h(e){return e.kind===i.NodeKind.Literal&&y(e.oper)}function f(e){return e.kind===i.NodeKind.Literal&&v(e.oper)}function S(e){return e.kind===s.OperKind.Number}function v(e){return e.kind===s.OperKind.Boolean}function y(e){return e.kind===s.OperKind.Missing}const F=s.OperKind.Number|s.OperKind.String|s.OperKind.Boolean,b=F|s.OperKind.Error|s.OperKind.Array|s.OperKind.Rich;var C;!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(C||(t.LangReasonKind=C={})),t.ReasonKind={...n.ReasonKind,...C};const k="_xlfn.",E="_xlws.",A="_xludf.",T="_xleta.",R="_xlpm.",N="_xlop.";function I(e){return e.kind!==i.StructRefKind.SpecialRef&&e.kind!==i.StructRefKind.BadRef||e.isBracketed}function P(e){return e.kind===i.StructRefKind.MissingRef||e.kind===i.StructRefKind.BadRef}function O(e){switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:return e.isClosed;case i.StructRefKind.RangeOpRef:return O(e.lhs)&&O(e.rhs);case i.StructRefKind.MissingRef:return!0;case i.StructRefKind.BadRef:return e.isClosed}}const M={[i.SpecialRefId.All]:1,[i.SpecialRefId.Headers]:2,[i.SpecialRefId.Data]:3,[i.SpecialRefId.Totals]:4,[i.SpecialRefId.ThisRow]:5},D=e=>e.kind===i.StructRefKind.MissingRef?7:e.kind!==i.StructRefKind.SpecialRef?6:M[e.id];function w(e,t){return D(e)-D(t)}},1973:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0,t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:i.OperKind.String,value:e}},t.errorOper=function(e){const t=u[e];return void 0!==t?t:s(e)},t.arrayOper=function(e,t,r){return(0,n.assertNatural)("calc.lang.arrayOper",e),(0,n.assertNatural)("calc.lang.arrayOper",t),r.length!==e?(0,n.assertFalse)("calc.lang.arrayOper: Inconsistent row number"):{kind:i.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return(0,n.assertPositiveInteger)("calc.lang.rangeSeqOper",t.length),{kind:i.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:i.OperKind.Range,sheets:e,ranges:[t]}};const n=r(6913),i=r(1813);var a,o;function s(e){return{kind:i.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(a||(t.PrecsBound=a={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL",e[e.TIMEOUT=20]="TIMEOUT"}(o||(t.ErrorType=o={})),t.nullErrorOper=s(o.NULL),t.div0ErrorOper=s(o.DIV0),t.valueErrorOper=s(o.VALUE),t.refErrorOper=s(o.REF),t.nameErrorOper=s(o.NAME),t.numErrorOper=s(o.NUM),t.naErrorOper=s(o.NA),t.gettingDataErrorOper=s(o.GETTING_DATA),t.spillErrorOper=s(o.SPILL),t.connectErrorOper=s(o.CONNECT),t.blockedErrorOper=s(o.BLOCKED),t.unknownErrorOper=s(o.UNKNOWN),t.fieldErrorOper=s(o.FIELD),t.calcErrorOper=s(o.CALC),t.busyErrorOper=s(o.BUSY),t.externalErrorOper=s(o.EXTERNAL);const u=(0,n.partialArray)({[o.NULL]:t.nullErrorOper,[o.DIV0]:t.div0ErrorOper,[o.VALUE]:t.valueErrorOper,[o.REF]:t.refErrorOper,[o.NAME]:t.nameErrorOper,[o.NUM]:t.numErrorOper,[o.NA]:t.naErrorOper,[o.GETTING_DATA]:t.gettingDataErrorOper,[o.SPILL]:t.spillErrorOper,[o.CONNECT]:t.connectErrorOper,[o.BLOCKED]:t.blockedErrorOper,[o.UNKNOWN]:t.unknownErrorOper,[o.FIELD]:t.fieldErrorOper,[o.CALC]:t.calcErrorOper,[o.BUSY]:t.busyErrorOper,[o.EXTERNAL]:t.externalErrorOper});t.missingOper={kind:i.OperKind.Missing},t.blankOper={kind:i.OperKind.Blank},t.trueOper={kind:i.OperKind.Boolean,value:!0},t.falseOper={kind:i.OperKind.Boolean,value:!1}},6426:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PledgeReducer=t.ZipVisitor=t.depthVisitor=t.ComposeVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=void 0,t.visitFormulaNode=a,t.visitOperatorNode=o,t.visitWSFNode=s,t.visitAppHeadNode=u,t.visitQualifier=function(e,t){switch(t.kind){case i.QualifierKind.Error:{const{label:r}=t;return e.errorQualifier(r)}case i.QualifierKind.Relative:{const{label:r}=t;return e.relativeQualifier(r)}case i.QualifierKind.Document:{const{document:r,path:n,isQuoted:i,label:a}=t;return e.documentQualifier(r,n,i,a)}case i.QualifierKind.Sheet:{const{sheet:r,document:n,isQuoted:i,label:a}=t;return e.sheetQualifier(r,n,i,a)}case i.QualifierKind.Ident:{const{name:r,isQuoted:n,label:i}=t;return e.identQualifier(r,n,i)}case i.QualifierKind.SheetRange:{const{sheet1:r,sheet2:n,document:i,isQuoted:a,label:o}=t;return e.sheetRangeQualifier(r,n,i,a,o)}case i.QualifierKind.Bad:{const{chars:r,isQuoted:n,isClosed:i,isTerminated:a,label:o}=t;return e.badQualifier(r,n,i,a,o)}default:return(0,n.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case i.CellRefKind.Error:{const{label:r}=t;return e.cellRefError(r)}case i.CellRefKind.Single:{const{row:r,col:n,isBracketed:i,label:a}=t;return e.cellRefSingle(r,n,i,a)}case i.CellRefKind.Range:{const{ref1:r,ref2:n,label:i}=t;return e.cellRefRange(r,n,i)}case i.CellRefKind.Row:{const{row1:r,row2:n,isBracketed:i,label:a}=t;return e.cellRefRow(r,n,i,a)}case i.CellRefKind.Col:{const{col1:r,col2:n,isBracketed:i,label:a}=t;return e.cellRefCol(r,n,i,a)}case i.CellRefKind.Bad:{const{chars:r,isBracketed:n,label:i}=t;return e.cellRefBad(r,n,i)}default:return(0,n.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=l,t.constVisitor=m,t.binaryVisitor=h,t.composeVisitor=S,t.zipVisitor=function(e){return l(new v(e))},t.reduceBottomUp_Recursive=y,t.reduceBottomUp_CPS=N,t.reduceBottomUp_Pledge=function(e,t){return M(new I(e),t)},t.reduceBottomUp_MaxDepth=O,t.reduceBottomUp=function(e,t){return O(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=M,t.reducePledge=function(e,t){return M(e,t.node)};const n=r(6913),i=r(1982);function a(e,t){switch(t.kind){case i.NodeKind.Literal:{const{oper:r,isClosed:n,label:i}=t;return e.literalNode(r,n,i)}case i.NodeKind.Array:{const{nodes:r,isClosed:n,label:i}=t;return e.arrayNode(r,n,i)}case i.NodeKind.App:{const{head:r,args:n,isClosed:i,label:a}=t;return e.appNode(r,n,i,a)}case i.NodeKind.Let:{const{head:r,vars:n,body:i,badArgs:a,isClosed:o,label:s}=t;return e.letNode(r,n,i,a,o,s)}case i.NodeKind.Lambda:{const{head:r,params:n,body:i,badArgs:a,isClosed:o,label:s}=t;return e.lambdaNode(r,n,i,a,o,s)}case i.NodeKind.Paren:{const{node:r,isClosed:n,label:i}=t;return e.parenNode(r,n,i)}case i.NodeKind.Name:{const{parts:r,qualifier:n,label:i}=t;return e.nameNode(r,n,i)}case i.NodeKind.CellRef:{const{ref:r,qualifier:n,label:i}=t;return e.cellRefNode(r,n,i)}case i.NodeKind.FieldRef:{const{lhs:r,rhs:n,label:i}=t;return e.fieldRefNode(r,n,i)}case i.NodeKind.StructRef:{const{lhs:r,rhs:n,label:i}=t;return e.structRefNode(r,n,i)}case i.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case i.NodeKind.BadChars:{const{type:r,chars:n,label:i}=t;return e.badCharsNode(r,n,i)}case i.NodeKind.BadSequence:{const{type:r,contents:n,label:i}=t;return e.badSequenceNode(r,n,i)}default:return(0,n.assertNever)("calc.lang.visitFormulaNode",t)}}function o(e,t){const{id:r,label:n}=t;return e.operatorNode(r,n)}function s(e,t){const{id:r,whole:n,label:i}=t;return e.wsfNode(r,n,i)}function u(e,t){switch(t.kind){case i.NodeKind.Operator:return o(e,t);case i.NodeKind.WSF:return s(e,t);default:return a(e,t)}}function l(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}class c{literalNode(e,t,r){return(0,i.literalNode)(e,t,r)}arrayNode(e,t,r){return(0,i.arrayNode)(e,t,r)}appNode(e,t,r,n){return(0,i.appNode)(e,t,r,n)}letNode(e,t,r,n,a,o){return(0,i.letNode)(e,t,r,n,a,o)}lambdaNode(e,t,r,n,a,o){return(0,i.lambdaNode)(e,t,r,n,a,o)}parenNode(e,t,r){return(0,i.parenNode)(e,t,r)}nameNode(e,t,r){return(0,i.nameNode)(e,t,r)}cellRefNode(e,t,r){return(0,i.cellRefNode)(e,t,r)}fieldRefNode(e,t,r){return(0,i.fieldRefNode)(e,t,r)}structRefNode(e,t,r){return(0,i.structRefNode)(e,t,r)}missingNode(e,t){return(0,i.missingNode)(e,t)}badSequenceNode(e,t,r){return(0,i.badSequenceNode)(e,t,r)}badCharsNode(e,t,r){return(0,i.badCharsNode)(e,t,r)}operatorNode(e,t){return(0,i.operatorNode)(e,t)}wsfNode(e,t,r){return(0,i.wsfNode)(e,t,r)}}t.IdentityVisitor=c,t.identityVisitor=l(new c);class d{literalNode(e,t,r){return this.value}arrayNode(e,t,r){return this.value}appNode(e,t,r,n){return this.value}letNode(e,t,r,n,i,a){return this.value}lambdaNode(e,t,r,n,i,a){return this.value}parenNode(e,t,r){return this.value}nameNode(e,t,r){return this.value}cellRefNode(e,t,r){return this.value}fieldRefNode(e,t,r){return this.value}structRefNode(e,t,r){return this.value}missingNode(e,t){return this.value}badSequenceNode(e,t,r){return this.value}badCharsNode(e,t,r){return this.value}operatorNode(e,t){return this.value}wsfNode(e,t,r){return this.value}constructor(e){this.value=e}}function m(e){return l(new d(e))}t.ConstVisitor=d,t.voidVisitor=m(void 0);class g{literalNode(e,t,r){return this.visitor.literalNode(e,t,r)}arrayNode(e,t,r){return this.visitor.arrayNode(e,t,r)}appNode(e,t,r,n){return this.visitor.appNode(e,t,r,n)}letNode(e,t,r,n,i,a){return this.visitor.letNode(e,t,r,n,i,a)}lambdaNode(e,t,r,n,i,a){return this.visitor.lambdaNode(e,t,r,n,i,a)}parenNode(e,t,r){return this.visitor.parenNode(e,t,r)}nameNode(e,t,r){return this.visitor.nameNode(e,t,r)}cellRefNode(e,t,r){return this.visitor.cellRefNode(e,t,r)}fieldRefNode(e,t,r){return this.visitor.fieldRefNode(e,t,r)}structRefNode(e,t,r){return this.visitor.structRefNode(e,t,r)}missingNode(e,t){return this.visitor.missingNode(e,t)}badSequenceNode(e,t,r){return this.visitor.badSequenceNode(e,t,r)}badCharsNode(e,t,r){return this.visitor.badCharsNode(e,t,r)}operatorNode(e,t){return this.visitor.operatorNode(e,t)}wsfNode(e,t,r){return this.visitor.wsfNode(e,t,r)}constructor(e){this.visitor=e}}t.DelegatingVisitor=g;class p extends g{arrayNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((e=>e.reduce(this.reducer))).reduce(this.reducer)}appNode(e,t,r,n){return t.reduce(this.reducer,e)}letNode(e,t,r,n,i,a){return[...t.map((({binder:e})=>e.arg)),...void 0===r?[]:[r.arg],...n.map((e=>e.arg))].reduce(this.reducer,e)}lambdaNode(e,t,r,i,a,o){return[...t.map((({name:e})=>e.arg.def?.rhs)).filter(n.isDefined),...void 0===r?[]:[r.arg],...i.map((e=>e.arg))].reduce(this.reducer,e)}parenNode(e,t,r){return e}fieldRefNode(e,t,r){return e}badSequenceNode(e,t,r){return(0,n.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)}constructor(e,t){super(e),this.reducer=(e,r)=>t(e,r)}}function h(e,t){return l(new p(e,t))}t.BinaryVisitor=p;class f{literalNode(e,t,r){return this.b(this.a.literalNode(e,t,r))}arrayNode(e,t,r){return this.b(this.a.arrayNode(e,t,r))}appNode(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))}letNode(e,t,r,n,i,a){return this.b(this.a.letNode(e,t,r,n,i,a))}lambdaNode(e,t,r,n,i,a){return this.b(this.a.lambdaNode(e,t,r,n,i,a))}parenNode(e,t,r){return this.b(this.a.parenNode(e,t,r))}nameNode(e,t,r){return this.b(this.a.nameNode(e,t,r))}cellRefNode(e,t,r){return this.b(this.a.cellRefNode(e,t,r))}fieldRefNode(e,t,r){return this.b(this.a.fieldRefNode(e,t,r))}structRefNode(e,t,r){return this.b(this.a.structRefNode(e,t,r))}missingNode(e,t){return this.b(this.a.missingNode(e,t))}badSequenceNode(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))}badCharsNode(e,t,r){return this.b(this.a.badCharsNode(e,t,r))}operatorNode(e,t){return this.b(this.a.operatorNode(e,t))}wsfNode(e,t,r){return this.b(this.a.wsfNode(e,t,r))}constructor(e,t){this.a=e,this.b=t}}function S(e,t){return l(new f(e,t))}t.ComposeVisitor=f,t.depthVisitor=S(h(m(0),n.fastMax),(e=>e+1));class v{literalNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].literalNode(e,t,r);return n}arrayNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].arrayNode(e,t,r);return n}appNode(e,t,r,n){const i={};for(const a of this.keys)i[a]=this.visitors[a].appNode(e,t,r,n);return i}letNode(e,t,r,n,i,a){const o={};for(const s of this.keys)o[s]=this.visitors[s].letNode(e,t,r,n,i,a);return o}lambdaNode(e,t,r,n,i,a){const o={};for(const s of this.keys)o[s]=this.visitors[s].lambdaNode(e,t,r,n,i,a);return o}parenNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].parenNode(e,t,r);return n}nameNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].nameNode(e,t,r);return n}cellRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].cellRefNode(e,t,r);return n}fieldRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].fieldRefNode(e,t,r);return n}structRefNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].structRefNode(e,t,r);return n}missingNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].missingNode(e,t);return r}badSequenceNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].badSequenceNode(e,t,r);return n}badCharsNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].badCharsNode(e,t,r);return n}operatorNode(e,t){const r={};for(const n of this.keys)r[n]=this.visitors[n].operatorNode(e,t);return r}wsfNode(e,t,r){const n={};for(const i of this.keys)n[i]=this.visitors[i].wsfNode(e,t,r);return n}constructor(e){this.visitors=e,this.keys=Object.keys(e)}}function y(e,t){const r=t=>{switch(t.kind){case i.NodeKind.Literal:{const{oper:r,isClosed:n,label:i}=t;return e.literalNode(r,n,i)}case i.NodeKind.Array:{const{nodes:n,isClosed:i,label:a}=t;return e.arrayNode(n.map((e=>e.map(r))),i,a)}case i.NodeKind.App:{const{head:n,args:a,isClosed:u,label:l}=t;return e.appNode((t=>{switch(t.kind){case i.NodeKind.Operator:return o(e,t);case i.NodeKind.WSF:return s(e,t);default:return r(t)}})(n),a.map(r),u,l)}case i.NodeKind.Let:{const{head:n,vars:a,body:o,badArgs:u,isClosed:l,label:c}=t;return e.letNode(s(e,n),a.map((({name:e,binder:t})=>(0,i.letVar)(e,(0,i.indexedArg)(r(t.arg),t.index)))),void 0===o?void 0:(0,i.indexedArg)(r(o.arg),o.index),u.map((e=>(0,i.indexedArg)(r(e.arg),e.index))),l,c)}case i.NodeKind.Lambda:{const{head:n,params:a,body:o,badArgs:u,isClosed:l,label:c}=t;return e.lambdaNode(s(e,n),a.map((({name:e})=>void 0===e.arg.def?(0,i.lambdaParam)(e):(0,i.lambdaParam)((0,i.indexedArg)((0,i.paramNode)(e.arg.name,(0,i.paramDefault)(r(e.arg.def.rhs),e.arg.def.label),e.arg.label),e.index)))),void 0===o?void 0:(0,i.indexedArg)(r(o.arg),o.index),u.map((e=>(0,i.indexedArg)(r(e.arg),e.index))),l,c)}case i.NodeKind.Paren:{const{node:n,isClosed:i,label:a}=t;return e.parenNode(r(n),i,a)}case i.NodeKind.Name:{const{parts:r,qualifier:n,label:i}=t;return e.nameNode(r,n,i)}case i.NodeKind.CellRef:{const{ref:r,qualifier:n,label:i}=t;return e.cellRefNode(r,n,i)}case i.NodeKind.FieldRef:{const{lhs:n,rhs:i,label:a}=t;return e.fieldRefNode(r(n),i,a)}case i.NodeKind.StructRef:{const{lhs:r,rhs:n,label:i}=t;return e.structRefNode(r,n,i)}case i.NodeKind.Missing:{const{chars:r,label:n}=t;return e.missingNode(r,n)}case i.NodeKind.BadChars:{const{type:r,chars:n,label:i}=t;return e.badCharsNode(r,n,i)}case i.NodeKind.BadSequence:{const{type:n,contents:i,label:a}=t;return e.badSequenceNode(n,i.map(r),a)}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function F(e,t,r,n){const i=[],a=e=>(i.push(e),o),o=()=>i.length<t.length?r(e,t[i.length],a):n(i);return o}function b(e,t,r){return F(e,t,R,r)}function C(e,t,r,n){return()=>void 0!==t?r(e,t,n):n(void 0)}function k(e,t,r){const{id:n,whole:i,label:a}=t;return()=>r(e.wsfNode(n,i,a))}function E(e,{name:t,binder:r},n){return R(e,r.arg,(e=>n((0,i.letVar)(t,(0,i.indexedArg)(e,r.index)))))}function A(e,{name:t},r){const n=t.arg;return void 0===n.def?()=>r((0,i.lambdaParam)(t)):R(e,n.def.rhs,(e=>r((0,i.lambdaParam)((0,i.indexedArg)((0,i.paramNode)(n.name,(0,i.paramDefault)(e,n.def.label),n.label),t.index)))))}function T(e,{arg:t,index:r},n){return R(e,t,(e=>n((0,i.indexedArg)(e,r))))}function R(e,t,r){switch(t.kind){case i.NodeKind.Literal:{const{oper:n,isClosed:i,label:a}=t;return()=>r(e.literalNode(n,i,a))}case i.NodeKind.Array:{const{nodes:n,isClosed:i,label:a}=t;return F(e,n,b,(t=>r(e.arrayNode(t,i,a))))}case i.NodeKind.App:{const{head:n,args:a,isClosed:o,label:s}=t;return()=>function(e,t,r){switch(t.kind){case i.NodeKind.Operator:{const{id:n,label:i}=t;return()=>r(e.operatorNode(n,i))}case i.NodeKind.WSF:return k(e,t,r);default:return R(e,t,r)}}(e,n,(t=>b(e,a,(n=>r(e.appNode(t,n,o,s))))))}case i.NodeKind.Let:{const{head:n,vars:i,body:a,badArgs:o,isClosed:s,label:u}=t;return()=>k(e,n,(t=>F(e,i,E,(n=>C(e,a,T,(i=>F(e,o,T,(a=>r(e.letNode(t,n,i,a,s,u))))))))))}case i.NodeKind.Lambda:{const{head:n,params:i,body:a,badArgs:o,isClosed:s,label:u}=t;return()=>k(e,n,(t=>()=>F(e,i,A,(n=>C(e,a,T,(i=>F(e,o,T,(a=>r(e.lambdaNode(t,n,i,a,s,u))))))))))}case i.NodeKind.Paren:{const{node:n,isClosed:i,label:a}=t;return()=>R(e,n,(t=>()=>r(e.parenNode(t,i,a))))}case i.NodeKind.Name:{const{parts:n,qualifier:i,label:a}=t;return()=>r(e.nameNode(n,i,a))}case i.NodeKind.CellRef:{const{ref:n,qualifier:i,label:a}=t;return()=>r(e.cellRefNode(n,i,a))}case i.NodeKind.FieldRef:{const{lhs:n,rhs:i,label:a}=t;return()=>R(e,n,(t=>()=>r(e.fieldRefNode(t,i,a))))}case i.NodeKind.StructRef:{const{lhs:n,rhs:i,label:a}=t;return()=>r(e.structRefNode(n,i,a))}case i.NodeKind.Missing:{const{chars:n,label:i}=t;return()=>r(e.missingNode(n,i))}case i.NodeKind.BadChars:{const{type:n,chars:i,label:a}=t;return()=>r(e.badCharsNode(n,i,a))}case i.NodeKind.BadSequence:{const{type:n,contents:i,label:a}=t;return b(e,i,(t=>r(e.badSequenceNode(n,t,a))))}default:return(0,n.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function N(e,t){let r;return function(e){let t=e;for(;null!=t;)t=t()}(R(e,t,(e=>{r=e}))),r}t.ZipVisitor=v;class I{literalNode(e,t,r){return n.Pledge.try((()=>this.visitor.literalNode(e,t,r)))}arrayNode(e,t,r){return n.Pledge.all(e.map((e=>n.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.visitor.arrayNode(e,t,r)))}appNode(e,t,r,i){return this.lazyVisitAppHeadNode(e).bind((e=>n.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.appNode(e,t,r,i)))))}letNode(e,t,r,i,a,o){return this.lazyVisitWSFNode(e).bind((e=>n.Pledge.all(t.map(this.lazyVisitVar)).bind((t=>(void 0===r?n.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>n.Pledge.all(i.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.letNode(e,t,r,n,a,o)))))))))}lambdaNode(e,t,r,i,a,o){return this.lazyVisitWSFNode(e).bind((e=>n.Pledge.all(t.map(this.lazyVisitParam)).bind((t=>(void 0===r?n.Pledge.resolve(void 0):this.lazyVisitIndexedArg(r)).bind((r=>n.Pledge.all(i.map(this.lazyVisitIndexedArg)).bind((n=>this.visitor.lambdaNode(e,t,r,n,a,o)))))))))}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.parenNode(e,t,r)))}nameNode(e,t,r){return n.Pledge.try((()=>this.visitor.nameNode(e,t,r)))}cellRefNode(e,t,r){return n.Pledge.try((()=>this.visitor.cellRefNode(e,t,r)))}fieldRefNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.visitor.fieldRefNode(e,t,r)))}structRefNode(e,t,r){return n.Pledge.try((()=>this.visitor.structRefNode(e,t,r)))}missingNode(e,t){return n.Pledge.try((()=>this.visitor.missingNode(e,t)))}badSequenceNode(e,t,r){return n.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>this.visitor.badSequenceNode(e,t,r)))}badCharsNode(e,t,r){return n.Pledge.try((()=>this.visitor.badCharsNode(e,t,r)))}operatorNode(e,t){return n.Pledge.try((()=>this.visitor.operatorNode(e,t)))}wsfNode(e,t,r){return n.Pledge.try((()=>this.visitor.wsfNode(e,t,r)))}constructor(e){this.visitor=e,this.visitFormulaNode=e=>a(this,e),this.lazyVisitFormulaNode=e=>n.Pledge.resolve(e).bind(this.visitFormulaNode),this.visitAppHeadNode=e=>u(this,e),this.lazyVisitAppHeadNode=e=>n.Pledge.resolve(e).bind(this.visitAppHeadNode),this.visitWSFNode=e=>s(this,e),this.lazyVisitWSFNode=e=>n.Pledge.resolve(e).bind(this.visitWSFNode),this.lazyVisitVar=({name:e,binder:t})=>this.lazyVisitFormulaNode(t.arg).bind((r=>(0,i.letVar)(e,(0,i.indexedArg)(r,t.index)))),this.lazyVisitParam=({name:e})=>{const t=e.arg;return void 0===t.def?n.Pledge.resolve((0,i.lambdaParam)(e)):this.lazyVisitFormulaNode(t.def.rhs).bind((r=>(0,i.lambdaParam)((0,i.indexedArg)((0,i.paramNode)(t.name,(0,i.paramDefault)(r,t.def.label),t.label),e.index))))},this.lazyVisitIndexedArg=({arg:e,index:t})=>this.lazyVisitFormulaNode(e).bind((e=>(0,i.indexedArg)(e,t)))}}t.PledgeReducer=I;const P=50;function O(e,t,r){return r<=P?y(e,t):N(e,t)}function M(e,t){return n.Pledge.settleOrThrow(n.Pledge.resolve(a(e,t)))}},9471:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEdit=function(e,t,r){try{if(r.valueType===s.FormatValueType.Text)return u(t);if(""===t)return(0,n.success)((0,s.otherEdit)(i.blankOper));if(t.length>1&&(0,n.stringStartsWith)(t,"="))return(0,n.success)((0,s.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){const a=function(e,t,r){const a=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return i.trueOper;if(0===e.stringCompareCI(t,e.falseName))return i.falseOper;for(let r=1;r<e.errorNames.length;r+=1){const n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,i.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==a)return(0,n.success)((0,s.otherEdit)(a));const o=r.valueType===s.FormatValueType.Date||r.valueType===s.FormatValueType.Time?[l,c]:[c,l];for(const i of o){const a=i(e,t,r);if(!(0,n.isSuccess)(a))return a;if(void 0!==a.value){const{value:e,format:t}=a.value;return(0,n.success)((0,s.numberEdit)(e,t))}}return(0,n.success)(void 0)}(e,t,r);if(!(0,n.isSuccess)(a))return a;if(void 0!==a.value)return(0,n.success)(a.value)}return t.length>1&&function(e){const t=e.charAt(0);return"="===t||"+"===t||"-"===t||"@"===t}(t)?(0,n.success)((0,s.formulaEdit)(t)):u(t)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}},t.shouldInstallFormat=function(e,t){return e!==t&&t.source===s.NumberFormatSource.Builtin&&(t.valueType===s.FormatValueType.General||function(e,t){return e?.valueType!==s.FormatValueType.Number&&t.valueType!==s.FormatValueType.Number&&e?.valueType!==t.valueType}(e,t))};const n=r(6913),i=r(6592),a=r(3985),o=r(6964),s=r(3739);function u(e){const t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>i.cellStringLimit?(0,n.failure)((0,s.notValueString)("cell text too long")):(0,n.success)((0,s.stringEdit)((0,i.stringOper)(r),t))}function l(e,t,r){return(0,o.parseDateInternal)((0,o.initParseDateGlobals)(e),t,r,s.GetTimeKind.ValueCell)}function c(e,t,r){const{localeInfo:n,mathpack:i}=e.config,o=n.isEastAsia&&r.valueType===s.FormatValueType.Percentage&&!0;let u=!1;switch(r.valueType){case s.FormatValueType.Number:case s.FormatValueType.Currency:case s.FormatValueType.Percentage:case s.FormatValueType.Fraction:case s.FormatValueType.Scientific:case s.FormatValueType.Accounting:u=!0}return(0,a.parseConstInternal)(n,i,t,o,!0,u)}},1333:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormatImpl=function(e,t,r){try{const i=c(e,t),a=R(i,r);return(0,n.success)({...a,format:v(i,a.format),mulOrDivTainted:i.multOrDivTainted})}catch(e){return e instanceof u?(0,n.failure)(e.reason):e===s?n.successUndefined:(0,n.failure)((0,n.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{const i=c(e,t),o=R(i,r);return(0,n.success)(function(e,{strong:t,format:r,valueType:n,decimals:i}){if(n!==a.FormatValueType.Number||!e.multOrDivTainted){if(i>0&&t&&(n===a.FormatValueType.Number||n===a.FormatValueType.Currency||n===a.FormatValueType.Accounting||n===a.FormatValueType.Percentage)){const t=f(e,r);i!==t.decimals&&(r=t.synthesizeDecimals(i))}if(n!==a.FormatValueType.General&&t)return r=v(e,r)}}(i,o))}catch(e){return e instanceof u?(0,n.failure)(e.reason):e===s?n.successUndefined:(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a=r(3739),o=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({strong:e,format:t,valueType:r,decimals:n}))),s={},u=(0,i.createFailureErrorClass)("InferenceError"),l={getDocumentLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes"),getCellFormat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getCellFormat"),getKnownFormat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat"),getIformat:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getIformat"),getFormatString:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getFormatString"),getContainingTable:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")};function c(e,t){const r=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??l.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??l.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??l.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??l.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??l.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??l.getSheetRangeIndexes,getCellFormat:e.getCellFormat?.bind(e)??l.getCellFormat,getKnownFormat:e.getKnownFormat?.bind(e)??l.getKnownFormat,getIformat:e.getIformat?.bind(e)??l.getIformat,getFormatString:e.getFormatString?.bind(e)??l.getFormatString,getContainingTable:e.getContainingTable?.bind(e)??l.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??l.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??l.getStructRefSpecialRef}}(e);return{globals:r,locals:t,config:e.config,localeInfo:t.config?.localeInfo??e.config.localeInfo,mathpack:e.config.mathpack,get document(){const e=t.originSheet;if(!(0,n.isSuccess)(e))throw new u(e);return e.value.document},get defaultFormat(){const e=S(this,i.KnownFormat.General);return o(!1,e,e.valueType,e.decimals)},get unitlessFormat(){const e=S(this,i.KnownFormat.General);return o(!0,e,e.valueType,e.decimals)},resolver:(0,i.createResolver)(r),multOrDivTainted:!1}}const d={[a.FormatValueType.General]:0,[a.FormatValueType.Number]:1,[a.FormatValueType.Currency]:2,[a.FormatValueType.Accounting]:2,[a.FormatValueType.Percentage]:3,[a.FormatValueType.Date]:4,[a.FormatValueType.Time]:5,[a.FormatValueType.Fraction]:6,[a.FormatValueType.Scientific]:7,[a.FormatValueType.Text]:8,[a.FormatValueType.Custom]:9};var m;!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(m||(m={}));const g={[i.WorksheetFuncId.INT]:m.Propagate,[i.WorksheetFuncId.MOD]:m.Propagate,[i.WorksheetFuncId.ROUND]:m.Propagate,[i.WorksheetFuncId.SUM]:m.Propagate,[i.WorksheetFuncId.TRUNC]:m.Propagate,[i.WorksheetFuncId.AVERAGE]:m.Propagate,[i.WorksheetFuncId.MAX]:m.Propagate,[i.WorksheetFuncId.MEDIAN]:m.Propagate,[i.WorksheetFuncId.MIN]:m.Propagate,[i.WorksheetFuncId.ROUNDUP]:m.Propagate,[i.WorksheetFuncId.ROUNDDOWN]:m.Propagate,[i.WorksheetFuncId.NPV]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.PV]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.FV]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.PMT]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.RATE]:i.KnownFormat.Pct0,[i.WorksheetFuncId.MIRR]:i.KnownFormat.Pct0,[i.WorksheetFuncId.IRR]:i.KnownFormat.Pct0,[i.WorksheetFuncId.DATE]:i.KnownFormat.MMDDYY,[i.WorksheetFuncId.TIME]:i.KnownFormat.HHMMAP,[i.WorksheetFuncId.NOW]:i.KnownFormat.MDYHMS,[i.WorksheetFuncId.SLN]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.SYD]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.DDB]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.IPMT]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.PPMT]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.TODAY]:i.KnownFormat.MMDDYY,[i.WorksheetFuncId.VDB]:i.KnownFormat.CoCurrencyDec,[i.WorksheetFuncId.DB]:i.KnownFormat.CoCurrencyDec},p=[[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.Percentage,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.Percentage,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Number,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.Currency,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Percentage,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Percentage,a.FormatValueType.Percentage,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Date,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Time,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Custom]],h=[[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.General,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.Number,a.FormatValueType.Currency,a.FormatValueType.Number,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Currency,a.FormatValueType.Currency,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Percentage,a.FormatValueType.Date,a.FormatValueType.Time,a.FormatValueType.Percentage,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Date,a.FormatValueType.Date,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Time,a.FormatValueType.Time,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Fraction,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Scientific,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Text,a.FormatValueType.Custom],[a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.General,a.FormatValueType.Custom]];function f(e,t){if("number"!=typeof t)return t;const r=e.globals.getIformat(e.document,t);if(!(0,n.isSuccess)(r))throw new u(r.reason);return r.value}function S(e,t){const r=e.globals.getKnownFormat(e.document,t);if(!(0,n.isSuccess)(r))throw new u(r.reason);return r.value}function v(e,t){if("number"==typeof t)return t;const r=e.globals.getFormatString(e.document,t.formatString);if(!(0,n.isSuccess)(r))throw new u(r.reason);return void 0!==r.value?r.value:t}function y(e,t,r){(0,n.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length);const[i,a]=t;return r(e,i,a)}function F(e,t,[r],[n]){const i=d[r.valueType],a=d[n.valueType],s=i<=a?t[i][a]:t[a][i],u=d[s],l=n.decimals>r.decimals?n.decimals:r.decimals;switch(u){case i:return o(!0,r.format,r.valueType,l);case a:return o(!0,n.format,n.valueType,l);default:return e.unitlessFormat}}function b(e,t,r){return F(e,h,t,r)}function C(e,t,r){const[n]=t,[s]=r;if(n.format===s.format&&n.valueType===s.valueType&&n.valueType===a.FormatValueType.Time)return o(!0,n.format,n.valueType,n.decimals);if(n.valueType===a.FormatValueType.Date&&s.valueType===a.FormatValueType.Time||n.valueType===a.FormatValueType.Time&&s.valueType===a.FormatValueType.Date){const t=S(e,i.KnownFormat.MDYHMS),{valueType:r,decimals:n}=t;return o(!0,t,r,n)}return F(e,p,t,r)}const k=e=>e.unitlessFormat;function E(e,[t],[r]){return t.format===r.format?o(!0,t.format,t.valueType,t.decimals):e.unitlessFormat}function A(e){return d[e]===d[a.FormatValueType.General]}class T{literalNode(e){switch(e.kind){case i.OperKind.String:case i.OperKind.Boolean:case i.OperKind.Error:case i.OperKind.Missing:return n.Pledge.resolve(this.context.defaultFormat);case i.OperKind.Number:const t=21,r=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),t),a=r.indexOf(this.context.localeInfo.decimalSeparator),s=a>=0?r.length-a-1:0,u=S(this.context,i.KnownFormat.General);return n.Pledge.resolve(o(!1,u,u.valueType,s));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}}arrayNode(e){return n.Pledge.resolve(this.context.defaultFormat)}appNode(e,t){if((0,i.isOperatorNode)(e))return n.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case i.OperatorId.Mul:case i.OperatorId.Div:return e.multOrDivTainted=!0,y(e,r,b);case i.OperatorId.Pow:return y(e,r,b);case i.OperatorId.Add:case i.OperatorId.Sub:return y(e,r,C);case i.OperatorId.Percent:{(0,n.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[t,a]=r[0];if(!(0,i.isNumberLiteralNode)(a))return e.defaultFormat;const{strong:s,decimals:u}=t,l=S(e,i.KnownFormat.Pct);return o(s,l,l.valueType,u)}case i.OperatorId.Pound:case i.OperatorId.At:return e.defaultFormat;case i.OperatorId.Neg:case i.OperatorId.Pos:{(0,n.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);const[e]=r[0];return e}case i.OperatorId.Lt:case i.OperatorId.Le:case i.OperatorId.Eq:case i.OperatorId.Ge:case i.OperatorId.Gt:case i.OperatorId.Ne:return y(e,r,k);case i.OperatorId.Isect:case i.OperatorId.Union:case i.OperatorId.Range:case i.OperatorId.Concat:return y(e,r,E);case i.OperatorId.And:case i.OperatorId.Or:case i.OperatorId.Xor:case i.OperatorId.Min:case i.OperatorId.Max:throw new u((0,i.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,n.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(this.context,e.id,t)));if((0,i.isWSFNode)(e)){const r=e.id,a=g[r]??m.Ignore,s=(0,i.getWorksheetFuncType)(r),u=(0,i.getArguments)(t);if((0,n.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,i.isValidArgsLength)(s,u.length)),a===m.Ignore)return n.Pledge.resolve(this.context.defaultFormat);if(a===m.Propagate)return 0===u.length?n.Pledge.resolve(this.context.defaultFormat):n.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((e=>{const t=e[0];let r=t.format,n=t.valueType,i=t.decimals;const a=!A(n);if(!t.strong&&a)return this.context.unitlessFormat;let s=a;for(let t=1;t<e.length;t+=1){const a=e[t],o=!A(a.valueType);if(!a.strong&&o)return this.context.unitlessFormat;s||(r=a.format,n=a.valueType,i=a.decimals,s=o)}return o(!0,r,n,i)}));const l=S(this.context,a),{valueType:c,decimals:d}=l;return n.Pledge.resolve(o(!0,l,c,d))}return this.lazyVisitFormulaNode(e)}letNode(e,t,r,i){return n.Pledge.resolve(this.context.defaultFormat)}lambdaNode(e,t,r,i){return n.Pledge.resolve(this.context.defaultFormat)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return n.Pledge.resolve(this.context.defaultFormat)}cellRefNode(e,t){const{resolution:r}=this.context.resolver.resolveCellRef(this.context.locals,(0,i.cellRefNode)(e,t));if(!(0,n.isSuccess)(r))throw(0,n.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==i.ResolveReasonKind.NoOriginSheet),new u(r.reason);const a=r.value;if(void 0===a)throw s;return(0,i.isSheetGridRange)(a)?n.Pledge.resolve(N(this.context,a)):n.Pledge.resolve(this.context.unitlessFormat)}fieldRefNode(e,t){return this.lazyVisitFormulaNode(e).bind((e=>this.context.defaultFormat))}structRefNode(e,t){const r=(0,i.structRefNode)(e,t),{resolution:a}=this.context.resolver.resolveStructRef(this.context.locals,r);if(!(0,n.isSuccess)(a)){if((0,n.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",a.reason.kind!==i.ResolveReasonKind.NoOriginSheet),a.reason.kind===i.ResolveReasonKind.EmptyIntersection)throw s;throw new u(a.reason)}const o=a.value;if(void 0===o)throw s;return n.Pledge.resolve(N(this.context,o))}missingNode(e){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")}badSequenceNode(e,t){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}badCharsNode(e,t){return(0,n.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")}operatorNode(e,t){return n.Pledge.resolve((0,i.operatorNode)(e,t))}wsfNode(e,t,r){return n.Pledge.resolve((0,i.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,i.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>n.Pledge.resolve(e).bind(this.visitFormulaNode)}}function R(e,t){return(0,i.reducePledge)(new T(e),t)}function N(e,t){const r=(0,i.sheetGridRangeAnchor)(t),s=e.globals.getCellFormat(r);if(!(0,n.isSuccess)(s))throw new u(s.reason);const l=s.value,c=f(e,l);if(!(0,i.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof l||c.source!==a.NumberFormatSource.Builtin))return e.defaultFormat;const{valueType:d,decimals:m}=c;return o(!0,l,d,m)}},1173:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=function(e){return{createFormat:(t,r)=>(0,o.createFormat)(e,t,"boolean"!=typeof r?r:r?l.NumberFormatSource.Builtin:l.NumberFormatSource.CustomString),applyFormat:(t,r,n)=>(0,o.applyFormat)(e,t,r,n),changeFormatDecimals:o.changeFormatDecimals,renderValue:(t,r)=>(0,u.renderValue)(e.config.mathpack,t,r),renderHashesValue:(e,t)=>(0,u.renderHashesValue)(e,t),renderFormulaBar(t,r,n,i){return(0,a.renderFormulaBar)(this,e,t,r,n,i)},parseGeneral:(t,r,n,i)=>(0,s.parseGeneral)(e,t,r,n,i),parseDate:(t,r)=>(0,s.parseDate)(e,t,r),parseEdit:(t,r)=>(0,n.parseEdit)(e,t,r),evalFormat:(t,r)=>(0,i.evalFormat)(e,t,r)}};const n=r(9471),i=r(1333),a=r(3556),o=r(9421),s=r(1616),u=r(4851),l=r(3739)},3556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=function(e,t,r,u,l,c){try{const{localeInfo:d}=t.config;switch(u.kind){case i.OperKind.Number:return function(e,t,r,u,l){if(l.isDate||l.isTime){const c=function(e,t,r,u,l){const{mathpack:c,localeInfo:d}=t.config;if(c.cond(u)<0)return(0,n.success)(void 0);let m="";const g=0!==c.fix(u)||l.isDate;let p=u;if(g){const l=c.trunc(u),g=(0,s.getFormatString)(e,t,r,(0,a.buildMMDDYYFormat)(d,!0),o.NumberFormatSource.CustomString);if(!(0,n.isSuccess)(g))return g;const h=(0,s.applyFormatAndRenderToString)(e,g.value,l);if(!(0,n.isSuccess)(h))return h;if("string"!=typeof h.value)return(0,n.success)(void 0);m+=h.value;const f=c.sub(u,l);(0,n.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,i.isErrorOper)(f)),p=f}if(c.cond(p)>0||l.isTime){g&&(m+="  ");const a=t.getKnownFormat(r,d.clock24Hour?i.KnownFormat.HHMMSS:i.KnownFormat.HHMMSSAP);if(!(0,n.isSuccess)(a))return a;const o=(0,s.applyFormatAndRenderToString)(e,a.value,p);if(!(0,n.isSuccess)(o))return o;if("string"!=typeof o.value)return(0,n.success)(void 0);m+=o.value}return(0,n.success)(m)}(e,(0,s.initUtilGlobals)(t),r,u,l);if(!(0,n.isSuccess)(c))return c;if(void 0!==c.value)return c.value,c}const{mathpack:c,localeInfo:d}=t.config;if(l.isPercent){const e=c.mul(u,c.fromNumber(100));return(0,i.isErrorOper)(e)?(0,n.failure)((0,i.notImplemented)(["renderFormulaBar % overflow"])):(0,n.success)(c.formatGeneral(d,e,21)+"%")}return(0,n.success)(c.formatGeneral(d,u,21))}(e,t,r,u,l);case i.OperKind.String:return(0,n.success)(c?"'"+u.value:u.value);case i.OperKind.Boolean:return(0,n.success)(u.value?d.trueName:d.falseName);case i.OperKind.Error:const m=d.errorNames[u.type];return null==m?(0,n.failure)((0,i.internal)(`No locale data for error type ${u.type}`)):(0,n.success)(m);case i.OperKind.Array:return(0,n.failure)((0,i.notImplemented)(["Array renderFormulaBar"]));case i.OperKind.Rich:return(0,n.failure)((0,i.notImplemented)(["Rich renderFormulaBar"]));case i.OperKind.Blank:return(0,n.success)("");default:return(0,n.assertNever)("calc.numfmt.renderFormulaBar: never value",u)}}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a=r(4243),o=r(3739),s=r(4759)},9421:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberFormatImpl=t.pictureCalendar=t.pictureNumberShape=void 0,t.createFormat=function(e,t,r){try{return(0,n.success)(new ge(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof me?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)(e))}},t.applyFormat=function(e,t,r,a){try{let o,u,l;const{localeInfo:c}=e.config;switch(r.kind){case i.OperKind.String:o=function(e){if(0===e.length)return!1;const t=(0,n.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?s.Alignment.Right:s.Alignment.Left,u=s.Clip.None,l=r;break;case i.OperKind.Number:o=t.isTextOnly?s.Alignment.Left:s.Alignment.Right,u=s.Clip.All,l=r;break;case i.OperKind.Boolean:o=s.Alignment.Center,u=s.Clip.All,l=(0,i.stringOper)(r.value?c.trueName:c.falseName);break;case i.OperKind.Blank:return(0,n.success)((0,s.formattedValue)([],void 0,s.Alignment.Left,s.Clip.All));case i.OperKind.Error:const e=c.errorNames[r.type];return null==e?(0,n.failure)((0,i.internal)(`No locale data for error type ${r.type}`)):(0,n.success)((0,s.formattedValue)([(0,s.formattedUnitString)(e)],void 0,s.Alignment.Center,s.Clip.All));case i.OperKind.Array:return(0,n.failure)((0,i.notImplemented)(["Array applyFormat"]));case i.OperKind.Rich:return(0,n.failure)((0,i.notImplemented)(["Rich applyFormat"]))}return t.apply(l,o,u,a)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case s.FormatValueType.General:return(0,n.failure)((0,i.notImplemented)(["changeDecimals General"]));case s.FormatValueType.Number:case s.FormatValueType.Currency:case s.FormatValueType.Accounting:case s.FormatValueType.Percentage:case s.FormatValueType.Scientific:if(0===e.decimals&&t<0)return n.successUndefined;const r=(0,n.fastMax)(0,e.decimals+t),a=e.synthesizeDecimals(r);return a.formatString===e.formatString?n.successUndefined:(0,n.success)(a);default:return n.successUndefined}}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a=r(5697),o=r(4851),s=r(3739),u=r(7420),{codePointMinusSign:l,codePointPlusSign:c,codePointDigitZero:d,codePointHash:m,codePointFullStop:g,codePointDigitOne:p,codePointDigitTwo:h,codePointLeftParen:f,codePointRightParen:S,codePointSmallT:v,codePointBackslash:y}=n.codePoint;var F;!function(e){e[e.WantPic=0]="WantPic",e[e.WantClose=1]="WantClose",e[e.Done=2]="Done"}(F||(F={}));const b={decimalSeparator:"NOTUSED"};function C(e,t,r,i){const{mantissa:a,exponent:o}=e.formatFixed(t,0,0);return(0,n.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",a.length<=o),(0,n.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==a.length||0===o),(0,u.convertDigitsShape)(o<r?(0,n.repeat)("0",r-o):"",i)+(0,u.convertNumberShape)(b,a+(0,n.repeat)("0",o-a.length),i)}function k(e,t,r,i,a){const{mantissa:o,exponent:s}=e.formatFixed(t,0,0);(0,n.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=s),(0,n.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===s);const l=((s<r?(0,n.repeat)("0",r-s):"")+o+(0,n.repeat)("0",s-o.length)).substring(0,i);return(0,u.convertDigitsShape)(l,a)}function E(e,t){const{mantissa:r,exponent:i}=e.formatFixed(t,0,0);return(0,n.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",r.length<=i),(0,n.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==r.length||0===i),""===r?"0":r.length<i?r+(0,n.repeat)("0",i-r.length):r}function A(e){const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];switch(n.kind){case s.FormattedUnitKind.Blank:case s.FormattedUnitKind.String:{let i=n.str;for(;r+1<e.length;){const t=e[r+1];if(t.kind!==n.kind)break;i+=t.str,r+=1}t.push({kind:n.kind,str:i});break}case s.FormattedUnitKind.Flexible:case s.FormattedUnitKind.General:t.push(n)}}return t}const T=e=>e.kind===s.FormattedUnitKind.Flexible,R={1:i.NumberShape.ChineseTrad1,2:i.NumberShape.ChineseTrad2,3:i.NumberShape.ChineseTrad3},N={1:i.NumberShape.ChineseSimp1,2:i.NumberShape.ChineseSimp2,3:i.NumberShape.ChineseSimp3},I={1:i.NumberShape.Japanese1,2:i.NumberShape.Japanese2,3:i.NumberShape.Japanese3},P={1:i.NumberShape.Korean1,2:i.NumberShape.Korean2,3:i.NumberShape.Korean3,4:i.NumberShape.Korean4};function O(e){return e+1}var M;!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(M||(M={}));const D=(0,n.partialArray)({[M.Ne]:"<>",[M.Le]:"<=",[M.Ge]:">=",[M.Eq]:"=",[M.Lt]:"<",[M.Gt]:">"}),w={[M.Ne]:i.OperatorId.Ne,[M.Le]:i.OperatorId.Le,[M.Ge]:i.OperatorId.Ge,[M.Eq]:i.OperatorId.Eq,[M.Lt]:i.OperatorId.Lt,[M.Gt]:i.OperatorId.Gt},_={[i.OperatorId.Ne]:M.Ne,[i.OperatorId.Le]:M.Le,[i.OperatorId.Ge]:M.Ge,[i.OperatorId.Eq]:M.Eq,[i.OperatorId.Lt]:M.Lt,[i.OperatorId.Gt]:M.Gt};var L;function x(e,t,r,n){for(let i=0;i<t.length;i+=1){const a=t[i];if(null==a)continue;if(n+a.length>r.length)continue;const o=r.substring(n,n+a.length);if(0===e.stringCompareCI(a,o))return Number(i)}}function K(e,t,r,i){for(let e=0;e<t.length;e+=1){const a=t[e];if(null!=a&&(0,n.stringStartsWith)(r,a,i))return Number(e)}return x(e,t,r,i)}function B(e,t){return e[t]??""}function W(e,t,r,i){const a=r.substring(i,i+(0,n.numCodeUnits)((0,n.stringCodePointAt)(r,i)));for(let r=0;r<t.length;r+=1){const i=t[r];if(null==i)continue;if(0===i.length)continue;const o=i.substring(0,(0,n.numCodeUnits)((0,n.stringCodePointAt)(i,0)));if(0===e.stringCompareCI(a,o))return!0}return!1}function U(e,t){let r=t.indexOf(B(e.pictureSingle,i.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(L||(L={}));const G=/^[0-9A-F]{1,8}$/i,j=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i;t.pictureNumberShape=(0,n.partialArray)({1:i.NumberShape.ASCII,2:i.NumberShape.ArabicIndic,3:i.NumberShape.ExtendedArabicIndic,4:i.NumberShape.Devanagari,5:i.NumberShape.Bengali,6:i.NumberShape.Gurmukhi,7:i.NumberShape.Gujarati,8:i.NumberShape.Oriya,9:i.NumberShape.Tamil,10:i.NumberShape.Telugu,11:i.NumberShape.Kannada,12:i.NumberShape.Malayalam,13:i.NumberShape.Thai,14:i.NumberShape.Lao,15:i.NumberShape.Tibetan,16:i.NumberShape.Myanmar,17:i.NumberShape.Ethiopic,18:i.NumberShape.Khmer,19:i.NumberShape.Mongolian,27:i.NumberShape.Japanese1,28:i.NumberShape.Japanese2,29:i.NumberShape.Japanese3,30:i.NumberShape.ChineseSimp1,31:i.NumberShape.ChineseSimp2,32:i.NumberShape.ChineseSimp3,33:i.NumberShape.ChineseTrad1,34:i.NumberShape.ChineseTrad2,35:i.NumberShape.ChineseTrad3,36:i.NumberShape.Korean1,37:i.NumberShape.Korean2,38:i.NumberShape.Korean3,39:i.NumberShape.Korean4}),t.pictureCalendar=(0,n.partialArray)({1:i.Calendar.Gregorian,2:i.Calendar.GregorianUS,3:i.Calendar.Japan,4:i.Calendar.Taiwan,5:i.Calendar.Korea,6:i.Calendar.Hijri,7:i.Calendar.Thai,8:i.Calendar.Hebrew,9:i.Calendar.GregorianMEFrench,10:i.Calendar.GregorianArabic,11:i.Calendar.GregorianXlitEnglish,12:i.Calendar.GregorianXlitFrench,22:i.Calendar.Persian,23:i.Calendar.UmAlQura});const V=Object.keys(s.CultureTag).reduce(((e,t)=>{const r=s.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function H(e){return e.toString(16).toUpperCase()}function q(e){return Number("0x"+e)}const z={culture:"en-US",tag:void 0},Q={culture:"fr-FR",tag:void 0},$={culture:"ar-IQ",tag:void 0},Y={culture:"ar-SA",tag:void 0},J={culture:"ar-DZ",tag:void 0},X={culture:"th-TH",tag:void 0},Z={[i.PictureSingle.Hour]:i.TimeDivision.Hour,[i.PictureSingle.HourTh]:i.TimeDivision.Hour,[i.PictureSingle.Minute]:i.TimeDivision.Minute,[i.PictureSingle.MinuteTh]:i.TimeDivision.Minute,[i.PictureSingle.Second]:i.TimeDivision.Second,[i.PictureSingle.SecondTh]:i.TimeDivision.Second};function ee(e){return e.kind===te.Char?e.formattedStr:void 0}var te;!function(e){e[e.Char=400]="Char",e[e.Fraction=401]="Fraction",e[e.Exp=402]="Exp",e[e.Num=403]="Num",e[e.FracSeconds=404]="FracSeconds",e[e.DateSep=405]="DateSep",e[e.TimeSep=406]="TimeSep",e[e.SysFormat=407]="SysFormat"}(te||(te={}));const re={kind:L.General};function ne(e){return 1===e.length&&e[0].kind===L.General}var ie,ae,oe;!function(e){e[e.Num=0]="Num",e[e.Date=1]="Date",e[e.Fraction=2]="Fraction",e[e.Percent=3]="Percent",e[e.Exp=4]="Exp",e[e.Text=5]="Text",e[e.General=6]="General",e[e.Other=7]="Other"}(ie||(ie={})),function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(ae||(ae={})),function(e){e[e.Unknown=0]="Unknown",e[e.Either=1]="Either",e[e.Number=2]="Number",e[e.Text=3]="Text"}(oe||(oe={}));const se={code:[re],color:void 0,dbnum:void 0,dtrRounding:i.Rounding.RoundSec};function ue(e){return void 0===e.color&&void 0===e.dbnum&&ne(e.code)}const le={},ce=(0,i.createFailureErrorClass)("ApplyHashesError"),de=(0,i.createFailureErrorClass)("ApplyError"),me=(0,i.createFailureErrorClass)("InitError");class ge{get isPercent(){return this.hasPercent}get isDate(){return this.hasDate}get isTime(){return this.hasTime}get isTextOnly(){return!this.posBeforeText}get isInputDependent(){return this.isInputDependentFormat()}get culture(){return this.thisCurrCode}get currencySymbol(){return this.thisCurrencySymbol}apply(e,t,r,i){try{return(0,n.success)(this.applyImpl(e,t,r,i))}catch(e){return e instanceof de?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)((0,n.prependErrorMessage)(e,`(while applying format ${this.logFormatString})`)))}}isInputDependentFormat(){for(const e of this.parts)for(const t of e.code)switch(t.kind){case L.General:case L.AMPM:case L.AMPMFE:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Text:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case te.Fraction:case te.Exp:case te.Num:case te.SysFormat:case te.FracSeconds:case i.PictureSingle.Question:return!0;case te.DateSep:case te.TimeSep:case te.Char:case L.LatinDate:case i.PictureSingle.Decimal:case i.PictureSingle.Percent:case L.BidiDate:case L.Currency:case L.CurrCode:case L.StrLit:case L.Numeral:case L.PrefixDigTh:case L.Exp:case i.PictureSingle.Slash:case i.PictureSingle.Star:case i.PictureSingle.Underscore:}return!1}applyImpl(e,t,r,a){const{mathpack:o,localeInfo:u}=this.config;if(this.valueType===s.FormatValueType.General){const n=void 0;if((0,i.isStringOper)(e))return(0,s.formattedValue)([(0,s.formattedUnitString)(e.value)],n,t,r);if(!a&&0===o.cond(e))return(0,s.formattedValue)([],n,t,r);const l=(0,s.formattedUnitGeneral)(o.toNumber(e),u.decimalSeparator,!0,i.NumberShape.ASCII,i.NumberShape.ASCII,!0);return(0,s.formattedValue)([l],n,t,r)}let l=!1;for(;;){let u;try{let n,m=!1;const g=[];if((0,i.isStringOper)(e))n=ae.Text;else{const t=o.cond(e);void 0!==this.condPos||void 0!==this.condNeg?({partKind:n,forceNeg:m}=this.getPart(e)):n=t<0?ae.Neg:t>0?ae.Pos:ae.Zero,t<0&&(this.onlyOneNumberPart||m)&&g.push((0,s.formattedUnitString)("-"))}u=this.parts[n];const{color:p,dbnum:h,code:f,dtrRounding:S}=u;if(!a&&n===ae.Zero&&u===this.parts[ae.Pos]&&!l)return(0,s.formattedValue)([],p,t,r);const v=this.getNumShape(h);this.applyPart({dtrRounding:S,dbnum:h,forceNeg:m,units:g,numShape:v,bidiDate:void 0},f,e,void 0);const y=r|(n!==ae.Text||ue(u)||(d=void 0,void 0===(c=u).color&&void 0===c.dbnum&&1===(d=c.code).length&&d[0].kind===i.PictureSingle.Text)?s.Clip.None:s.Clip.MaxChars),F=g.some(T)?s.Alignment.Left:t;return(0,s.formattedValue)(A(g),p,F,y)}catch(t){if(t===le){(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,i.isStringOper)(e)&&0!==o.cond(e)),e=o.zero,l=!0;continue}if(t instanceof ce)return(0,s.hashesValue)(t.reason,u?.color);throw t}}var c,d}applyPart(e,t,r,a){const{mathpack:l,datepack:c,localeInfo:d}=this.config,m=this.applyCurrCode?.calendar??i.Calendar.Gregorian;let g;const p=()=>{if(void 0!==g)return g;(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,i.isStringOper)(r));const{date1904:t,dateCompatibility:a}=this.config;if(!a&&l.cond(r)<0)throw new ce(s.dateOverflow);if(a&&l.cond(r)<0){if(t)throw new de((0,i.notImplemented)(["negative date 1904"]));throw new ce(s.dateOverflow)}const o=c.fromNum(this.config,l.abs(r),e.dtrRounding);if(!1===o)throw new ce(s.dateOverflow);switch(m){case i.Calendar.Gregorian:case i.Calendar.GregorianUS:case i.Calendar.GregorianMEFrench:case i.Calendar.GregorianArabic:case i.Calendar.GregorianXlitEnglish:case i.Calendar.GregorianXlitFrench:break;case i.Calendar.Thai:o.yr+=543;break;default:throw new de((0,i.notImplemented)(["calendar: "+m]))}return(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",o.yr>=0&&o.mon>=1&&o.mon<=12&&o.dom>=0&&o.dom<=31&&o.hour>=0&&o.hour<=23&&o.min>=0&&o.min<=59&&o.sec>=0&&o.sec<=59&&o.fracSec>=0&&o.wdy>=1&&o.wdy<=7),g=o},h=()=>{if(void 0!==g)throw new de((0,i.notImplemented)(["use of value after date component"]));return r};let f=!1,S=e.numShape;const v=e.units;for(let g=0;g<t.length;g+=1){const y=t[g];switch(y.kind){case L.General:{f=!0;const t=h();if((0,i.isStringOper)(t))v.push((0,s.formattedUnitString)(t.value));else{const r=l.abs(t);if(l.cond(t)<0&&"0"===l.formatGeneral(d,r,1))throw new de((0,i.notImplemented)(["potential LRestart in interval (-0.5,0)"]));const a=(0,s.formattedUnitGeneral)(l.toNumber(r),d.decimalSeparator,!1,S,this.getNumShape(void 0),this.valueType===s.FormatValueType.General);if(void 0!==e.dbnum){const e=(0,o.renderGeneral)(l,a,255);(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==e),v.push((0,s.formattedUnitString)(e));break}v.push(a)}break}case i.PictureSingle.Text:{const e=h();(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,i.isStringOper)(e)),v.push((0,s.formattedUnitString)(e.value));break}case L.Exp:case i.PictureSingle.Slash:case te.Char:v.push((0,s.formattedUnitString)(y.formattedStr));break;case i.PictureSingle.Star:v.push((0,s.formattedUnitFlexible)(y.escaped));break;case i.PictureSingle.Underscore:v.push((0,s.formattedUnitBlank)(y.escaped));break;case L.StrLit:v.push((0,s.formattedUnitString)(y.escaped));break;case i.PictureSingle.Percent:case L.Numeral:v.push((0,s.formattedUnitString)(y.formattedStr));break;case L.Currency:v.push((0,s.formattedUnitString)(d.currencySymbol));break;case L.CurrCode:{const{currencySymbol:e,currCode:t}=y;(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,s.isSystemCultureTag)(t?.tag)),void 0!==e&&v.push((0,s.formattedUnitString)(e));break}case te.DateSep:v.push((0,s.formattedUnitString)(d.dateSeparator));break;case te.TimeSep:y.printAsTimeSep?v.push((0,s.formattedUnitString)(d.timeSeparator)):v.push((0,s.formattedUnitString)(y.formattedStr));break;case te.Num:{const t=h();(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,i.isStringOper)(t)),(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===a);const{numDigLeft:r,numDigDec:o,numPercent:s,numThousands:u}=y,c=2*s-3*u,{mantissa:d,exponent:m}=l.formatFixed(t,c,o);if((0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==d.length||0===m),(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",d.length<=m+o),l.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===d.length)throw le;this.applyPart(e,y.codeBefore,l.zero,void 0),this.applyPart(e,y.code,l.zero,{comma:y.comma,fractionDenom:!1,decimal:!1,digits:d,digitsExp:m,numDigLeft:r});break}case te.Exp:{const t=h();(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,i.isStringOper)(t)),(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===a);const{numMantDigLeft:r,numMantDigDec:o}=y,u=0===r&&0===o,{mantissa:c,exponent:d}=l.formatScientific(t,r,o);(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==c.length||0===d||u);const m=(0,i.formatScientificLeft)(d,r);(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",c.length<=m+o),this.applyPart(e,y.codeMant,l.zero,{comma:y.commaMant,fractionDenom:!1,decimal:!1,digits:c,digitsExp:m,numDigLeft:y.numMantDigLeft}),this.applyPart(e,y.codeBetween,l.zero,void 0);const g=""!==c||u?d-m:0;g<0?v.push((0,s.formattedUnitString)("-")):y.isNeg||v.push((0,s.formattedUnitString)("+"));const p=E(l,l.fromNumber(g));this.applyPart(e,y.codeExp,l.zero,{comma:y.commaMant,fractionDenom:!1,decimal:!1,digits:p,digitsExp:p.length,numDigLeft:y.numExpDigLeft});break}case te.Fraction:{const t=h();(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,i.isStringOper)(t)),(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===a);const{numPercent:r,numThousands:o,numIntDigLeft:u,numNumerDig:c,numDenomDig:d,commaInt:m,denomValue:g}=y,p=2*r-3*o,f=l.tenTo(p),S=(0,i.isErrorOper)(f)?f:l.mul(l.abs(t),f);if((0,i.isErrorOper)(S))throw new de((0,i.notImplemented)(["overflow on fraction exp adjust"]));const F=e=>{for(let t=e;t<v.length;t+=1){const e=v[t];e.kind===s.FormattedUnitKind.String&&(v[t]=(0,s.formattedUnitBlank)(e.str))}};let b,C,k,A=y.anyZeroNumer;if(void 0!==y.codeInt){let t=l.trunc(S);const r=l.sub(S,t);if((0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,i.isNumberOper)(r)),({numer:b,denom:C}=this.formFraction(r,g,d)),(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",l.cond2(b,C)<=0),0===l.cond2(b,C)){b=l.zero;const e=l.add(t,l.one);(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,i.isNumberOper)(e)),t=e}0!==l.cond(b)&&(A=!0);const a=E(l,t),o={comma:m,fractionDenom:!1,decimal:!1,digits:a,digitsExp:a.length,numDigLeft:u},s=v.length;this.applyPart(e,y.codeInt,l.zero,o),k=v.length,(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==y.lastDigInt),0===l.cond(t)&&A&&y.lastDigInt!==i.PictureSingle.Zero?(y.lastDigInt!==i.PictureSingle.Question&&(v.length=s),this.applyPart(e,y.codeBetween1,l.zero,void 0),F(s),y.firstDigNumer!==i.PictureSingle.Question&&(v.length=s)):this.applyPart(e,y.codeBetween1,l.zero,void 0)}else{if(({numer:b,denom:C}=this.formFraction(S,g,d)),l.cond(t)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===l.cond(b))throw le;A=!0,k=v.length}const T=E(l,b),R={comma:!1,fractionDenom:!1,decimal:!1,digits:T,digitsExp:T.length,numDigLeft:c};this.applyPart(e,y.codeNumer,l.zero,R),this.applyPart(e,y.codeBetween2,l.zero,void 0);const N=E(l,C),I={comma:!1,fractionDenom:!0,decimal:R.decimal,digits:N,digitsExp:N.length,numDigLeft:d};this.applyPart(e,y.codeDenom,l.zero,I),A||(y.anyQuestionNumer||y.firstDigDenom===i.PictureSingle.Question?F(k):v.length=k);break}case i.PictureSingle.Decimal:(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==a),a.digitsExp>0&&(a.numDigLeft=a.digitsExp,this.dumpDigLeft(e,a,a.digitsExp)),a.decimal=!0,v.push((0,s.formattedUnitString)(d.decimalSeparator));break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:{(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==a);let r=y.count;if(a.decimal||a.fractionDenom&&y.kind===i.PictureSingle.Question){if(a.fractionDenom&&g!==t.length-1)throw new de((0,i.notImplemented)(["left-align bug in denominator"]));if(a.digitsExp<0){const e=(0,n.fastMin)(r,-a.digitsExp),t=(0,u.convertDigitsShape)((0,n.repeat)("0",e),S);v.push((0,s.formattedUnitString)(t)),a.digitsExp+=e,r-=e}{const e=(0,n.fastMin)(r,a.digits.length),t=(0,u.convertDigitsShape)(a.digits.substring(0,e),S);v.push((0,s.formattedUnitString)(t)),a.digits=a.digits.substring(e),r-=e}if(y.kind!==i.PictureSingle.Hash&&r>0){const e=(0,u.convertDigitsShape)((0,n.repeat)("0",r),S);v.push(y.kind===i.PictureSingle.Question?(0,s.formattedUnitBlank)(e):(0,s.formattedUnitString)(e))}break}if(a.numDigLeft>a.digitsExp){const e=(0,n.fastMin)(r,a.numDigLeft-a.digitsExp);if(y.kind!==i.PictureSingle.Hash){let t=(0,u.convertDigitsShape)((0,n.repeat)("0",e),S);a.comma&&(t=(0,u.insertCommas)(d,t,a.numDigLeft-e)),v.push(y.kind===i.PictureSingle.Question?(0,s.formattedUnitBlank)(t):(0,s.formattedUnitString)(t))}r-=e,a.numDigLeft-=e}else r+=a.digitsExp-a.numDigLeft,a.numDigLeft=a.digitsExp;this.dumpDigLeft(e,a,r);break}case L.PrefixDigTh:d.isThai&&(S=e.numShape=i.NumberShape.Thai);break;case L.LatinDate:this.hasTokenCurrCode||(e.bidiDate=s.BidiDate.English);break;case L.BidiDate:throw new de((0,i.notImplemented)(["TokenKind.BidiDate"]));case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:{const t=y.kind===i.PictureSingle.HourTh||y.kind===i.PictureSingle.MinuteTh||y.kind===i.PictureSingle.SecondTh,r=t&&!this.hasTokenCurrCode?i.NumberShape.Thai:S;if(y.isAbs){const a=h();if((0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,i.isStringOper)(a)),t&&this.hasTokenCurrCode)throw new de((0,i.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));const o=c.toTime(this.config,l.abs(a),Z[y.kind],e.dtrRounding);if(!1===o)throw new de((0,i.notImplemented)(["absolute time overflow"]));v.push((0,s.formattedUnitString)(C(l,l.fromNumber(o),y.count,r)))}else{const e=p();let t;if(y.kind===i.PictureSingle.Minute||y.kind===i.PictureSingle.MinuteTh)t=e.min;else if(y.kind===i.PictureSingle.Second||y.kind===i.PictureSingle.SecondTh)t=e.sec;else if(t=e.hour,y.isAMPM){if(y.kind===i.PictureSingle.HourTh)throw new de((0,i.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));t>12&&(t-=12),0===t&&(t=12)}v.push((0,s.formattedUnitString)(C(l,l.fromNumber(t),y.count,r)))}break}case L.AMPM:case L.AMPMFE:{let e;if(e=!!(0,i.isStringOper)(r)||p().hour<12,(!this.hasTokenCurrCode||y.kind===L.AMPMFE)&&(y.kind===L.AMPMFE||d.isEastAsia||y.pictureKind===i.PictureSpecial.AP2)){const t=U(d,y.tokenStr);v.push((0,s.formattedUnitString)(t[e?0:1]));break}const t=this.getBundledLocaleInfo("localised AM/PM string",i.Calendar.Gregorian,this.applyCurrCode);v.push((0,s.formattedUnitString)(t.ampmSymbols[e?0:1]));break}case te.FracSeconds:{const e=p();(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",e.rounding>=y.rounding);const t=k(l,l.fromNumber(e.fracSec),e.rounding,y.rounding,S);v.push((0,s.formattedUnitString)(d.decimalSeparator+t));break}case i.PictureSingle.Era:throw new de((0,i.notImplemented)(["PictureSingle.Era"]));case i.PictureSingle.EraYear:throw new de((0,i.notImplemented)(["PictureSingle.EraYear"]));case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Year:{const e=y.kind!==i.PictureSingle.YearTh&&y.kind!==i.PictureSingle.ThYear||this.hasTokenCurrCode?S:i.NumberShape.Thai,t=(y.kind===i.PictureSingle.YearTh||y.kind===i.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,r=p().yr+(t?543:0),n=y.count>2?r:r%100;v.push((0,s.formattedUnitString)(C(l,l.fromNumber(n),y.count,e)));break}case i.PictureSingle.Month:case i.PictureSingle.MonthTh:{const t=p().mon;switch(y.count){case 1:case 2:{const e=y.kind!==i.PictureSingle.MonthTh||this.hasTokenCurrCode?S:i.NumberShape.Thai;v.push((0,s.formattedUnitString)(C(l,l.fromNumber(t),y.count,e)));break}case 3:case 4:case 5:{let r;if(r=e.bidiDate===s.BidiDate.English?(0,i.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised month string",m,y.kind!==i.PictureSingle.MonthTh||this.hasTokenCurrCode?this.applyCurrCode:X),3===y.count)v.push((0,s.formattedUnitString)(r.monthNameShort[t-1]));else if(4===y.count||e.bidiDate===s.BidiDate.English)v.push((0,s.formattedUnitString)(r.monthNameLong[t-1]));else{const e=r.monthNameLong[t-1];v.push((0,s.formattedUnitString)(e.substring(0,(0,n.numCodeUnits)((0,n.stringCodePointAt)(e,0)))))}break}}break}case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:{const t=y.kind===i.PictureSingle.DayTh;if(y.count<3){const e=t&&!this.hasTokenCurrCode?i.NumberShape.Thai:S,r=p().dom;v.push((0,s.formattedUnitString)(C(l,l.fromNumber(r),y.count,e)))}else{const r=p().wdy;let n;if(n=e.bidiDate===s.BidiDate.English||!this.hasTokenCurrCode&&d.isEastAsia&&y.kind===i.PictureSingle.Day?(0,i.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",m,t&&!this.hasTokenCurrCode?X:this.applyCurrCode),t&&this.hasTokenCurrCode&&3===y.count)throw new de((0,i.notImplemented)(["fcDay3Th && fIntlNum bug"]));const a=3===y.count?n.dayNameShort[r-1]:n.dayNameLong[r-1];v.push((0,s.formattedUnitString)(a))}break}case te.SysFormat:(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===a),this.applyPart(e,y.codeSysFormat,r,a);break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",y)}}f&&h()}dumpDigLeft(e,t,r){const{localeInfo:i}=this.config,{units:a,numShape:o}=e;let l=r;{const e=(0,n.fastMin)(l,t.digits.length);let r=(0,u.convertDigitsShape)(t.digits.substring(0,e),o);t.comma&&(r=(0,u.insertCommas)(i,r,t.numDigLeft-e)),a.push((0,s.formattedUnitString)(r)),t.digits=t.digits.substring(e),l-=e,t.digitsExp-=e,t.numDigLeft-=e}if(l>0){let e=(0,u.convertDigitsShape)((0,n.repeat)("0",l),o);t.comma&&(e=(0,u.insertCommas)(i,e,t.numDigLeft-l)),a.push((0,s.formattedUnitString)(e)),t.digitsExp-=l,t.numDigLeft-=l}}getPart(e){const{mathpack:t}=this.config;for(let r=ae.Pos;r<ae.Zero;r+=1){const a=r;let o;if(r===ae.Pos){if(o=this.condPos,void 0===o&&t.cond(e)>0)return{partKind:a,forceNeg:!1}}else{if(this.parts[a]===this.parts[ae.Pos])throw new ce(s.noFormatPart);if(0===this.parts[ae.Pos].code.length)throw new de((0,i.notImplemented)(['emulation of ";[COND]foo" bug']));if(o=this.condNeg,void 0===o){if(this.parts[ae.Zero]===this.parts[ae.Pos])return(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:a,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===i.OperatorId.Eq};if(t.cond(e)<0)return{partKind:a,forceNeg:!1}}}if(void 0===o)continue;const{operator:u,operand:l}=o,c=t.sub(e,l);if((0,i.isErrorOper)(c))throw new de((0,i.notImplemented)(["overflow in condition check"]));if((0,i.applyComparison)(u,t.cond2(e,l)))switch(u){case i.OperatorId.Eq:return{partKind:a,forceNeg:!1};case i.OperatorId.Ne:case i.OperatorId.Gt:case i.OperatorId.Ge:return{partKind:a,forceNeg:!0};case i.OperatorId.Lt:return{partKind:a,forceNeg:t.cond(l)>0};case i.OperatorId.Le:return{partKind:a,forceNeg:t.cond(l)>=0}}}const r=ae.Zero;if(this.parts[r]===this.parts[ae.Pos])throw new ce(s.noFormatPart);return{partKind:r,forceNeg:!0}}getNumShape(e){const t=this.applyCurrCode;let r=t?.numberShape;if(void 0!==r)return r;if(void 0===e)return i.NumberShape.ASCII;const n=this.getBundledLocaleInfo("localised DBNUM culture",i.Calendar.Gregorian,t);return n.isEastAsia&&(n.isKorea?r=P[e]:n.isJapan?r=I[e]:n.isChinaT?r=R[e]:n.isChinaS&&(r=N[e])),r??i.NumberShape.ASCII}formFraction(e,t,r){const{mathpack:a}=this.config;if(void 0!==t){const r=a.fromNumber(137438953472);if((0,i.isErrorOper)(a.sub(e,r)))throw new de((0,i.notImplemented)(["overflow in fraction threshold check"]));if(a.cond2(e,r)<0){const t=a.mul(e,a.fromNumber(1.0000000000000002));(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,i.isNumberOper)(t)),e=t}const o=t,u=a.toNumber(o)<<1,l=a.mul(e,a.fromNumber(u));if(!(0,i.isNumberOper)(l))throw new de((0,i.notImplemented)(["overflow in fraction denom mul"]));const c=a.lfix(l);if(c<0||c>=65535)throw new ce(s.fractionOverflow);return{numer:a.fromNumber(c+1>>1),denom:o}}let o;switch(r){case 1:o=10;break;case 2:o=100;break;case 3:o=1e3;break;case 4:o=1e4;break;case 5:o=1e5;break;case 6:o=1e6;break;default:o=1e7}let u=a.fix(e);if(u>=2147483647)throw new ce(s.fractionOverflow);let l=e,c=1,d=1,m=0,g=0;for(;;){const e=c*u;g+=e;const t=m*u;if(d+=t,e>2147483647||t>2147483647||d>=o){1===m&&2===u&&0===a.cond2(l,a.trunc(l))&&(c+=1);break}[c,g]=[g,c],[m,d]=[d,m];const r=a.sub(l,a.trunc(l));if((0,n.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,i.isNumberOper)(r)),0===a.cond(r))break;const s=a.div(a.one,r);if((0,i.isErrorOper)(s))throw new de((0,i.notImplemented)(["overflow in fraction inversion"]));if(l=s,(u=a.fix(l))>2147483647)break}return 0===m&&(m=c=1),{numer:a.fromNumber(c),denom:a.fromNumber(m)}}synthesizeDecimals(e){const t=(0,n.fastMax)(0,(0,n.fastMin)(e,127)),r=[];for(let e=ae.Pos;e<=ae.Text;e+=1){const n=this.parts[e];if((e===ae.Neg||e===ae.Zero)&&n===this.parts[ae.Pos]){r.push(r[ae.Pos]);continue}if(e===ae.Text){r.push(n===this.parts[ae.Pos]?r[ae.Pos]:n);continue}const{code:i,color:a,dbnum:o,dtrRounding:s}=n,u={code:i.map((r=>{if(r.kind===te.Num){const{numDigLeft:n,numPercent:i,numThousands:a,comma:o,codeBefore:s}=r;return{kind:te.Num,numDigLeft:n,numDigDec:t,numPercent:i,numThousands:a,comma:o,code:this.adjustDecimals(e,r.numDigDec,r.code,t),codeBefore:s}}if(r.kind===te.Exp){const{isNeg:n,numMantDigLeft:i,numExpDigLeft:a,commaMant:o,codeBetween:s,codeExp:u}=r;return{kind:te.Exp,isNeg:n,numMantDigLeft:i,numMantDigDec:t,numExpDigLeft:a,commaMant:o,codeMant:this.adjustDecimals(e,r.numMantDigDec,r.codeMant,t),codeBetween:s,codeExp:u}}return r})),color:a,dbnum:o,dtrRounding:s};r.push(u)}try{const e=new ge(this.config,{old:this,logFormatString:`synthesizeDecimals(dec=${t} on ${this.logFormatString})`,synth:r});if(e.formatString.length>255)throw new me(this.notFormatString("format string too long: max length"));return e}catch(e){if(e instanceof me)return this;throw e}}adjustDecimals(e,t,r,a){if(a===t)return r;let o,s,u,l=!1;for(let e=0;e<r.length;e+=1){const t=r[e];switch(t.kind){case i.PictureSingle.Decimal:void 0===u&&(u=e);break;case i.PictureSingle.Hash:case i.PictureSingle.Question:case i.PictureSingle.Zero:void 0!==u?s=e:(o=e,t.kind===i.PictureSingle.Question&&(l=!0))}}const c=e=>e===i.PictureSingle.Percent||e===L.Currency||e===L.CurrCode||e===i.PictureSingle.Star;if(0===a){if(void 0===u)return r;let e=0,t=0;void 0===o?void 0!==s&&(e=u+1,t=s+1):(e=u,t=(s??u)+1);const i=r.slice(0,e);for(let n=e;n<t;n+=1)c(r[n].kind)&&i.push(r[n]);return(0,n.safePush)(i,r.slice(t)),i}if(t>a){let e;(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==u),function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(e||(e={}));let o=e.AfterDigs;const s=[];let l=t-a;for(let t=r.length-1;t>=0;t-=1){t<=u&&(o=e.Keeping);const a=r[t];if(o===e.AfterDigs&&(a.kind!==i.PictureSingle.Hash&&a.kind!==i.PictureSingle.Question&&a.kind!==i.PictureSingle.Zero||(o=e.Dropping)),o===e.Keeping||o===e.AfterDigs||c(a.kind))s.push(a);else if(a.kind===i.PictureSingle.Hash||a.kind===i.PictureSingle.Question||a.kind===i.PictureSingle.Zero){const t=(0,n.fastMin)(l,a.count);t<a.count&&s.push({kind:a.kind,count:a.count-t}),l-=t,0===l&&(o=e.Keeping)}}return s.reverse(),s}if(e===ae.Zero&&l&&void 0===s)return r;const d=a-t;if(void 0!==s){const e=r.slice(),t=e[s];return e[s]={kind:t.kind,count:t.count+d},e}const m=r.slice(),g=u??o??m.length-1,p=[];return void 0===u&&p.push({kind:i.PictureSingle.Decimal}),p.push({kind:i.PictureSingle.Zero,count:d}),m.splice(g+1,0,...p),m}parseString(e){if(this.source!==s.NumberFormatSource.CustomBytecode&&e.length>255)throw new me(this.notFormatString("format string too long: max length"));let t=!1,r=!1,a=0,o=!1;for(let c=ae.Pos;c<=ae.Text&&!o;c+=1){const d=this.tokenize(e.substring(a)),{cond:m,currencySymbol:g,hasTokenCurrCode:p}=d,h=this.convertTokToSun(d),{currCode:f,hasPercent:S,hasDate:v,hasTime:y}=h,F=this.classifySunPartKind(h,c===ae.Text?oe.Text:oe.Unknown),{part:b,applyCurrCode:C}=this.convertSunToCode(h);if(a+=d.consumed,o=d.eos,S&&(this.hasPercent=!0),v&&(this.hasDate=!0),y&&(this.hasTime=!0),p){if(!(c===ae.Pos||this.hasTokenCurrCode&&(u=this.thisCurrCode,l=f,u===l||void 0!==u&&void 0!==l&&(0,s.isFormatCultureEqual)(u,l))))throw new me((0,i.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=f)}if(void 0!==C&&void 0===this.applyCurrCode&&(this.applyCurrCode=C),void 0!==g&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=g),this.source===s.NumberFormatSource.System&&((0,n.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",c===ae.Pos),!o||F===oe.Text))throw new me(this.notFormatString("system format with more than one part"));if((F===oe.Text||c===ae.Pos&&F===oe.Either)&&(t=!0,this.parts[ae.Text]=b,F===oe.Text)){if(void 0!==m)throw new me(this.notFormatString("condition in text part"));if(void 0!==f)throw new me((0,i.notImplemented)(["CurrCode in text part"]));break}if(r=!0,this.parts[c]=b,this.onlyOneNumberPart=c===ae.Pos,c===ae.Pos)this.parts[ae.Neg]=b,this.parts[ae.Zero]=b,this.condPos=m;else if(c===ae.Neg)this.condNeg=m;else if(void 0!==m)throw new me(this.notFormatString("condition in zero part"))}var u,l;if(!o)throw new me(this.notFormatString("too many parts"));r||(this.parts[ae.Pos]=se,this.parts[ae.Neg]=se,this.parts[ae.Zero]=se,this.posBeforeText=!1),t||(this.parts[ae.Text]=se),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!ne(this.parts[ae.Pos].code)&&(this.parts[ae.Neg]=se,this.onlyOneNumberPart=!1),(0,n.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((e=>void 0!==e))),this.checkBytecode()}tokenize(e){const{localeInfo:t}=this.config,r={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};let n,a,o;for(;r.consumed<e.length&&r.eos;){const t=this.readToken(r,e,r.consumed),s=n;switch(n=t,r.consumed+=t.tokenStr.length,t.kind){case i.PictureSingle.Sep:r.eos=!1;continue;case L.Color:if(void 0!==r.color)throw new me(this.notFormatString("more than one color"));if(0!==r.tokens.length)throw new me((0,i.notImplemented)(["colour in middle of format"]));r.color=t.color;continue;case L.Dbnum:if(void 0!==r.dbnum)throw new me(this.notFormatString("more than one DBNUM"));if(r.dbnumForbidden)throw new me(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==r.tokens.length)throw new me((0,i.notImplemented)(["DBNUM in middle of format"]));r.dbnum=t.dbnum;continue;case L.Cond:if(void 0!==r.cond)throw new me(this.notFormatString("more than one condition"));if(0!==r.tokens.length)throw new me((0,i.notImplemented)(["condition in middle of format"]));r.cond=t.cond;continue;case L.CurrCode:if(void 0!==a)throw new me(this.notFormatString("more than one currency code in section"));a=t;break;case L.Currency:o=t;break;case L.AMPM:case L.AMPMFE:case i.PictureSingle.Colon:case i.PictureSingle.DateSep:case L.LatinDate:case L.BidiDate:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.EngYearTh:case i.PictureSingle.DayTh:case i.PictureSingle.MonthTh:case i.PictureSingle.YearTh:case i.PictureSingle.ThYear:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:if(s?.kind===t.kind){s.count+=t.count;continue}}r.tokens.push(t)}return void 0!==a?(r.hasTokenCurrCode=!0,r.currCode=a.currCode,r.currencySymbol=a.currencySymbol):void 0!==o&&void 0===r.currencySymbol&&(r.currencySymbol=s.FormatCurrency.LocaleInfo),4!==r.dbnum||t.isKorea||void 0===r.currCode&&!t.isThai||(r.dbnum=void 0),r}readToken(e,t,r){const{mathpack:a,localeInfo:o}=this.config,s=x(o,o.pictureSpecial,t,r);if(void 0!==s){let e=s;const n=B(o.pictureSpecial,e);o.isJapan&&e===i.PictureSpecial.GeneralOldMAC&&(e=i.PictureSpecial.General);const a=t.substring(r,r+n.length);switch(e){case i.PictureSpecial.AP1:case i.PictureSpecial.AP2:return{kind:L.AMPM,tokenStr:a,count:1,pictureKind:e};case i.PictureSpecial.AP3:return{kind:L.AMPMFE,tokenStr:a,count:1};case i.PictureSpecial.General:return{kind:L.General,tokenStr:a};case i.PictureSpecial.Currency:return{kind:L.Currency,tokenStr:a}}}const u=(0,n.stringCodePointAt)(t,r),F=(0,n.numCodeUnits)(u),b=t.substring(r,r+F),C=K(o,o.pictureSingle,t,r);if(void 0!==C){let s=C;if((o.isJapan||o.isChinaT)&&(s===i.PictureSingle.E||s===i.PictureSingle.EraYear)){let e,n;s=!(r+F+1<t.length)||(e=t.charCodeAt(r+F))!==l&&e!==c||(n=t.charCodeAt(r+F+1))!==d&&n!==m&&n!==g?i.PictureSingle.EraYear:i.PictureSingle.E}if(s===i.PictureSingle.BidiDate||s===i.PictureSingle.EngYearTh){let e;if(r+F<t.length&&((e=t.charCodeAt(r+F))===p||e===h))return{kind:e===p?L.LatinDate:L.BidiDate,tokenStr:t.substring(r,r+F+1),count:1};s=i.PictureSingle.EngYearTh}if(s===i.PictureSingle.BidiNum)throw new me(this.notFormatString("bidi num not allowed"));switch(s){case i.PictureSingle.Star:case i.PictureSingle.Underscore:{if(r+F>=t.length)throw new me(this.notFormatString("unterminated "+b));const e=(0,n.stringCodePointAt)(t,r+F),i=(0,n.numCodeUnits)(e),a=(0,n.stringFromCodePoint)(e);return{kind:s,tokenStr:t.substring(r,r+F+i),escaped:a}}case i.PictureSingle.Backslash:return this.readToken_Backslash(t,r,F);case i.PictureSingle.Quote:{const e=t.indexOf(b,r+F);if(e<0)throw new me(this.notFormatString("unterminated quoted string"));const n=t.substring(r+F,e),a=t.substring(r,e+F),s=x(o,o.pictureSpecial,n,0);return void 0!==s&&s===i.PictureSpecial.Currency&&B(o.pictureSpecial,s).length===n.length?{kind:L.Currency,tokenStr:a}:{kind:L.StrLit,tokenStr:a,escaped:n}}case i.PictureSingle.E:{if(o.isEastAsia){if(void 0!==e.dbnum)throw new me(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new me((0,i.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+F>=t.length)throw new me(this.notFormatString("unterminated exp"));const n=t.charCodeAt(r+F);if(n!==c&&n!==l)throw new me(this.notFormatString("exp not followed by sign"));const a=t.substring(r,r+F+1);return{kind:L.Exp,tokenStr:a,eStr:b,isNeg:n===l}}case i.PictureSingle.Hash:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.YearTh:case i.PictureSingle.MonthTh:case i.PictureSingle.DayTh:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Question:case i.PictureSingle.Comma:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:{if(s===i.PictureSingle.Reign&&!o.isJapan&&!o.isChinaT)break;let e=F,a=1;for(;(0,n.stringStartsWith)(t,b,r+e)&&void 0===x(o,o.pictureSpecial,t,r+e);)e+=F,a+=1;if(s===i.PictureSingle.LocDay&&a<3)break;return{kind:s,tokenStr:t.substring(r,r+e),count:a}}case i.PictureSingle.Sep:case i.PictureSingle.Text:case i.PictureSingle.Decimal:case i.PictureSingle.Slash:case i.PictureSingle.Minus:case i.PictureSingle.Plus:return{kind:s,tokenStr:b};case i.PictureSingle.Space:return{kind:L.Char,tokenStr:b,escaped:b};case i.PictureSingle.Colon:return{kind:s,tokenStr:b,count:1};case i.PictureSingle.Percent:if(o.isEastAsia){if(void 0!==e.dbnum)throw new me(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new me((0,i.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:i.PictureSingle.Percent,tokenStr:b};case i.PictureSingle.DateSep:return b===B(o.pictureSingle,i.PictureSingle.Slash)?{kind:i.PictureSingle.Slash,tokenStr:b}:b===B(o.pictureSingle,i.PictureSingle.Minus)?{kind:i.PictureSingle.Minus,tokenStr:b}:{kind:i.PictureSingle.DateSep,tokenStr:b,count:1};case i.PictureSingle.ColorStart:{const e=B(o.pictureSingle,i.PictureSingle.ColorEnd),u=t.indexOf(e,r+F);if(u<0)throw new me(this.notFormatString("unterminated ["));const l=t.substring(r+F,u),c=t.substring(r,u+e.length),d=x(o,D,l,0);if(void 0!==d){let e=B(D,d).length;for(;e<l.length&&(0,i.isSpace)(l.charCodeAt(e));)e+=1;const t=(0,i.parseSignedLiteral)(o,a,l,e,!1);if(t[1]===e)throw new me((0,i.notImplemented)(["invalid number in condition"]));if(t[1]!==l.length)throw new me((0,i.notImplemented)(["trailing junk after condition"]));return{kind:L.Cond,tokenStr:c,cond:{operator:w[d],operand:t[0]}}}const m=x(o,o.pictureColor,l,0);if(void 0!==m){const e=B(o.pictureColor,m);if(m!==i.PictureColor.Color){if(e.length!==l.length)throw new me((0,i.notImplemented)(["trailing junk after named color"]));return{kind:L.Color,tokenStr:c,color:(k=m,i.PictureColor[k])}}if(m===i.PictureColor.Color){let t=e.length;for(;t<l.length&&(0,i.isSpace)(l.charCodeAt(t));)t+=1;const[r,n]=(0,i.parseUint)(o,4,l,t);if(n===t)throw new me(this.notFormatString("missing number for numbered color"));if(n!==l.length)throw new me((0,i.notImplemented)(["trailing junk after numbered color"]));if(r<1||r>56)throw new me(this.notFormatString("out-of-range numbered color"));return{kind:L.Color,tokenStr:c,color:r+8}}}const g=x(o,o.pictureDbnum,l,0);if(void 0!==g){if(B(o.pictureDbnum,g).length!==l.length)throw new me((0,i.notImplemented)(["trailing junk after DBNUM"]));return{kind:L.Dbnum,tokenStr:c,dbnum:O(g)}}return(0,n.stringStartsWith)(l,"$")?{kind:L.CurrCode,tokenStr:c,...this.parseCurrCode(l.substring(1))}:{kind:s,tokenStr:b}}case i.PictureSingle.ColorEnd:return{kind:s,tokenStr:b};case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:return{kind:s,tokenStr:b,escaped:b};case i.PictureSingle.Extra:case i.PictureSingle.APDelim:case i.PictureSingle.Nen1:case i.PictureSingle.Gatsu1:case i.PictureSingle.Nichi1:case i.PictureSingle.Nen2:case i.PictureSingle.Gatsu2:case i.PictureSingle.Nichi2:case i.PictureSingle.Zero:case i.PictureSingle.ZeroTh:break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",s)}}var k;if(o.isNumeral(u)){if(o.getNumberShape(u)!==i.NumberShape.ASCII)throw new me((0,i.notImplemented)(["non-ASCII digits"]));const e=o.getOrdinal(u);if(0===e){let e=F,a=1;for(;(0,n.stringStartsWith)(t,b,r+e);)e+=F,a+=1;const o=t.substring(r,r+e);return{kind:i.PictureSingle.Zero,tokenStr:o,count:a}}return{kind:L.Numeral,tokenStr:b,ordinal:e}}switch(u){case f:return{kind:i.PictureSingle.OpenParen,tokenStr:b,escaped:b};case S:return{kind:i.PictureSingle.CloseParen,tokenStr:b,escaped:b};case y:return this.readToken_Backslash(t,r,F);case v:if(o.isThai)return{kind:L.PrefixDigTh,tokenStr:b}}return{kind:L.Char,tokenStr:b,escaped:b}}readToken_Backslash(e,t,r){if(t+r>=e.length)throw new me(this.notFormatString("unterminated backslash"));const a=(0,n.stringCodePointAt)(e,t+r),o=(0,n.numCodeUnits)(a),s=(0,n.stringFromCodePoint)(a),u=e.substring(t,t+r+o);return a===f||a===S?{kind:a===f?i.PictureSingle.OpenParen:i.PictureSingle.CloseParen,tokenStr:u,escaped:s}:{kind:L.Char,tokenStr:u,escaped:s}}convertTokToSun({color:e,dbnum:t,cond:r,currCode:a,tokens:o}){const{localeInfo:s}=this.config,u={suns:[],dtrRounding:i.Rounding.RoundSec,color:e,dbnum:t,currCode:a,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===r&&void 0===e&&void 0===t&&void 0===a}},l=0===s.stringCompareCI(B(s.pictureSingle,i.PictureSingle.Month),B(s.pictureSingle,i.PictureSingle.Minute));let c,d,m,g,p,h=!1,f=0,S=0,v=!1,y=!1,b=!1,C=!1,k=0;const E=(e,t)=>{const r=Z[e];if(t){if(y)throw new me(this.notFormatString("more than one absolute time"));if(void 0!==c&&r>=c)throw new me(this.notFormatString("absolute time must be largest division"));y=!0}else if(y&&r<=c)throw new me((0,i.notImplemented)(["larger time division after absolute time"]));(void 0===c||r<c)&&(c=r)};function A(e,t,r){const a=c;if(E(e,t),e===i.PictureSingle.Hour||e===i.PictureSingle.HourTh)b=!0,g=r,p=void 0;else if(e===i.PictureSingle.Second||e===i.PictureSingle.SecondTh)if(void 0===p||y)void 0===a&&(b=!0);else{const e=p.code[0];(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",e.kind===i.PictureSingle.Month);const t=i.PictureSingle.Minute,r=e.count;(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===r||2===r);const a=!1;E(t,a),f-=1,S+=1,p.code=[{kind:t,count:r,isAbs:a}],p=void 0}else b=!1}function T(e){const t=B(s.pictureSingle,e.kind);return{kind:te.TimeSep,printAsTimeSep:f>0||S>0,formattedStr:t}}function R(e){const t=B(s.pictureSingle,e.kind);return t===B(s.pictureSingle,i.PictureSingle.DateSep)?{kind:te.DateSep}:t===B(s.pictureSingle,i.PictureSingle.Colon)?T(e):{kind:te.Char,formattedStr:t}}for(let e=0;e<o.length;e+=1){const t=o[e];switch(t.kind){case L.AMPM:case L.AMPMFE:case i.PictureSingle.Colon:case i.PictureSingle.DateSep:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case i.PictureSingle.Reign:case i.PictureSingle.LocDay:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.EngYearTh:case L.LatinDate:case L.BidiDate:case i.PictureSingle.DayTh:case i.PictureSingle.MonthTh:case i.PictureSingle.YearTh:case i.PictureSingle.ThYear:case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:{const r={kind:ie.Date,code:[]};switch(u.suns.push(r),v=!0,t.kind){case L.LatinDate:case L.BidiDate:if(0!==e&&(1!==e||o[0].kind!==L.CurrCode))throw new me(this.notFormatString("bidi date must be first"));r.code.push(t);break;case i.PictureSingle.DateSep:r.code.push({kind:te.DateSep});break;case i.PictureSingle.Colon:r.code.push(T(t));break;case i.PictureSingle.Reign:f+=1,s.isJapan&&t.count>=2&&r.code.push({kind:i.PictureSingle.Era,count:3}),r.code.push({kind:i.PictureSingle.EraYear,count:s.isChinaT?1:2});break;case i.PictureSingle.Era:f+=1,r.code.push({kind:i.PictureSingle.Era,count:(0,n.fastMin)(3,t.count)});break;case i.PictureSingle.EraYear:f+=1,r.code.push({kind:i.PictureSingle.EraYear,count:(0,n.fastMin)(2,t.count)});break;case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:p=void 0,f+=1,r.code.push({kind:t.kind,count:t.count<=2?2:4});break;case i.PictureSingle.Month:if(l&&t.count<=2){if(b){const e=i.PictureSingle.Minute,n=!1;A(e,n,r),S+=1,r.code.push({kind:e,count:t.count,isAbs:n}),b=!1;break}p=r}else p=void 0;f+=1,r.code.push({kind:t.kind,count:(0,n.fastMin)(5,t.count)});break;case i.PictureSingle.MonthTh:f+=1,r.code.push({kind:t.kind,count:(0,n.fastMin)(4,t.count)});break;case i.PictureSingle.Day:case i.PictureSingle.DayTh:p=void 0,f+=1,r.code.push({kind:t.kind,count:(0,n.fastMin)(4,t.count)});break;case i.PictureSingle.LocDay:p=void 0,f+=1,r.code.push({kind:i.PictureSingle.LocDay,count:3===t.count?3:4});break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:{const e=!1;A(t.kind,e,r),S+=1;const a=(0,n.fastMin)(2,t.count);t.kind===i.PictureSingle.Hour||t.kind===i.PictureSingle.HourTh?r.code.push({kind:t.kind,count:a,isAbs:e,isAMPM:!1}):r.code.push({kind:t.kind,count:a,isAbs:e});break}case L.AMPM:case L.AMPMFE:if(y)throw new me(this.notFormatString("AM/PM after absolute time"));if(t.count>1)throw new me((0,i.notImplemented)(["multiple AM/PM symbols"]));void 0!==g&&(g.code[0].isAMPM=!0,g=void 0),C=!0,r.code.push(t);break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",t)}break}case i.PictureSingle.Decimal:case L.Numeral:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case i.PictureSingle.Comma:{if(v){if(t.kind!==i.PictureSingle.Decimal&&t.kind!==i.PictureSingle.Comma)throw new me(this.notFormatString("number picture in date/time format"));const r={kind:ie.Date,code:[]};u.suns.push(r);const a=o[e+1];if(t.kind===i.PictureSingle.Decimal&&a?.kind===i.PictureSingle.Zero){const t=a.count;if(t>3)throw new me(this.notFormatString("invalid number of fractional seconds"));e+=1,A(i.PictureSingle.Second,!1,r),S+=1,r.code.push({kind:te.FracSeconds,rounding:t}),u.dtrRounding=(0,n.fastMax)(u.dtrRounding,t)}else r.code.push(R(t));break}if(t.kind===i.PictureSingle.Comma){const e=B(s.pictureSingle,t.kind),r={kind:ie.Other,code:[{kind:te.Char,formattedStr:e}]};u.suns.push(r);break}const r=e=>e===L.Numeral||e===i.PictureSingle.Hash||e===i.PictureSingle.Zero||e===i.PictureSingle.Question,a={kind:ie.Num,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};let l;for(u.suns.push(a),void 0===d&&(d=a),m=a,e-=1;e+1<o.length;e+=1){const t=o[e+1];let n=!0;switch(t.kind){case i.PictureSingle.Decimal:h=a.decimal=!0,a.code.push(t),l=void 0;break;case L.Numeral:a.code.push({kind:t.kind,formattedStr:t.tokenStr,ordinal:t.ordinal}),a.numVal=a.nonZero=!0,l=void 0;break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:if(a.decimal?a.numDigDec+=t.count:a.numDigLeft+=t.count,void 0===a.firstDig&&(a.firstDig=t.kind),a.lastDig=t.kind,t.kind===i.PictureSingle.Hash?a.anyHash=!0:t.kind===i.PictureSingle.Question?a.anyQuestion=!0:(a.anyZero=!0,a.numVal=!0),void 0!==l&&l.kind===t.kind)l.count+=t.count;else{const e={kind:t.kind,count:t.count};a.code.push(e),l=e}break;case i.PictureSingle.Comma:const u=o[e+2]?.kind;if(r(u))h||(a.comma=!0);else{let e=t.count;const r=B(s.pictureSingle,i.PictureSingle.Space);r===B(s.pictureSingle,i.PictureSingle.Comma)&&(!s.isCurrencySymbolLead&&s.isCurrencySepBySpace&&u===L.Currency||s.isPercentSepBySpace&&u===i.PictureSingle.Percent)&&(a.code.push({kind:te.Char,formattedStr:r}),e-=1),e>0&&(a.numThousands+=e)}break;default:n=!1}if(!n)break}break}case i.PictureSingle.Percent:{k+=1;const e={kind:ie.Percent,code:[{kind:i.PictureSingle.Percent,formattedStr:t.tokenStr}]};u.suns.push(e),u.hasPercent=!0;break}case L.Exp:{const e={kind:ie.Exp,code:[{kind:L.Exp,formattedStr:t.eStr,isNeg:t.isNeg}],isNeg:t.isNeg};u.suns.push(e);break}case L.General:{const e={kind:ie.General,code:[t]};u.suns.push(e);break}case i.PictureSingle.Text:{const e={kind:ie.Text,code:[t]};u.suns.push(e);break}case i.PictureSingle.Slash:{if(v){const e={kind:ie.Date,code:[R(t)]};u.suns.push(e);break}const e={kind:ie.Fraction,code:[{kind:i.PictureSingle.Slash,formattedStr:t.tokenStr}]};u.suns.push(e);break}case i.PictureSingle.Star:case L.PrefixDigTh:case i.PictureSingle.Underscore:case L.Currency:case L.CurrCode:case L.StrLit:{const e={kind:ie.Other,code:[t]};u.suns.push(e);break}case i.PictureSingle.ColorEnd:case i.PictureSingle.Plus:{const e={kind:ie.Other,code:[{kind:te.Char,formattedStr:t.tokenStr}]};u.suns.push(e);break}case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:case L.Char:{const e={kind:ie.Other,code:[{kind:te.Char,formattedStr:t.escaped}]};u.suns.push(e);break}case i.PictureSingle.Minus:{if(v){const e={kind:ie.Date,code:[R(t)]};u.suns.push(e);break}const e=B(s.pictureSingle,t.kind),r={kind:ie.Other,code:[{kind:te.Char,formattedStr:e}]};u.suns.push(r);break}case i.PictureSingle.ColorStart:{let t=F.WantPic;const r={kind:ie.Date,code:[]};for(;e+1<o.length&&t!==F.Done;e+=1){const a=o[e+1];switch(a.kind){case i.PictureSingle.ColorEnd:if(t!==F.WantClose)throw new me(this.notFormatString("unexpected closing ]"));t=F.Done;continue;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Month:case i.PictureSingle.Minute:case i.PictureSingle.Second:{if(a.kind===i.PictureSingle.Month&&!l)break;const e=a.kind===i.PictureSingle.Month?i.PictureSingle.Minute:a.kind,o=!0;A(e,o,r),S+=1;const s=(0,n.fastMin)(2,a.count);e===i.PictureSingle.Hour||e===i.PictureSingle.HourTh?r.code.push({kind:e,count:s,isAbs:o,isAMPM:!1}):r.code.push({kind:e,count:s,isAbs:o}),v=!0,t=F.WantClose;continue}case L.Char:if(a.tokenStr===B(s.pictureSingle,i.PictureSingle.Space))continue}throw new me(this.notFormatString("unexpected token after ["))}if(t!==F.Done)throw new me((0,i.notImplemented)(["semicolon inside [ ]"]));u.suns.push(r);break}default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",t)}if(u.suns.length>=2){const e=u.suns[u.suns.length-2],t=u.suns[u.suns.length-1];if(e.kind===ie.Other&&t.kind===ie.Other){const r=e.code;(0,n.safePush)(r,t.code),u.suns.pop()}}}if(void 0!==d&&(d.numThousands=m.numThousands,d.numPercent=k),C&&void 0!==g&&(g.code[0].isAMPM=!0),y)for(const e of u.suns)if(e.kind===ie.Date)for(const t of e.code)switch(t.kind){case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:t.isAbs=Z[t.kind]===c}if(u.suns.length>32)throw new me(this.notFormatString("format string too long: SUNs limit"));return u.hasDate=f>0,u.hasTime=S>0,u}classifySunPartKind({suns:e,isEmpty:t,hasDate:r,hasTime:i},a){let o=a===oe.Number,s=a===oe.Text,u=!o&&!s;for(const t of e){switch(t.kind){case ie.Num:case ie.Fraction:case ie.Percent:case ie.Exp:o=!0;break;case ie.Text:s=!0;break;case ie.General:continue;case ie.Other:case ie.Date:break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",t)}u=!1}if((o?1:0)+(r||i?1:0)+(s?1:0)>1)throw new me(this.notFormatString("cannot mix number/date/text"));return o||r||i?oe.Number:s?oe.Text:u&&!t?oe.Either:a}convertSunToCode({suns:e,isEmpty:t,dtrRounding:r,color:i,dbnum:a,currCode:o}){const{localeInfo:u}=this.config,l=[];function c(t){for(let r=t-1;r>=0;r-=1){const t=e[r];if(t.kind===ie.Num)return[r,t]}}function d(t){for(let r=t+1;r<e.length;r+=1){const t=e[r];if(t.kind===ie.Num)return[r,t]}}let m,g=!1,p=0;for(let t=0;t<e.length;t+=1){const r=e[t];switch(r.kind){case ie.Text:if(m===ie.Text)break;if(void 0!==m)throw new me(this.notFormatString("@ after other control"));m=ie.Text;break;case ie.General:if(void 0!==m)throw new me(this.notFormatString("General after other control"));if(g)throw new me(this.notFormatString("General after number"));m=ie.General;break;case ie.Num:if(g=!0,m===ie.General)throw new me(this.notFormatString("number after General"));break;case ie.Fraction:if(void 0!==m)throw new me(this.notFormatString("/ after other control"));if(u.isEastAsia&&void 0!==a)throw new me(this.notFormatString("/ not allowed with DBNUM"));m=ie.Fraction;const i=c(t);if(void 0===i)throw new me(this.notFormatString("no number before /"));const[o,s,h]=this.mergeNumSuns(e,p,i[0]),f=d(t);if(void 0===f)throw new me(this.notFormatString("no number after /"));const S=e.slice(i[0]+1,f[0]),v=void 0!==d(f[0]);(0,n.safePush)(l,this.flattenSuns(o)),(0,n.safePush)(l,this.buildFractCode(s,h,i[1],S,f[1],v)),p=f[0]+1;break;case ie.Exp:if(void 0!==m)throw new me(this.notFormatString("E after other control"));m=ie.Exp;const[y,F,b]=this.mergeNumSuns(e,p,t);if(void 0===F)throw new me(this.notFormatString("no number before E"));const[C,k,E]=this.mergeNumSuns(e,t+1,e.length);if(void 0===k)throw new me(this.notFormatString("no number after E"));(0,n.safePush)(l,this.flattenSuns(y)),(0,n.safePush)(l,this.buildExpCode(r.isNeg,F,[...b,e[t],...C],k)),(0,n.safePush)(l,this.flattenSuns(E)),p=e.length;break;case ie.Percent:case ie.Other:case ie.Date:break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",r)}}if(void 0===m){const[t,r,i]=this.mergeNumSuns(e,p,e.length);void 0!==r?(0,n.safePush)(l,this.buildNumberCode(t,r)):(0,n.safePush)(l,this.flattenSuns(t)),(0,n.safePush)(l,this.flattenSuns(i)),p=e.length}(0,n.safePush)(l,this.flattenSuns(e.slice(p))),0!==e.length||t||l.push(re);const h=o?.tag;if((0,s.isSystemCultureTag)(h)){const e=h===s.CultureTag.SysDate?u.sysDateFormat:u.sysTimeFormat,t=new ge(this.config,{old:void 0,formatString:e,source:s.NumberFormatSource.System}),r=t.parts[ae.Pos];return{part:{code:[{kind:te.SysFormat,codeSysFormat:r.code,codeThisFormat:l}],color:r.color,dbnum:r.dbnum,dtrRounding:r.dtrRounding},applyCurrCode:t.thisCurrCode}}return{part:{code:l,color:i,dbnum:a,dtrRounding:r},applyCurrCode:o}}flattenSuns(e){return(0,n.safeConcat)([],e.map((e=>e.code)))}buildExpCode(e,t,r,n){if(n.comma)throw new me(this.notFormatString("comma following E"));const i=t.numDigDec;if(i>127)throw new me(this.notFormatString("too many decimal digits"));const{code:a,comma:o,numDigLeft:s}=this.bumpDigitsForComma(t);return[{kind:te.Exp,isNeg:e,numMantDigLeft:s,numMantDigDec:i,numExpDigLeft:n.numDigLeft,commaMant:o,codeMant:a,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]}buildNumberCode(e,t){const{numDigDec:r}=t;if(r>127)throw new me(this.notFormatString("too many decimal digits"));const{code:n,comma:i,numDigLeft:a}=this.bumpDigitsForComma(t);return[{kind:te.Num,numDigLeft:a,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:i,codeBefore:this.flattenSuns(e),code:n}]}buildFractCode(e,t,r,a,o,s){const{mathpack:u}=this.config;if(r.comma)throw new me(this.notFormatString("comma in numerator"));if(r.decimal)throw new me((0,i.notImplemented)(["decimals in numerator"]));if(o.comma)throw new me(this.notFormatString("comma in denominator"));if(o.decimal)throw new me(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new me(this.notFormatString("decimals in numerator"));if((l=o).numVal&&l.nonZero&&l.digitTokens)throw new me(this.notFormatString("literal and placeholder digits mixed in denominator"));var l;if(s)throw new me((0,i.notImplemented)(["fraction number formats with trailing numbers"]));let c,d=!1,m=0;if(void 0!==e){if(!e.reallyNum)throw new me((0,i.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new me((0,i.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new me(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new me((0,i.notImplemented)(["numerals in fraction integer part"]));({code:c,comma:d,numDigLeft:m}=this.bumpDigitsForComma(e))}const g=e?.numPercent??r.numPercent,p=e?.numThousands??r.numThousands;if(p>0)throw new me((0,i.notImplemented)(["fraction number formats with thousands"]));let h,{code:f,numDigLeft:S,firstDig:v}=o;if(o.numVal&&o.nonZero){if(s)throw new me((0,i.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(o.code.length>5)throw new me((0,i.notImplemented)(["too many digits in denominator"]));let e=0;for(let t=0;t<o.code.length;t+=1){const r=o.code[t];switch(r.kind){case L.Numeral:e=10*e+r.ordinal;break;case i.PictureSingle.Zero:if(0===t)throw new me((0,i.notImplemented)(["leading zero in denominator"]));e*=10;break;default:return(0,n.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(e>32767)throw new me((0,i.notImplemented)(["overflow in denominator not emulated"]));f=[{kind:i.PictureSingle.Hash,count:1}],S=1,v=void 0,h=u.fromNumber(e)}return[{kind:te.Fraction,numIntDigLeft:m,numPercent:g,numThousands:p,numNumerDig:r.numDigLeft,numDenomDig:S,commaInt:d,codeInt:c,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(a),codeDenom:f,denomValue:h,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:v,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]}mergeNumSuns(e,t,r){const i=[],a=[];let o;for(let s=t;s<e.length&&s<r;s+=1){const t=e[s];void 0!==o?t.kind===ie.Num?(o.decimal?o.numDigDec+=t.numDigLeft+t.numDigDec:(o.numDigLeft+=t.numDigLeft,o.numDigDec+=t.numDigDec),o.comma=o.comma||t.comma,o.decimal=o.decimal||t.decimal,o.numVal=o.numVal||t.numVal,o.nonZero=o.nonZero||t.nonZero,void 0!==t.lastDig&&(o.lastDig=t.lastDig),void 0===o.firstDig&&(o.firstDig=t.firstDig),o.anyHash=o.anyHash||t.anyHash,o.anyQuestion=o.anyQuestion||t.anyQuestion,o.anyZero=o.anyZero||t.anyZero,(0,n.safePush)(o.code,this.flattenSuns(a)),a.length=0,(0,n.safePush)(o.code,t.code)):a.push(t):t.kind===ie.Num?o=t:i.push(t)}return[i,o,a]}bumpDigitsForComma(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;const t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1;for(let t=0;t<e.code.length;t+=1){const n=e.code[t];switch(n.kind){case i.PictureSingle.Hash:{const i=e.code.slice();return i[t]={...n,count:n.count+(r-e.numDigLeft)},{code:i,comma:!0,numDigLeft:r}}case i.PictureSingle.Zero:case i.PictureSingle.Question:case i.PictureSingle.Decimal:{const n=e.code.slice();return n.splice(t,0,{kind:i.PictureSingle.Hash,count:r-e.numDigLeft}),{code:n,comma:!0,numDigLeft:r}}}}throw new me((0,i.notImplemented)(["comma with pure number literal"]))}anyLegalCommaPosition(e){if(e.numDigLeft<4)return!1;const t=e=>{const t=e?.kind;return t===i.PictureSingle.Hash||t===i.PictureSingle.Zero||t===i.PictureSingle.Question};let r=e.numDigLeft;for(let n=0;n<e.code.length;n+=1){const a=e.code[n];if(a.kind===i.PictureSingle.Decimal)return!1;if(t(a))for(let i=0;i<a.count;i+=1)if(r-=1,r>0&&r%3==0&&(i+1<a.count||t(e.code[n+1])))return!0}return!1}parseCurrCode(e){const{localeInfo:t}=this.config;let r,a,o;{const a=e.indexOf("-");if(0!==e.length&&0!==a){if(r=a<0?e:e.substring(0,a),r.length>61)throw new me(this.notFormatString("currencySymbol too long"));for(const e of(0,n.codePointIterator)(r))if(t.isNumeral(e)&&t.getNumberShape(e)!==i.NumberShape.ASCII)throw new me((0,i.notImplemented)(["non-ASCII digits in currencySymbol"]))}a>=0&&(o=e.substring(a+1))}if(void 0!==o&&(a=this.parseFormatCulture(o),void 0===a))throw new me((0,i.notImplemented)(["unhandled CurrCode: "+(0,n.anonymizeFormulaString)(e)]));if((0,s.isSystemCultureTag)(a?.tag)){if(void 0!==r)throw new me(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===s.NumberFormatSource.System)throw new me(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:r,currCode:a}}parseFormatCulture(e){const r={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},o=a=>{const o=(32512&a)>>8;if(0!==o&&(r.numberShape=t.pictureNumberShape[o],void 0===r.numberShape))throw new me((0,i.notImplemented)([`unknown number shape ${o} in culture: ${(0,n.anonymizeFormulaString)(e)}`]));r.nationalNumberInput=0!=(32768&a);const s=127&a;if(0!==s&&(r.calendar=t.pictureCalendar[s],void 0===r.calendar))throw new me((0,i.notImplemented)([`unknown calendar ${s} in culture: ${(0,n.anonymizeFormulaString)(e)}`]));r.localCalendarInput=0!=(128&a)},u=e.match(j);if(null!=u){r.culture=u[1]??"";const t=u[2]??u[3];if(null!=t){if(r.tag=V[t.toLowerCase()],void 0===r.tag)throw new me((0,i.notImplemented)(["unknown CurrCode tag: "+(0,n.anonymizeFormulaString)(e)]));switch(r.tag){case s.CultureTag.SysDate:case s.CultureTag.SysTime:case s.CultureTag.Euro1:case s.CultureTag.Euro2:case s.CultureTag.Bitcoin1:case s.CultureTag.Bitcoin2:if(""!==r.culture)throw new me(this.notFormatString(`CultureTag ${String(r.tag)} cannot have culture`));break;case s.CultureTag.GenLower:case s.CultureTag.GenUpper:case s.CultureTag.NomLower:case s.CultureTag.Gannen:if(""===r.culture)throw new me(this.notFormatString(`CultureTag ${String(r.tag)} must have culture`))}}const a=u[4];return null!=a&&o(q(a)),r}if(G.test(e)){const t=q(e);let n=65535&t;switch(n){case i.LCID.SystemLongDate:r.tag=s.CultureTag.SysDate;break;case i.LCID.SystemTime:r.tag=s.CultureTag.SysTime;break;case i.LCID.EuroTrailing:r.tag=s.CultureTag.Euro1;break;case i.LCID.EuroLeading:r.tag=s.CultureTag.Euro2;break;default:64512==(64512&n)&&(r.tag=s.CultureTag.GenLower),63488==(64512&n)&&(r.tag=s.CultureTag.GenUpper),62464==(64512&n)&&(r.tag=s.CultureTag.NomLower),void 0!==r.tag&&(n&=-63489),r.culture=(0,a.convertKnownLCID)(n)}return o(t>>16),r}}determineValueType(){const{localeInfo:e}=this.config,t={accountFill:!1,fvt:void 0};for(const e of this.parts){t.accountFill=!1;const r=this.determineValueTypeCodes(t,e.code);if(void 0!==r)return r;if(t.accountFill&&(t.fvt===s.FormatValueType.Number||t.fvt===s.FormatValueType.Currency))return s.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===B(e.pictureSpecial,i.PictureSpecial.General)?s.FormatValueType.General:s.FormatValueType.Custom}determineValueTypeCodes(e,t){const{localeInfo:r}=this.config;for(let a=0;a<t.length;a+=1){const o=t[a];switch(o.kind){case L.General:break;case i.PictureSingle.Text:return s.FormatValueType.Text;case i.PictureSingle.Star:e.accountFill=!0;break;case te.Char:case L.Exp:case i.PictureSingle.Slash:case L.StrLit:case i.PictureSingle.Percent:case i.PictureSingle.Underscore:case L.Numeral:case te.DateSep:case te.TimeSep:break;case L.Currency:e.fvt=s.FormatValueType.Currency;break;case L.CurrCode:void 0!==o.currencySymbol&&(e.fvt=s.FormatValueType.Currency);break;case te.Num:{e.fvt=1===o.numPercent&&0===o.numThousands?s.FormatValueType.Percentage:s.FormatValueType.Number;const t=o.codeBefore;let n,i=0;if(r.isEastAsia){if(i<t.length&&"("===ee(t[i])&&(i+=1),i<t.length&&"US$"===ee(t[i]))return s.FormatValueType.Currency;if(r.isChinaT){if(i<t.length&&"NT$"===ee(t[i]))return s.FormatValueType.Currency}else if(i<t.length&&"$"===ee(t[i]))return s.FormatValueType.Currency}if(void 0!==(n=this.determineValueTypeCodes(e,o.codeBefore.slice(i))))return n;if(void 0!==(n=this.determineValueTypeCodes(e,o.code)))return n;break}case te.Exp:{let t;if(e.fvt=s.FormatValueType.Scientific,void 0!==(t=this.determineValueTypeCodes(e,o.codeMant)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeBetween)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeExp)))return t;break}case te.Fraction:{let t;if(e.fvt=s.FormatValueType.Fraction,void 0!==o.codeInt&&void 0!==(t=this.determineValueTypeCodes(e,o.codeInt)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeBetween1)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeNumer)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeBetween2)))return t;if(void 0!==(t=this.determineValueTypeCodes(e,o.codeDenom)))return t;break}case i.PictureSingle.Decimal:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case L.PrefixDigTh:case L.LatinDate:case L.BidiDate:break;case i.PictureSingle.HourTh:case i.PictureSingle.MinuteTh:case i.PictureSingle.SecondTh:case i.PictureSingle.Hour:case i.PictureSingle.Minute:case i.PictureSingle.Second:case te.FracSeconds:return s.FormatValueType.Time;case L.AMPM:case L.AMPMFE:break;case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.MonthTh:case i.PictureSingle.DayTh:case i.PictureSingle.Year:case i.PictureSingle.Month:case i.PictureSingle.Day:case i.PictureSingle.LocDay:return s.FormatValueType.Date;case te.SysFormat:return this.determineValueTypeCodes(e,o.codeThisFormat);default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",o)}}}determineDecimals(){const e=this.parts[ae.Pos];for(const t of e.code)switch(t.kind){case te.Num:return t.numDigDec;case te.Exp:return t.numMantDigDec}return 0}determineBidiDate(){const e=B(this.config.localeInfo.pictureSingle,i.PictureSingle.BidiDate);return(0,n.stringStartsWith)(this.formatString,e+"1")?s.BidiDate.English:(0,n.stringStartsWith)(this.formatString,e+"2")?s.BidiDate.Lunar:void 0}printFormatString(e){const t=e??this.config.localeInfo,[r,n,a,o]=this.parts,s=!(ue(o)||o===r),u=this.posBeforeText||!s;let l="";return u&&(l+=this.printPart(r,this.condPos,t),n!==r&&(l+=B(t.pictureSingle,i.PictureSingle.Sep),l+=this.printPart(n,this.condNeg,t),a!==r&&(l+=B(t.pictureSingle,i.PictureSingle.Sep),l+=this.printPart(a,void 0,t)))),s&&(u&&(l+=B(t.pictureSingle,i.PictureSingle.Sep)),l+=this.printPart(o,void 0,t)),l}printPart(e,t,r){const{mathpack:n}=this.config;let a="";var o;if(void 0!==e.color&&(a+=B(r.pictureSingle,i.PictureSingle.ColorStart)+("number"==typeof e.color?B(r.pictureColor,i.PictureColor.Color)+String(e.color-8):B(r.pictureColor,(o=e.color,i.PictureColor[o])))+B(r.pictureSingle,i.PictureSingle.ColorEnd)),void 0!==t){const e=21;a+=B(r.pictureSingle,i.PictureSingle.ColorStart)+B(D,_[t.operator])+n.formatGeneral(r,t.operand,e)+B(r.pictureSingle,i.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(a+=B(r.pictureSingle,i.PictureSingle.ColorStart)+B(r.pictureDbnum,e.dbnum-1)+B(r.pictureSingle,i.PictureSingle.ColorEnd)),a+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0,r),a}printCodes(e,r,a,o){const{mathpack:l}=this.config;let c,d="";if(void 0!==a&&a.numThousands>0){for(let e=0;e<r.length;e+=1){const t=r[e].kind;t!==i.PictureSingle.Zero&&t!==i.PictureSingle.Hash&&t!==i.PictureSingle.Question&&t!==i.PictureSingle.Decimal&&t!==L.Numeral||(c=e)}(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==c)}for(let m=0;m<r.length;m+=1){const g=r[m],p=e.wasPrevDig;switch(e.wasPrevDig=!1,g.kind){case L.General:d+=B(o.pictureSpecial,i.PictureSpecial.General);break;case i.PictureSingle.Decimal:void 0!==a&&(a.decimal=!0),e.wasPrevDig=!0,d+=B(o.pictureSingle,i.PictureSingle.Decimal);break;case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:{e.seenDig=!0,e.wasPrevDig=!0;const t=g.kind===i.PictureSingle.Zero?"0":B(o.pictureSingle,g.kind),s=(0,n.repeat)(t,g.count);if(void 0===a||a.decimal){d+=s;break}if(a.comma){const e=a.numDigLeft-g.count;d+=(0,u.insertCommas)({isThousandsPosition:t=>{return t>0&&t%3==0&&(t>e||(n=r[m+1]?.kind,n===i.PictureSingle.Hash||n===i.PictureSingle.Zero||n===i.PictureSingle.Question));var n},thousandsSeparator:B(o.pictureSingle,i.PictureSingle.Comma)},s,e)}else d+=s;a.numDigLeft-=g.count;break}case L.Numeral:e.wasPrevDig=!0,d+=g.formattedStr;break;case te.Exp:d+=this.printCodes(e,g.codeMant,{comma:g.commaMant,numThousands:0,decimal:!1,numDigLeft:g.numMantDigLeft},o)+this.printCodes(e,g.codeBetween,void 0,o)+this.printCodes(e,g.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:g.numExpDigLeft},o);break;case te.Num:d+=this.printCodes(e,g.codeBefore,void 0,o)+this.printCodes(e,g.code,{comma:g.comma,numThousands:g.numThousands,decimal:!1,numDigLeft:g.numDigLeft},o);break;case te.Fraction:{const t=void 0===g.codeInt?"":this.printCodes(e,g.codeInt,{comma:g.commaInt,numThousands:0,decimal:!1,numDigLeft:g.numIntDigLeft},o),r=this.printCodes(e,g.codeBetween1,void 0,o),n=this.printCodes(e,g.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:g.numNumerDig},o),i=this.printCodes(e,g.codeBetween2,void 0,o),a=this.printCodes(e,g.codeDenom,{comma:!1,numThousands:g.numThousands,decimal:!1,numDigLeft:g.numDenomDig},o);d+=t+r+n+i+(void 0!==g.denomValue?E(l,g.denomValue):a);break}case te.Char:{const t=B(o.pictureSingle,i.PictureSingle.Backslash),a=K(o,o.pictureSingle,g.formattedStr,0),s=W(o,o.pictureSpecial,g.formattedStr,0);if(void 0!==a&&a!==i.PictureSingle.Extra&&a!==i.PictureSingle.Zero)switch(a){case i.PictureSingle.Comma:const n=r[m+1];if(p){const e=B(o.pictureSingle,i.PictureSingle.Space);if(g.formattedStr!==e||void 0===n||(o.isCurrencySymbolLead||!o.isCurrencySepBySpace||n.kind!==L.Currency)&&(!o.isPercentSepBySpace||n.kind!==i.PictureSingle.Percent)){d+=t;break}}if(n?.kind===te.Char&&n?.formattedStr===g.formattedStr){d+=t;break}break;case i.PictureSingle.Decimal:d+=t;break;case i.PictureSingle.Slash:e.seenDig&&(d+=t);break;case i.PictureSingle.Space:case i.PictureSingle.Minus:case i.PictureSingle.Plus:case i.PictureSingle.OpenParen:case i.PictureSingle.CloseParen:break;case i.PictureSingle.DateSep:B(o.pictureSingle,i.PictureSingle.DateSep)!==B(o.pictureSingle,i.PictureSingle.Minus)&&(d+=t);break;default:d+=t}else(s||o.isNumeral((0,n.stringCodePointAt)(g.formattedStr,0)))&&(d+=t);d+=g.formattedStr;break}case L.Exp:d+=g.formattedStr+(g.isNeg?"-":"+");break;case L.StrLit:{const e=B(o.pictureSingle,i.PictureSingle.Quote);(0,n.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",g.escaped.indexOf(e)<0),d+=e+g.escaped+e;break}case i.PictureSingle.Slash:d+=B(o.pictureSingle,i.PictureSingle.Slash);break;case i.PictureSingle.Percent:d+=B(o.pictureSingle,i.PictureSingle.Percent);break;case i.PictureSingle.Star:d+=B(o.pictureSingle,i.PictureSingle.Star)+g.escaped;break;case i.PictureSingle.Underscore:d+=B(o.pictureSingle,i.PictureSingle.Underscore)+g.escaped;break;case L.PrefixDigTh:d+="t";break;case L.Currency:d+=B(o.pictureSpecial,i.PictureSpecial.Currency);break;case L.CurrCode:if(d+=B(o.pictureSingle,i.PictureSingle.ColorStart),d+="$",void 0!==g.currencySymbol&&(d+=g.currencySymbol),void 0!==g.currCode){const{culture:e,numberShape:r,nationalNumberInput:i,calendar:a,localCalendarInput:o,tag:u}=g.currCode;d+="-";let l=0;switch(void 0!==r&&(l|=t.pictureNumberShape.indexOf(r)<<8),i&&(l|=32768),void 0!==a&&(l|=t.pictureCalendar.indexOf(a)),o&&(l|=128),typeof e){case"number":{let t=e;switch(u){case void 0:break;case s.CultureTag.GenLower:t|=64512;break;case s.CultureTag.GenUpper:t|=63488;break;case s.CultureTag.NomLower:t|=62464;break;default:(0,n.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}let r=H(l<<16|t);/^[a-f]{1,7}$/i.test(r)&&(r="0"+r),d+=r;break}case"string":d+=e,void 0!==u&&(""!==e&&(d+="-"),d+="x-",d+=String(u)),0!==l&&(d+=",",d+=H(l))}}d+=B(o.pictureSingle,i.PictureSingle.ColorEnd);break;case i.PictureSingle.Text:d+=B(o.pictureSingle,i.PictureSingle.Text);break;case L.LatinDate:d+=B(o.pictureSingle,i.PictureSingle.BidiDate)+"1";break;case L.BidiDate:d+=B(o.pictureSingle,i.PictureSingle.BidiDate)+"2";break;case te.FracSeconds:d+=B(o.pictureSingle,i.PictureSingle.Decimal)+(0,n.repeat)("0",g.rounding);break;case te.DateSep:d+=B(o.pictureSingle,i.PictureSingle.DateSep);break;case te.TimeSep:d+=B(o.pictureSingle,i.PictureSingle.Colon);break;case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:d+=(0,n.repeat)(B(o.pictureSingle,g.kind),g.count);break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:if(g.isAbs){d+=B(o.pictureSingle,i.PictureSingle.ColorStart)+(0,n.repeat)(B(o.pictureSingle,g.kind),g.count)+B(o.pictureSingle,i.PictureSingle.ColorEnd);break}d+=(0,n.repeat)(B(o.pictureSingle,g.kind),g.count);break;case L.AMPM:case L.AMPMFE:g.kind===L.AMPMFE||o.isEastAsia||g.pictureKind===i.PictureSpecial.AP2?d+=g.tokenStr:d+=B(o.pictureSpecial,g.pictureKind);break;case te.SysFormat:d+=this.printCodes(e,g.codeThisFormat,void 0,o);break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",g)}m===c&&(d+=(0,n.repeat)(B(o.pictureSingle,i.PictureSingle.Comma),a.numThousands))}return d}countBytecodeBuffer(e){const{mathpack:t,localeInfo:r}=this.config;let a=0;for(let o=0;o<e.length;o+=1){const s=e[o];let u=1;switch(s.kind){case i.PictureSingle.Percent:case L.Numeral:case te.Char:case i.PictureSingle.Star:case i.PictureSingle.Underscore:u+=2;break;case L.StrLit:u+=1+2*s.escaped.length;break;case te.FracSeconds:case i.PictureSingle.Hash:case i.PictureSingle.Zero:case i.PictureSingle.Question:case L.Exp:u+=1;break;case i.PictureSingle.Hour:case i.PictureSingle.HourTh:case i.PictureSingle.Minute:case i.PictureSingle.MinuteTh:case i.PictureSingle.Second:case i.PictureSingle.SecondTh:s.isAbs&&(u+=1);break;case te.Fraction:u+=5,void 0!==s.codeInt&&(u+=this.countBytecodeBuffer(s.codeInt)),u+=this.countBytecodeBuffer(s.codeBetween1),u+=this.countBytecodeBuffer(s.codeNumer),u+=this.countBytecodeBuffer(s.codeBetween2),u+=this.countBytecodeBuffer(s.codeDenom),void 0!==s.denomValue&&(u-=2,u+=2+2*E(t,s.denomValue).length),s.commaInt&&(u+=1);break;case te.Exp:u+=3,u+=this.countBytecodeBuffer(s.codeMant),u+=this.countBytecodeBuffer(s.codeBetween),u+=this.countBytecodeBuffer(s.codeExp),s.commaMant&&(u+=1);break;case te.Num:u+=3,u+=this.countBytecodeBuffer(s.codeBefore),u+=this.countBytecodeBuffer(s.code),s.comma&&(u+=1);break;case te.SysFormat:u=0,u+=this.countBytecodeBuffer(s.codeThisFormat);break;case L.CurrCode:u+=2*((s.currencySymbol?.length??0)+1),u+=8;break;case L.AMPM:{const e=r.isEastAsia||s.pictureKind===i.PictureSpecial.AP2?U(r,s.tokenStr):r.ampmSymbols;u+=2+2*(e[0].length+e[1].length)}break;case L.AMPMFE:case L.General:case i.PictureSingle.Decimal:case i.PictureSingle.Slash:case L.PrefixDigTh:case L.Currency:case i.PictureSingle.Text:case L.LatinDate:case L.BidiDate:case te.DateSep:case te.TimeSep:case i.PictureSingle.Era:case i.PictureSingle.EraYear:case i.PictureSingle.Year:case i.PictureSingle.YearTh:case i.PictureSingle.EngYearTh:case i.PictureSingle.ThYear:case i.PictureSingle.Month:case i.PictureSingle.MonthTh:case i.PictureSingle.Day:case i.PictureSingle.DayTh:case i.PictureSingle.LocDay:break;default:return(0,n.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",s)}a+=u}return a}countBytecodePart({code:e,color:t,dbnum:r,dtrRounding:n}){let i=0;return void 0!==t&&(i+=2),void 0!==r&&(i+=2),0!==n&&(i+=2),i+=this.countBytecodeBuffer(e),i}countBytecode(){let e=0;for(let t=ae.Pos;t<=ae.Text;t+=1){(t===ae.Pos&&void 0!==this.condPos||t===ae.Neg&&void 0!==this.condNeg)&&(e+=10);const r=this.parts[t];let n=!1;for(let e=ae.Pos;e<t;e+=1)if(this.parts[e]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e}checkBytecode(){if(this.countBytecode()>255)throw new me(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new me((0,i.notImplemented)(["format string too long: close to bytecode limit"]))}getBundledLocaleInfo(e,t,r){let n=r;switch(t){case i.Calendar.GregorianUS:n=z;break;case i.Calendar.GregorianMEFrench:n=Q;break;case i.Calendar.GregorianArabic:n=$;break;case i.Calendar.GregorianXlitEnglish:n=Y;break;case i.Calendar.GregorianXlitFrench:n=J;break;case i.Calendar.UmAlQura:case i.Calendar.Hijri:break;case i.Calendar.Thai:n=X}if(void 0!==n?.culture&&""!==n.culture){const t=(0,a.getBundledLocaleInfo)(n);if(void 0===t)throw new de(this.notImplementedCulture(e,n.culture));return t}return this.config.localeInfo}notFormatString(e){return(0,s.notFormatString)(`${e} (source=${String(this.source)}): ${this.logFormatString}`)}notImplementedCulture(e,t){const r="number"==typeof t?`lcid:${H(t)}`:`lang:${t}`;return(0,i.notImplemented)([`${e}: culture = ${r}`])}constructor(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,void 0===t.old?(this.logFormatString=(0,n.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=s.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}}t.NumberFormatImpl=ge},1159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.applyFormatAndRenderToString=t.getFormatString=t.initUtilGlobals=t.getRibbonFormat=t.RibbonFormat=t.convertKnownLCID=t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildCurrencyFormat=t.buildFractionFormat=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.createNumberFormatter=t.shouldInstallFormat=t.PackageName=void 0;const n=r(6533);t.PackageName="excel-online-calc-numfmt";var i=r(9471);Object.defineProperty(t,"shouldInstallFormat",{enumerable:!0,get:function(){return i.shouldInstallFormat}});var a=r(1173);Object.defineProperty(t,"createNumberFormatter",{enumerable:!0,get:function(){return a.createNumberFormatter}});var o=r(4243);Object.defineProperty(t,"buildNumberFormat",{enumerable:!0,get:function(){return o.buildNumberFormat}}),Object.defineProperty(t,"buildPercentFormat",{enumerable:!0,get:function(){return o.buildPercentFormat}}),Object.defineProperty(t,"buildScientificFormat",{enumerable:!0,get:function(){return o.buildScientificFormat}}),Object.defineProperty(t,"buildFractionFormat",{enumerable:!0,get:function(){return o.buildFractionFormat}}),Object.defineProperty(t,"buildCurrencyFormat",{enumerable:!0,get:function(){return o.buildCurrencyFormat}}),Object.defineProperty(t,"getKnownFormat",{enumerable:!0,get:function(){return o.getKnownFormat}}),Object.defineProperty(t,"isKnownFormatDefined",{enumerable:!0,get:function(){return o.isKnownFormatDefined}}),Object.defineProperty(t,"englishXLSXKnownFormat",{enumerable:!0,get:function(){return o.englishXLSXKnownFormat}});var s=r(5697);Object.defineProperty(t,"convertKnownLCID",{enumerable:!0,get:function(){return s.convertKnownLCID}});var u=r(8900);Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return u.RibbonFormat}}),Object.defineProperty(t,"getRibbonFormat",{enumerable:!0,get:function(){return u.getRibbonFormat}}),n.__exportStar(r(3739),t);var l=r(4759);Object.defineProperty(t,"initUtilGlobals",{enumerable:!0,get:function(){return l.initUtilGlobals}}),Object.defineProperty(t,"getFormatString",{enumerable:!0,get:function(){return l.getFormatString}}),Object.defineProperty(t,"applyFormatAndRenderToString",{enumerable:!0,get:function(){return l.applyFormatAndRenderToString}});var c=r(3434);Object.defineProperty(t,"getValueEditOperKind",{enumerable:!0,get:function(){return c.getValueEditOperKind}}),Object.defineProperty(t,"applyValueEdit",{enumerable:!0,get:function(){return c.applyValueEdit}}),Object.defineProperty(t,"toXLNumber",{enumerable:!0,get:function(){return c.toXLNumber}})},4243:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=void 0,t.getSpecial=s,t.getSingle=u,t.getColor=l,t.buildNumberFormat=c,t.buildPercentFormat=d,t.buildScientificFormat=m,t.buildQuoted=g,t.buildFractionFormat=p,t.buildCurrencyFormat=v,t.buildSingle=y,t.buildMMDDYYFormat=A,t.buildNumShapeConstFormat=function(e,t,r,o,s,l,m,g){const p=a.pictureNumberShape.indexOf(r)<<24|function(e){switch(e){case i.NumberShape.ArabicIndic:case i.NumberShape.ExtendedArabicIndic:return i.LCID.Arabic;case i.NumberShape.Devanagari:return i.LCID.Hindi;case i.NumberShape.Bengali:return 1093;case i.NumberShape.Gurmukhi:return 1094;case i.NumberShape.Gujarati:return 1095;case i.NumberShape.Oriya:return 1096;case i.NumberShape.Tamil:return i.LCID.Tamil;case i.NumberShape.Telugu:return 1098;case i.NumberShape.Kannada:return 1099;case i.NumberShape.Malayalam:return 1100;case i.NumberShape.Thai:return i.LCID.Thailand;case i.NumberShape.Lao:return 1108;case i.NumberShape.Tibetan:return 1105;case i.NumberShape.Myanmar:return 1109;case i.NumberShape.Ethiopic:return 1118;case i.NumberShape.Khmer:return 1107;case i.NumberShape.Mongolian:return 1104;case i.NumberShape.ASCII:case i.NumberShape.ChineseTrad1:case i.NumberShape.ChineseTrad2:case i.NumberShape.ChineseTrad3:case i.NumberShape.ChineseSimp1:case i.NumberShape.ChineseSimp2:case i.NumberShape.ChineseSimp3:case i.NumberShape.Japanese1:case i.NumberShape.Japanese2:case i.NumberShape.Japanese3:case i.NumberShape.Korean1:case i.NumberShape.Korean2:case i.NumberShape.Korean3:case i.NumberShape.Korean4:return 0;default:return(0,n.assertNever)("calc.numfmt.lcidFromNumShape",e)}}(r);let h=m;if((o||s)&&(h=2),h=(0,n.fastMin)(h,14),o){const t=y(e,i.PictureSingle.ColorStart,"$"+e.currencySymbol+"-"+p.toString(16).toUpperCase(),i.PictureSingle.ColorEnd);return v({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!0,2,!0,!1,t).replace(t,(()=>t+u(e,i.PictureSingle.Space)))}const f=y(e,i.PictureSingle.ColorStart,"$-"+p.toString(16).toUpperCase(),i.PictureSingle.ColorEnd);if(s)return f+d({...e,isPercentSepBySpace:!1},2);if(l)return f+c(e,!0,4,h);const S=t.formatGeneral(e,g,11),F=S.indexOf("E");if(F>=0){const t=S.substring(0,F),r=t.indexOf(e.decimalSeparator)>=0,a=t.replace(e.decimalSeparator,"").length,o=S.substring(F+2).length;return f+y(e,"0",h>0&&!r?"":i.PictureSingle.Decimal,(0,n.repeat)(u(e,i.PictureSingle.Hash),a-1),i.PictureSingle.E,h>0?"-":"+",(0,n.repeat)("0",o))}return f+y(e,"0",h>0?i.PictureSingle.Decimal:"",(0,n.repeat)(u(e,i.PictureSingle.Hash),h))},t.buildNumShapeDateTimeFormat=function(e,t,r){return y(e,i.PictureSingle.ColorStart,"$-"+(a.pictureNumberShape.indexOf(t)<<24).toString(16).toUpperCase(),i.PictureSingle.ColorEnd)+P(e,r)},t.getKnownFormat=P,t.isKnownFormatDefined=function(e,t){return e<=i.KnownFormat.General&&e>=i.KnownFormat.AcctDec||(e<=-1e3&&e>=-1099?t.isEastAsia:e<=-1100&&e>=-1199?t.isJapan:e<=-1200&&e>=-1299?t.isKorea:e<=-1300&&e>=-1399?t.isChinaT:e<=-1400&&e>=-1499?t.isChinaS:e<=-2e3&&e>=-2099?t.isThai:(0,n.assertFalse)("calc.numfmt.isKnownFormatDefined"))};const n=r(6913),i=r(6592),a=r(9421),o=r(7420);function s(e,t){const r=e.pictureSpecial[t]??i.englishPictureSpecial[t];return(0,n.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==r),r}function u(e,t){const r=e.pictureSingle[t]??i.englishPictureSingle[t];return(0,n.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==r),r}function l(e,t){const r=e.pictureColor[t]??i.englishPictureColor[t];return(0,n.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==r),r}function c(e,t,r,a){let s="";if(r>1){const a=(0,n.repeat)(u(e,i.PictureSingle.Hash),r-1);s+=t?(0,o.insertCommas)({isThousandsPosition:e=>e>0&&e%3==0,thousandsSeparator:u(e,i.PictureSingle.Comma)},a,1):a}return s+="0",a>0&&(s+=u(e,i.PictureSingle.Decimal),s+=(0,n.repeat)("0",a)),s}function d(e,t){let r="";return r+="0",t>0&&(r+=u(e,i.PictureSingle.Decimal),r+=(0,n.repeat)("0",t)),e.isPercentSepBySpace&&(r+=u(e,i.PictureSingle.Space)),r+=u(e,i.PictureSingle.Percent),r}function m(e,t,r,a){let o="";return o+=c(e,!1,t,r),e.isExpSepBySpace&&(o+=u(e,i.PictureSingle.Space)),o+=u(e,i.PictureSingle.E),o+="+",o+=(0,n.repeat)("0",a),o}function g(e,t){const r=u(e,i.PictureSingle.Quote);return r+t+r}function p(e,t){let r="";r+=u(e,i.PictureSingle.Hash);const a=e.fractionSeparator;return a===u(e,i.PictureSingle.Comma)?r+=g(e,a):r+=" "===a?u(e,i.PictureSingle.Space):g(e,a),r+=(0,n.repeat)(u(e,i.PictureSingle.Question),t),r+=u(e,i.PictureSingle.Slash),r+=(0,n.repeat)(u(e,i.PictureSingle.Question),t),r}var h,f;function S(e,t){let r="";return r+=g(e,"-"),t>0&&(r+=(0,n.repeat)(u(e,i.PictureSingle.Question),t)),r}function v(e,t,r,n,a,o,d=!1){const{isCurrencySymbolLead:m,currencyFormat:g,isCurrencySepBySpace:p}=e,f=d?h.Pos:a?h.Text:h.Neg,v=c(e,!0,4,r);let F="";for(let c=h.Pos;c<=f;c+=1){c!==h.Pos&&(F+=u(e,i.PictureSingle.Sep)),c===h.Neg&&t&&(F+=u(e,i.PictureSingle.ColorStart)+l(e,i.PictureColor.Red)+u(e,i.PictureSingle.ColorEnd));const d=()=>c===h.Zero?S(e,r):c===h.Text?u(e,i.PictureSingle.Text):v,f=()=>c!==h.Text?y(e,i.PictureSingle.Star,i.PictureSingle.Space):"",b=()=>{let t="";if(m)switch(g){case i.CurrencyFormat.Paren:t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.OpenParen);break;case i.CurrencyFormat.Trail:t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);break;case i.CurrencyFormat.Intern:t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}else{switch(g){case i.CurrencyFormat.Trail:t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);break;case i.CurrencyFormat.Paren:case i.CurrencyFormat.Intern:t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}g!==i.CurrencyFormat.Lead&&(t+=f())}return t},C=()=>{if(m)switch(g){case i.CurrencyFormat.Lead:return y(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);case i.CurrencyFormat.Intern:return y(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}else switch(g){case i.CurrencyFormat.Lead:return y(e,i.PictureSingle.Underscore,i.PictureSingle.Minus);case i.CurrencyFormat.Paren:case i.CurrencyFormat.Intern:return y(e,i.PictureSingle.Underscore,i.PictureSingle.Space)}return""},k=()=>c===h.Neg?u(e,i.PictureSingle.OpenParen):"",E=()=>c!==h.Text||m?c===h.Neg?u(e,i.PictureSingle.CloseParen):y(e,i.PictureSingle.Underscore,i.PictureSingle.CloseParen):"",A=()=>{let t="";if(c!==h.Neg)switch(g){case i.CurrencyFormat.Intern:m||c===h.Text||(t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.Minus));break;case i.CurrencyFormat.Lead:case i.CurrencyFormat.Trail:if(g===i.CurrencyFormat.Lead&&!a)break;t+=y(e,i.PictureSingle.Underscore,i.PictureSingle.Minus)}else t+=u(e,i.PictureSingle.Minus);return a&&!m&&g===i.CurrencyFormat.Lead&&(t+=f()),t},T=()=>{let t="";return n&&!m&&p&&(t+=u(e,i.PictureSingle.Space)),n&&(t+=o??s(e,i.PictureSpecial.Currency)),m&&p&&(t+=u(e,i.PictureSingle.Space)),t},R=()=>{let e="";return c!==h.Text&&(m?(n&&(e+=T()),a&&(e+=f())):e+=T()),e};if(a&&(F+=b()),m)switch(g){case i.CurrencyFormat.Paren:a||(F+=k()),F+=R(),a&&(F+=k()),F+=d(),F+=E();break;case i.CurrencyFormat.Lead:F+=A(),F+=R(),F+=d();break;case i.CurrencyFormat.Intern:F+=R(),F+=A(),F+=d();break;case i.CurrencyFormat.Trail:F+=R(),F+=d(),F+=A()}else switch(g){case i.CurrencyFormat.Paren:F+=k(),F+=d(),a&&(F+=E()),F+=R(),a||(F+=E());break;case i.CurrencyFormat.Lead:F+=A(),F+=d(),F+=R();break;case i.CurrencyFormat.Intern:F+=d(),F+=A(),F+=R();break;case i.CurrencyFormat.Trail:F+=d(),F+=R(),F+=A()}a&&(F+=C())}return F}function y(e,...t){return t.map((t=>"string"==typeof t?t:u(e,t))).join("")}!function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(h||(h={})),function(e){e[e.Day=0]="Day",e[e.Month=1]="Month",e[e.Year=2]="Year"}(f||(f={}));const F={[i.DateOrder.MDY]:[f.Month,f.Day,f.Year],[i.DateOrder.DMY]:[f.Day,f.Month,f.Year],[i.DateOrder.YMD]:[f.Year,f.Month,f.Day],[i.DateOrder.MYD]:[f.Month,f.Year,f.Day],[i.DateOrder.DYM]:[f.Day,f.Year,f.Month],[i.DateOrder.YDM]:[f.Year,f.Day,f.Month]};function b(e,t){return y(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?i.PictureSingle.Hour:"",i.PictureSingle.Hour,i.PictureSingle.Colon,i.PictureSingle.Minute,i.PictureSingle.Minute)}function C(e,t){return b(e,t)+y(e,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second)}function k(e){let t="";return e.isAMPMSepBySpace&&(t+=u(e,i.PictureSingle.Space)),t+=s(e,i.PictureSpecial.AP1),t}function E(e,t,r,a,o=e.year4Digits){const{month2Digits:s,day2Digits:l}=e,c=[(0,n.repeat)(t,l?2:1),(0,n.repeat)(r,s?2:1),(0,n.repeat)(a,o?4:2)],d=F[e.dateOrder];let m="";for(let t=0;t<3;t+=1)m+=c[d[t]],t<2&&(m+=u(e,i.PictureSingle.DateSep));return m}function A(e,t){const r=u(e,i.PictureSingle.Year),n=u(e,i.PictureSingle.Month);return E(e,u(e,i.PictureSingle.Day),n,r,t)}function T(e,t,r,n=i.PictureSingle.Day,a=i.PictureSingle.Month,o=i.PictureSingle.Year){const{day2Digits:s}=e,l=e.country===i.Country.GER,c="/"===e.dateSeparator&&" "!==e.dateAltSeparator;let d="";return t&&(d+=y(e,s?n:"",n),c?d+=e.dateAltSeparator:(d+=u(e,i.PictureSingle.DateSep),l&&(d+=u(e,i.PictureSingle.Space)))),d+=y(e,a,a,a),r&&(d+=c?e.dateAltSeparator:u(e,l?i.PictureSingle.Space:i.PictureSingle.DateSep),d+=y(e,o,o)),d}function R(e){return y(e,e.hour2Digits?i.PictureSingle.HourTh:"",i.PictureSingle.HourTh,i.PictureSingle.Colon,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh)}function N(e){return E(e,u(e,i.PictureSingle.DayTh),u(e,i.PictureSingle.MonthTh),u(e,i.PictureSingle.YearTh))}function I(e,t,r){return T(e,t,r,i.PictureSingle.DayTh,i.PictureSingle.MonthTh,i.PictureSingle.YearTh)}function P(e,t){switch(t){case i.KnownFormat.General:return s(e,i.PictureSpecial.General);case i.KnownFormat.NoComFixed0:return c(e,!1,1,0);case i.KnownFormat.NoComFixed:return c(e,!1,1,2);case i.KnownFormat.Fixed0:return c(e,!0,4,0);case i.KnownFormat.Fixed:return c(e,!0,4,2);case i.KnownFormat.Currency:return v(e,!1,0,!0,!1);case i.KnownFormat.CoCurrency:return v(e,!0,0,!0,!1);case i.KnownFormat.CurrencyDec:return v(e,!1,2,!0,!1);case i.KnownFormat.CoCurrencyDec:return v(e,!0,2,!0,!1);case i.KnownFormat.Pct0:return d(e,0);case i.KnownFormat.Pct:return d(e,2);case i.KnownFormat.Exp:return m(e,1,2,2);case i.KnownFormat.Fract:return p(e,1);case i.KnownFormat.FractBond:return p(e,2);case i.KnownFormat.MMDDYY:return A(e);case i.KnownFormat.DDMMMYY:return T(e,!0,!0);case i.KnownFormat.DDMMM:return T(e,!0,!1);case i.KnownFormat.MMMYY:return T(e,!1,!0);case i.KnownFormat.HHMMAP:return b(e,!0)+k(e);case i.KnownFormat.HHMMSSAP:return C(e,!0)+k(e);case i.KnownFormat.HHMM:return b(e,!1);case i.KnownFormat.HHMMSS:return C(e,!1);case i.KnownFormat.MDYHMS:return y(e,A(e),i.PictureSingle.Space,b(e,!1));case i.KnownFormat.USCoCurrency:case i.KnownFormat.USCoCurrencyDec:return v({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!0,t===i.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?g(e,"US$"):"$");case i.KnownFormat.Currency2:return v(e,!1,0,!1,!1);case i.KnownFormat.CoCurrency2:return v(e,!0,0,!1,!1);case i.KnownFormat.CurrencyDec2:return v(e,!1,2,!1,!1);case i.KnownFormat.CoCurrencyDec2:return v(e,!0,2,!1,!1);case i.KnownFormat.Acct:return v(e,!1,0,!1,!0);case i.KnownFormat.AcctDec:return v(e,!1,2,!1,!0);case i.KnownFormat.AcctCur:return v(e,!1,0,!0,!0);case i.KnownFormat.AcctDecCur:return v(e,!1,2,!0,!0);case i.KnownFormat.MMSS:return y(e,i.PictureSingle.Minute,i.PictureSingle.Minute,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second);case i.KnownFormat.AbsHMMSS:return y(e,i.PictureSingle.ColorStart,i.PictureSingle.Hour,i.PictureSingle.ColorEnd,i.PictureSingle.Colon,i.PictureSingle.Minute,i.PictureSingle.Minute,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second);case i.KnownFormat.SS0:return y(e,i.PictureSingle.Minute,i.PictureSingle.Minute,i.PictureSingle.Colon,i.PictureSingle.Second,i.PictureSingle.Second,i.PictureSingle.Decimal,"0");case i.KnownFormat.Eng:return m(e,3,1,1);case i.KnownFormat.Text:return u(e,i.PictureSingle.Text);case i.KnownFormat.NoComFixed0_Tha:return"t"+c(e,!1,1,0);case i.KnownFormat.NoComFixed_Tha:return"t"+c(e,!1,1,2);case i.KnownFormat.Fixed0_Tha:return"t"+c(e,!0,4,0);case i.KnownFormat.Fixed_Tha:return"t"+c(e,!0,4,2);case i.KnownFormat.CoCurrency_Tha:case i.KnownFormat.CoCurrencyDec_Tha:return v({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!0,t===i.KnownFormat.CoCurrencyDec_Tha?2:0,!0,!1,"t"+s(e,i.PictureSpecial.Currency));case i.KnownFormat.Pct0_Tha:return"t"+d(e,0);case i.KnownFormat.Pct_Tha:return"t"+d(e,2);case i.KnownFormat.MMDDYY_Tha:return N(e);case i.KnownFormat.DDMMMYY_Tha:return I(e,!0,!0);case i.KnownFormat.DDMMM_Tha:return I(e,!0,!1);case i.KnownFormat.MMMYY_Tha:return I(e,!1,!0);case i.KnownFormat.HHMM_Tha:return R(e);case i.KnownFormat.HHMMSS_Tha:return function(e){return R(e)+y(e,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh)}(e);case i.KnownFormat.MDYHMS_Tha:return y(e,N(e),i.PictureSingle.Space,R(e));case i.KnownFormat.AbsHMMSS_Tha:return y(e,i.PictureSingle.ColorStart,i.PictureSingle.HourTh,i.PictureSingle.ColorEnd,i.PictureSingle.Colon,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh);case i.KnownFormat.MMSS_Tha:return y(e,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh);case i.KnownFormat.SS0_Tha:return y(e,i.PictureSingle.MinuteTh,i.PictureSingle.MinuteTh,i.PictureSingle.Colon,i.PictureSingle.SecondTh,i.PictureSingle.SecondTh,i.PictureSingle.Decimal,"0");case i.KnownFormat.DMBB_Tha:return E(e,u(e,i.PictureSingle.Day),u(e,i.PictureSingle.Month),u(e,i.PictureSingle.EngYearTh),!1);default:return(0,n.assertNever)("calc.numfmt.getKnownFormat",t)}}t.englishXLSXKnownFormat={0:i.KnownFormat.General,1:i.KnownFormat.NoComFixed0,2:i.KnownFormat.NoComFixed,3:i.KnownFormat.Fixed0,4:i.KnownFormat.Fixed,5:i.KnownFormat.Currency,6:i.KnownFormat.CoCurrency,7:i.KnownFormat.CurrencyDec,8:i.KnownFormat.CoCurrencyDec,9:i.KnownFormat.Pct0,10:i.KnownFormat.Pct,11:i.KnownFormat.Exp,12:i.KnownFormat.Fract,13:i.KnownFormat.FractBond,14:i.KnownFormat.MMDDYY,15:i.KnownFormat.DDMMMYY,16:i.KnownFormat.DDMMM,17:i.KnownFormat.MMMYY,18:i.KnownFormat.HHMMAP,19:i.KnownFormat.HHMMSSAP,20:i.KnownFormat.HHMM,21:i.KnownFormat.HHMMSS,22:i.KnownFormat.MDYHMS,37:i.KnownFormat.Currency2,38:i.KnownFormat.CoCurrency2,39:i.KnownFormat.CurrencyDec2,40:i.KnownFormat.CoCurrencyDec2,41:i.KnownFormat.Acct,42:i.KnownFormat.AcctCur,43:i.KnownFormat.AcctDec,44:i.KnownFormat.AcctDecCur,45:i.KnownFormat.MMSS,46:i.KnownFormat.AbsHMMSS,47:i.KnownFormat.SS0,48:i.KnownFormat.Eng,49:i.KnownFormat.Text}},5697:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBundledLocaleInfo=function({culture:e,tag:t}){if("number"==typeof e)return;let r=e;return void 0!==t&&(""!==e&&(r+="-"),r+="x-"+String(t)),void 0===o&&(o=function(){const e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"];for(const r of Object.keys(a)){const i=a[r];if("string"==typeof i){const t=e[i];(0,n.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==t),e[r]=t;continue}const[o,s,u,l,c]=i.slice(0,5).map(((r,i)=>{if("string"==typeof r){const a=e[r];return(0,n.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==a),a[t[i]]}return r})),d=i[5],m="k"===d,g="j"===d,p="t"===d,h="s"===d,f=m||g||p||h;e[r]={monthNameShort:o,monthNameLong:s,dayNameShort:u,dayNameLong:l,ampmSymbols:c,isEastAsia:f,isKorea:m,isJapan:g,isChinaT:p,isChinaS:h}}return e}()),o[r]},t.convertKnownLCID=function(e){return"string"==typeof e?e:s[e]??e};const n=r(6913),i=r(6592),a={ar:[["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["ص","م"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","sá."],["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],["a. m.","p. m."],"z"],fr:[["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["週日","週一","週二","週三","週四","週五","週六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],["上午","下午"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["siječanj","veljača","ožujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","čet","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","četvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sön","mån","tis","ons","tor","fre","lör"],["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sâm."],["duminică","luni","marți","miercuri","joi","vineri","sâmbătă"],["a.m.","p.m."],"z"],ru:[["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","čet","pet","sub"],["nedelja","ponedeljak","utorak","sreda","četvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],["неділя","понеділок","вівторок","середа","четвер","п'ятниця","субота"],"en","z"],bg:[["яну","фев","мар","апр","май","юни","юли","авг","сеп","окт","ное","дек"],["януари","февруари","март","април","май","юни","юли","август","септември","октомври","ноември","декември"],["нед","пон","вт","ср","четв","пет","съб"],["неделя","понеделник","вторник","сряда","четвъртък","петък","събота"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],["ne","po","út","st","čt","pá","so"],["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["sø","ma","ti","on","to","fr","lø"],["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],"sv","z"],el:[["Ιαν","Φεβ","Μαρ","Απρ","Μαϊ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],["πμ","μμ"],"z"],et:[["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],["יום א","יום ב","יום ג","יום ד","יום ה","יום ו","שבת"],["יום ראשון","יום שני","יום שלישי","יום רביעי","יום חמישי","יום שישי","שבת"],"en","z"],hu:[["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["日","月","火","水","木","金","土"],["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],["午前","午後"],"j"],ko:["ja",["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],["일","월","화","수","목","금","토"],["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],["오전","오후"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","birž.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","št"],["sekmadienis","pirmadienis","antradienis","trečiadienis","ketvirtadienis","penktadienis","šeštadienis"],["priešpiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jūn.","jūl.","aug.","sept.","okt.","nov.","dec."],["janvāris","februāris","marts","aprīlis","maijs","jūnijs","jūlijs","augusts","septembris","oktobris","novembris","decembris"],["svētd.","pirmd.","otrd.","trešd.","ceturtd.","piektd.","sestd."],["svētdiena","pirmdiena","otrdiena","trešdiena","ceturtdiena","piektdiena","sestdiena"],["priekšp.","pēcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["søn","man","tir","ons","tor","fre","lør"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sáb"],["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],"en","z"],sk:["ja",["január","február","marec","apríl","máj","jún","júl","august","september","október","november","december"],["ne","po","ut","st","št","pi","so"],["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","čet.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","četrtek","petek","sobota"],["dop.","pop."],"z"],th:[["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],"en","z"],tr:[["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"],["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],["ÖÖ","ÖS"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tháng Giêng","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"],["SA","CH"],"z"],ta:[["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஞாயிறு","திங்கள்","செவ்வாய்","புதன்","வியாழன்","வெள்ளி","சனி"],["ஞாயிற்றுக்கிழமை","திங்கள்கிழமை","செவ்வாய்க்கிழமை","புதன்கிழமை","வியாழக்கிழமை","வெள்ளிக்கிழமை","சனிக்கிழமை"],["காலை","மாலை"],"z"],syr:[["܏ܟܢ ܏ܒ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","܏ܬܫ ܏ܐ","܏ܬܫ ܏ܒ","܏ܟܢ ܏ܐ"],["ܟܢܘܢ ܐܚܪܝ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","ܬܫܪܝ ܩܕܝܡ","ܬܫܪܝ ܐܚܪܝ","ܟܢܘܢ ܩܕܝܡ"],["܏ܐ ܏ܒܫ","܏ܒ ܏ܒܫ","܏ܓ ܏ܒܫ","܏ܕ ܏ܒܫ","܏ܗ ܏ܒܫ","܏ܥܪܘܒ","܏ܫܒ"],["ܚܕ ܒܫܒܐ","ܬܪܝܢ ܒܫܒܐ","ܬܠܬܐ ܒܫܒܐ","ܐܪܒܥܐ ܒܫܒܐ","ܚܡܫܐ ܒܫܒܐ","ܥܪܘܒܬܐ","ܫܒܬܐ"],["ܩ.ܛ","ܒ.ܛ"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["студз","лют","сак","крас","май","чэрв","ліп","жн","вер","кастр","ліст","снеж"],["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],["нд","пн","аўт","ср","чц","пт","сб"],["нядзеля","панядзелак","аўторак","серада","чацвер","пятніца","субота"],"en","z"],dv:[["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["މކ","މފ"],"z"],hi:[["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["रवि.","सोम.","मंगल.","बुध.","गुरु.","शुक्र.","शनि."],["रविवार","सोमवार","मंगलवार","बुधवार","गुरुवार","शुक्रवार","शनिवार"],["पूर्वाह्न","अपराह्न"],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],"es",["a. m.","p. m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mié","jue","vie","sáb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fév.","mar.","avr.","mai","jui.","juil.","août","sept.","oct.","nov.","déc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["周日","周一","周二","周三","周四","周五","周六"],"zh","zh","s"],"zh-SG":[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jän","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","Sâ"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["янв.","февр.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","čet.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["студзеня","лютага","сакавіка","красавіка","мая","чэрвеня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};let o;const s={[i.LCID.USA]:"en-US",[i.LCID.Greek]:"el-GR",[i.LCID.Hungarian]:"hu-HU",[i.LCID.Turkish]:"tr-TR",[i.LCID.Thailand]:"th-TH",[i.LCID.Vietnam]:"vi-VN",[i.LCID.Arabic]:"ar-SA",[i.LCID.Hebrew]:"he-IL",[i.LCID.Tamil]:"ta-IN",[i.LCID.Syriac]:"syr-SY",[i.LCID.Iraq]:"ar-IQ",[i.LCID.Algerian]:"ar-DZ",[i.LCID.Basque]:"eu-ES",[i.LCID.PortBrazil]:"pt-BR",[i.LCID.Croatian]:"hr-HR",[i.LCID.Czech]:"cs-CZ",[i.LCID.Danish]:"da-DK",[i.LCID.Dutch]:"nl-NL",[i.LCID.Australian]:"en-AU",[i.LCID.CanadianEnglish]:"en-CA",[i.LCID.British]:"en-GB",[i.LCID.Finnish]:"fi-FI",[i.LCID.French]:"fr-FR",[i.LCID.FrenchCanadian]:"fr-CA",[i.LCID.Italian]:"it-IT",[i.LCID.NorskBokmal]:"nb-NO",[i.LCID.NorskNynorsk]:"nn-NO",[i.LCID.Polish]:"pl-PL",[i.LCID.PortIberian]:"pt-PT",[i.LCID.Romanian]:"ro-RO",[i.LCID.Russian]:"ru-RU",[i.LCID.Ukrainian]:"uk-UA",[i.LCID.Belarusian]:"be-BY",[i.LCID.SerbianCyrillic]:"sr-Cyrl-CS",[i.LCID.SerbianLatin]:"sr-Latn-CS",[i.LCID.Slovak]:"sk-SK",[i.LCID.Slovenian]:"sl-SI",[i.LCID.SpanishModern]:"es-ES",[i.LCID.Swedish]:"sv-SE",[i.LCID.HongKong]:"zh-HK",[i.LCID.ChinaT]:"zh-TW",[i.LCID.Korea]:"ko-KR",[i.LCID.Japan]:"ja-JP",[i.LCID.China]:"zh-CN",[i.LCID.Devihi]:"dv-MV",[i.LCID.Hindi]:"hi-IN",[i.LCID.German]:"de-DE",[i.LCID.Swiss]:"fr-CH",[i.LCID.Indonesia]:"id-ID",[i.LCID.EnglishIndonesia]:"en-ID",[i.LCID.EnglishIndia]:"en-IN",[i.LCID.Singapore]:"zh-SG",[i.LCID.EnglishSingapore]:"en-SG",[i.LCID.Serbia]:"sr-RS",[i.LCID.Mexico]:"es-MX",[i.LCID.Ireland]:"en-IE",[i.LCID.EnglishZimbabwe]:"en-ZW",[i.LCID.Belgium]:"nl-BE"}},1616:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseGeneral=function(e,t,r,o,s){try{const{localeInfo:u,mathpack:l}=e.config,c=(0,i.parseConstInternal)(u,l,t,r,o,!1);return(0,n.isSuccess)(c)?void 0!==c.value?c:(0,a.parseDateInternal)((0,a.initParseDateGlobals)(e),t,void 0,s):c}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,a.parseDateInternal)((0,a.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(3985),a=r(6964)},3985:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=function(e,t,r,i,a,o){if(!a)return S(e,t,r,i,h.None,o);for(let a=h.None;a<=h.Trail;a+=1){const s=S(e,t,r,i,a,o);if(!(0,n.isSuccess)(s))return s;if(void 0!==s.value)return s;if(a===h.None&&r.indexOf("€")<0)break}return(0,n.success)(void 0)};const n=r(6913),i=r(6592),a=r(4243),{codePointDollarSign:o,codePointBackslash:s,codePointPercentSign:u,codePointSpace:l,codePointLeftParen:c,codePointMinusSign:d,codePointPlusSign:m,codePointRightParen:g}=n.codePoint;var p,h;function f(e,t,r,n){if(" "===t||""===t)return;const i="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===o&&!i)return{currency:p.DollarUS,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?p.DollarUS:p.DollarExtra,i:n+3};if(("¥"===t&&e.isJapan||"₩"===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===s)return{currency:p.Default,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:p.DollarExtra,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:p.Default,i:n+t.length}:void 0}function S(e,t,r,o,s,S){let v,y=0,F=!1,b=!1,C=!1,{isCurrencySymbolLead:k,currencySymbol:E}=e;s!==h.None&&(k=s===h.Lead,E="€");let A=0;for(;A<r.length;){if(void 0===v&&k){const t=f(e,E,r,A);if(void 0!==t){({currency:v,i:A}=t);continue}}const t=r.charCodeAt(A);switch(t){case u:A+=1,y+=1;continue;case l:A+=1;continue;case c:case d:case m:if(A+=1,b)return(0,n.success)(void 0);b=!0,t===c&&(F=!0),C=t!==m;continue}break}const T=(0,i.parseNumberLiteral)(e,t,r,A,!0,y>0||o,S);if(void 0===T||void 0===T.value)return(0,n.success)(void 0);A=T.i;const R=C?t.neg(T.value):T.value;for(;A<r.length;){if(void 0===v&&!k){const t=f(e,E,r,A);if(void 0!==t){({currency:v,i:A}=t);continue}}switch(r.charCodeAt(A)){case u:A+=1,y+=1;continue;case l:A+=1;continue;case g:if(A+=1,!F)return(0,n.success)(void 0);F=!1;continue}break}if(A!==r.length||F||y>1||void 0!==v&&y>0)return(0,n.success)(void 0);let N,I=T.numDigDec;if(T.consumedDecimal&&I<e.numberDecimals&&(T.consumedThousands||y>0?I=e.numberDecimals:void 0!==v&&(I=e.currencyDecimals)),void 0!==T.format)N=T.format;else if(v===p.DollarUS)N=T.consumedDecimal?i.KnownFormat.USCoCurrencyDec:i.KnownFormat.USCoCurrency;else if(v===p.DollarExtra)N=(0,a.buildCurrencyFormat)({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.CurrencyFormat.Paren},!1,T.consumedDecimal?2:0,!0,!1,e.isChinaT?(0,a.buildQuoted)(e,"NT$"):(0,a.buildQuoted)(e,"US$"));else if(T.numShape===i.NumberShape.Thai&&e.isThai)N=void 0!==v?T.consumedDecimal?i.KnownFormat.CoCurrencyDec_Tha:i.KnownFormat.CoCurrency_Tha:y>0?T.consumedDecimal?i.KnownFormat.Pct_Tha:i.KnownFormat.Pct0_Tha:T.consumedThousands?T.consumedDecimal?i.KnownFormat.Fixed_Tha:i.KnownFormat.Fixed0_Tha:T.consumedDecimal?i.KnownFormat.NoComFixed_Tha:i.KnownFormat.NoComFixed0_Tha;else if(T.numShape!==i.NumberShape.ASCII)N=(0,a.buildNumShapeConstFormat)(e,t,T.numShape,void 0!==v,y>0,T.consumedThousands,I,R);else if(void 0!==v)switch(s){case h.None:N=T.consumedDecimal?i.KnownFormat.CoCurrencyDec:i.KnownFormat.CoCurrency;break;case h.Lead:N=(0,a.buildCurrencyFormat)({...e,isCurrencySymbolLead:!0,isCurrencySepBySpace:!0,currencyFormat:i.CurrencyFormat.Lead},!0,T.consumedDecimal?2:0,!0,!1,"[$€-x-euro2]");break;case h.Trail:N=(0,a.buildCurrencyFormat)({...e,isCurrencySymbolLead:!1,isCurrencySepBySpace:!0,currencyFormat:i.CurrencyFormat.Lead},!0,T.consumedDecimal?2:0,!0,!1,"[$€-x-euro1]")}else N=y>0?T.consumedDecimal?i.KnownFormat.Pct:i.KnownFormat.Pct0:T.consumedThousands?T.consumedDecimal?i.KnownFormat.Fixed:i.KnownFormat.Fixed0:i.KnownFormat.General;return(0,n.success)({value:R,format:N})}!function(e){e[e.Default=0]="Default",e[e.DollarUS=1]="DollarUS",e[e.DollarExtra=2]="DollarExtra"}(p||(p={})),function(e){e[e.None=0]="None",e[e.Lead=1]="Lead",e[e.Trail=2]="Trail"}(h||(h={}))},6964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initParseDateGlobals=function(e){return{config:e.config,getTime:e.getTime?.bind(e)??d.getTime}},t.parseDateInternal=function(e,t,r,a){const{config:s}=e,{localeInfo:c}=s;if(!c.isEastAsia&&!function(e,t){for(const r of(0,n.codePointIterator)(t))if(e.isNumeral(r))return!0;return!1}(c,t))return(0,n.success)(void 0);if(c.isEastAsia)return(0,n.failure)((0,i.notImplemented)(["parse East Asia date"]));if(c.isThai){let e=t.indexOf("b");if(e<0&&(e=t.indexOf("B")),e>=0&&e+1<t.length&&c.isNumeral((0,n.stringCodePointAt)(t,e+1)))return(0,n.failure)((0,i.notImplemented)(["parse Thai Buddhist date"]))}const d=function(e,t,r){const{localeInfo:a,dateCompatibility:o}=e,s=[];let c=r?.bidiDate,d=i.NumberShape.ASCII;const g=r?.culture;let p,h=!1,f=!1;for(let e=0;e<t.length;){if(s.length>=9)return(0,n.success)(void 0);let r;if(a.isNumeral((0,n.stringCodePointAt)(t,e))||!o&&e+1<t.length&&t.charCodeAt(e)===l&&a.isNumeral((0,n.stringCodePointAt)(t,e+1))){const[o,s]=L(a,t,e,p);if(void 0===o)return(0,n.success)(void 0);e=s,o.numShape!==i.NumberShape.ASCII&&(d=o.numShape),r=o}else{if(t.charCodeAt(e)===u)return(0,n.failure)((0,i.notImplemented)(["absurd date/time string with leading space"]));{const[i,o]=_(a,t,e);if(void 0===i)return(0,n.success)(void 0);if(e=o,i.kind===m.Month){if(h)return(0,n.success)(void 0);h=!0,void 0!==i.bidiDate&&(c=i.bidiDate)}if(i.kind===m.AMPM){if(f)return(0,n.success)(void 0);if(f=!0,0===s.length||s[s.length-1].sep!==C.Space)return(0,n.success)(void 0);p=s[s.length-1].sep=C.Time}r=i}}const[g,S]=x(a,t,e,p);for(e=S;e<t.length&&t.charCodeAt(e)===u;)e+=1;s.push({tok:r,sep:g}),p=g}return(0,n.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==s.length),(0,n.success)({tokens:s,bidiDate:c,numShape:d,culture:g})}(s,t,r);if(!(0,n.isSuccess)(d)||void 0===d.value)return d;const{tokens:g,bidiDate:p,numShape:h,culture:f}=d.value;if(p===o.BidiDate.Lunar)return(0,n.failure)((0,i.notImplemented)(["Lunar calendar"]));if(void 0!==f&&(f.localCalendarInput||f.tag===o.CultureTag.Gannen))return(0,n.failure)((0,i.notImplemented)(["parse date: possible local calendar"]));const S=function(e,t){const{localeInfo:r}=e;let a,o,s,u,l,c,d;for(let e=0;e<t.length;e+=1)if(k(t[e].sep)){a={start:e,end:e+1};break}if(void 0!==a){if(0!==a.start&&t[a.start-1].sep!==C.Space&&!E(r,t[a.start-1].sep))return(0,n.success)(void 0);for(;a.end<t.length&&k(t[a.end-1].sep);)a.end+=1;if(a.end<t.length&&t[a.end-1].sep===C.FracSec){a.end+=1;const e=t[a.end-1];if(e.tok.kind!==m.Number)return(0,n.success)(void 0);if(e.tok,c=e,a.end<t.length&&k(t[a.end-1].sep)){a.end+=1;const e=t[a.end-1];if(e.tok.kind!==m.AMPM)return(0,n.failure)((0,i.notImplemented)(["non-AM/PM after FracSec"]));e.tok,d=e}}else{const e=t[a.end-1];e.tok.kind===m.AMPM&&(e.tok,d=e)}const e=a.end-a.start-(void 0!==c?1:0)-(void 0!==d?1:0);for(let r=0;r<e;r+=1)if(t[a.start+r].tok.kind!==m.Number)return(0,n.failure)((0,i.notImplemented)(["non-number in H/M/S component"]));switch(e){case 0:return(0,n.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,n.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===c),s=t[a.start];break;case 2:void 0===c?(s=t[a.start],u=t[a.start+1]):(u=t[a.start],l=t[a.start+1]);break;case 3:s=t[a.start],u=t[a.start+1],l=t[a.start+2];break;default:return(0,n.success)(void 0)}for(let e=a.end;e<t.length;e+=1)if(k(t[e].sep))return(0,n.success)(void 0);if(a.end===t.length){const e=t[a.end-1].sep;if(!(A(e)||void 0!==d&&e===C.FracSec))return(0,n.failure)((0,i.notImplemented)(["trailing sep after time"]))}else{const e=t[a.end-1].sep;if(!A(e)&&e!==C.Intl1St3)return(0,n.failure)((0,i.notImplemented)(["unexpected sep between time and date"]))}if(0===a.start)a.end!==t.length&&(o={start:a.end,end:t.length});else{if(a.end!==t.length)return(0,n.failure)((0,i.notImplemented)(["date part split around time part"]));o={start:0,end:a.start}}}else o={start:0,end:t.length};return(0,n.success)({time:a,date:o,hour:s,min:u,sec:l,fracSec:c,ampm:d})}(s,g);if(!(0,n.isSuccess)(S)||void 0===S.value)return S;const{time:v,date:y,hour:F,min:R,sec:N,fracSec:I,ampm:M}=S.value,D=function(e,t,r,a){const{config:o}=e,{localeInfo:s,dateCompatibility:u,datepack:l}=o;let c,d,g,p=!1;if(void 0!==a){const e=a.end-a.start;if(e<2||e>3)return(0,n.success)(void 0);const{tok:t,sep:o}=r[a.start],{tok:l,sep:h}=r[a.start+1],{tok:f,sep:S}=r[a.end-1];if((0,n.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",t.kind!==m.AMPM&&l.kind!==m.AMPM&&f.kind!==m.AMPM),!A(S)&&!E(s,S))return(0,n.success)(void 0);const v=void 0!==function(e,t){for(let r=t.start;r<t.end;r+=1)if(e[r].tok.kind===m.Month)return r}(r,a);if(p=v,v)if(T(o)&&T(h))if(t.kind===m.Month){if(e>2)return(0,n.success)(void 0);d=t,(0,n.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",f.kind!==m.Month),c=f}else{if(l.kind!==m.Month)return(0,n.success)(void 0);g=t,d=l,3===e&&((0,n.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",f.kind!==m.Month),c=f)}else{if(3!==e)return(0,n.success)(void 0);if(A(h))return(0,n.success)(void 0);const r=s.longDateFormat?t:l,i=s.longDateFormat?l:t;if(r.kind!==m.Month)return(0,n.success)(void 0);(0,n.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",i.kind!==m.Month&&f.kind!==m.Month),g=i,d=r,c=f}else if((0,n.assertTrue)("calc.numfmt.parseDateInternal: all not Month",t.kind!==m.Month&&l.kind!==m.Month&&f.kind!==m.Month),2===e&&o===C.Date)switch(p=!0,s.dateOrder){case i.DateOrder.MDY:d=t,c=f;break;case i.DateOrder.YMD:P(t.value,1,12)?(d=t,g=f):(c=t,d=f);break;case i.DateOrder.DMY:P(f.value,1,12)?(g=t,d=f):(d=t,c=f);break;default:return(0,n.failure)((0,i.notImplemented)(["date parse date order"]))}else{if(e<3||o!==C.Date||h!==C.Date)return(0,n.success)(void 0);switch(t.value>999||!u&&t.value>99?i.DateOrder.YMD:s.dateOrder){case i.DateOrder.MDY:d=t,g=l,c=f;break;case i.DateOrder.YMD:c=t,d=l,g=f;break;case i.DateOrder.DMY:g=t,d=l,c=f;break;default:return(0,n.failure)((0,i.notImplemented)(["date parse date order"]))}}}let h=!1;if(s.dateOrder!==i.DateOrder.DMY&&void 0===g&&void 0!==d&&P(d.value,1,12)&&void 0!==c&&P(c.value,1,31)){const r=O(e,t);if(!(0,n.isSuccess)(r))return r;c.value<=l.daysPerMonth(d.value,r.value,u)&&(g=c,c=b(r.value,4,i.NumberShape.ASCII),h=!0)}return(0,n.success)({yr:c,mon:d,dom:g,useMonthName:p,usingCurrentYear:h})}(e,a,g,y);if(!(0,n.isSuccess)(D)||void 0===D.value)return D;const{yr:w,mon:B,dom:W,useMonthName:U,usingCurrentYear:G}=D.value,j=function(e,t,r,a,o,s,u,l,c,d){const{config:m}=e,{mathpack:g,datepack:p,dateCompatibility:h}=m;let f,S,v;if(void 0!==a||void 0!==o||void 0!==r){if((0,n.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==o||void 0!==r),(0,n.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==a),S=a.value,!P(S,1,12))return(0,n.success)(void 0);if(void 0===r){const r=O(e,t);if(!(0,n.isSuccess)(r))return r;f=r.value}else f=P(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!P(f,1900,9999))return(0,n.success)(void 0);if(v=o?.value??1,!P(v,1,p.daysPerMonth(S,f,h)))return(0,n.success)(void 0)}else{const e=p.fromNum(m,g.zero,i.Rounding.RoundSec);(0,n.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==e),({yr:f,mon:S,dom:v}=e)}let y,F=0,b=0,C=0,k=0,E=i.Rounding.RoundSec,A=0;if(void 0!==s){if(s.value<0)return(0,n.failure)((0,i.notImplemented)(["negative hour"]));if(s.value>23){if(void 0!==y)return(0,n.success)(void 0);A=s.value,y=i.TimeDivision.Hour}else F=s.value}if(void 0!==u){if(u.value<0)return(0,n.failure)((0,i.notImplemented)(["negative minute"]));if(u.value>59){if(void 0!==y)return(0,n.success)(void 0);A=u.value,y=i.TimeDivision.Minute}else b=u.value}if(void 0!==l){if(l.value<0)return(0,n.failure)((0,i.notImplemented)(["negative second"]));if(l.value>59){if(void 0!==y)return(0,n.success)(void 0);A=l.value,y=i.TimeDivision.Second}else C=l.value}if(void 0!==c){if(c.value<0)return(0,n.failure)((0,i.notImplemented)(["negative fractional second"]));(0,n.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",c.digits>=1&&c.digits<=3),E=c.digits,(0,n.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",c.value<(3===E?1001:2===E?100:10)),k=c.value}if(void 0!==d){if(void 0!==y||F>12)return(0,n.success)(void 0);d.am?12===F&&(F=0):F<12&&(F+=12)}const T=(0,i.dateTime)(f,S,v,F,b,C,1,k,E),R=void 0!==y?p.toNumWithDuration(m,T,y,A):p.toNum(m,T);return(0,i.isErrorOper)(R)?(0,n.success)(void 0):(0,n.success)({value:R,duration:y})}(e,a,w,B,W,F?.tok,R?.tok,N?.tok,I?.tok,M?.tok);if(!(0,n.isSuccess)(j)||void 0===j.value)return j;const{value:V,duration:H}=j.value,q=function(e,t,r,a,o,s,u,l,c,d,m,g,p){if(l)return c?.sep===C.TimeAlt?(0,n.success)(e.sysTimeFormat):void 0!==m?(0,n.success)(K(e,t,i.KnownFormat.SS0,i.KnownFormat.SS0_Tha)):void 0!==p?p!==i.TimeDivision.Hour||void 0!==g||r?(0,n.success)(i.KnownFormat.General):(0,n.success)(K(e,t,i.KnownFormat.AbsHMMSS,i.KnownFormat.AbsHMMSS_Tha)):r?(0,n.success)(K(e,t,i.KnownFormat.MDYHMS,i.KnownFormat.MDYHMS_Tha)):void 0!==g?(0,n.success)(K(e,t,void 0!==d?i.KnownFormat.HHMMSSAP:i.KnownFormat.HHMMAP,void 0!==d?i.KnownFormat.HHMMSS_Tha:i.KnownFormat.HHMM_Tha)):(0,n.success)(K(e,t,void 0!==d?i.KnownFormat.HHMMSS:i.KnownFormat.HHMM,void 0!==d?i.KnownFormat.HHMMSS_Tha:i.KnownFormat.HHMM_Tha));if((0,n.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",r),!s)return(0,n.success)(K(e,t,i.KnownFormat.MMDDYY,i.KnownFormat.MMDDYY_Tha));const h=void 0!==a&&!u,f=K(e,t,void 0===o?i.KnownFormat.MMMYY:h?i.KnownFormat.DDMMMYY:i.KnownFormat.DDMMM,void 0===o?i.KnownFormat.MMMYY_Tha:h?i.KnownFormat.DDMMMYY_Tha:i.KnownFormat.DDMMM_Tha);return e.isEastAsia&&f===i.KnownFormat.DDMMM&&r?(0,n.failure)((0,i.notImplemented)(["parseDateInternal ifmt for East Asian DDMMM"])):(0,n.success)(f)}(c,h,void 0!==y,w,W,U,G,void 0!==v,R,N,I,M,H);return(0,n.isSuccess)(q)?(0,n.success)({value:V,format:q.value}):q};const n=r(6913),i=r(6592),a=r(4243),o=r(3739),{codePointSlash:s,codePointSpace:u,codePointMinusSign:l,codePointColon:c}=n.codePoint,d={getTime:()=>(0,n.assertFalse)("calc.numfmt.parseDateInternal: default getTime")};var m;function g(e,t){return(0,n.assertTrue)("calc.numfmt.monthToken",P(e,1,12)),{kind:m.Month,value:e,bidiDate:t}}!function(e){e[e.Month=0]="Month",e[e.AMPM=1]="AMPM",e[e.Number=2]="Number"}(m||(m={}));const p=[...new Array(12)].map(((e,t)=>g(t+1))),h=e=>p[e],f=e=>g(e+1,o.BidiDate.English),S=e=>g(e+1,o.BidiDate.Lunar),[v,y]=[!0,!1].map((e=>({kind:m.AMPM,am:e}))),F=e=>0===e?v:y;function b(e,t,r){return(0,n.assertTrue)("calc.numfmt.numberToken",(0,n.isInteger)(e)&&P(e,-9999,9999)&&P(t,1,4)),{kind:m.Number,value:e,digits:t,numShape:r}}var C;!function(e){e[e.Nil=0]="Nil",e[e.Space=1]="Space",e[e.Date=2]="Date",e[e.Time=3]="Time",e[e.TimeAlt=4]="TimeAlt",e[e.FracSec=5]="FracSec",e[e.Intl1St3=6]="Intl1St3"}(C||(C={}));const k=e=>e===C.Time||e===C.TimeAlt,E=(e,t)=>e.lcid===i.LCID.Hungarian&&t===C.Date,A=e=>e<=C.Space,T=e=>e<=C.Date,R=["上午","下午"],N={[i.Country.FRN]:[["Jun",g(6)],["Jul",g(7)]],[i.Country.DUT]:[["Mrt",g(3)]],[i.Country.GER]:[["Mrz",g(3)]]},I=["محرم","صفر","ربيع الاول","ربيع الثاني","جمادى الاولى","جمادى الثانية","رجب","شعبان","رمضان","شوال","ذو القعدة","ذو الحجة"];function P(e,t,r){return e>=t&&e<=r}function O(e,t){const r=e.getTime(i.TimeGranularity.Year,t);if(!(0,n.isSuccess)(r))return r;const a=e.config,o=a.datepack.fromNum(a,r.value,i.Rounding.RoundSec);return(0,n.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==o),(0,n.success)(o.yr)}function M(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function D(e,t,r,i,a,o){const s=t.indexOf(" ",r);for(let u=0;u<i.length;u+=1){const l=i[u],c=(0,n.fastMin)(a,l.length);if(s>=0&&l.indexOf(" ")<0&&s-r>=c&&s-r<=l.length){const n=l.substring(0,s-r);if(M(e,n,t,r))return[o(u),r+n.length]}let d;for(let n=c;n<=l.length;n+=1){const i=l.substring(0,n);if(!M(e,i,t,r))break;d=r+i.length}if(void 0!==d)return[o(u),d]}}function w(e,t,r,n,i){for(let a=0;a<n.length;a+=1){const o=n[a];if(M(e,o,t,r))return[i(a),r+o.length]}}function _(e,t,r){const n=N[e.country];if(void 0!==n)for(const[i,a]of n)if(M(e,i,t,r))return[a,r+i.length];let a;if(e.isEastAsia){if(a=D(e,t,r,(0,i.getEnglishLocaleInfo)().monthNameLong,3,h),void 0!==a)return a}else if(e.isComplexScript){if(a=w(e,t,r,e.monthNameLong,h),void 0!==a)return a;if(a=w(e,t,r,e.monthNameShort,h),void 0!==a)return a;if(a=w(e,t,r,(0,i.getEnglishLocaleInfo)().monthNameLong,f),void 0!==a)return a;if(a=w(e,t,r,(0,i.getEnglishLocaleInfo)().monthNameShort,f),void 0!==a)return a}else if(a=D(e,t,r,e.monthNameLong,3,h),void 0!==a)return a;return(e.lcid&i.LCID.LANG)==(i.LCID.Arabic&i.LCID.LANG)&&(a=w(e,t,r,I,S),void 0!==a)?a:(a=D(e,t,r,e.ampmSymbols,1,F),void 0!==a?a:(a=D(e,t,r,(0,i.getEnglishLocaleInfo)().ampmSymbols,1,F),void 0!==a||(e.isChinaS||e.isChinaT)&&(a=D(e,t,r,R,1,F),void 0!==a)?a:[void 0,r]))}function L(e,t,r,a){let o=r;const s=t.charCodeAt(o)===l;let u,c,d;if(s&&(o+=1),a===C.FracSec){if([u,c]=(0,i.parseUint)(e,4,o+4<t.length?t.substring(0,o+4):t,o),d=c-o,(0,n.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",P(d,1,4)),4===d){let r;for(;c<t.length&&e.isNumeral(r=(0,n.stringCodePointAt)(t,c));)c+=(0,n.numCodeUnits)(r);u=Math.round(u/10),d=3}}else if([u,c]=(0,i.parseUint)(e,4,t,o),d=c-o,d>4||d>2&&u<100)return[void 0,r];if(0===d)return[void 0,r];const m=function(e,t){let r=i.NumberShape.ASCII;for(const a of(0,n.codePointIterator)(t)){const t=e.getNumberShape(a);t!==i.NumberShape.ASCII&&(r=t)}return r}(e,t.substring(o,c));return o=c,[b(s?-u:u,d,m),o]}function x(e,t,r,i){let a=C.Nil,o=r;if(t.charCodeAt(o)===u)for(a=C.Space;t.charCodeAt(o)===u;)o+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&i===C.Time&&(0,n.stringStartsWith)(t,e.timeAltSeparator,o)?(a=C.TimeAlt,o+=e.timeAltSeparator.length):(0,n.stringStartsWith)(t,e.dateSeparator,o)?(a=C.Date,o+=e.dateSeparator.length):(0,n.stringStartsWith)(t,e.timeSeparator,o)?(a=C.Time,o+=e.timeSeparator.length):(0,n.stringStartsWith)(t,e.decimalSeparator,o)&&i===C.Time?(a=C.FracSec,o+=e.decimalSeparator.length):t.charCodeAt(o)===s||t.charCodeAt(o)===l?(a=C.Date,o+=1):t.charCodeAt(o)===c?(a=C.Time,o+=1):(0,n.stringStartsWith)(t,", ",o)&&(a=C.Intl1St3,o+=2),a===C.Space&&(" "===e.dateSeparator?a=C.Date:" "===e.timeSeparator?a=C.Time:" "===e.decimalSeparator&&i===C.Time&&(a=C.FracSec)),[a,o]}function K(e,t,r,n){return t===i.NumberShape.ASCII?r:t!==i.NumberShape.Lao&&t!==i.NumberShape.Thai||!e.isThai?(0,a.buildNumShapeDateTimeFormat)(e,t,r):n}},4851:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderGeneral=p,t.renderValue=function(e,t,r){try{return(0,a.isHashesValue)(t)?(0,n.success)((0,a.hashesValue)(t.units,t.color)):(0,n.success)(function(e,{units:t,color:r,alignment:i,clip:o},l){const h=(0,a.memoizedRenderCallback)(l);let f,S;if(t.every(s))f=t;else if(h.renderWidth===1/0)f=t.map((t=>{if(t.kind!==a.FormattedUnitKind.General)return t;const r=p(e,t,g);return(0,n.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r),(0,a.formattedUnitString)(r)}));else{let r,i,s="",u="";for(let e=0;e<t.length;e+=1){const o=t[e];switch(o.kind){case a.FormattedUnitKind.String:case a.FormattedUnitKind.Blank:void 0!==r?u+=o.str:s+=o.str;break;case a.FormattedUnitKind.General:(0,n.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===r),r=e,i=o;case a.FormattedUnitKind.Flexible:}}(0,n.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==r&&void 0!==i);const l=i,c=d(h,o,s,u,"0",l.builtin,(t=>p(e,l,(0,n.fastMin)(t,g))));if("number"==typeof c)throw new m((0,a.tooWide)(c));f=t.map((e=>e.kind===a.FormattedUnitKind.General?(0,a.formattedUnitString)(c):e))}if(f.every(u))S=f;else if(h.renderWidth===1/0||h.bestFit)S=f.filter(u);else{let e,t,r="",i="";for(let n=0;n<f.length;n+=1){const o=f[n];switch(o.kind){case a.FormattedUnitKind.String:case a.FormattedUnitKind.Blank:void 0!==e?i+=o.str:r+=o.str;break;case a.FormattedUnitKind.Flexible:e=n,t=o}}(0,n.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==e&&void 0!==t);const s=t;let u=d(h,a.Clip.All,r,i,t.str,!1,(e=>(0,n.repeat)(s.str,e)));if("number"==typeof u){if(0!=(u&o))throw new m((0,a.tooWide)(u));u=""}let l=u.length/s.str.length;l=(0,n.fastMax)(l-1,0);const c=(0,n.repeat)(s.str,l);S=f.map(((t,r)=>t.kind!==a.FormattedUnitKind.Flexible?t:(0,a.formattedUnitString)(r===e?c:"")))}if(o!==a.Clip.None){let e="";for(let t=0;t<S.length;t+=1)e+=S[t].str;const t=c(h,o,e);if(h.bestFit&&t===a.Clip.CellWidth)return(0,a.renderedValue)(S,r,i,o);if(void 0!==t)throw new m((0,a.tooWide)(t))}return(0,a.renderedValue)(S,r,i,o)}(e,t,r))}catch(e){return e instanceof m?(0,n.success)((0,a.hashesValue)(e.reason,t.color)):(0,n.failure)((0,n.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{let r=d((0,a.memoizedRenderCallback)(t),e.clip,"","","#",!1,(e=>(0,n.repeat)("#",e)));if("number"==typeof r)switch(r){case a.Clip.MaxChars:r=(0,n.repeat)("#",l);break;case a.Clip.CellWidth:r="";break;default:return(0,n.assertNever)("calc.numFmt.renderHashesValue",r)}const i=(0,a.formattedUnitString)(r);return(0,n.success)((0,a.renderedValue)([i],e.color,e.alignment,e.clip))}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a=r(3739),o=r(7420),s=e=>e.kind!==a.FormattedUnitKind.General,u=e=>e.kind!==a.FormattedUnitKind.Flexible,l=255;function c(e,t,r){return 0!=(t&a.Clip.MaxChars)&&r.length>l?a.Clip.MaxChars:0!=(t&a.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?a.Clip.CellWidth:void 0}function d(e,t,r,i,a,o,s){const u=(0,n.fastMax)(0,l-r.length-i.length);let d=0===a.length?u:Math.floor(u/a.length);if(e.renderWidth!==1/0){const t=e.getTextWidth(a);t>0&&(d=(0,n.fastMin)(d,(0,n.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+i))/t),0)))}const m=s(d);if(e.bestFit&&o&&(!1===m||m.indexOf("E")>=0)){let e=1,t=m;for(;(!1===t||t.indexOf("E")>=0)&&d+e<=g;)t=s(d+e),e++;if(!1!==t)return t}let p;if(!1===m||void 0===(p=c(e,t,r+m+i))){let a=m;for(let n=d+1;n<d+50;n+=1){const o=s(n);if(!1===o)continue;if(o===a)break;const u=c(e,t,r+o+i);if(void 0!==u){!1===a&&(a=u);break}a=o}return(0,n.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==a),a}let h=p;for(let n=d-1;n>=0;n-=1){const a=s(n);if(!1===a)break;const o=c(e,t,r+a+i);if(void 0===o)return a;h=o}return h}const m=(0,i.createFailureErrorClass)("RenderHashesError"),g=11;function p(e,t,r){const i=e.fromNumber(t.num),a=t.includeSign&&e.cond(i)<0?"-":"";let s=a+e.formatGeneral(t,e.abs(i),r-a.length);if("-0"===s&&(s="0"),s.length>r)return!1;const u=s.indexOf("E");if(u>=0){const e=(0,o.convertNumberShape)(t,s.substring(0,u),t.expNumberShape),r=s.substring(u,u+2),i=(0,o.convertDigitsShape)(s.substring(u+2),t.expNumberShape);return(0,n.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===r||"E+"===r),e+r+i}return(0,o.convertNumberShape)(t,s,t.numberShape)}},8900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RibbonFormat=void 0,t.getRibbonFormat=function(e,t,r){const s=(r?.culture?.calendar??n.Calendar.Gregorian)===n.Calendar.Gregorian;switch(t){case a.GalleryGeneral:case a.KeyboardGeneral:return(0,i.getKnownFormat)(e,n.KnownFormat.General);case a.GalleryNumber:return(0,i.buildNumberFormat)(e,!1,1,e.currencyDecimals);case a.KeyboardNumber:return(0,i.buildNumberFormat)(e,!0,4,e.currencyDecimals);case a.GalleryCurrency:{const t={...e,currencyFormat:e.currencyFormat===n.CurrencyFormat.Paren?n.CurrencyFormat.Lead:e.currencyFormat};return(0,i.buildCurrencyFormat)(t,!1,e.currencyDecimals,!0,!1,void 0,!0)}case a.KeyboardCurrency:return(0,i.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case a.GalleryAccounting:case a.ButtonAccounting:return(0,i.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case a.GalleryShortDate:return s?(0,i.getKnownFormat)(e,n.KnownFormat.MMDDYY):(0,i.buildSingle)(e,n.PictureSingle.Month,n.PictureSingle.DateSep,n.PictureSingle.Day,n.PictureSingle.Sep,n.PictureSingle.Text);case a.GalleryLongDate:return s?o(e,"x-sysdate")+(0,i.buildSingle)(e,n.PictureSingle.Day,n.PictureSingle.Day,n.PictureSingle.Day,n.PictureSingle.Day,", ",n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month," ",n.PictureSingle.Day,n.PictureSingle.Day,", ",n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Year):(0,i.buildSingle)(e,n.PictureSingle.Month,n.PictureSingle.DateSep,n.PictureSingle.Day,n.PictureSingle.DateSep,n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Sep,n.PictureSingle.Text);case a.GalleryTime:return o(e,"x-systime")+(0,i.buildSingle)(e,n.PictureSingle.Hour,n.PictureSingle.Colon,n.PictureSingle.Minute,n.PictureSingle.Minute,n.PictureSingle.Colon,n.PictureSingle.Second,n.PictureSingle.Second," ")+(0,i.getSpecial)(e,n.PictureSpecial.AP1);case a.KeyboardDate:return o(e,"en-US")+(0,i.buildSingle)(e,n.PictureSingle.Day,"-",n.PictureSingle.Month,n.PictureSingle.Month,n.PictureSingle.Month,"-",n.PictureSingle.Year,n.PictureSingle.Year,n.PictureSingle.Sep,n.PictureSingle.Text);case a.KeyboardTime:return o(e,"en-US")+(0,i.buildSingle)(e,n.PictureSingle.Hour,n.PictureSingle.Colon,n.PictureSingle.Minute,n.PictureSingle.Minute," ",(0,i.getSpecial)(e,n.PictureSpecial.AP1),n.PictureSingle.Sep,n.PictureSingle.Text);case a.GalleryPercentage:return(0,i.buildPercentFormat)(e,e.currencyDecimals);case a.ButtonPercentage:case a.KeyboardPercentage:return(0,i.getKnownFormat)(e,n.KnownFormat.Pct0);case a.GalleryFraction:return(0,i.getKnownFormat)(e,n.KnownFormat.Fract);case a.GalleryScientific:case a.KeyboardScientific:return(0,i.buildScientificFormat)(e,1,e.currencyDecimals,2);case a.GalleryText:return(0,i.getKnownFormat)(e,n.KnownFormat.Text);case a.ButtonComma:return(0,i.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}};const n=r(6592),i=r(4243);var a;function o(e,t){return(0,i.buildSingle)(e,n.PictureSingle.ColorStart,"$-",t,n.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(a||(t.RibbonFormat=a={}))},3739:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberFormatSource=t.EditKind=t.renderInfiniteWidth=t.renderedValue=t.formattedValue=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.CultureTag=t.BidiDate=t.FormatValueType=t.FormatLocKind=t.aggregationError=t.fractionOverflow=t.dateOverflow=t.noFormatPart=t.ReasonKind=t.FormatReasonKind=void 0,t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.previousFormatFailure=function(e){return{kind:t.ReasonKind.PreviousFormatFailure,format:e}},t.formatLocKnownFormat=function(e,t){return{kind:o.KnownFormat,document:e,knownFormat:t}},t.formatLocIFormat=function(e,t){return{kind:o.IFormat,document:e,iformat:t}},t.isSystemCultureTag=function(e){return e===l.SysDate||e===l.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},t.formattedUnitGeneral=function(e,t,r,n,i,a){return{kind:h.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:i,builtin:a}},t.formattedUnitString=function(e){return{kind:h.String,str:e}},t.formattedUnitBlank=function(e){return{kind:h.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:h.Flexible,str:e}},t.hashesValue=function(e,t){return v(e,t,m.Center,p.All)},t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=y,t.memoizedRenderCallback=function(e){const t=(0,n.makeStringMap)();return y(e.renderWidth,(r=>{if(null!=t[r])return t[r];const n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderedValueToString=function(e){let t="";for(const r of e.units)switch(r.kind){case h.String:t+=r.str;break;case h.Blank:for(let e=0;e<r.str.length;e+=1)t+=" "}return t},t.formulaEdit=function(e){return{kind:f.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:f.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:f.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:f.Other,value:e}},t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){const r=(0,i.sheetGridRangeAnchor)(e.range);return{config:t??void 0,lexicalSource:e,originGridCell:(0,n.success)(r.range),originSheet:(0,n.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}};const n=r(6913),i=r(6592);var a,o,s,u,l,c,d,m,g,p,h,f,S;function v(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function y(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"}(a||(t.FormatReasonKind=a={})),t.ReasonKind={...i.LangReasonKind,...a},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.aggregationError={kind:t.ReasonKind.AggregationError},function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"}(o||(t.FormatLocKind=o={})),function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(s||(t.FormatValueType=s={})),function(e){e.English="English",e.Lunar="Lunar"}(u||(t.BidiDate=u={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(l||(t.CultureTag=l={})),function(e){e[e.LocaleInfo=0]="LocaleInfo"}(c||(t.FormatCurrency=c={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(d||(t.NamedColor=d={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(m||(t.Alignment=m={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(g||(t.GetTimeKind=g={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(p||(t.Clip=p={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(h||(t.FormattedUnitKind=h={})),t.formattedValue=v,t.renderedValue=v,t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:e=>e.length},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(f||(t.EditKind=f={})),function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(S||(t.NumberFormatSource=S={}))},7420:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDigitsShape=c,t.convertNumberShape=function({decimalSeparator:e},t,r){if(r===i.NumberShape.ASCII)return t;switch(r){case i.NumberShape.ArabicIndic:case i.NumberShape.ExtendedArabicIndic:case i.NumberShape.Devanagari:case i.NumberShape.Bengali:case i.NumberShape.Gurmukhi:case i.NumberShape.Gujarati:case i.NumberShape.Oriya:case i.NumberShape.Tamil:case i.NumberShape.Telugu:case i.NumberShape.Kannada:case i.NumberShape.Malayalam:case i.NumberShape.Thai:case i.NumberShape.Lao:case i.NumberShape.Tibetan:case i.NumberShape.Myanmar:case i.NumberShape.Ethiopic:case i.NumberShape.Khmer:case i.NumberShape.Mongolian:{const n=t.indexOf(e);return c(t.substring(0,n<0?void 0:n),r)+(n<0?"":e)+(n<0?"":c(t.substring(n+e.length),r))}case i.NumberShape.ChineseTrad1:case i.NumberShape.ChineseTrad2:case i.NumberShape.ChineseTrad3:case i.NumberShape.ChineseSimp1:case i.NumberShape.ChineseSimp2:case i.NumberShape.ChineseSimp3:case i.NumberShape.Japanese1:case i.NumberShape.Japanese2:case i.NumberShape.Japanese3:case i.NumberShape.Korean1:case i.NumberShape.Korean2:case i.NumberShape.Korean3:case i.NumberShape.Korean4:{const i=l[r],o="ChineseSimp"===i.langId||"ChineseTrad"===i.langId,u=2===i.dbnum||"Korean"===i.langId&&(1===i.dbnum||4===i.dbnum),c=t.indexOf(e);let p=0,h=c<0?t.length:c,f="";if(h>12){if(h>16)for(;12<h;h--,p++)f+=d(i,t.charCodeAt(p));else{let e=16,r=m.Thousand,n=!1;do{if(e>h){e--,r--;continue}const l=t.charCodeAt(p);l!==a?((o||u||l>s||e%4==1)&&(o&&n&&(f+=d(i,a),n=!1),f+=d(i,l)),r>=m.Ten&&(f+=g(i,r))):n=!0,e--,r--,h--,p++}while(e>12)}f+=g(i,m.Trillion)}{let e=12;do{let r=m.Thousand,n=!1,l=!1;do{if(e>h){e--,r--;continue}const c=t.charCodeAt(p);c!==a||0===f.length?((o||u||c>s||e%4==1)&&(o&&l&&(f+=d(i,a),l=!1),f+=d(i,c)),r>=m.Ten&&(f+=g(i,r)),n=!0):l=!0,e--,r--,h--,p++}while(e%4);n&&h/4!=0&&(8===h?f+=g(i,m.HundredMillion):4===h&&(f+=g(i,m.TenThousand)))}while(h>0)}if(p!==t.length)for((0,n.assertTrue)("calc.numfmt.convertNumberShape",c>=0&&p===c),f+=e,p=c+e.length;p<t.length;p++)f+=d(i,t.charCodeAt(p));return f}default:return(0,n.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";const i=(0,n.countCodePoints)(t,0,t.length);let a="";for(let o=0,s=0;o<t.length;){const u=(0,n.stringCodePointAt)(t,o),l=(0,n.numCodeUnits)(u);a+=t.substring(o,o+l),o+=l,s+=1,e.isThousandsPosition(r+(i-s))&&(a+=e.thousandsSeparator)}return a};const n=r(6913),i=r(6592),{codePointDigitZero:a,codePointDigitNine:o,codePointDigitOne:s}=n.codePoint,u={[i.NumberShape.ArabicIndic]:{zero:1632,one:1633},[i.NumberShape.ExtendedArabicIndic]:{zero:1776,one:1777},[i.NumberShape.Devanagari]:{zero:2406,one:2407},[i.NumberShape.Bengali]:{zero:2534,one:2535},[i.NumberShape.Gurmukhi]:{zero:2662,one:2663},[i.NumberShape.Gujarati]:{zero:2790,one:2791},[i.NumberShape.Oriya]:{zero:2918,one:2919},[i.NumberShape.Tamil]:{zero:48,one:3047},[i.NumberShape.Telugu]:{zero:3174,one:3175},[i.NumberShape.Kannada]:{zero:3302,one:3303},[i.NumberShape.Malayalam]:{zero:3430,one:3431},[i.NumberShape.Thai]:{zero:3664,one:3665},[i.NumberShape.Lao]:{zero:3792,one:3793},[i.NumberShape.Tibetan]:{zero:3872,one:3873},[i.NumberShape.Myanmar]:{zero:4160,one:4161},[i.NumberShape.Ethiopic]:{zero:48,one:4969},[i.NumberShape.Khmer]:{zero:6112,one:6113},[i.NumberShape.Mongolian]:{zero:6160,one:6161}},l={[i.NumberShape.Japanese1]:{digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:1},[i.NumberShape.Japanese2]:{digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:2},[i.NumberShape.Japanese3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:3},[i.NumberShape.Korean1]:{digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:1},[i.NumberShape.Korean2]:{digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:2},[i.NumberShape.Korean3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:3},[i.NumberShape.Korean4]:{digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312,langId:"Korean",dbnum:4},[i.NumberShape.ChineseSimp1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:1},[i.NumberShape.ChineseSimp2]:{digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:2},[i.NumberShape.ChineseSimp3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:3},[i.NumberShape.ChineseTrad1]:{digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:1},[i.NumberShape.ChineseTrad2]:{digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:2},[i.NumberShape.ChineseTrad3]:{digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:3}};function c(e,t){if(t===i.NumberShape.ASCII)return e;switch(t){case i.NumberShape.ArabicIndic:case i.NumberShape.ExtendedArabicIndic:case i.NumberShape.Devanagari:case i.NumberShape.Bengali:case i.NumberShape.Gurmukhi:case i.NumberShape.Gujarati:case i.NumberShape.Oriya:case i.NumberShape.Tamil:case i.NumberShape.Telugu:case i.NumberShape.Kannada:case i.NumberShape.Malayalam:case i.NumberShape.Thai:case i.NumberShape.Lao:case i.NumberShape.Tibetan:case i.NumberShape.Myanmar:case i.NumberShape.Ethiopic:case i.NumberShape.Khmer:case i.NumberShape.Mongolian:{let r="";const i=u[t];for(let t=0;t<e.length;t+=1){const u=e.charCodeAt(t);(0,n.assertTrue)("calc.numfmt.convertDigitsShape",a<=u&&u<=o),r+=u===a?(0,n.stringFromCodePoint)(i.zero):(0,n.stringFromCodePoint)(i.one+(u-s))}return r}case i.NumberShape.ChineseTrad1:case i.NumberShape.ChineseTrad2:case i.NumberShape.ChineseTrad3:case i.NumberShape.ChineseSimp1:case i.NumberShape.ChineseSimp2:case i.NumberShape.ChineseSimp3:case i.NumberShape.Japanese1:case i.NumberShape.Japanese2:case i.NumberShape.Japanese3:case i.NumberShape.Korean1:case i.NumberShape.Korean2:case i.NumberShape.Korean3:case i.NumberShape.Korean4:{let r="";const n=l[t];for(let t=0;t<e.length;t+=1)r+=d(n,e.charCodeAt(t));return r}}}function d(e,t){return(0,n.assertTrue)("calc.numfmt.ideographicDigit",a<=t&&t<=o),(0,n.stringFromCodePoint)(e.digits[t-a])}var m;function g(e,t){switch(t){case m.Ten:return(0,n.stringFromCodePoint)(e.ten);case m.Hundred:return(0,n.stringFromCodePoint)(e.hundred);case m.Thousand:return(0,n.stringFromCodePoint)(e.thousand);case m.TenThousand:return(0,n.stringFromCodePoint)(e.tenThousand);case m.HundredMillion:return(0,n.stringFromCodePoint)(e.hundredMillion);case m.Trillion:return(0,n.stringFromCodePoint)(e.trillion);default:return(0,n.assertFalse)("calc.numfmt.ideographicRank")}}!function(e){e[e.Ten=10]="Ten",e[e.Hundred=11]="Hundred",e[e.Thousand=12]="Thousand",e[e.TenThousand=13]="TenThousand",e[e.HundredMillion=14]="HundredMillion",e[e.Trillion=15]="Trillion"}(m||(m={}))},4759:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initUtilGlobals=function(e){return{config:e.config,getKnownFormat:e.getKnownFormat?.bind(e)??o.getKnownFormat,getIformat:e.getIformat?.bind(e)??o.getIformat,getFormatString:e.getFormatString?.bind(e)??o.getFormatString}},t.getFormatString=function(e,t,r,i,a){const o=t.getFormatString(r,i);return(0,n.isSuccess)(o)?void 0!==o.value?t.getIformat(r,o.value):e.createFormat(i,a):o},t.applyFormatAndRenderToString=function(e,t,r){const o=(0,i.isStringOper)(r)?a.Clip.None:a.Clip.All,s=t.apply(r,a.Alignment.Right,o,!0);if(!(0,n.isSuccess)(s))return s;const u=e.renderValue(s.value,a.renderInfiniteWidth);return(0,n.isSuccess)(u)?(0,a.isHashesValue)(u.value)?(0,n.success)(u.value.units):(0,n.success)((0,a.renderedValueToString)(u.value)):u};const n=r(6913),i=r(6592),a=r(3739),o={getKnownFormat:()=>(0,n.assertFalse)("calc.numfmt: default getKnownFormat"),getIformat:()=>(0,n.assertFalse)("calc.numfmt: default getIformat"),getFormatString:()=>(0,n.assertFalse)("calc.numfmt: default getFormatString")}},3434:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,u){let l=r;if(u.kind===s.EditKind.Number&&u.format!==i.KnownFormat.General){const i=u.format,s="string"==typeof i?i:(0,o.getKnownFormat)(t,i),c="string"!=typeof i,d=e.createFormat(s,c);if(!(0,n.isSuccess)(d))return d;const m=d.value;(0,a.shouldInstallFormat)(m,r)&&(l=m)}return e.applyFormat(l,u.value,!0)},t.toXLNumber=function(e,t,r){const i=t.parseGeneral(r,!1,!0,s.GetTimeKind.NonVolatile);return(0,n.isSuccess)(i)?null==i.value?(0,n.failure)(null):(0,n.success)(e.toNumber(i.value.value)):i};const n=r(6913),i=r(6592),a=r(9471),o=r(4243),s=r(3739)},1764:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},1935:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sumproduct=void 0,t.sum=function(e,t){const r=e.dereferenceAllOpers(t);return v(e,r)},t.sumsq=function(e,t){const r=e.dereferenceAllOpers(t),n=oe(d),i=(0,o.reduceDerefOpers)(e,g(e.mathpack.add),n,r);return null==i?e.mathpack.zero:i},t.sumif=b,t.sumifs=function(e,t){if(3===t.length)return b(e,[t[1],t[2],t[0]]);const r=C(e,t);return(0,n.isSuccess)(r)?S(e,[r.value]):r.reason},t.product=function(e,t){const r=e.dereferenceAllOpers(t);return k(e,r)},t.average=function(e,t){const r=e.dereferenceAllOpers(t);return R(e,r)},t.averageif=I,t.averageifs=function(e,t){if(3===t.length)return I(e,[t[1],t[2],t[0]]);const r=C(e,t,void 0,!0);return(0,n.isSuccess)(r)?T(e,[r.value]):r.reason},t.averagea=function(e,t){const r=e.dereferenceAllOpers(t);return N(e,r)},t.concat=function(e,t){const r=e.dereferenceAllOpers(t);return P(e,[],!0,t,r)},t.textjoin=function(e,t){const[r,a,...u]=t,l=[];if(!(0,i.isMissingOper)(r)){if((0,i.isRangeOper)(r)&&r.ranges.length>1)return i.valueErrorOper;const t=(e,t)=>e.coerceOper(t,i.OperKind.String),a=(0,o.reduceDerefOpers)(e,$(l,s.assertString),t,e.dereferenceAllOpers([r]));if(void 0!==a&&(0,i.isErrorOper)(a))return a;(0,n.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==a&&(0,i.isStringOper)(a))}return P(e,l,(0,i.isMissingOper)(a)||a.value,u,e.dereferenceAllOpers(u))},t.count=function(e,t){const r=e.dereferenceAllOpers(t);return M(e,r)},t.countblank=function(e,t){const r=t[0];if(!(0,i.isSheetIndex)(r.sheets)||1!==r.ranges.length)return i.valueErrorOper;const n=e.dereferenceAllOpers(t);return D(e,n)},t.counta=function(e,t){const r=e.dereferenceAllOpers(t);return w(e,r)},t.countif=L,t.countifs=function(e,t){if(2===t.length)return L(e,t);const r=C(e,t,!0);return(0,n.isSuccess)(r)?_(e,[r.value]):r.reason},t.max=function(e,t){const r=e.dereferenceAllOpers(t);return W(e,r)},t.min=function(e,t){const r=e.dereferenceAllOpers(t);return U(e,r)},t.maxa=function(e,t){const r=e.dereferenceAllOpers(t);return G(e,r)},t.mina=function(e,t){const r=e.dereferenceAllOpers(t);return j(e,r)},t.maxifs=function(e,t){const r=C(e,t);return(0,n.isSuccess)(r)?W(e,[r.value]):r.reason},t.minifs=function(e,t){const r=C(e,t);return(0,n.isSuccess)(r)?U(e,[r.value]):r.reason},t.and=function(e,t){const r=e.dereferenceAllOpers(t);return q(e,r)},t.or=function(e,t){const r=e.dereferenceAllOpers(t);return z(e,r)},t.xor=function(e,t){const r=e.dereferenceAllOpers(t);return Q(e,r)},t.large=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return J(e,r,n)},t.small=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return X(e,r,n)},t.percentile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ee(e,r,n)},t.percentile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return te(e,r,n)},t.quartile=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ne(e,r,n)},t.quartile_exc=function(e,t){const[r,n]=e.dereferenceAllOpers(t);return ie(e,r,n)},t.median=function(e,t){const r=e.dereferenceAllOpers(t);return ae(e,r)},t.trimmean=function(e,t){const[r,a]=e.dereferenceAllOpers(t);let u=[];const l=(0,o.reduceDerefOpers)(e,$(u,s.assertNumber),d,[r]);if(null==l)return i.numErrorOper;if((0,i.isErrorOper)(l))return l;const c=e.mathpack;if(c.cond(a)<0)return i.numErrorOper;if(c.cond2(a,c.one)>=0)return i.numErrorOper;u=u.sort(c.cond2);const m=c.lfix((0,s.assertNumber)(c.div((0,s.assertNumber)(c.mul(c.fromNumber(u.length),a)),c.fromNumber(2))));(0,n.assertTrue)("calc.funcs.trimmean",m+m<u.length);const p=u[m],h=u[u.length-1-m];let f=0,S=0;const v=(0,o.reduceDerefOpers)(e,g(e.mathpack.add),((e,t)=>{const r=d(0,t);if(void 0===r)return r;(0,n.assertTrue)("calc.funcs.trimmean: unexpected error",(0,i.isNumberOper)(r));const a=e.mathpack;if(a.cond2(r,p)<0)f+=1;else{if(!(a.cond2(r,h)>0))return r;S+=1}}),[r]);(0,n.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==v&&(0,i.isNumberOper)(v)),(0,n.assertTrue)("calc.funcs.trimmean: trimmed too many",f<=m&&S<=m);let y=v;for(;f<m;f+=1){const e=c.sub(y,p);if((0,i.isErrorOper)(e))return e;y=e}for(;S<m;S+=1){const e=c.sub(y,h);if((0,i.isErrorOper)(e))return e;y=e}return c.div(y,c.fromNumber(u.length-m-m))},t.stdev=function(e,t){const r=e.dereferenceAllOpers(t);return Se(e,r)},t.stdevp=function(e,t){const r=e.dereferenceAllOpers(t);return ve(e,r)},t.stdeva=function(e,t){const r=e.dereferenceAllOpers(t);return ye(e,r)},t.stdevpa=function(e,t){const r=e.dereferenceAllOpers(t);return Fe(e,r)},t.var_=function(e,t){const r=e.dereferenceAllOpers(t);return me(e,r)},t.varp=function(e,t){const r=e.dereferenceAllOpers(t);return ge(e,r)},t.vara=function(e,t){const r=e.dereferenceAllOpers(t);return pe(e,r)},t.varpa=function(e,t){const r=e.dereferenceAllOpers(t);return he(e,r)},t.mode=function(e,t){return ke(e,t)},t.mode_mult=function(e,t){const r=Ce(e,t);return Array.isArray(r)?(0,i.arrayOper)(r.length,1,r.map((e=>[e.value]))):r},t.subtotal=function(e,[t,...r]){const n=e.mathpack.sfix(t),a=be.length;if(!(n>=1&&n<=a||n>=101&&n<=a+100))return i.valueErrorOper;const o=n>100||e.isInFilterMode(r),s=e.dereferenceAllOpersAndFormulae(r,o).map(Ae);return(0,be[n%100-1])(e,s)},t.aggregate=function(e,t){const[r,a,s,c,...d]=t,m=e.mathpack,g=m.sfix(r),p=m.sfix(a);if(!(g>=1&&g<=Te.length+Re.length&&p>=0&&p<=7))return i.valueErrorOper;const h=1==(1&p),f=2==(2&p),S=!(4==(4&p));function v(t){let r=S?e.dereferenceAllOpersAndFormulae(t,h).map(Ae):e.dereferenceAllOpers(t,h);return f&&(r=r.map((e=>{if((0,o.isPrimitiveCoercedOper)(e))return e;if((0,l.isRangeValues)(e)){const t=e.arrays.map((e=>e.map((e=>void 0===e||(0,i.isErrorOper)(e)?void 0:e))));return(0,l.rangeValues)(t)}if((0,o.isCoercedArrayOper)(e)){const t=e.opers.map((e=>e.map((e=>void 0===e||(0,i.isErrorOper)(e)?void 0:e))));return(0,o.coercedArrayOper)(e.rows,e.cols,t)}return e}))),r}if(g>Te.length){if(void 0===c||d.length>0)return i.valueErrorOper;const t=i.OperKind.Number;!(0,i.isRangeOper)(c)||(0,i.isSheetIndex)(c.sheets)&&1===c.ranges.length&&(0,i.isGridCell)(c.ranges[0])||(0,u.throwEvaluationError)((0,i.notImplemented)(["AGGREGATE multi-cell array param"]));const r=e.coerceOper(e.dereferenceOper(c,t),t);if((0,i.isErrorOper)(r))return i.valueErrorOper;if((0,i.isRangeOper)(s)&&!(0,i.isSheetIndex)(s.sheets))return i.valueErrorOper;const[n]=v([s]),a=Te.length;return(0,Re[g-a-1])(e,n,r)}for(let e=2;e<t.length;e+=1){const r=t[e];if(!r||!(0,i.isRangeOper)(r)||!(0,i.isSheetIndex)(r.sheets))return i.valueErrorOper}const y=v(t.slice(2));return(0,n.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",g>=1&&g<=Te.length),(0,Te[g-1])(e,y)},t.rank=function(e,t){return Ne(e,t,!1)},t.rank_avg=function(e,t){return Ne(e,t,!0)},t.avedev=function(e,t){const r=e.dereferenceAllOpers(t),n=Pe(Ie,e,r);if(!Array.isArray(n))return n;const[i,a]=n;return e.mathpack.div(i,e.mathpack.fromNumber(a))},t.devsq=function(e,t){const r=e.dereferenceAllOpers(t),n=Pe(oe,e,r);if(!Array.isArray(n))return n;const[i]=n;return i},t.geomean=function(e,t){const r=e.mathpack,a=e.dereferenceAllOpers(t),s={count:0,prodExp:0};let u=(0,o.reduceDerefOpers)(e,function(e,t){const r=e.mathpack;return function(e,a,o){if(void 0!==e&&(0,i.isErrorOper)(e))return e;if((0,n.assertTrue)("calc.funcs.geometricReducer",void 0===e||(0,i.isNumberOper)(e)),(0,i.isErrorOper)(a))return a;if((0,n.assertTrue)("calc.funcs.geometricReducer",(0,i.isNumberOper)(a)),r.cond(a)<=0)return i.numErrorOper;const[s,u]=De(r,a);let l=e??r.one;for(let e=0;e<o;e+=1){if(t.count%512==511){const[e,n]=De(r,l);if(t.prodExp+=n,l=e,t.prodExp>2130706431||t.prodExp<-2130706431)return i.numErrorOper}t.count+=1,t.prodExp+=u,l=r.mul(l,s),(0,n.assertTrue)("calc.funcs.geometricReducer",!(0,i.isErrorOper)(l))}return l}}(e,s),d,a);if(null==u)return i.numErrorOper;if((0,i.isErrorOper)(u))return u;if((0,n.assertTrue)("calc.funcs.geomean",s.count>0&&(0,i.isNumberOper)(u)),1===s.count)return we(r,u,s.prodExp);{const[e,t]=De(r,u);s.prodExp+=t,u=e}const l=s.prodExp/s.count|0,c=s.prodExp%s.count,m=r.div(r.one,r.fromNumber(s.count));if((0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(m)),c<=1e3){const e=we(r,u,c),t=r.power(e,m);return(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(t)),we(r,t,l)}const g=c-1e3,p=we(r,u,c-g),h=r.power(p,m);(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(h));const f=we(r,h,l),S=r.mul(r.fromNumber(s.count),r.fromNumber(1.4426950408889636));(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(S));const v=r.div(r.fromNumber(g),S);(0,n.assertTrue)("calc.funcs.geomean",!(0,i.isErrorOper)(v));const y=r.exp(v);return(0,i.isErrorOper)(y)?y:r.mul(f,y)},t.harmean=function(e,t){const r=e.dereferenceAllOpers(t),a=(u=d,function(e,t){const r=u(e,t);if(void 0===r||!(0,i.isNumberOper)(r))return r;const n=e.mathpack;return n.cond(r)<=0?i.numErrorOper:n.div(n.one,r)}),s=(0,o.reduceDerefOpers)(e,g(e.mathpack.add),a,r);var u;if(null==s)return i.naErrorOper;if((0,i.isErrorOper)(s))return s;const l={count:0},c=(0,o.reduceDerefOpers)(e,p(l),a,r);(0,n.assertTrue)("calc.funcs.harmean",(0,i.isNumberOper)(s)&&c?.kind===i.OperKind.Number&&l.count>0);const m=e.mathpack.div(s,e.mathpack.fromNumber(l.count));return(0,i.isErrorOper)(m)?m:e.mathpack.div(e.mathpack.one,m)};const n=r(6913),i=r(6592),a=r(9231),o=r(2496),s=r(7217),u=r(4624),l=r(9001),c=r(199);function d(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;switch(r.kind){case i.OperKind.Number:return r;case i.OperKind.Boolean:case i.OperKind.String:return;case i.OperKind.Error:return r;case i.OperKind.Missing:case i.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function m(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;switch(r.kind){case i.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case i.OperKind.Number:return r;case i.OperKind.String:return e.mathpack.zero;case i.OperKind.Error:return r;case i.OperKind.Missing:case i.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function g(e){return function(t,r,a){if(void 0!==t&&(0,i.isErrorOper)(t))return t;if((0,n.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,i.isNumberOper)(t)),(0,i.isErrorOper)(r))return r;let o,s;(0,n.assertTrue)("calc.funcs.numberReducer",(0,i.isNumberOper)(r)),void 0===t?(o=r,s=a-1):(o=t,s=a);for(let t=0;t<s;t+=1){const t=e(o,r);if((0,i.isErrorOper)(t))return t;o=t}return o}}function p(e){return(t,r,n)=>(e.count+=n,r)}function h(e,t,r){if(!(0,i.isNumberOper)(r))return r;const n=function(e){for(let t=e.length-1;t>=0;t-=1){const r=e[t];if(void 0!==r&&(0,l.isRangeValues)(r))for(let e=r.arrays.length-1;e>=0;e-=1){const t=r.arrays[e];if(t.rows>t.denseRows||t.cols>t.denseCols){const e=t.getSparse();if(e?.kind===i.OperKind.Number)return e}for(let e=t.denseRows-1;e>=0;e-=1)for(let r=t.denseCols-1;r>=0;r-=1){const n=t.get(e,r);if(n?.kind===i.OperKind.Number)return n}}}}(t);return n?.kind!==i.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function f(e,t,r){let n=(0,o.reduceDerefOpers)(t,g(t.mathpack.add),d,r);return null==n?t.mathpack.zero:(e&&(n=h(t,r,n)),n)}const S=f.bind(void 0,!1),v=f.bind(void 0,!0);function y(e){return(0,i.isRangeOper)(e)&&1!==e.ranges.length}function F(e,t,r){if(y(t))return(0,n.failure)(i.valueErrorOper);if(void 0===r){const r=e.dereferenceAllOpers([t])[0];return(0,n.success)({values:r,valuesToFilter:r})}if(y(r))return(0,n.failure)(i.valueErrorOper);const{actualEvalRange:a,actualFilterRange:o}=function(e,t){const r=e.ranges[0],a=t.ranges[0],o=(0,n.fastMin)(r.cols,i.sheetCols-a.col),s=(0,n.fastMin)(r.rows,i.sheetRows-a.row),u=(0,i.gridRange)(r.row,r.col,s,o),l=(0,i.range3DOper)(e.sheets,u),c=(0,i.gridRange)(a.row,a.col,s,o);return{actualEvalRange:l,actualFilterRange:(0,i.range3DOper)(t.sheets,c)}}(t,r),s=a.ranges[0],u=o.ranges[0],l=e.dereferenceAllOpers([a])[0];if(s.col===u.col&&s.row===u.row)return(0,n.success)({values:l,valuesToFilter:l});const c=e.dereferenceAllOpers([o])[0];return(0,n.success)({values:l,valuesToFilter:c})}function b(e,[t,r,i]){const o=F(e,t,i);if(!(0,n.isSuccess)(o))return o.reason;const{values:s,valuesToFilter:u}=o.value,c=[(0,l.rangeValues)([(0,a.applyCriteria)(e,s.arrays[0],r,u.arrays[0])])];return S(e,c)}function C(e,t,r=!1,o=!1){const s=t[0];if(y(s))return(0,n.failure)(i.valueErrorOper);let u,c;if(r){const r=t[1],[n]=e.dereferenceAllOpers([s]);u=(0,a.applyCriteria)(e,n.arrays[0],r),c=2}else{const[t]=e.dereferenceAllOpers([s]);u=t.arrays[0],c=1}for(let r=c;r<t.length;r+=2){const o=t[r],l=t[r+1];if(y(o))return(0,n.failure)(i.valueErrorOper);if(o.ranges[0].cols!==s.ranges[0].cols||o.ranges[0].rows!==s.ranges[0].rows)return(0,n.failure)(i.valueErrorOper);const[c]=e.dereferenceAllOpers([o]);u=(0,a.applyCriteria)(e,c.arrays[0],l,u)}return o&&(u=u.strict()),(0,n.success)((0,l.rangeValues)([u]))}function k(e,t){const r=(0,o.reduceDerefOpers)(e,g(e.mathpack.mul),d,t);return null==r?e.mathpack.zero:r}function E(e,t,r,a,s,u){let l=(0,o.reduceDerefOpers)(s,g(s.mathpack.add),e,u,t);if(null==l)return a;if(r&&(l=h(s,u,l)),(0,i.isErrorOper)(l))return l;const c={count:0},d=(0,o.reduceDerefOpers)(s,p(c),e,u,t);(0,n.assertTrue)("calc.funcs.averageCoerceInner",(0,i.isNumberOper)(l)&&d?.kind===i.OperKind.Number&&c.count>0);const m=s.mathpack.div(l,s.mathpack.fromNumber(c.count));return(0,i.isErrorOper)(m)?m:[m,c.count]}function A(e,t,r,n,a){const o=E(e,t,r,i.div0ErrorOper,n,a);return Array.isArray(o)?o[0]:o}const T=A.bind(void 0,d,void 0,!1),R=A.bind(void 0,d,void 0,!0),N=A.bind(void 0,m,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isStringOper)(r)?e.mathpack.zero:d(0,r)}),!0);function I(e,[t,r,i]){const o=F(e,t,i);if(!(0,n.isSuccess)(o))return o.reason;const{values:s,valuesToFilter:u}=o.value,c=[(0,l.rangeValues)([(0,a.applyCriteria)(e,s.arrays[0],r,u.arrays[0]).strict()])];return T(e,c)}function P(e,t,r,a,s){let u,l=0,c="";const d=(e,t)=>e.coerceOper(t,i.OperKind.String),m=(e,a,o)=>{if(void 0!==e&&(0,i.isErrorOper)(e))return e;for(let e=0;e<o;e+=1){if(void 0!==u&&t.length>0&&(!r||u.value.length>0)){const e=t[l];if(l=(l+1)%t.length,c.length+e.value.length>i.cellStringLimit)return i.valueErrorOper;c+=e.value}if((0,i.isErrorOper)(a))return a;if((0,n.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,i.isStringOper)(a)),c.length+a.value.length>i.cellStringLimit)return i.valueErrorOper;if(c+=a.value,u=a,""===a.value&&(0===t.length||r))break}return a};for(let t=0;t<s.length;t+=1){const r=a[t];if((0,i.isRangeOper)(r)&&r.ranges.length>1)return i.valueErrorOper;const u=(0,o.reduceDerefOpers)(e,m,d,s.slice(t,t+1));if(void 0!==u&&(0,i.isErrorOper)(u))return u;(0,n.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==u&&(0,i.isStringOper)(u))}if(r&&void 0!==u&&""===u.value&&t.length>0&&c.length>0){const e=t[(l+t.length-1)%t.length];c=c.substring(0,c.length-e.value.length)}return(0,i.stringOper)(c)}function O(e,t,r){const n={count:0};return(0,o.reduceDerefOpers)(t,p(n),e,r),t.mathpack.fromNumber(n.count)}const M=O.bind(void 0,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isNumberOper)(r)?r:void 0})),D=O.bind(void 0,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isBlankOper)(r)||(0,c.isEmptyStringOper)(r)?r:void 0})),w=O.bind(void 0,(function(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isPrimitiveOper)(r)||(0,i.isErrorOper)(r)?r:void 0})),_=O.bind(void 0,((e,t)=>t));function L(e,[t,r]){if(y(t))return i.valueErrorOper;const[n]=e.dereferenceAllOpers([t]),o=[(0,l.rangeValues)([(0,a.applyCriteria)(e,n.arrays[0],r)])];return _(e,o)}const x=(e,t,r)=>e.mathpack.cond2(t,r)>0,K=(e,t,r)=>e.mathpack.cond2(t,r)<0;function B(e,t,r,a,s){const u=(0,o.reduceDerefOpers)(a,((t,r,o)=>void 0===t?r:(0,i.isErrorOper)(t)?t:((0,n.assertTrue)("calc.funcs.minMaxCoerceInner",(0,i.isNumberOper)(t)),(0,i.isErrorOper)(r)?r:((0,n.assertTrue)("calc.funcs.minMaxCoerceInner",(0,i.isNumberOper)(r)),e(a,t,r)?t:r))),t,s,r);return null==u?a.mathpack.zero:u}const W=B.bind(void 0,x,d,void 0),U=B.bind(void 0,K,d,void 0),G=B.bind(void 0,x,m,d),j=B.bind(void 0,K,m,d);function V(e,t){const r=(0,i.isRichOper)(t)?t.getFallback():t;switch(r.kind){case i.OperKind.Boolean:return r;case i.OperKind.Number:return(0,i.booleanOper)(0!==e.mathpack.cond(r));case i.OperKind.String:return;case i.OperKind.Error:return r;case i.OperKind.Missing:case i.OperKind.Blank:return;default:return(0,n.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function H(e,t,r){const a=(0,o.reduceDerefOpers)(t,((t,r,a)=>void 0!==t&&(0,i.isErrorOper)(t)?t:(0,i.isErrorOper)(r)?r:((0,n.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,i.isBooleanOper)(t))&&(0,i.isBooleanOper)(r)),(0,i.booleanOper)(e(t?.value,r.value,a)))),V,r);return null==a?i.valueErrorOper:a}const q=H.bind(void 0,((e,t)=>!1!==e&&t)),z=H.bind(void 0,((e,t)=>!0===e||t)),Q=H.bind(void 0,((e,t,r)=>t?((!0===e?1:0)+r)%2==1:!0===e));function $(e,t){return(r,n,a)=>{if(void 0!==r&&(0,i.isErrorOper)(r))return r;if(!(0,i.isErrorOper)(n)){const r=t(n);for(let t=0;t<a;t+=1)e.push(r)}return n}}function Y(e,t,r,n){const a=[],u=(0,o.reduceDerefOpers)(t,$(a,s.assertNumber),d,[r]);if(null==u)return i.numErrorOper;if((0,i.isErrorOper)(u))return u;const l=t.mathpack;if(l.cond2(n,l.one)<0)return i.numErrorOper;if(l.cond2(n,l.fromNumber(a.length))>0)return i.numErrorOper;const c=a.sort(l.cond2);if(e){const e=(0,s.assertNumber)(l.add((0,s.assertNumber)(l.sub(l.fromNumber(a.length),n)),l.one));return c[l.lfix(e)-1]}return c[l.lfix(n)-1]}const J=Y.bind(void 0,!0),X=Y.bind(void 0,!1);function Z(e,t,r,n){const a=e.mathpack,u=[],l=(0,o.reduceDerefOpers)(e,$(u,s.assertNumber),d,t);if(null==l)return i.numErrorOper;if((0,i.isErrorOper)(l))return l;if((0,i.isErrorOper)(r))return r;if(a.cond(r)<0)return i.numErrorOper;if(a.cond2(r,a.one)>0)return i.numErrorOper;const c=u.sort(a.cond2),m=(0,s.assertNumber)(a.sub(a.fromNumber(c.length),a.one)),g=(0,s.assertNumber)(a.add(a.fromNumber(c.length),a.one)),p=n?(0,s.assertNumber)(a.mul(m,r)):(0,s.assertNumber)(a.sub((0,s.assertNumber)(a.mul(g,r)),a.one));if(a.cond(p)<0||a.cond2(p,m)>0)return i.numErrorOper;const h=a.lfix(p),f=(0,s.assertNumber)(a.sub(p,a.fromNumber(h)));if(0===a.cond(f))return c[h];const S=a.sub(c[h+1],c[h]);return(0,i.isErrorOper)(S)?S:a.add(c[h],(0,s.assertNumber)(a.mul(S,f)))}const ee=(e,t,r)=>Z(e,[t],r,!0),te=(e,t,r)=>Z(e,[t],r,!1);function re(e,t){const r=e.mathpack;if(r.cond(t)<0)return i.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return i.numErrorOper;const n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}const ne=(e,t,r)=>Z(e,[t],re(e,r),!0),ie=(e,t,r)=>Z(e,[t],re(e,r),!1);function ae(e,t){return Z(e,t,e.mathpack.fromNumber(.5),!0)}function oe(e){return function(t,r){const n=e(t,r);return void 0!==n&&(0,i.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function se(e,t){return function(r,n){const a=e(r,n);if(a?.kind!==i.OperKind.Number)return a;const o=r.mathpack,s=o.sub(a,t);return(0,i.isErrorOper)(s)?s:o.mul(s,s)}}function ue(e,t,r,a){const s={count:0};if(null==(0,o.reduceDerefOpers)(r,p(s),e,a,t))return i.div0ErrorOper;(0,n.assertTrue)("calc.funcs.varFirstPass: unexpected count type",s.count>=1);const u=g(r.mathpack.add),l=(0,o.reduceDerefOpers)(r,u,e,a,t),c=(0,o.reduceDerefOpers)(r,u,oe(e),a,void 0===t?void 0:oe(t));if((0,n.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=l),(0,n.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=c),(0,i.isErrorOper)(l))return l;if((0,i.isErrorOper)(c))return c;(0,n.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,i.isNumberOper)(l)&&(0,i.isNumberOper)(c));const d=r.mathpack,m=d.div(l,d.fromNumber(s.count));return(0,i.isErrorOper)(m)?m:[s.count,l,c,m]}function le(e,t,r,a,s){const u=g(r.mathpack.add),l=(0,o.reduceDerefOpers)(r,u,se(e,s),a,void 0===t?void 0:se(t,s));return(0,n.assertTrue)("calc.funcs.varSecondPass: unexpected error",l?.kind===i.OperKind.Number),l}function ce(e,t,r,n){const a=ue(e,t,r,n);if(!Array.isArray(a))return a;const o=r.mathpack,[u,l,c,d]=a;if(u<2)return i.div0ErrorOper;const m=o.mul(l,l);if((0,i.isErrorOper)(m))return m;const g=(0,s.assertNumber)(o.div(m,o.fromNumber(u))),p=(0,s.assertNumber)(o.sub(c,g));if(0===o.cond(d))return o.cond(p)<0?o.zero:o.div(p,o.fromNumber(u-1));if(o.cond(p)>=0){const e=(0,s.assertNumber)(o.div(p,o.fromNumber(u-1))),t=21219957905e-324;if(o.cond2(e,o.fromNumber(t))>0){const t=o.div(g,c),r=(0,i.isErrorOper)(t)?t:o.sub(t,o.one);if(!(0,i.isErrorOper)(r)&&o.cond2(o.abs(r),o.fromNumber(.01))>0){const t=o.div(d,e),r=(0,i.isErrorOper)(t)?t:o.sub(o.abs(t),o.fromNumber(1e3));if(!(0,i.isErrorOper)(r)&&o.cond(r)<0)return e}}}const h=le(e,t,r,n,d);return o.cond(h)<0?o.zero:o.div(h,o.fromNumber(u-1))}function de(e,t,r,n){const a=ue(e,t,r,n);if(!Array.isArray(a))return a;const o=r.mathpack,[u,l,c,d]=a;if(u<1)return i.div0ErrorOper;const m=o.mul(l,l);if((0,i.isErrorOper)(m))return m;const g=o.mul(c,o.fromNumber(u));if((0,i.isErrorOper)(g))return g;const p=(0,s.assertNumber)(o.sub(g,m));if(0===o.cond(d))return o.cond(p)<0?o.zero:o.div(p,o.fromNumber(u*u));if(o.cond(p)>=0){const e=(0,s.assertNumber)(o.div(p,o.fromNumber(u*u))),t=21219957905e-324;if(o.cond2(e,o.fromNumber(t))>0){const t=o.div((0,s.assertNumber)(o.div(m,o.fromNumber(u))),c),r=(0,i.isErrorOper)(t)?t:o.sub(t,o.one);if(!(0,i.isErrorOper)(r)&&o.cond2(o.abs(r),o.fromNumber(.01))>0){const t=o.div(d,e),r=(0,i.isErrorOper)(t)?t:o.sub(o.abs(t),o.fromNumber(1e3));if(!(0,i.isErrorOper)(r)&&o.cond(r)<0)return e}}}const h=le(e,t,r,n,d);return o.cond(h)<0?o.zero:o.div(h,o.fromNumber(u))}const me=ce.bind(void 0,d,void 0),ge=de.bind(void 0,d,void 0),pe=ce.bind(void 0,m,d),he=de.bind(void 0,m,d);function fe(e){return function(t,r){const n=e(t,r);return(0,i.isNumberOper)(n)?t.mathpack.sqrt(n):n}}const Se=fe(me),ve=fe(ge),ye=fe(pe),Fe=fe(he),be=[R,M,w,W,U,k,Se,ve,v,me,ge];function Ce(e,t){const r=[],a=(0,o.reduceDerefOpers)(e,(s=r,(e,t,r)=>{if(void 0!==e&&(0,i.isErrorOper)(e))return e;if((0,i.isNumberOper)(t))for(let e=0;e<r;e+=1)s.push({value:t,index:s.length});return t}),d,t);var s;if(null==a)return i.naErrorOper;if((0,i.isErrorOper)(a))return a;const u=e.mathpack,l=r.sort(((e,t)=>u.cond2(e.value,t.value)));let c=1,m=0,g=1/0;const p=[];function h(e){c=1,g=e.index}const f=e=>{const{value:t}=e;c>m?(m=c,p.length=0,p.push({value:t,index:g})):c===m&&p.push({value:t,index:g})};h(l[0]);for(let e=1;e<l.length;e+=1)v=l[e-1],y=l[e],0===u.cond2(v.value,y.value)?((S=l[e]).index<g&&(g=S.index),c+=1):(f(l[e-1]),h(l[e]));var S,v,y;return f(l[l.length-1]),m<2?i.naErrorOper:((0,n.assertTrue)("calc.funcs.modeInner: unexpected error",0!==p.length),p.sort(((e,t)=>e.index-t.index)))}function ke(e,t){const r=Ce(e,t);return Array.isArray(r)?r[0].value:r}const Ee=(0,i.binaryVisitor)({...(0,i.constVisitor)(!1),wsfNode:e=>e===i.WorksheetFuncId.SUBTOTAL||e===i.WorksheetFuncId.AGGREGATE},((e,t)=>e||t));function Ae(e){if(!(0,l.isRangeValues)(e))return e;const t=e.arrays.map((e=>e.map((([e,t])=>{return void 0!==t&&(r=t.formula,(0,i.reduceBottomUp)(Ee,r))?void 0:e;var r}))));return(0,l.rangeValues)(t)}const Te=[...be,ae,ke],Re=[J,X,ee,ne,te,ie];function Ne(e,[t,r,n=i.falseOper],a){const u=n.value?1:-1;let l=0,c=0;const m=e.mathpack,g=(0,o.reduceDerefOpers)(e,((e,r,n)=>{if(void 0!==e)return e;if((0,i.isErrorOper)(r))return r;const a=m.cond2(t,(0,s.assertNumber)(r));0===a?l+=n:a===u&&(c+=n)}),d,e.dereferenceAllOpers([r]));if(void 0!==g)return g;if(0===l)return i.naErrorOper;const p=m.fromNumber(c+1);if(a){const e=m.div(m.fromNumber(l-1),m.fromNumber(2));return m.add(p,(0,s.assertNumber)(e))}return p}function Ie(e){return function(t,r){const n=e(t,r);return n?.kind===i.OperKind.Number?t.mathpack.abs(n):n}}function Pe(e,t,r){const a=E(d,void 0,!0,i.numErrorOper,t,r);if(!Array.isArray(a))return a;const[u,l]=a,c=(0,o.reduceDerefOpers)(t,g(t.mathpack.add),e(function(e,t){return function(r,n){const a=e(r,n);return a?.kind===i.OperKind.Number?r.mathpack.sub(a,t):a}}(d,u)),r);return(0,n.assertTrue)("calc.funcs.sumDevAndCount",void 0!==c),(0,i.isErrorOper)(c)?c:[(0,s.assertNumber)(c),l]}const Oe=new Float64Array(1),Me=new Int32Array(Oe.buffer);function De(e,t){Oe[0]=e.toNumber(t);const r=((2146435072&Me[1])>>>20)-1023;return Me[1]=-2146435073&Me[1]|1072693248,[e.fromNumber(Oe[0]),r]}function we(e,t,r){Oe[0]=e.toNumber(t);const n=((2146435072&Me[1])>>>20)-1023;return Me[1]=-2146435073&Me[1]|n+r+1023<<20&2146435072,e.fromNumber(Oe[0])}const _e=e=>(0,i.isRichOper)(e)?e.getFallback():e;t.sumproduct=(e,t)=>{const r=t.map((e=>(0,i.arrayOper)(e.rows,e.cols,e.opers.map((e=>e.map(_e)))))),n=e.mathpack;for(const e of r)for(const t of e.opers)for(const e of t)if((0,i.isErrorOper)(e))return e;const a=r[0].rows,o=r[0].cols;if(!r.every((e=>e.rows===a&&e.cols===o)))return i.valueErrorOper;let s=n.zero;for(let e=0;e<a;++e)e:for(let t=0;t<o;++t){const a=r[0].opers[e][t];if(!(0,i.isNumberOper)(a))continue e;let o=a;for(let a=1;a<r.length;++a){const s=r[a].opers[e][t];if(!(0,i.isNumberOper)(s))continue e;if(o=n.mul(o,s),(0,i.isErrorOper)(o))return o}if(s=n.add(o,s),(0,i.isErrorOper)(s))return s}return s}},4206:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filter=function(e,t){const[r,a,u]=t,l=(0,o.rangeOrArrayToVal)(r,i.refErrorOper);if((0,i.isErrorOper)(l))return l;const c=(0,o.rangeOrArrayToVal)(a,i.refErrorOper);if((0,i.isErrorOper)(c))return c;const{rows:d,cols:m}=(0,o.makeSlicer)(l),{rows:g,cols:p}=(0,o.makeSlicer)(c);if(!(1===g&&p>=1||1===p&&g>=1))return i.valueErrorOper;const h=1===g&&1===p?1===d:g>1;if(h?g!==d:p!==m)return i.valueErrorOper;const[f]=e.dereferenceAllOpers([c]),S=(0,n.sparseArray2DTo1D)((0,s.isRangeValues)(f)?f.arrays[0]:new n.StrictSparseArray2D(f.rows,f.cols,f.rows,f.cols,f.opers,i.blankOper),!h),v=[];for(let t=0;t<S.length;++t){const r=e.coerceOper(S.get(t),i.OperKind.Boolean);if(!(0,i.isBooleanOper)(r))return r;if(r.value)v.push(t);else if(t>=S.denseLength)break}if(h?(0,o.validateArraySize)(v.length,m):(0,o.validateArraySize)(d,v.length),0===v.length)return void 0===u||(0,i.isMissingOper)(u)?i.calcErrorOper:u;const[y]=e.dereferenceAllOpers([l]),F=(0,s.isRangeValues)(y)?y.arrays[0]:new n.StrictArray2D(y.rows,y.cols,y.opers),b=e=>new n.NonstrictArray2D(v.length,e.cols,((t,r)=>e.get(v[t],r))),C=h?b(F):(0,n.transposeArray2D)(b((0,n.transposeArray2D)(F)));return(0,i.arrayOper)(C.rows,C.cols,(0,n.array2DToJaggedArray)(C))},t.sort=function(e,t){const[r,a,o,s]=t,m=u(r),g=!!s&&s.value,p=c(m,g),h=p.cols,f=l(e,a,h,(e=>e>=1&&e<=h?e-1:i.valueErrorOper));if(!Array.isArray(f))return f;const S=l(e,o,f.length,(e=>1===e||-1===e?e:i.valueErrorOper));if(!Array.isArray(S))return S;if(1===S.length)S.length=f.length,(0,n.arrayFill)(S,S[0]);else if(S.length!==f.length)return i.valueErrorOper;const v=f.map(((e,t)=>[t=>p.get(t,e),S[t]]));return 1===p.rows?m:d(e,p,g,v)},t.sortby=function(e,t){const[r,...a]=t,o=u(r);(0,n.assertTrue)("calc.funcs.sortby",a.every(((e,t)=>t%2==0?(0,i.isArrayOper)(e)||(0,i.isBlankOper)(e):(0,i.isNumberOper)(e)||(0,i.isMissingOper)(e))));const s=[];for(let e=0;e<a.length;e+=2)s.push([u(a[e]),a[e+1]??i.missingOper]);const l=s[0][0].cols>=s[0][0].rows&&s[0][0].cols===o.cols,m=c(o,l),g=[];for(const[t,r]of s){if(1!==t.rows&&1!==t.cols)return i.valueErrorOper;if(!(l?t.cols===o.cols:t.rows===o.rows))return i.valueErrorOper;const n=t.opers,a=e.mathpack.sfix((0,i.isNumberOper)(r)?r:e.mathpack.one);if(1!==a&&-1!==a)return i.valueErrorOper;g.push([l?e=>n[0][e]:e=>n[e][0],a])}return 1===m.rows?o:d(e,m,l,g)},t.unique=function(e,t){const[r,o,s]=t,l=u(r),d=o?.value??!1,m=s?.value??!1,g=c(l,d);if(1===g.rows)return l;const p=e.config,h=[];let f=n.RedBlackMapTree.create(((e,t)=>{for(let r=0;r<g.cols;++r){const n=(0,a.sortOpers)(p,g.get(e,r),g.get(t,r),1,!0);if(0!==n)return n}return 0}));for(let e=0;e<g.rows;++e){let t;[f,t]=f.getOrSetValue(e,(()=>({firstRow:e,count:0}))),t.count+=1,h.push(t)}const S=m?h.filter((e=>1===e.count)):h.filter(((e,t)=>e.firstRow===t));if(0===S.length)return i.calcErrorOper;const v=new n.NonstrictArray2D(S.length,g.cols,((e,t)=>g.get(S[e].firstRow,t))),y=d?(0,n.transposeArray2D)(v):v;return(0,i.arrayOper)(y.rows,y.cols,(0,n.array2DToJaggedArray)(y))};const n=r(6913),i=r(6592),a=r(1382),o=r(7217),s=r(9001);function u(e){return(0,i.isBlankOper)(e)?(0,i.arrayOper)(1,1,[[e]]):e}function l(e,t=i.missingOper,r,n){const a=e.mathpack,s=(0,i.isMissingOper)(t)?(0,i.arrayOper)(1,1,[[a.one]]):t;if(!(1===s.rows&&s.cols>=1||1===s.cols&&s.rows>=1))return i.valueErrorOper;if(s.rows*s.cols>r)return i.valueErrorOper;const u=[];for(let t=0;t<s.rows;++t)for(let r=0;r<s.cols;++r){const l=e.coerceOper(s.opers[t][r],i.OperKind.Number);if(!(0,i.isNumberOper)(l))return(0,o.assertError)(l);const c=n(a.sfix(l));if("number"!=typeof c)return c;u.push(c)}return u}function c(e,t){return t?new n.NonstrictArray2D(e.cols,e.rows,((t,r)=>e.opers[r][t])):new n.StrictArray2D(e.rows,e.cols,e.opers)}function d(e,t,r,o){const{rows:s,cols:u}=t,l=e.config,c=[];for(let e=0;e<s;++e)c.push(e);c.sort(((e,t)=>{for(let r=0;r<o.length;++r){const[n,i]=o[r],s=(0,a.sortOpers)(l,n(e),n(t),i,!1);if(0!==s)return s}return e-t}));const d=new n.NonstrictArray2D(s,u,((e,r)=>t.get(c[e],r))),m=r?(0,n.transposeArray2D)(d):d;return(0,i.arrayOper)(m.rows,m.cols,(0,n.array2DToJaggedArray)(m))}},9231:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseCriteria=c,t.compileCriteria=d,t.applyCriteria=function(e,t,r,i){const a=d(e,c(e,r)),o=t,s=void 0===i?o:i;return new n.NonstrictSparseArray2D(s.rows,s.cols,(0,n.fastMax)(o.denseRows,s.denseRows),(0,n.fastMax)(o.denseCols,s.denseCols),((e,t)=>{const r=o.get(e,t);return a(r)?s.get(e,t):void 0}),(()=>{const e=o.getSparse();return a(e)?s.getSparse():void 0}))};const n=r(6913),i=r(6592),a=r(2968),o=r(9110),s=r(199),u={"=":i.OperatorId.Eq,"<":i.OperatorId.Lt,">":i.OperatorId.Gt},l={"<>":i.OperatorId.Ne,"<=":i.OperatorId.Le,">=":i.OperatorId.Ge};function c(e,t){if(!(0,i.isStringOper)(t))return t;const[r,n]=function(e){if(e.length>=2){const t=l[e.substring(0,2)];if(void 0!==t)return[t,e.substring(2)]}if(e.length>=1){const t=u[e.substring(0,1)];if(void 0!==t)return[t,e.substring(1)]}return[void 0,e]}(t.value),a=function(e,t){const{localeInfo:r}=e.config;if(0===r.stringCompareCI(t,r.trueName))return i.trueOper;if(0===r.stringCompareCI(t,r.falseName))return i.falseOper;for(let e=1;e<r.errorNames.length;e+=1){const n=r.errorNames[e];if(null!=n&&0===r.stringCompareCI(n,t))return(0,i.errorOper)(e)}const n=e.parseGeneral(t,!1);return void 0!==n?n:(0,i.stringOper)(t)}(e,n);return{kind:"FilterExpression",operator:r,operand:a}}function d(e,t){const r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:i.OperatorId.Eq,operand:t},{mathpack:u,localeInfo:l}=e.config;if(r.operator===i.OperatorId.Ne&&(0,s.isEmptyStringOper)(r.operand))return e=>!(0,i.isBlankOper)(e);if(r.operator===i.OperatorId.Eq&&(0,s.isEmptyStringOper)(r.operand))return i.isBlankOper;if(void 0!==r.operator&&(0,s.isEmptyStringOper)(r.operand))return e=>!1;if(void 0===r.operator&&(0,s.isEmptyStringOper)(r.operand))return e=>(0,i.isBlankOper)(e)||(0,s.isEmptyStringOper)(e);const c=void 0===r.operator?i.OperatorId.Eq:r.operator;switch(r.operand.kind){case i.OperKind.Number:return d=c,m=r.operand,t=>{const r=(0,i.isRichOper)(t)?t.getFallback():t;if((0,i.isNumberOper)(r))return(0,o.cmpNum)(u,d,r,m);if((0,i.isStringOper)(r)&&d===i.OperatorId.Eq){const t=e.parseGeneral(r.value,!1);return void 0!==t&&(0,o.cmpNum)(u,d,t,m)}return d===i.OperatorId.Ne};case i.OperKind.Boolean:return function(e,t){return r=>{const n=(0,i.isRichOper)(r)?r.getFallback():r;return(0,i.isBooleanOper)(n)?(0,o.cmpBool)(e,n,t):e===i.OperatorId.Ne}}(c,r.operand);case i.OperKind.String:return function(e,t){switch(e){case i.OperatorId.Eq:case i.OperatorId.Ne:const r=new a.WildExp(l,t.value);return t=>{const n=(0,i.isRichOper)(t)?t.getFallback():t;return(0,i.isStringOper)(n)?r.test(n.value)===(e===i.OperatorId.Eq):e===i.OperatorId.Ne};case i.OperatorId.Lt:case i.OperatorId.Gt:case i.OperatorId.Le:case i.OperatorId.Ge:return r=>{const n=(0,i.isRichOper)(r)?r.getFallback():r;return!!(0,i.isStringOper)(n)&&(0,o.cmpStr)(l,e,n,t)}}}(c,r.operand);case i.OperKind.Error:return function(e,t){return r=>{const n=(0,i.isRichOper)(r)?r.getFallback():r;return(0,i.isErrorOper)(n)?(0,o.cmpInt)(e,n.type-t.type):e===i.OperatorId.Ne}}(c,r.operand);default:return(0,n.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}var d,m}},8536:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eomonth=t.edate=t.weeknum=t.isoweeknum=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0,t.weekday=function(e,t){return s(e,t)},t.date=function(e,[t,r,n]){const{mathpack:a,datepack:o,config:s}=e;let u=a.sfix(t);if(u>g)return i.numErrorOper;const l=a.sfix(r);if(l>d||l<c)return i.numErrorOper;let p=a.sfix(n);(p>d||p<c)&&(p=d),s.dateCompatibility?u<m&&(u+=1900):u<m&&!(1899===u&&12===l&&p>=30)&&(u+=1900);const h=(0,i.dateTime)(u,l,p,0,0,0,0,0,i.Rounding.RoundSec);return o.toNum(s,h)},t.time=function(e,[t,r,n]){const{mathpack:a,datepack:o,config:s}=e,u=a.sfix(t);if(u>32767)return i.numErrorOper;const l=a.sfix(r);if(l>32767)return i.numErrorOper;const c=a.sfix(n);if(c>32767)return i.numErrorOper;let d,g,S;s.dateCompatibility?(d=s.date1904?1904:1900,g=p,S=s.date1904?1:0):(d=m-1,g=h,S=f);const v=(0,i.dateTime)(d,g,S,u,l,c,0,0,i.Rounding.RoundSec),y=o.toNum(s,v);return(0,i.isErrorOper)(y)?y:a.cond(y)<0?i.numErrorOper:a.sub(y,a.trunc(y))},t.days360=function(e,[t,r,n]){const{mathpack:a,datepack:o,config:s}=e,u=n?.value??!1,l=o.fromNum(s,t,i.Rounding.RoundSec);if(!1===l)return i.naErrorOper;const c=31===l.dom||!u&&2===l.mon&&l.dom===o.daysPerMonth(2,l.yr,s.dateCompatibility)?30:l.dom,d=a.fromNumber(360*(l.yr-m)+30*l.mon+c),g=o.fromNum(s,r,i.Rounding.RoundSec);if(!1===g)return i.naErrorOper;const p=31!==g.dom||!u&&30!==l.dom?g.dom:30,h=a.fromNumber(360*(g.yr-m)+30*g.mon+p);return a.sub(h,d)},t.datedif=function(e,[t,r,{value:n}]){if(n.length>2||0===n.length)return i.numErrorOper;const{mathpack:a,datepack:o,config:s}=e,u=a.lfix(t),l=o.fromNum(s,t,i.Rounding.RoundSec);if(!1===l)return i.numErrorOper;const c=e.mathpack.lfix(r),d=o.fromNum(s,r,i.Rounding.RoundSec);if(!1===d)return i.numErrorOper;if(u>c)return i.numErrorOper;let m=d.dom,g=d.mon,p=d.yr;l.dom>m&&(g-=1,0===g&&(g=12,p-=1),m+=o.daysPerMonth(g,p,s.dateCompatibility)),l.mon>g&&(g+=12,p-=1);const h=(e,t)=>0===s.localeInfo.stringCompareCI(e,t);if(h(n,"Y"))return a.fromNumber(p-l.yr);if(h(n,"M"))return a.fromNumber(12*(p-l.yr)+(g-l.mon));if(h(n,"D"))return a.fromNumber(c-u);if(h(n,"MD"))return a.fromNumber(m-l.dom);if(h(n,"YM"))return a.fromNumber(g-l.mon);if(h(n,"YD")){let e=0;for(let t=l.mon;t<g;t+=1)e+=o.daysPerMonth(t,l.yr,s.dateCompatibility);return a.fromNumber(e+(m-l.dom))}return i.numErrorOper},t.days=function(e,[t,r]){if((0,i.isStringOper)(t)&&t.value.length>255||(0,i.isStringOper)(r)&&r.value.length>255)return i.valueErrorOper;const n=S(e,t);if((0,i.isErrorOper)(n))return n;const a=S(e,r);return(0,i.isErrorOper)(a)?a:e.mathpack.sub(n,a)},t.workday_intl=k,t.workday=function(e,[t,r,n]){return k(e,n?[t,r,i.missingOper,n]:[t,r])},t.networkdays_intl=R,t.networkdays=function(e,[t,r,n]){return R(e,n?[t,r,i.missingOper,n]:[t,r])},t.yearFrac=function(e,[t,r,n]){let o=P.DefaultBasis;if(void 0!==n){const t=function(e,t){let r=P.DefaultBasis;if(void 0===t||(0,i.isMissingOper)(t))return r;const n=(0,a.chkNumOper)(e,t);if((0,i.isErrorOper)(n))return n;const o=e.mathpack;switch(r=o.lfix(o.floor(n)),r){case P.Basis30360:case P.BasisActual:case P.BasisActual360:case P.BasisActual365:case P.BasisE30360:return r;default:return i.numErrorOper}}(e,n);if("number"!=typeof t)return t;o=t}let s=(0,a.chkDateOper)(e,t);if((0,i.isErrorOper)(s))return s;let u=(0,a.chkDateOper)(e,r);if((0,i.isErrorOper)(u))return u;const l=e.mathpack;if(l.cond2(s,u)>0){const e=s;s=u,u=e}const c=function(e,t,r,n,o){const s=e.mathpack;switch(s.cond2(t,r)){case 1:break;case 0:return s.zero;case-1:switch(n){case P.Basis30360:return function(e,t,r,n,a){const{datepack:o,config:s}=e,u=o.fromNum(s,t,i.Rounding.RoundSec);if(!1===u)return!1;let l=u.dom;const c=u.mon,d=u.yr,m=o.fromNum(s,r,i.Rounding.RoundSec);if(!1===m)return!1;let g=m.dom;const p=m.mon,h=m.yr;return 2===g&&I(e,g,p,h)&&2===l&&I(e,l,c,d)&&(g=30),31===g&&l>=30&&(g=30),31===l&&(l=30),2===c&&I(e,l,c,d)&&(l=30),N(e,d,h,c,p,l,g)}(e,t,r);case P.BasisActual360:case P.BasisActual365:case P.BasisActual:return(0,a.assertNumber)(s.sub(r,t));case P.BasisE30360:return function(e,t,r){const{datepack:n,config:a}=e,o=n.fromNum(a,t,i.Rounding.RoundSec);if(!1===o)return!1;let s=o.dom;const u=o.mon,l=o.yr,c=n.fromNum(a,r,i.Rounding.RoundSec);if(!1===c)return!1;let d=c.dom;const m=c.mon;return 31===s&&(s=30),31===d&&(d=30),N(e,l,c.yr,u,m,s,d)}(e,t,r)}}return!1}(e,s,u,o);if(!1===c)return i.numErrorOper;const d=function(e,t,r,n){const{mathpack:o,datepack:s,config:u}=e,l=o.fromNumber(360),c=o.fromNumber(365),d=o.fromNumber(366);switch(t){case P.BasisActual:const e=s.fromNum(u,r,i.Rounding.RoundSec);if(!1===e)return!1;const t=e.dom,m=e.mon,g=e.yr,p=s.fromNum(u,n,i.Rounding.RoundSec);if(!1===p)return!1;const h=p.dom,f=p.mon,S=p.yr,v=S-1;if(g===S)return 29===s.daysPerMonth(2,g,u.dateCompatibility)?d:c;if(v===g&&(m>f||m===f&&t>=h)){if(29===s.daysPerMonth(2,g,u.dateCompatibility)){const e=s.toNum(u,(0,i.dateTime)(g,2,29,0,0,0,0,0,i.Rounding.RoundSec));return!(0,i.isErrorOper)(e)&&(o.cond2(e,r)>=0?d:c)}if(29===s.daysPerMonth(2,S,u.dateCompatibility)){const e=s.toNum(u,(0,i.dateTime)(g,2,29,0,0,0,0,0,i.Rounding.RoundSec));return!(0,i.isErrorOper)(e)&&(o.cond2(e,n)<=0?d:c)}return c}let y=0;for(let e=g;e<=S;e+=1)29===s.daysPerMonth(2,e,u.dateCompatibility)?y+=366:y+=365;const F=o.fromNumber(S-g+1);return(0,a.assertNumber)(o.div(o.fromNumber(y),F));case P.Basis30360:case P.BasisActual360:case P.BasisE30360:return l;case P.BasisActual365:return c;default:return l}}(e,o,s,u);return!1===d?i.numErrorOper:l.div(c,d)};const n=r(6913),i=r(6592),a=r(7217);function o(e,t,[r]){const{datepack:n,config:a}=t,o=n.fromNum(a,r,i.Rounding.RoundSec);return!1===o?i.numErrorOper:t.mathpack.fromNumber(e(o))}function s(e,[t,r],n=!1){const{config:a,mathpack:o,datepack:s}=e,u=s.fromNum({...a,date1904:a.date1904&&!n},t,i.Rounding.RoundSec);if(!1===u)return i.numErrorOper;let l;switch(void 0!==r?o.sfix(r):1){case 1:case 17:l=u.wdy;break;case 2:case 11:l=1===u.wdy?7:u.wdy-1;break;case 3:l=1===u.wdy?6:u.wdy-2;break;case 12:l=(u.wdy+4)%7+1;break;case 13:l=(u.wdy+3)%7+1;break;case 14:l=(u.wdy+2)%7+1;break;case 15:l=(u.wdy+1)%7+1;break;case 16:l=u.wdy%7+1;break;default:return i.numErrorOper}return o.fromNumber(l)}function u(e,t,r){if(!t){const t=e.lfix(r);if(0===t||1===t)return e.fromNumber(52)}return i.numErrorOper}function l(e,t,[r,o]){const l=(0,a.chkDateOper)(t,r);if((0,i.isErrorOper)(l))return l;const[c,d]=function(e,t,r){if(void 0===t||(0,i.isMissingOper)(t))return[r?2:1,r];const n=(0,a.chkNumOper)(e,t);if(!(0,i.isErrorOper)(n)){const t=e.mathpack.sfix(n);if(r){if(1===t||2===t)return[t,r]}else{if(1===t||2===t)return[t,r];if(t>=11&&t<=16)return[t-9,r];if(17===t)return[1,r];if(21===t)return[2,!0]}}return[void 0,r]}(t,o,e);if(void 0===c)return i.numErrorOper;const{mathpack:m,datepack:g,config:p}=t,h={...p,date1904:!1},f=g.fromNum(h,l,i.Rounding.RoundSec);if(!1===f)return u(m,h.dateCompatibility,l);const S=(0,i.dateTime)(f.yr,1,1,0,0,0,0,0,i.Rounding.RoundSec),v=g.toNum(h,S);if((0,i.isErrorOper)(v))return u(m,h.dateCompatibility,l);const y=s(t,[v],!0);if((0,i.isErrorOper)(y))return y;const F=(0,a.assertNumber)(m.add((0,a.assertNumber)(m.sub(y,m.fromNumber(c))),m.fromNumber(7))),b=(0,a.assertNumber)((0,a.numMod)(m,F,m.fromNumber(7))),C=(0,a.assertNumber)(m.add(m.floor((0,a.assertNumber)(m.div((0,a.assertNumber)(m.add((0,a.assertNumber)(m.sub(l,v)),b)),m.fromNumber(7)))),m.one));return d?function(e,t,r,i){const{mathpack:o,datepack:s,config:u}=e,l={...i},c=(t+6-l.wdy)%7;if(12===l.mon&&l.dom+c>=35)return o.one;l.dom=4,l.mon=1;let d=s.toDays(u,l);if((0,n.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==d),d=(d-1)%7+1,(d-t+7)%7<3){const e=(0,a.assertNumber)(o.sub(r,o.one));if(0===o.cond(e)){const e=l.yr-1;return t===d||e%4==0&&(e%100!=0||e%400==0)&&(t-d+7)%7==6?o.fromNumber(53):o.fromNumber(52)}return e}return r}(t,c,C,f):C}t.year=o.bind(void 0,(e=>e.yr)),t.month=o.bind(void 0,(e=>e.mon)),t.day=o.bind(void 0,(e=>e.dom)),t.hour=o.bind(void 0,(e=>e.hour)),t.minute=o.bind(void 0,(e=>e.min)),t.second=o.bind(void 0,(e=>e.sec)),t.isoweeknum=l.bind(void 0,!0),t.weeknum=l.bind(void 0,!1);const c=-32768,d=32767,m=1900,g=9999,p=1,h=12,f=30;function S(e,t){let r;if((0,i.isStringOper)(t)){const n=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,i.stringOper)(n),i.OperKind.Number),(0,i.isErrorOper)(r))return r}else r=t;return(0,a.chkDateOper)(e,r)}function v(e,t,r){return r?(0,a.assertNumber)(e.sub(t,e.fromNumber(a.atpm1904to1900Days))):t}function y(e,t){return 0!=(e>>t%7&1)}var F;function b(e){switch(e){case 1:return F.Saturday|F.Sunday;case 2:return F.Sunday|F.Monday;case 3:return F.Monday|F.Tuesday;case 4:return F.Tuesday|F.Wednesday;case 5:return F.Wednesday|F.Thursday;case 6:return F.Thursday|F.Friday;case 7:return F.Friday|F.Saturday;case 11:return F.Sunday;case 12:return F.Monday;case 13:return F.Tuesday;case 14:return F.Wednesday;case 15:return F.Thursday;case 16:return F.Friday;case 17:return F.Saturday;default:return!1}}function C(e){if(7!==e.length)return!1;let t=F.None;for(let r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function k(e,[t,r,o,s]){let u=F.Saturday|F.Sunday,l=(0,a.chkDateOper)(e,t);if((0,i.isErrorOper)(l))return l;let c=(0,a.chkNumOper)(e,r);if((0,i.isErrorOper)(c))return c;const{mathpack:d,config:m}=e;c=d.floor(c);const g=d.cond(c)>0?d.one:d.fromNumber(-1);let p=d.abs(c);const h=(0,a.assertNumber)(d.add(l,c));if(!(0,a.validDateRange)(e,h))return i.numErrorOper;if(0===d.cond(p))return v(d,l,m.date1904);let f=null;const S=[];if(o){if(!(0,i.isMissingOper)(o)){if((0,i.isNumberOper)(o)){const e=b(d.lfix(o));if(!1===e)return i.numErrorOper;u=e}else{if(!(0,i.isStringOper)(o))return i.numErrorOper;{const e=C(o.value);if(!1===e)return i.valueErrorOper;u=e}}if(127===u)return i.valueErrorOper}if(s&&!(0,i.isMissingOper)(s)){const t=(0,a.chkNumMultiOper)(e,s);if(!(0,n.isSuccess)(t))return t.reason;f=t.value}}const k=null==f?[]:function(e){const t=[],r=e.getSparse(),n=e.cols-e.denseCols;for(let i=0;i<e.denseRows;i+=1){for(let r=0;r<e.denseCols;r+=1){const n=e.get(i,r);void 0!==n&&t.push(n)}if(n>0&&void 0!==r)for(let e=0;e<n;e+=1)t.push(r)}const i=(e.rows-e.denseRows)*e.cols;if(i>0&&void 0!==r)for(let e=0;e<i;e+=1)t.push(r);return t}(f);for(let t=k.length-1;t>=0;t-=1){const r=k[t];switch(r.kind){case i.OperKind.Number:case i.OperKind.String:case i.OperKind.Blank:const n=(0,a.chkDateOper)(e,r);if((0,i.isErrorOper)(n))return n;S[t]=n;break;case i.OperKind.Error:return r;default:return i.valueErrorOper}}for(;d.cond(p)>0;){if(l=(0,a.assertNumber)(d.add(l,g)),y(u,d.lfix(l)))continue;let e=!0;for(let t=0;t<k.length;t+=1)if(0===d.cond2(S[t],l)){e=!1;break}e&&(p=(0,a.assertNumber)(d.sub(p,d.one)))}return l=v(d,l,m.date1904),(0,a.validDateRange)(e,l)?l:i.numErrorOper}!function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(F||(F={}));const E=1900,A=-9999;function T(e,t,[r,n]){const o=(0,a.chkDateOper)(t,r);if((0,i.isErrorOper)(o))return o;let s=(0,a.chkNumOper)(t,n);if((0,i.isErrorOper)(s))return s;const{mathpack:u,config:l}=t;s=u.cond(s)>0?u.floor(s):u.ceil(s);const c=function(e,t,r,n){const{mathpack:o,datepack:s,config:u}=e,l={...u,date1904:!1},c=s.fromNum(l,t,i.Rounding.RoundSec);if(!1===c)return c;let d=o.fromNumber(c.dom),m=o.fromNumber(c.mon);const g=o.fromNumber(12);let p=o.fromNumber(c.yr);if(o.cond(r)>=0){p=(0,a.assertNumber)(o.add(o.floor((0,a.assertNumber)(o.div(r,g))),p));const e=(0,a.assertNumber)((0,a.numMod)(o,r,g)),t=(0,a.assertNumber)(o.add(e,m));1===o.cond2(t,g)&&(p=(0,a.assertNumber)(o.add(p,o.one))),m=(0,a.assertNumber)((0,a.numMod)(o,t,g))}else{const e=o.neg(r),t=o.floor((0,a.assertNumber)(o.div(e,g)));p=(0,a.assertNumber)(o.sub(p,t));const n=(0,a.assertNumber)((0,a.numMod)(o,e,g));if(o.cond2(n,m)>=0)p=(0,a.assertNumber)(o.sub(p,o.one)),m=(0,a.assertNumber)(o.add((0,a.assertNumber)(o.sub(m,n)),g));else{const e=(0,a.assertNumber)(o.sub(m,n));m=(0,a.assertNumber)((0,a.numMod)(o,e,g))}}0===o.cond(m)&&(m=g);const h=o.lfix(m);switch(h){case 4:case 6:case 9:case 11:const e=o.fromNumber(30);o.cond2(d,e)>0&&(d=e);break;case 2:o.cond2(d,o.fromNumber(28))>0&&(d=o.fromNumber(s.daysPerMonth(2,o.toNumber(p),!1)))}if(n&&(d=o.fromNumber(s.daysPerMonth(h,o.toNumber(p),!1))),o.lfix(p)<(l.dateCompatibility?E:A))return!1;const f=function(e,t,r,n,a,o){const s=e.lfix(n),u=e.lfix(a),l=e.lfix(o);return t.toNum(r,(0,i.dateTime)(l,u,s,0,0,0,0,0,i.Rounding.RoundSec))}(o,s,l,d,m,p);return!(0,i.isErrorOper)(f)&&f}(t,o,s,!e);return!1===c?i.numErrorOper:v(u,c,l.date1904)}function R(e,[t,r,n,o]){const s=e.mathpack;let u,l=F.Saturday|F.Sunday,c=5;function d(e){l=e,c=7;let t=l;for(;0!==t;)1==(1&t)&&(c-=1),t>>=1}if(void 0!==n&&!(0,i.isMissingOper)(n))if((0,i.isStringOper)(n)){const e=C(n.value);if(!1===e)return i.valueErrorOper;d(e)}else{const t=(0,a.chkNumOper)(e,n);if((0,i.isErrorOper)(t))return i.valueErrorOper;const r=b(s.lfix(t));if(!1===r)return i.numErrorOper;d(r)}const m=o??i.missingOper,g=(0,a.chkDateOper)(e,t);if((0,i.isErrorOper)(g))return g;const p=(0,a.chkDateOper)(e,r);if((0,i.isErrorOper)(p))return p;let h,f=s.lfix(g),S=s.lfix(p);f>S?(h=f,f=S,S=h,u=-1):u=1,h=f%7,h=S%7;let v=0,k=f<S?f:S,E=f<S?S:f;for(;k%7!=0&&k!==E;)y(l,k)||(v+=1),k+=1;for(;E%7!=6&&k!==E;)y(l,E)||(v+=1),E-=1;if(E===k&&1!=(l>>k%7&1)&&(v+=1),f>S){const e=k;k=E,E=e}let A=s.fromNumber(c*Math.floor((E+1-k)/7)+v);switch(m.kind){case i.OperKind.Number:case i.OperKind.String:const t=(0,a.chkDateOper)(e,m);if((0,i.isErrorOper)(t))return t;h=s.lfix(t),h>=f&&h<=S&&h%7>=2&&(A=(0,a.assertNumber)(s.sub(A,s.one)));break;case i.OperKind.Range:case i.OperKind.Array:const r=function(e,t,r,n,o,s){let u;const l=e.mathpack;if(void 0===s||(0,i.isMissingOper)(s))u=F.Saturday|F.Sunday;else if((0,i.isStringOper)(s)){const e=C(s.value);if(!1===e)return i.valueErrorOper;u=e}else{const t=(0,a.chkNumOper)(e,s);if((0,i.isErrorOper)(t))return i.valueErrorOper;const r=b(l.lfix(t));if(!1===r)return i.numErrorOper;u=r}const c=l.fromNumber(r),d=l.fromNumber(n),m=e.dereferenceOper(o,i.OperKind.Array);if(!(0,i.isArrayOper)(m))return i.valueErrorOper;const g=[];function p(e){if(l.cond2(e,c)>=0&&l.cond2(e,d)<=0){const t=l.lfix(e);y(u,t)||g.push(e)}}for(let t=0;t<m.rows;t+=1)for(let r=0;r<m.cols;r+=1){const n=m.opers[t][r];switch(n.kind){case i.OperKind.Number:case i.OperKind.String:const t=(0,a.chkDateOper)(e,n);if((0,i.isErrorOper)(t))return t;p(t);break;case i.OperKind.Blank:break;case i.OperKind.Error:return n;default:return i.valueErrorOper}}let h=t;if(0!==g.length){const e=g.sort(((e,t)=>l.cond2(e,t)));let t=e[0];h=(0,a.assertNumber)(l.sub(h,l.one));for(let r=0;r<e.length;r+=1){const n=e[r];0!==l.cond2(n,t)&&(t=n,h=(0,a.assertNumber)(l.sub(h,l.one)))}}return h}(e,A,f,S,m,n);if((0,i.isErrorOper)(r))return r;A=r;break;case i.OperKind.Error:return m;case i.OperKind.Missing:break;default:return i.valueErrorOper}return s.mul(s.fromNumber(u),A)}function N(e,t,r,n,i,a,o){const{mathpack:s}=e,u=360*(r-t),l=30*(i-n);return s.fromNumber(o-a+l+u)}function I(e,t,r,n){const{datepack:i,config:a}=e;return t===i.daysPerMonth(r,n,a.dateCompatibility)}var P;t.edate=T.bind(void 0,!0),t.eomonth=T.bind(void 0,!1),function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(P||(P={}))},232:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delta=function(e,t){const r=a(e,t);if(!Array.isArray(r))return r;const[n,i]=r,o=e.mathpack;return 0===o.cond2(n,i)?o.one:o.zero},t.gestep=function(e,t){const r=a(e,t);if(!Array.isArray(r))return r;const[n,i]=r,o=e.mathpack;return o.cond2(n,i)>=0?o.one:o.zero};const n=r(6592),i=r(7217);function a(e,t){const[r,a]=t,o=void 0===a||(0,n.isMissingOper)(a)?e.mathpack.zero:(0,i.chkNumOper)(e,a);if((0,n.isErrorOper)(o))return o;const s=(0,i.chkNumOper)(e,r);return(0,n.isErrorOper)(s)?s:[s,o]}},9128:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=function(e){return E||(E=!0,(0,i.isFeatureEnabled)(i.FeatureName.CalcRecordFunctions)&&(k[a.WorksheetFuncId.RECORD]=v.record),(0,i.isFeatureEnabled)(i.FeatureName.CalcNestedRecordFunction)&&(k[a.WorksheetFuncId.NESTEDRECORD]=v.record),(0,i.isFeatureEnabled)(i.FeatureName.CalcLambdaBasicFunctions)&&(k[a.WorksheetFuncId.APPLY]=d.apply,k[a.WorksheetFuncId.ISLAMBDA]=f.islambda)),k[e]};const n=r(6533),i=r(6913),a=r(6592),o=n.__importStar(r(1935)),s=n.__importStar(r(4206)),u=n.__importStar(r(8536)),l=n.__importStar(r(232)),c=n.__importStar(r(7247)),d=n.__importStar(r(8778)),m=n.__importStar(r(1620)),g=n.__importStar(r(1533)),p=n.__importStar(r(3657)),h=n.__importStar(r(8510)),f=n.__importStar(r(7670)),S=n.__importStar(r(1634)),v=n.__importStar(r(460)),y=n.__importStar(r(314)),F=n.__importStar(r(3603)),b=n.__importStar(r(2951)),C=n.__importStar(r(8099)),k={};k[a.WorksheetFuncId.SUM]=o.sum,k[a.WorksheetFuncId.PRODUCT]=o.product,k[a.WorksheetFuncId.AVERAGE]=o.average,k[a.WorksheetFuncId.COUNTBLANK]=o.countblank,k[a.WorksheetFuncId.MAX]=o.max,k[a.WorksheetFuncId.MIN]=o.min,k[a.WorksheetFuncId.AND]=o.and,k[a.WorksheetFuncId.COUNTA]=o.counta,k[a.WorksheetFuncId.OR]=o.or,k[a.WorksheetFuncId.CONCAT]=o.concat,k[a.WorksheetFuncId.AVERAGEIF]=o.averageif,k[a.WorksheetFuncId.AVERAGEIFS]=o.averageifs,k[a.WorksheetFuncId.COUNT]=o.count,k[a.WorksheetFuncId.COUNTIF]=o.countif,k[a.WorksheetFuncId.COUNTIFS]=o.countifs,k[a.WorksheetFuncId.MEDIAN]=o.median,k[a.WorksheetFuncId.SUMSQ]=o.sumsq,k[a.WorksheetFuncId.SUMIF]=o.sumif,k[a.WorksheetFuncId.SUMIFS]=o.sumifs,k[a.WorksheetFuncId.LARGE]=o.large,k[a.WorksheetFuncId.SMALL]=o.small,k[a.WorksheetFuncId.RANK]=o.rank,k[a.WorksheetFuncId.RANK_EQ]=o.rank,k[a.WorksheetFuncId.RANK_AVG]=o.rank_avg,k[a.WorksheetFuncId.PERCENTILE]=o.percentile,k[a.WorksheetFuncId.PERCENTILE_INC]=o.percentile,k[a.WorksheetFuncId.PERCENTILE_EXC]=o.percentile_exc,k[a.WorksheetFuncId.QUARTILE]=o.quartile,k[a.WorksheetFuncId.QUARTILE_INC]=o.quartile,k[a.WorksheetFuncId.QUARTILE_EXC]=o.quartile_exc,k[a.WorksheetFuncId.TRIMMEAN]=o.trimmean,k[a.WorksheetFuncId.AVERAGEA]=o.averagea,k[a.WorksheetFuncId.MAXA]=o.maxa,k[a.WorksheetFuncId.MINA]=o.mina,k[a.WorksheetFuncId.MAXIFS]=o.maxifs,k[a.WorksheetFuncId.MINIFS]=o.minifs,k[a.WorksheetFuncId.XOR]=o.xor,k[a.WorksheetFuncId.AGGREGATE]=o.aggregate,k[a.WorksheetFuncId.SUBTOTAL]=o.subtotal,k[a.WorksheetFuncId.VAR]=o.var_,k[a.WorksheetFuncId.VAR_S]=o.var_,k[a.WorksheetFuncId.VARP]=o.varp,k[a.WorksheetFuncId.VAR_P]=o.varp,k[a.WorksheetFuncId.STDEV]=o.stdev,k[a.WorksheetFuncId.STDEV_S]=o.stdev,k[a.WorksheetFuncId.STDEVP]=o.stdevp,k[a.WorksheetFuncId.STDEV_P]=o.stdevp,k[a.WorksheetFuncId.VARA]=o.vara,k[a.WorksheetFuncId.VARPA]=o.varpa,k[a.WorksheetFuncId.STDEVA]=o.stdeva,k[a.WorksheetFuncId.STDEVPA]=o.stdevpa,k[a.WorksheetFuncId.AVEDEV]=o.avedev,k[a.WorksheetFuncId.DEVSQ]=o.devsq,k[a.WorksheetFuncId.MODE]=o.mode,k[a.WorksheetFuncId.MODE_SNGL]=o.mode,k[a.WorksheetFuncId.MODE_MULT]=o.mode_mult,k[a.WorksheetFuncId.TEXTJOIN]=o.textjoin,k[a.WorksheetFuncId.SUMPRODUCT]=o.sumproduct,k[a.WorksheetFuncId.GEOMEAN]=o.geomean,k[a.WorksheetFuncId.HARMEAN]=o.harmean,k[a.WorksheetFuncId.YEAR]=u.year,k[a.WorksheetFuncId.MONTH]=u.month,k[a.WorksheetFuncId.DAY]=u.day,k[a.WorksheetFuncId.HOUR]=u.hour,k[a.WorksheetFuncId.MINUTE]=u.minute,k[a.WorksheetFuncId.SECOND]=u.second,k[a.WorksheetFuncId.WEEKNUM]=u.weeknum,k[a.WorksheetFuncId.ISOWEEKNUM]=u.isoweeknum,k[a.WorksheetFuncId.WEEKDAY]=u.weekday,k[a.WorksheetFuncId.DATE]=u.date,k[a.WorksheetFuncId.TIME]=u.time,k[a.WorksheetFuncId.DAYS360]=u.days360,k[a.WorksheetFuncId.DAYS]=u.days,k[a.WorksheetFuncId.DATEDIF]=u.datedif,k[a.WorksheetFuncId.WORKDAY]=u.workday,k[a.WorksheetFuncId.WORKDAY_INTL]=u.workday_intl,k[a.WorksheetFuncId.EDATE]=u.edate,k[a.WorksheetFuncId.EOMONTH]=u.eomonth,k[a.WorksheetFuncId.NETWORKDAYS]=u.networkdays,k[a.WorksheetFuncId.NETWORKDAYS_INTL]=u.networkdays_intl,k[a.WorksheetFuncId.YEARFRAC]=u.yearFrac,k[a.WorksheetFuncId.DELTA]=l.delta,k[a.WorksheetFuncId.GESTEP]=l.gestep,k[a.WorksheetFuncId.NA]=c.na,k[a.WorksheetFuncId.T]=c.t_,k[a.WorksheetFuncId.N]=c.n_,k[a.WorksheetFuncId.TYPE]=c.type,k[a.WorksheetFuncId.ERROR_TYPE]=c.error_type,k[a.WorksheetFuncId.INFO]=c.info,k[a.WorksheetFuncId.IF]=m.if_,k[a.WorksheetFuncId.IFS]=m.ifs,k[a.WorksheetFuncId.SWITCH]=m.switch_,k[a.WorksheetFuncId.TRUE]=m.true_,k[a.WorksheetFuncId.FALSE]=m.false_,k[a.WorksheetFuncId.NOT]=m.not,k[a.WorksheetFuncId.CHOOSE]=m.choose,k[a.WorksheetFuncId.INDEX]=g.index,k[a.WorksheetFuncId.MATCH]=g.match,k[a.WorksheetFuncId.LOOKUP]=g.lookup,k[a.WorksheetFuncId.HLOOKUP]=g.hlookup,k[a.WorksheetFuncId.VLOOKUP]=g.vlookup,k[a.WorksheetFuncId.ABS]=p.abs,k[a.WorksheetFuncId.CEILING]=p.ceiling,k[a.WorksheetFuncId.ECMA_CEILING]=p.ceiling,k[a.WorksheetFuncId.DEGREES]=p.degrees,k[a.WorksheetFuncId.FLOOR]=p.floor,k[a.WorksheetFuncId.RADIANS]=p.radians,k[a.WorksheetFuncId.ROUND]=p.round,k[a.WorksheetFuncId.ROUNDUP]=p.roundup,k[a.WorksheetFuncId.ROUNDDOWN]=p.rounddown,k[a.WorksheetFuncId.EVEN]=p.even,k[a.WorksheetFuncId.SIGN]=p.sign,k[a.WorksheetFuncId.PI]=p.pi,k[a.WorksheetFuncId.SQRT]=p.sqrt,k[a.WorksheetFuncId.EXP]=p.exp,k[a.WorksheetFuncId.POWER]=p.power,k[a.WorksheetFuncId.LN]=p.ln,k[a.WorksheetFuncId.LOG10]=p.log10,k[a.WorksheetFuncId.LOG]=p.log,k[a.WorksheetFuncId.SIN]=p.sin,k[a.WorksheetFuncId.COS]=p.cos,k[a.WorksheetFuncId.TAN]=p.tan,k[a.WorksheetFuncId.ASIN]=p.asin,k[a.WorksheetFuncId.ACOS]=p.acos,k[a.WorksheetFuncId.ATAN]=p.atan,k[a.WorksheetFuncId.ATAN2]=p.atan2,k[a.WorksheetFuncId.FACT]=p.fact,k[a.WorksheetFuncId.SQRTPI]=p.sqrtpi,k[a.WorksheetFuncId.FACTDOUBLE]=p.factdouble,k[a.WorksheetFuncId.INT]=p.int,k[a.WorksheetFuncId.TRUNC]=p.trunc,k[a.WorksheetFuncId.ODD]=p.odd,k[a.WorksheetFuncId.MROUND]=p.mround,k[a.WorksheetFuncId.QUOTIENT]=p.quotient,k[a.WorksheetFuncId.FLOOR_MATH]=p.floor_math,k[a.WorksheetFuncId.FLOOR_PRECISE]=p.floor_precise,k[a.WorksheetFuncId.CEILING_MATH]=p.ceiling_math,k[a.WorksheetFuncId.CEILING_PRECISE]=p.ceiling_precise,k[a.WorksheetFuncId.ISO_CEILING]=p.ceiling_precise,k[a.WorksheetFuncId.MOD]=p.mod,k[a.WorksheetFuncId.TEXT]=h.text,k[a.WorksheetFuncId.FIXED]=h.fixed,k[a.WorksheetFuncId.DOLLAR]=h.dollar,k[a.WorksheetFuncId.VALUE]=h.value,k[a.WorksheetFuncId.DATEVALUE]=h.datevalue,k[a.WorksheetFuncId.TIMEVALUE]=h.timevalue,k[a.WorksheetFuncId.NUMBERVALUE]=h.numbervalue,k[a.WorksheetFuncId.ARRAYTOTEXT]=h.arraytotext,k[a.WorksheetFuncId.VALUETOTEXT]=h.valuetotext,k[a.WorksheetFuncId.ISERROR]=f.iserror,k[a.WorksheetFuncId.ISERR]=f.iserr,k[a.WorksheetFuncId.ISBLANK]=f.isblank,k[a.WorksheetFuncId.ISLOGICAL]=f.islogical,k[a.WorksheetFuncId.ISNA]=f.isna,k[a.WorksheetFuncId.ISNONTEXT]=f.isnontext,k[a.WorksheetFuncId.ISTEXT]=f.istext,k[a.WorksheetFuncId.ISNUMBER]=f.isnumber,k[a.WorksheetFuncId.ISREF]=f.isref,k[a.WorksheetFuncId.ISEVEN]=f.iseven,k[a.WorksheetFuncId.ISODD]=f.isodd,k[a.WorksheetFuncId.ISFORMULA]=f.isformula,k[a.WorksheetFuncId.FORMULATEXT]=f.formulatext,k[a.WorksheetFuncId.ROWS]=S.rows,k[a.WorksheetFuncId.COLUMNS]=S.columns,k[a.WorksheetFuncId.AREAS]=S.areas,k[a.WorksheetFuncId.SHEETS]=S.sheets,k[a.WorksheetFuncId.ROW]=S.row,k[a.WorksheetFuncId.COLUMN]=S.column,k[a.WorksheetFuncId.SHEET]=S.sheet,k[a.WorksheetFuncId.OFFSET]=S.offset,k[a.WorksheetFuncId.TRANSPOSE]=S.transpose,k[a.WorksheetFuncId.SINGLE]=S.single,k[a.WorksheetFuncId.ADDRESS]=y.address,k[a.WorksheetFuncId.INDIRECT]=y.indirect,k[a.WorksheetFuncId.TAKE]=y.take,k[a.WorksheetFuncId.DROP]=y.drop,k[a.WorksheetFuncId.SEQUENCE]=y.sequence,k[a.WorksheetFuncId.HSTACK]=y.hstack,k[a.WorksheetFuncId.VSTACK]=y.vstack,k[a.WorksheetFuncId.CHOOSECOLS]=y.choosecols,k[a.WorksheetFuncId.CHOOSEROWS]=y.chooserows,k[a.WorksheetFuncId.TOCOL]=y.tocol,k[a.WorksheetFuncId.TOROW]=y.torow,k[a.WorksheetFuncId.EXPAND]=y.expand,k[a.WorksheetFuncId.WRAPCOLS]=y.wrapcols,k[a.WorksheetFuncId.WRAPROWS]=y.wraprows,k[a.WorksheetFuncId.FILTER]=s.filter,k[a.WorksheetFuncId.SORT]=s.sort,k[a.WorksheetFuncId.SORTBY]=s.sortby,k[a.WorksheetFuncId.UNIQUE]=s.unique,k[a.WorksheetFuncId.LEFT]=F.left,k[a.WorksheetFuncId.RIGHT]=F.right,k[a.WorksheetFuncId.MID]=F.mid,k[a.WorksheetFuncId.LEN]=F.len,k[a.WorksheetFuncId.CONCATENATE]=F.concatenate,k[a.WorksheetFuncId.EXACT]=F.exact,k[a.WorksheetFuncId.REPT]=F.rept,k[a.WorksheetFuncId.TRIM]=F.trim,k[a.WorksheetFuncId.CLEAN]=F.clean,k[a.WorksheetFuncId.CHAR]=F.char,k[a.WorksheetFuncId.UNICHAR]=F.unichar,k[a.WorksheetFuncId.CODE]=F.code,k[a.WorksheetFuncId.UNICODE]=F.unicode,k[a.WorksheetFuncId.LOWER]=F.lower,k[a.WorksheetFuncId.UPPER]=F.upper,k[a.WorksheetFuncId.PROPER]=F.proper,k[a.WorksheetFuncId.FIND]=F.find,k[a.WorksheetFuncId.REPLACE]=F.replace,k[a.WorksheetFuncId.SEARCH]=F.search,k[a.WorksheetFuncId.SUBSTITUTE]=F.substitute,k[a.WorksheetFuncId.TEXTBEFORE]=F.textBefore,k[a.WorksheetFuncId.TEXTAFTER]=F.textAfter,k[a.WorksheetFuncId.TEXTSPLIT]=F.textSplit,k[a.WorksheetFuncId.RAND]=b.rand,k[a.WorksheetFuncId.RANDBETWEEN]=b.randbetween,k[a.WorksheetFuncId.NOW]=b.now,k[a.WorksheetFuncId.TODAY]=b.today,k[a.WorksheetFuncId.RANDARRAY]=b.randarray,k[a.WorksheetFuncId.HYPERLINK]=C.hyperlink,k[a.WorksheetFuncId.FIELDVALUE]=v.fieldvalue,k[a.WorksheetFuncId._FV]=v.fieldvalue,k[a.WorksheetFuncId.MAKEARRAY]=d.makearray,k[a.WorksheetFuncId.ISOMITTED]=f.isomitted,k[a.WorksheetFuncId.MAP]=d.map,k[a.WorksheetFuncId.BYROW]=d.byrow,k[a.WorksheetFuncId.BYCOL]=d.bycol,k[a.WorksheetFuncId.REDUCE]=d.reduce,k[a.WorksheetFuncId.SCAN]=d.scan,k[a.WorksheetFuncId.XLOOKUP]=g.xlookup,k[a.WorksheetFuncId.XMATCH]=g.xmatch;let E=!1},7247:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.na=function(e,t){return i.naErrorOper},t.t_=function(e,[t]){const r=u(e,t);return(0,i.isStringOper)(r)||(0,i.isErrorOper)(r)?r:s.emptyStringOper},t.n_=function(e,[t]){const r=u(e,t);if((0,i.isNumberOper)(r)||(0,i.isErrorOper)(r))return r;const n=e.mathpack;return(0,i.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,[t]){const r=e.mathpack;switch(t.kind){case i.OperKind.Number:return r.fromNumber(1);case i.OperKind.String:return r.fromNumber(2);case i.OperKind.Boolean:return r.fromNumber(4);case i.OperKind.Error:return r.fromNumber(16);case i.OperKind.Array:return r.fromNumber(64);case i.OperKind.Rich:return r.fromNumber(128);default:return(0,n.assertNever)("calc.funcs.type",t)}},t.error_type=function(e,[t]){return(0,i.isErrorOper)(t)?(t.type>i.ErrorType.CALC&&(0,a.throwEvaluationError)((0,i.notImplemented)(["ERROR.TYPE for "+String(t.type)])),e.mathpack.fromNumber(t.type)):i.naErrorOper},t.info=function(e,t){return i.valueErrorOper};const n=r(6913),i=r(6592),a=r(4624),o=r(4810),s=r(199);function u(e,t){if((0,i.isRangeOper)(t)){if((0,i.isSheetIndex)(t.sheets)){const r=(0,i.rangeSeqOper)(t.sheets,[(0,i.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,o.readOperType)}return i.valueErrorOper}return t}},8778:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apply=function(e,[t,...r]){const n=l(e,t,r.length);return(0,i.isErrorOper)(n)?n:e.applyLambda(n,r)},t.makearray=function(e,[t,r,n]){const o=l(e,n,2);if((0,i.isErrorOper)(o))return o;const u=e.mathpack,d=(0,i.isMissingOper)(t)?1:u.fix(t),m=(0,i.isMissingOper)(r)?1:u.fix(r);return d<1||m<1?i.valueErrorOper:((0,a.validateArraySize)(d,m),(0,s.machineCall)(new s.ArrayMachine(e,d,m,((t,r)=>{const n=e.mathpack,i=[n.fromNumber(t+1),n.fromNumber(r+1)];return e.applyLambda(o,i)}),c(i.WorksheetFuncId.MAKEARRAY,e))))},t.map=function(e,t){const r=t.slice(0,t.length-1),a=t[t.length-1];return d(e,i.WorksheetFuncId.MAP,r,a,n.identity)},t.byrow=function(e,t){const r=[t[0]],n=t[1];return void 0===n?i.naErrorOper:d(e,i.WorksheetFuncId.BYROW,r,n,(e=>({rows:e.rows,cols:1,slice:(t,r,n,i)=>e.slice(t,r,0,e.cols)})))},t.bycol=function(e,t){const r=[t[0]],n=t[1];return void 0===n?i.naErrorOper:d(e,i.WorksheetFuncId.BYCOL,r,n,(e=>({rows:1,cols:e.cols,slice:(t,r,n,i)=>e.slice(0,e.rows,n,i)})))},t.reduce=function(e,t){const[r,n,a]=t;return m(e,i.WorksheetFuncId.REDUCE,r,n,a)},t.scan=function(e,t){const[r,n,a]=t;return m(e,i.WorksheetFuncId.SCAN,r,n,a)};const n=r(6913),i=r(6592),a=r(7217),o=r(4624),s=r(4810),u=r(9470);function l(e,t,r){const n=function(e,t){return(0,i.isRangeOper)(t)&&(0,i.isSheetIndex)(t.sheets)&&1===t.ranges.length&&(0,i.isGridCell)(t.ranges[0])?e.dereferenceOper(t,i.SignatureType.All&~i.OperKind.Range):t}(e,t);return n instanceof u.LambdaOper&&n.checkArity(r)?n:i.valueErrorOper}function c(e,t){return r=>{let a=r;if((0,i.isRangeOper)(a)){if(!(0,i.isSheetIndex)(a.sheets)||1!==a.ranges.length||!(0,i.isGridCell)(a.ranges[0]))return(0,s.earlyReturn)((0,n.success)(i.calcErrorOper));a=t.dereferenceOper(a,i.SignatureType.All&~i.OperKind.Range),(0,n.assertTrue)("calc.funcs.coerceLambdaRvToArrayElt",!(0,i.isRangeOper)(a))}return(0,i.isArrayOper)(a)?1!==a.rows||1!==a.cols?(0,s.earlyReturn)((0,n.success)(i.calcErrorOper)):a.opers[0][0]:((0,i.isMissingOper)(a)&&(0,o.throwEvaluationError)((0,i.notImplemented)([`${(0,i.englishWorksheetFuncIdToName)(e)}: MissingOper in result`])),a)}}function d(e,t,r,o,u){const d=l(e,o,r.length);if((0,i.isErrorOper)(d))return d;const m=[];for(const e of r){if(!(0,i.isArrayOper)(e)&&!(0,i.isRangeOper)(e))return i.valueErrorOper;const t=(0,a.rangeOrArrayToVal)(e,i.valueErrorOper);if((0,i.isErrorOper)(t))return t;m.push(u((0,a.makeSlicer)(t)))}const g=m.map((e=>e.rows)).reduce(n.fastMin),p=m.map((e=>e.rows)).reduce(n.fastMax),h=m.map((e=>e.cols)).reduce(n.fastMin),f=m.map((e=>e.cols)).reduce(n.fastMax);return(0,a.validateArraySize)(p,f),(0,s.machineCall)(new s.ArrayMachine(e,p,f,((t,r)=>t>=g||r>=h?i.naErrorOper:e.applyLambda(d,m.map((e=>e.slice(t,1,r,1))))),c(t,e)))}function m(e,t,r,o,u){const d=(0,a.rangeOrArrayToVal)(o,i.valueErrorOper);if((0,i.isErrorOper)(d))return d;const m=(0,a.makeSlicer)(d),g=l(e,u,2);if((0,i.isErrorOper)(g))return g;const p=!(0,i.isMissingOper)(r);let h,f=p?r:void 0,S=!0;if(t===i.WorksheetFuncId.REDUCE)h=e=>(f=e,i.blankOper);else{const r=c(t,e);h=e=>{const t=r(e);return t.kind===s.EarlyReturnKind.EarlyReturn||(f=t),t}}const v=(0,s.machineCall)(new s.ArrayMachine(e,m.rows,m.cols,((t,r)=>{const i=S;return S=!1,i&&!p?m.slice(t,1,r,1):((0,n.assertTrue)("calc.funcs.scanReduce",void 0!==f),e.applyLambda(g,[f,m.slice(t,1,r,1)]))}),h));return t===i.WorksheetFuncId.REDUCE?(0,s.machineCall)(new s.ThenMachine(e,(()=>v),(()=>((0,n.assertTrue)("calc.funcs.scanReduce",void 0!==f),f)))):v}},1620:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.if_=function(e,t){const r=t[0];(0,n.assertTrue)("calc.funcs.if: condition is not a boolean",(0,i.isBooleanOper)(r));const a=t[r.value?1:2];return(0,n.assertTrue)("calc.funcs.if: result is undefined",void 0!==a),a},t.choose=function(e,t){const r=t[0];(0,n.assertTrue)("calc.funcs.choose",(0,i.isNumberOper)(r));const a=e.mathpack.fix(r);return a<1||a>t.length-1?i.valueErrorOper:t[a]},t.ifs=function e(t,r){for(let a=0;a<r.length;a+=2){const o=r[a];if((0,i.isArrayOper)(o)){const n=r.slice(a);return l(t,s,e,n)}if((0,i.isErrorOper)(o))return o;if((0,n.assertTrue)("calc.funcs.ifs",(0,i.isBooleanOper)(o)),o.value)return r[a+1]}return i.naErrorOper},t.switch_=function e(t,r){const o=r[0];if((0,i.isArrayOper)(o))return l(t,u,e,r);if((0,i.isErrorOper)(o))return o;const s=function({mathpack:e,localeInfo:t},r){switch(r.kind){case i.OperKind.Number:return t=>(0,i.isRichOper)(t)?(0,a.throwEvaluationError)((0,i.notImplemented)(["SWITCH with a rich value case"])):(0,i.isNumberOper)(t)&&0===e.compare(r,t);case i.OperKind.String:return e=>(0,i.isRichOper)(e)?(0,a.throwEvaluationError)((0,i.notImplemented)(["SWITCH with a rich value case"])):(0,i.isStringOper)(e)&&0===t.stringCompareCI(r.value,e.value);case i.OperKind.Boolean:return e=>(0,i.isRichOper)(e)?(0,a.throwEvaluationError)((0,i.notImplemented)(["SWITCH with a rich value case"])):(0,i.isBooleanOper)(e)&&r.value===e.value;case i.OperKind.Rich:return(0,a.throwEvaluationError)((0,i.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,n.assertNever)("calc.funcs.makeSwitchComparer",r)}}(t.config,o);for(let n=1;n<r.length-1;n+=2){const a=i.OperKind.Error|i.OperKind.Rich|i.OperKind.Number|i.OperKind.Boolean|i.OperKind.String|i.OperKind.Array,o=t.coerceOper(t.dereferenceOper(r[n],a),a);if((0,i.isArrayOper)(o))return l(t,u,e,r);if((0,i.isErrorOper)(o))return o;if(s(o))return r[n+1]}return r.length%2==0?r[r.length-1]:i.naErrorOper},t.true_=function(e,t){return i.trueOper},t.false_=function(e,t){return i.falseOper},t.not=function(e,[t]){return(0,i.booleanOper)(!t.value)};const n=r(6913),i=r(6592),a=r(4624),o=r(199),s=(0,o.makeStrict)((0,i.getWorksheetFuncType)(i.WorksheetFuncId.IFS)),u=(0,o.makeStrict)((0,i.getWorksheetFuncType)(i.WorksheetFuncId.SWITCH));function l(e,t,r,n){const a=n.slice();return e.dereferenceOpers(a,t),(0,o.arrayLift)(e,t,(n=>{const a=[];for(let r=0;r<n.length;r+=1){const o=(0,i.getArgType)(t,r,n.length);a[r]=e.coerceOper(n[r],o)}return r(e,a)}),a)}},1533:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.index=l,t.makeLookupComparer=g,t.binarySearch=p,t.linearSearch=h,t.match=function(e,[t,r,a=e.mathpack.one]){const o=e.mathpack,s=function(e){switch(e.kind){case i.OperKind.Number:return e;case i.OperKind.Range:if(!(0,i.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.refErrorOper;const t=e.ranges[0];return 1!==t.rows||1!==t.cols?i.refErrorOper:e}}(a);if((0,i.isErrorOper)(s))return s;const[u]=e.dereferenceAllOpers([s]),l=S(e,u);if((0,i.isErrorOper)(l))return l;const c=v(r);if((0,i.isErrorOper)(c))return c;const[d]=e.dereferenceAllOpers([c]),m=y(d),g=1===m.rows,f=(0,n.sparseArray2DTo1D)(m,g);let F=-1;return F=o.cond(l)>0?p(e,t,f):0===o.cond(l)?h(e,t,f,i.OperatorId.Eq):h(e,t,f,i.OperatorId.Lt),F<0||F>=f.length?i.naErrorOper:e.mathpack.fromNumber(F+1)},t.lookup=function(e,[t,r,a]){const o=f(r);if((0,i.isErrorOper)(o))return o;const s=b(o),u=k(o,s),[l]=e.dereferenceAllOpers([u]),c=(0,n.sparseArray2DTo1D)(y(l),s),d=p(e,t,c);if(d<0)return i.naErrorOper;if(void 0!==a){const t=v(a);if((0,i.isErrorOper)(t))return t;const r=b(t),o=function(e,t,r){if((0,i.isRangeOper)(r)){const a=r.ranges[0],o=(0,i.gridRange)(a.row,a.col,(0,n.fastMin)(t?1:e,i.sheetRows-a.row),(0,n.fastMin)(t?e:1,i.sheetCols-a.col));return(0,i.range3DOper)(r.sheets,o)}return r}(c.length,r,t),s=(0,n.sparseArray2DTo1D)(F(e,o),r);return d>=s.length?(0,i.isArrayOper)(t)?i.naErrorOper:i.blankOper:s.get(d)}const m=F(e,o);return s?m.get(m.rows-1,d):m.get(d,m.cols-1)},t.hlookup=function(e,t){return C(e,t,!0)},t.vlookup=function(e,t){return C(e,t,!1)},t.makeWildcardComparer=I,t.xlookup=function(e,t){const[r,a,o,s=i.missingOper,u,c]=t,d=R(e,a,u,c);if(void 0!==d.kind)return d;const m=function(e){switch(e.kind){case i.OperKind.Range:return(0,n.assertTrue)("calc.funcs.xlookup",(0,i.isSheetIndex)(e.sheets)),e.ranges.length>1?i.naErrorOper:[e.ranges[0].rows,e.ranges[0].cols];case i.OperKind.Array:return[e.rows,e.cols]}}(o);if(!Array.isArray(m))return m;const[g,p]=m,h=d.lookupArray.length,f=h===g&&(1===g||!d.isHorizontal),S=h===p&&(1===p||d.isHorizontal);if(!f&&!S)return i.valueErrorOper;const v=P(e,d,r);if(void 0===v)return(0,i.isMissingOper)(s)?i.naErrorOper:s;const y=e.mathpack;return l(e,f?[o,y.fromNumber(v+1),1===p?y.one:y.zero]:[o,1===g?y.one:y.zero,y.fromNumber(v+1)])},t.xmatch=function(e,t){const[r,n,a,o]=t,s=R(e,n,a,o);if(void 0!==s.kind)return s;const u=P(e,s,r);return void 0===u?i.naErrorOper:e.mathpack.fromNumber(u+1)};const n=r(6913),i=r(6592),a=r(1382),o=r(2968),s=r(4624),u=r(9001);function l(e,[t,r,a,o]){const s=e.mathpack,u=s.sfix(r);if(u<0)return i.valueErrorOper;const l=void 0===a?void 0:s.sfix(a);if(void 0!==l&&l<0)return i.valueErrorOper;const c=void 0===o?0:s.sfix(o)-1;if(c<0)return i.valueErrorOper;let d,m;switch(t.kind){case i.OperKind.Range:if(!(0,i.isSheetIndex)(t.sheets))return i.valueErrorOper;if(c>=t.ranges.length)return i.refErrorOper;const e=t.ranges[c];if(void 0===l)if(1===e.rows)d=0,m=u-1;else{if(1!==e.cols)return i.refErrorOper;d=u-1,m=-1}else d=u-1,m=l-1;if(d>=e.rows||m>=e.cols)return i.refErrorOper;const r=(0,i.gridRange)(e.row+(0,n.fastMax)(d,0),e.col+(0,n.fastMax)(m,0),-1===d?e.rows:1,-1===m?e.cols:1);return(0,i.rangeSeqOper)(t.sheets,[r]);case i.OperKind.Array:return c>0?i.refErrorOper:(void 0===l?1===t.rows?(d=0,m=u-1):(d=u-1,m=-1):(d=u-1,m=l-1),d>=t.rows||m>=t.cols?i.refErrorOper:-1===d&&-1===m?t:-1===d?(0,i.arrayOper)(t.rows,1,t.opers.map((e=>[e[m]]))):-1===m?(0,i.arrayOper)(1,t.cols,[t.opers[d]]):t.opers[d][m]);default:return(0,n.assertNever)("calc.funcs.lookupFuncs: INDEX",t)}}const c=e=>e<0?i.OperatorId.Lt:e>0?i.OperatorId.Gt:i.OperatorId.Eq,d=(e,t,r)=>c(e.cond2(t,r)),m=(e,t)=>c(e-t);function g(e,t,r=!1){const a=!0,{localeInfo:u,mathpack:l}=e.config;let g;switch(t.kind){case i.OperKind.Number:g=e=>({correctType:a,sgnT:d(l,e,t)});break;case i.OperKind.String:if(r){const e=new o.WildExp(u,t.value);g=t=>({correctType:a,sgnT:e.test(t.value)?i.OperatorId.Eq:i.OperatorId.Ne})}else g=e=>({correctType:a,sgnT:c(u.stringCompareCI(e.value,t.value))});break;case i.OperKind.Boolean:g=e=>({correctType:a,sgnT:m(e.value,t.value)});break;case i.OperKind.Rich:return(0,s.throwEvaluationError)((0,i.notImplemented)(["lookup with rich value condition"]));case i.OperKind.Blank:g=()=>({correctType:a,sgnT:i.OperatorId.Eq});break;default:return(0,n.assertNever)("calc.funcs.makeLookupComparer",t)}return e=>{const r=(0,i.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:i.OperatorId.Ne}:g(r)}}function p(e,t,r){let n=!1;const a=r.length-1;let o=Math.floor((0+a)/2),s=0,u=a;const l=g(e,t);for(;;){let e=l(r.get(o)).sgnT;if(e===i.OperatorId.Ne){if(o<u)for(let t=o+1;t<=u;t+=1)if(e=l(r.get(t)).sgnT,e!==i.OperatorId.Ne){o=t;break}e===i.OperatorId.Ne&&(o=Math.floor((s+u)/2),e=i.OperatorId.Gt)}if(e===i.OperatorId.Eq){if(o<a){o+=1,n=!0,s=o,u=o;continue}return o}if(e===i.OperatorId.Lt?s=o+1:u=o-1,!(s<=u)){if(n)o-=1;else if(e===i.OperatorId.Gt&&(o-=1,o>=0)){s=o,u=o;continue}return o}o=Math.floor((s+u)/2)}}function h(e,t,r,a){let o=-1;const s=g(e,t,a===i.OperatorId.Eq);for(let e=0;e<r.length;e+=1){const t=r.get(e),{correctType:u,sgnT:l}=s(t);if(u){if(l===i.OperatorId.Eq)return e;if(l!==i.OperatorId.Ne&&l===a)return o;o=e}e===r.denseLength&&(e=(0,n.fastMax)(e,r.length-2))}return a!==i.OperatorId.Eq?o:r.length}function f(e){switch(e.kind){case i.OperKind.Number:return i.naErrorOper;case i.OperKind.Range:return(0,i.isSheetIndex)(e.sheets)?e.ranges.length>1?i.naErrorOper:e:i.valueErrorOper;case i.OperKind.Array:return e}}function S(e,t){let r;switch(t.kind){case i.OperKind.Number:return t;case u.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case i.OperKind.Array:r=t.opers[0][0];break;default:return(0,n.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,i.OperKind.Number),(0,i.isErrorOper)(r)?i.refErrorOper:r}function v(e){switch(e.kind){case i.OperKind.Number:case i.OperKind.Rich:return i.naErrorOper;case i.OperKind.Range:if(!(0,i.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.naErrorOper;const t=e.ranges[0];return 1!==t.rows&&1!==t.cols?i.naErrorOper:e;case i.OperKind.Array:return 1!==e.rows&&1!==e.cols?i.naErrorOper:e}}function y(e){switch(e.kind){case u.DerefOperKind.RangeValues:return e.arrays[0];case i.OperKind.Array:return new n.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,i.blankOper)}}function F(e,t){switch(t.kind){case i.OperKind.Range:const r=t.sheets,a=t.ranges[0];return new n.NonstrictSparseArray2D(a.rows,a.cols,a.rows,a.cols,((t,n)=>{const o=(0,i.gridCell)(a.row+t,a.col+n),[s]=e.dereferenceAllOpers([(0,i.rangeSeqOper)(r,[o])]);return s.arrays[0].get(0,0)}),(()=>(0,n.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")));case i.OperKind.Array:return new n.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,i.blankOper)}}function b(e){if((0,i.isRangeOper)(e)){const t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function C(e,[t,r,a,o=i.trueOper],u){const l=f(r);if((0,i.isErrorOper)(l))return l;const c=k(l,u),[d]=e.dereferenceAllOpers([c]),m=(0,n.sparseArray2DTo1D)(y(d),u),g=o.value?p(e,t,m):h(e,t,m,i.OperatorId.Eq);if(g<0||g>=m.length)return i.naErrorOper;const v=function(e,t){switch(t.kind){case i.OperKind.Number:return t;case i.OperKind.Range:if(!(0,i.isSheetIndex)(t.sheets))return i.valueErrorOper;if(t.ranges.length>1)return i.refErrorOper;const r=t.ranges;return e.calcingArray?(0,s.throwEvaluationError)((0,i.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,s.throwEvaluationError)((0,i.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case i.OperKind.Array:return(0,s.throwEvaluationError)((0,i.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,a);if((0,i.isErrorOper)(v))return v;const[b]=e.dereferenceAllOpers([v]),C=S(e,b);if((0,i.isErrorOper)(C))return C;const E=e.mathpack.sfix(C)-1,A=F(e,l);return E<0?i.valueErrorOper:E>=(u?A.rows:A.cols)?i.refErrorOper:u?A.get(E,g):A.get(g,E)}function k(e,t){if((0,i.isRangeOper)(e)){const r=e.ranges[0],n=(0,i.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,i.rangeSeqOper)(e.sheets,[n])}return e}var E,A;function T(e){return e===A.DescendingBinary||e===A.AscendingBinary}function R(e,t,r=i.missingOper,a=i.missingOper){const o=(0,i.isMissingOper)(r)?E.Exact:e.mathpack.sfix(r);if(o<E.Lower||o>E.Wildcard)return i.valueErrorOper;const s=(0,i.isMissingOper)(a)?A.Linear:e.mathpack.sfix(a);if(s<A.DescendingBinary||s>A.AscendingBinary||0===s)return i.valueErrorOper;if(o===E.Wildcard&&T(s))return i.valueErrorOper;const u=f(t);if((0,i.isErrorOper)(u))return u;const[l]=e.dereferenceAllOpers([u]),c=y(l),{rows:d,cols:m}=c;let g;if(1===d)g=!0;else{if(1!==m)return i.valueErrorOper;g=!1}return{kind:void 0,lookupArray:(0,n.sparseArray2DTo1D)(c,g),matchMode:o,searchMode:s,isHorizontal:g}}function N(e,t,r,n,o){return r===i.OperatorId.Gt?t===E.Higher&&(void 0===o||c((0,a.sortOpers)(e,n,o,1,!1))===i.OperatorId.Lt):t===E.Lower&&(void 0===o||c((0,a.sortOpers)(e,n,o,1,!1))===i.OperatorId.Gt)}function I(e,t){const r=new o.WildExp(e.config.localeInfo,t.value);return e=>(0,i.isStringOper)(e)&&r.test(e.value)?i.OperatorId.Eq:i.OperatorId.Ne}function P(e,t,r){return T(t.searchMode)?function(e,{lookupArray:t,matchMode:r,searchMode:o},s){const u=e.config,l=o===A.DescendingBinary;let d,m=0,g=t.length-1;(0,n.assertTrue)("calc.funcs.xBinarySearch",r!==E.Wildcard);let p=!1;for(;g>=m;){const e=Math.floor((g+m)/2),n=(h=t.get(e),c((0,a.sortOpers)(u,h,s,1,!1)));if(n===i.OperatorId.Eq)p=!0,d=e;else if(!p){const t=r===E.Higher&&n===i.OperatorId.Gt,a=r===E.Lower&&n===i.OperatorId.Lt;(t||a)&&(d=e)}l!==(n===i.OperatorId.Lt)?m=e+1:g=e-1}var h;return d}(e,t,r):function(e,{lookupArray:t,matchMode:r,searchMode:o},s){const u=e.config;let l;const d=r===E.Lower||r===E.Higher,m=r===E.Wildcard&&(0,i.isStringOper)(s)?I(e,s):e=>c((0,a.sortOpers)(u,e,s,1,!1)),g=o===A.ReverseLinear?t.length-1:0,p=o===A.ReverseLinear?-1:1;for(let e=g;e>=0&&e<t.length;e+=p){const a=t.get(e),o=m(a);if(o===i.OperatorId.Eq){l=e;break}if(d&&((0,n.assertTrue)("calc.funcs.xLinearSearch",o!==i.OperatorId.Ne),N(u,r,o,a,void 0===l?void 0:t.get(l))&&(l=e)),e>=t.denseLength){const r=t.denseLength,i=t.length-1;e=p>0?(0,n.fastMax)(e,i-1):(0,n.fastMin)(e,r+1)}}return l}(e,t,r)}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Higher=1]="Higher",e[e.Wildcard=2]="Wildcard"}(E||(E={})),function(e){e[e.DescendingBinary=-2]="DescendingBinary",e[e.ReverseLinear=-1]="ReverseLinear",e[e.Linear=1]="Linear",e[e.AscendingBinary=2]="AscendingBinary"}(A||(A={}))},3657:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mod=t.abs=t.odd=t.even=t.rounddown=t.roundup=t.round=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log10=t.ln=t.power=t.exp=t.sqrt=void 0,t.pi=function(e,t){return e.mathpack.pi},t.log=function(e,[t,r]){const i=e.mathpack;if(void 0===r)return i.log(t);const a=i.ln(t);if((0,n.isErrorOper)(a))return a;const o=i.ln(r);return(0,n.isErrorOper)(o)?o:i.div(a,o)},t.int=function(e,t){let[r]=t;const n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.trunc=function(e,[t,r=e.mathpack.zero]){return e.mathpack.roundDown(t,r)},t.mround=function(e,[t,r]){const a=(0,i.chkNumOper)(e,t);if((0,n.isErrorOper)(a))return a;const o=(0,i.chkNumOper)(e,r);if((0,n.isErrorOper)(o))return o;const s=e.mathpack;if(0===s.cond(o))return s.zero;if(0!==s.cond(a)&&s.cond(a)<0!=s.cond(o)<0)return n.numErrorOper;const u=s.div(a,o);if((0,n.isErrorOper)(u))return n.numErrorOper;const l=s.floor(u),c=(0,i.assertNumber)(s.sub(u,l)),d=s.fromNumber(.5-5e-15);if(s.cond2(c,d)<0)return s.mul(l,o);const m=s.add(l,s.one);return(0,n.isErrorOper)(m)?m:s.mul(m,o)},t.ceiling=function(e,[t,r]){return a(e.mathpack,t,r)},t.ceiling_math=function(e,[t,r,i]){const o=e.mathpack;let s=void 0===r||(0,n.isMissingOper)(r)?o.one:o.abs(r);const u=void 0===i||(0,n.isMissingOper)(i)?o.zero:i;return 0!==o.cond(u)&&o.cond(t)<0&&(s=o.neg(s)),0===o.cond(s)?o.zero:a(o,t,s)},t.ceiling_precise=function(e,[t,r]){const i=e.mathpack,o=void 0===r||(0,n.isMissingOper)(r)?i.one:i.abs(r);return 0===i.cond(o)?i.zero:a(i,t,o)},t.floor=function(e,[t,r]){return o(e.mathpack,t,r)},t.floor_math=function(e,[t,r,i]){const a=e.mathpack;let s=void 0===r||(0,n.isMissingOper)(r)?a.one:a.abs(r);const u=void 0===i||(0,n.isMissingOper)(i)?a.zero:i;return 0!==a.cond(u)&&a.cond(t)<0&&(s=a.neg(s)),0===a.cond(s)?a.zero:o(a,t,s)},t.floor_precise=function(e,[t,r]){const i=e.mathpack,a=void 0===r||(0,n.isMissingOper)(r)?i.one:i.abs(r);return 0===i.cond(a)?i.zero:o(i,t,a)},t.sign=function(e,[t]){const r=e.mathpack;return r.fromNumber(r.cond(t))},t.degrees=function(e,[t]){const r=e.mathpack,n=(0,i.assertNumber)(r.div(r.fromNumber(180),r.pi));return r.mul(t,n)},t.radians=function(e,[t]){const r=e.mathpack,n=(0,i.assertNumber)(r.div(r.pi,r.fromNumber(180)));return r.mul(t,n)},t.quotient=function(e,[t,r]){const a=(0,i.chkNumOper)(e,t);if((0,n.isErrorOper)(a))return a;const o=(0,i.chkNumOper)(e,r);if((0,n.isErrorOper)(o))return o;const s=e.mathpack;if(0===s.cond(o))return n.div0ErrorOper;const u=s.div(a,o);return(0,n.isErrorOper)(u)?n.numErrorOper:s.cond(u)>0?s.floor(u):s.ceil(u)},t.fact=function(e,[t]){const r=e.mathpack,i=r.sfix(t);if(r.cond(t)<0||i>170)return n.numErrorOper;let a=r.one;for(let e=i;e>0;e-=1){if((0,n.isErrorOper)(a))return a;a=r.mul(r.fromNumber(e),a)}return a},t.factdouble=function(e,[t]){const r=(0,i.chkNumOper)(e,t);if((0,n.isErrorOper)(r))return r;const a=e.mathpack,o=a.floor(r);if(a.cond2(o,a.fromNumber(-1))<0||a.cond2(o,a.fromNumber(300))>0)return n.numErrorOper;let s=a.one;for(let e=a.toNumber(o);e>1;e-=2){if((0,n.isErrorOper)(s))return s;s=a.mul(a.fromNumber(e),s)}return s},t.sqrtpi=function(e,[t]){const r=(0,i.chkNumOper)(e,t);if((0,n.isErrorOper)(r))return r;const a=e.mathpack;if(a.cond(r)<0)return n.numErrorOper;const o=a.mul(a.pi,r);return(0,n.isErrorOper)(o)?o:a.sqrt(o)};const n=r(6592),i=r(7217);function a(e,t,r){const i=e.cond(t),a=e.cond(r);if(i>0&&a<0)return n.numErrorOper;if(0===i||0===a)return e.zero;const o=e.div(t,r);return(0,n.isErrorOper)(o)?o:e.mul(e.ceil(e.viewRound(o)),r)}function o(e,t,r){const i=e.cond(t),a=e.cond(r);if(i>0&&a<0)return n.numErrorOper;if(0===i&&0===a)return t;const o=e.div(t,r);return(0,n.isErrorOper)(o)?o:e.mul(e.floor(e.viewRound(o)),r)}function s(e,t,[r]){const n=t.mathpack;if(n.cond(r)>=0){const t=n.ceil(r);return 0===n.cond2((0,i.assertNumber)((0,i.numMod)(n,t,n.fromNumber(2))),n.one)===e?n.add(t,n.one):t}const a=n.floor(r);return 0===n.cond2((0,i.assertNumber)((0,i.numMod)(n,a,n.fromNumber(2))),n.one)===e?n.sub(a,n.one):a}t.sqrt=(0,i.wrap1)((e=>e.mathpack.sqrt)),t.exp=(0,i.wrap1)((e=>e.mathpack.exp)),t.power=(0,i.wrap2)((e=>e.mathpack.power)),t.ln=(0,i.wrap1)((e=>e.mathpack.ln)),t.log10=(0,i.wrap1)((e=>e.mathpack.log)),t.sin=(0,i.wrap1)((e=>e.mathpack.sin)),t.cos=(0,i.wrap1)((e=>e.mathpack.cos)),t.tan=(0,i.wrap1)((e=>e.mathpack.tan)),t.asin=(0,i.wrap1)((e=>e.mathpack.asin)),t.acos=(0,i.wrap1)((e=>e.mathpack.acos)),t.atan=(0,i.wrap1)((e=>e.mathpack.atan)),t.atan2=(0,i.wrap2)((e=>e.mathpack.atan2)),t.round=(0,i.wrap2)((e=>e.mathpack.round)),t.roundup=(0,i.wrap2)((e=>e.mathpack.roundUp)),t.rounddown=(0,i.wrap2)((e=>e.mathpack.roundDown)),t.even=s.bind(void 0,!0),t.odd=s.bind(void 0,!1),t.abs=(0,i.wrap1)((e=>e.mathpack.abs)),t.mod=(0,i.wrap2)((e=>e.mathpack.mod))},5386:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=void 0,t.nextFuncs={v1:{}}},8510:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.text=function(e,[t,{value:r}]){const o=(0,i.isRichOper)(t)?t.getFallback():t;if((0,i.isStringOper)(o)&&o.value.length>255||r.length>255)return i.valueErrorOper;let s;switch(o.kind){case i.OperKind.String:{const t=e.coerceOper(o,i.OperKind.Number);s=(0,i.isNumberOper)(t)?t:o;break}case i.OperKind.Number:s=o;break;case i.OperKind.Boolean:{const t=e.coerceOper(o,i.OperKind.String);(0,n.assertTrue)("calc.funcs.text",(0,i.isStringOper)(t)),s=t;break}case i.OperKind.Error:return i.valueErrorOper}const u=e.applyFormat(e.originSheet.document,r,s,a.NumberFormatSource.CustomString);return void 0!==u?(0,i.stringOper)(u):i.valueErrorOper},t.fixed=function(e,[t,r,n]){const{formatValue:o,formatDecimals:s}=m(e,t,r,void 0);if((0,i.isErrorOper)(o))return o;let u;u=n?.value?0===s?i.KnownFormat.NoComFixed0:2===s?i.KnownFormat.NoComFixed:(0,a.buildNumberFormat)(e.config.localeInfo,!1,1,s):0===s?i.KnownFormat.Fixed0:2===s?i.KnownFormat.Fixed:(0,a.buildNumberFormat)(e.config.localeInfo,!0,4,s);const l=e.applyFormat(e.originSheet.document,u,o,a.NumberFormatSource.CustomBytecode);return void 0!==l?(0,i.stringOper)(l):i.valueErrorOper},t.dollar=function(e,[t,r]){const{localeInfo:n}=e.config,{formatValue:o,formatDecimals:s}=m(e,t,r,n.isEastAsia?n.currencyDecimals:void 0);if((0,i.isErrorOper)(o))return o;const l=0===s?i.KnownFormat.Currency:2===s?i.KnownFormat.CurrencyDec:(0,a.buildCurrencyFormat)(n,!1,s,!0,!1),c=e.applyFormat(e.originSheet.document,l,o,a.NumberFormatSource.CustomBytecode);return void 0!==c&&c.length>0&&c.charCodeAt(c.length-1)===u?(0,i.stringOper)(c.substring(0,c.length-1)):void 0!==c?(0,i.stringOper)(c):i.valueErrorOper},t.value=function(e,[t]){switch(t.kind){case i.OperKind.Boolean:return i.valueErrorOper;case i.OperKind.Number:return t;case i.OperKind.String:return t.value.length>255?i.valueErrorOper:e.coerceOper((0,i.stringOper)(g(t.value)),i.OperKind.Number)}},t.datevalue=function(e,[t]){const r=p(e,t);return(0,i.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,[t]){const r=p(e,t);return(0,i.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},t.isWhitespace=h,t.numbervalue=function(e,t){const[r,a,o]=t,s=e.mathpack,u=e.config.localeInfo;if(void 0!==a&&(!(0,i.isStringOper)(a)||""===a.value)||void 0!==o&&(!(0,i.isStringOper)(o)||""===o.value))return i.valueErrorOper;const l=e=>(0,n.stringFromCodePoint)((0,n.stringCodePointAt)(e,0)),c=u.decimalSeparator,d=a?l(a.value):c;let m=o?l(o.value):u.thousandsSeparator;if(d===m){if(void 0!==o)return i.valueErrorOper;m=c}const g=r.value;if(""===g)return s.zero;let p=!1,f=0;const S=[];let v=0;const y=e=>(S.push(e),v+=e.length);for(;f<g.length&&v<255;)if(h(g.charCodeAt(f)))f+=1;else if(p||!(0,n.stringStartsWith)(g,m,f))if((0,n.stringStartsWith)(g,d,f))p=!0,y(c),f+=d.length;else{const e=(0,n.stringCodePointAt)(g,f);y((0,n.stringFromCodePoint)(e)),f+=(0,n.numCodeUnits)(e)}else f+=m.length;if(f!==g.length)return i.valueErrorOper;let F=0;for(;S.length>0&&"%"===S[S.length-1];)v-=S.pop().length,++F;if(0===S.length)return s.zero;const b=e.coerceOper((0,i.stringOper)(S.join("")),i.OperKind.Number);if(!(0,i.isNumberOper)(b))return i.valueErrorOper;let C=b;for(;F>0;)C=s.div(C,s.fromNumber(100)),(0,n.assertTrue)("calc.funcs.numberValue",(0,i.isNumberOper)(C)),--F;return C},t.arraytotext=function(e,t){return S(e,t[0],t[1])},t.valuetotext=function(e,t){return S(e,t[0],t[1])};const n=r(6913),i=r(6592),a=r(1159),o=r(3657),s=r(4624),{codePointSpace:u,codePointTab:l,codePointLF:c,codePointCR:d}=n.codePoint;function m(e,t,r,a){if(void 0===r||(0,i.isMissingOper)(r))return{formatValue:t,formatDecimals:a??2};const s=e.config.mathpack;if(s.cond(r)<0){const a=0,s=(0,o.round)(e,[t,r]);return(0,n.assertTrue)("calc.funcs.fixedDollarRound",(0,i.isNumberOper)(s)||(0,i.isErrorOper)(s)),{formatValue:s,formatDecimals:a}}const u=s.sfix(r);return u<0||u>127?{formatValue:i.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:u}}function g(e){let t=0;for(;t<e.length&&e.charCodeAt(t)===u;)t+=1;return e.substring(t)}function p(e,t){return(0,i.isStringOper)(t)?t.value.length>255?i.valueErrorOper:e.parseDate(g(t.value))??i.valueErrorOper:i.valueErrorOper}function h(e){return e===u||e===l||e===d||e===c}var f;function S(e,t,r){const n=void 0===r?f.Concise:e.mathpack.sfix(r);return n!==f.Concise&&n!==f.Strict?i.valueErrorOper:v(e,t,n)}function v(e,t,r){const a=[],o=e.config.localeInfo;switch(t.kind){case i.OperKind.Array:{for(let e=0;e<t.rows;++e)for(let r=0;r<t.cols;++r){const n=t.opers[e][r];if((0,i.isArrayOper)(n)||(0,i.isRangeOper)(n))return i.calcErrorOper}const n=r===f.Concise?o.listSeparator:o.rowSeparator,s=r===f.Concise?o.listSeparator:o.columnSeparator;r===f.Strict&&a.push(o.leftBrace);for(let o=0;o<t.rows;++o){0!==o&&(a.push(n),r===f.Concise&&a.push(" "));for(let n=0;n<t.cols;++n){0!==n&&(a.push(s),r===f.Concise&&a.push(" "));const u=v(e,t.opers[o][n],r);if((0,i.isErrorOper)(u))return u;a.push(u.value)}}r===f.Strict&&a.push(o.rightBrace);break}case i.OperKind.String:r===f.Strict?a.push('"'+t.value.replace(/"/g,'""')+'"'):a.push(t.value);break;case i.OperKind.Number:case i.OperKind.Boolean:{const r=e.coerceOper(t,i.OperKind.String);(0,n.assertTrue)("calc.funcs.operToText",(0,i.isStringOper)(r)),a.push(r.value);break}case i.OperKind.Blank:break;case i.OperKind.Error:{const e=o.errorNames[t.type];null==e&&(0,s.throwEvaluationError)((0,i.internal)(`No locale data for error type ${t.type}`)),a.push(e);break}case i.OperKind.Rich:(0,s.throwEvaluationError)((0,i.notImplemented)(["ARRAYTOTEXT/VALUETOTEXT rich argument"]));default:return(0,n.assertNever)("calc.funcs.operToText",t)}return a.reduce(((e,t)=>e+t.length),0)>i.cellStringLimit?i.calcErrorOper:(0,i.stringOper)(a.join(""))}!function(e){e[e.Concise=0]="Concise",e[e.Strict=1]="Strict"}(f||(f={}))},7670:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iserror=function(e,[t]){return(0,i.booleanOper)((0,i.isErrorOper)(t))},t.iserr=function(e,[t]){return(0,i.booleanOper)((0,i.isErrorOper)(t)&&t.type!==i.ErrorType.NA)},t.isblank=function(e,[t]){return(0,i.booleanOper)((0,i.isBlankOper)(t))},t.islogical=function(e,[t]){return(0,i.booleanOper)((0,i.isBooleanOper)(t))},t.isna=function(e,[t]){return(0,i.booleanOper)((0,i.isErrorOper)(t)&&t.type===i.ErrorType.NA)},t.isnontext=function(e,[t]){return(0,i.booleanOper)(!(0,i.isStringOper)(t))},t.istext=function(e,[t]){return(0,i.booleanOper)((0,i.isStringOper)(t))},t.isnumber=function(e,[t]){return(0,i.booleanOper)((0,i.isNumberOper)(t))},t.isref=function(e,[t]){return(0,i.booleanOper)((0,i.isRangeOper)(t))},t.islambda=function(e,[t]){return(0,i.booleanOper)(t instanceof o.LambdaOper)},t.isomitted=function(e,[t]){return(0,i.booleanOper)((0,i.isMissingOper)(t))},t.iseven=s,t.isodd=function(e,t){const r=s(e,t);return(0,i.isBooleanOper)(r)?(0,i.booleanOper)(!r.value):r},t.isformula=function(e,[t]){return u(e,t,(e=>(0,i.booleanOper)(void 0!==e)))},t.formulatext=function(e,[t]){return u(e,t,((t,r)=>{if(void 0===t)return i.naErrorOper;const n=e.printFormula(t,r.range);return t.source.kind===i.LexicalKind.Cell?(0,i.stringOper)(n):(0,i.stringOper)("{"+n+"}")}))};const n=r(6913),i=r(6592),a=r(7217),o=r(9470);function s(e,[t]){const r=(0,a.chkNumOper)(e,t);if((0,i.isErrorOper)(r))return r;const n=e.mathpack,o=(0,a.assertNumber)(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),s=(0,a.assertNumber)(n.div(n.floor(o),n.fromNumber(2)));return(0,i.booleanOper)(0===n.cond2(s,n.floor(s)))}function u(e,t,r){if(!(0,i.isSheetIndex)(t.sheets))return i.valueErrorOper;const a=t.ranges[0];if(e.calcingArray||!(0,i.isGridCell)(a)){const o=t.sheets;return(0,i.arrayOper)(a.rows,a.cols,(0,n.jaggedArray)(a.rows,a.cols,((t,n)=>{const s=(0,i.sheetGridCell)(o,(0,i.gridCell)(a.row+t,a.col+n));return r(e.getCellFormula(s),s)})))}const o=(0,i.sheetGridRangeAnchor)((0,i.sheetGridRange)(t.sheets,a));return r(e.getCellFormula(o),o)}},1634:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areas=function(e,[t]){return(0,i.isSheetIndex)(t.sheets)?e.mathpack.fromNumber(t.ranges.length):i.valueErrorOper},t.rows=function(e,[t]){const r=e.mathpack;return(0,i.isArrayOper)(t)?r.fromNumber(t.rows):(0,i.isSheetIndex)(t.sheets)?t.ranges.length>1?i.refErrorOper:r.fromNumber(t.ranges[0].rows):i.valueErrorOper},t.columns=function(e,[t]){const r=e.mathpack;return(0,i.isArrayOper)(t)?r.fromNumber(t.cols):(0,i.isSheetIndex)(t.sheets)?t.ranges.length>1?i.refErrorOper:r.fromNumber(t.ranges[0].cols):i.valueErrorOper},t.row=function(e,[t]){const r=a(e,t);if(!Array.isArray(r))return r;const[o,s]=r,u=e.mathpack;return s?u.fromNumber(o.row+1):(0,i.arrayOper)(o.rows,1,(0,n.jaggedArray)(o.rows,1,(e=>u.fromNumber(o.row+e+1))))},t.column=function(e,[t]){const r=a(e,t);if(!Array.isArray(r))return r;const[o,s]=r,u=e.mathpack;return s?u.fromNumber(o.col+1):(0,i.arrayOper)(1,o.cols,(0,n.jaggedArray)(1,o.cols,((e,t)=>u.fromNumber(o.col+t+1))))},t.sheets=function(e,[t]){const r=e.mathpack;return t?(0,i.isArrayOper)(t)?i.naErrorOper:r.fromNumber(e.getSheetRangeIndexes(t.sheets).length):r.fromNumber(e.getSheetRangeIndexes((0,i.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,[t]){const r=e.mathpack;if(!t){const t=e.reflectionSheet;return void 0===t.index?i.naErrorOper:r.fromNumber(e.getSheetRangePosition(t)+1)}if((0,i.isStringOper)(t)){const n=e.getSheetIndex(e.reflectionSheet.document,t.value);return void 0===n?i.naErrorOper:r.fromNumber(e.getSheetRangePosition(n)+1)}return(0,i.isRangeOper)(t)?r.fromNumber(e.getSheetRangePosition(t.sheets)+1):(0,i.isArrayOper)(t)?i.naErrorOper:(0,n.assertNever)("calc.funcs.sheet",t)},t.offset=function(e,[t,r,a,o,s]){if(!(0,i.isSheetIndex)(t.sheets))return i.valueErrorOper;if(1!==t.ranges.length)return i.valueErrorOper;const u=e.mathpack,{row:l,col:c,rows:d,cols:m}=t.ranges[0];let g=l;(0,i.isNumberOper)(r)&&(g+=u.lfix(r));let p=c;(0,i.isNumberOper)(a)&&(p+=u.lfix(a));let h=g+d-1;if(void 0!==o&&(0,i.isNumberOper)(o)){const e=u.cond(o);if(0===e)return i.refErrorOper;h=g+u.lfix(o)-(e>0?1:-1)}let f=p+m-1;if(void 0!==s&&(0,i.isNumberOper)(s)){const e=u.cond(s);if(0===e)return i.refErrorOper;f=p+u.lfix(s)-(e>0?1:-1)}const S=(0,n.fastMin)(g,h),v=(0,n.fastMin)(p,f),y=(0,n.fastMax)(g,h)-S+1,F=(0,n.fastMax)(p,f)-v+1;return S<0||v<0||S+y>i.sheetRows||v+F>i.sheetCols?i.refErrorOper:(0,i.rangeSeqOper)(t.sheets,[(0,i.gridRange)(S,v,y,F)])},t.transpose=function(e,[t]){return(0,i.isArrayOper)(t)?(0,i.arrayOper)(t.cols,t.rows,(0,n.jaggedArray)(t.cols,t.rows,((e,r)=>t.opers[r][e]))):t},t.single=function(e,[t]){if((0,i.isPrimitiveOper)(t)||(0,i.isMissingOper)(t)||(0,i.isBlankOper)(t)||(0,i.isRichOper)(t))return t;if((0,i.isArrayOper)(t))return t.opers[0][0];if(!(0,i.isSheetIndex)(t.sheets))return i.refErrorOper;if(1!==t.ranges.length)return i.valueErrorOper;const r=e.originGridCell,n=(0,i.gridCellImplicitIsect)(r,t.ranges[0]);return void 0===n?i.valueErrorOper:(0,i.rangeSeqOper)(t.sheets,[n])};const n=r(6913),i=r(6592);function a(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,i.isSheetIndex)(t.sheets))return i.valueErrorOper;if(t.ranges.length>1)return i.refErrorOper;const r=t.ranges[0];return[r,(0,i.isGridCell)(r)]}},460:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldvalue=function(e,[t,{value:r}]){if((0,i.isRichOper)(t)){const e=t.getField(r);if(void 0!==e)return e}return i.fieldErrorOper},t.record=function(e,t){const r=t[0],i=e.config.localeInfo;let o=n.RedBlackMapTree.create(i.stringCompareCI);for(let e=1;e<t.length;e+=2){const{value:r}=t[e],n=t[e+1];o=o.setValue(r,n)}return new a.RecordOper(o,r)};const n=r(6913),i=r(6592),a=r(9470)},2496:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coercedArrayOper=function(e,t,r){return(0,n.assertNatural)("calc.runtime.coercedArrayOper",e),(0,n.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,n.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:i.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===i.OperKind.Array},t.isPrimitiveCoercedOper=function(e){const{kind:t}=e;return"number"==typeof t&&0!=(t&o)},t.reduceDerefOpers=function(e,t,r,o,s){const u=(a,o,u,c)=>{if(o?.kind===i.OperKind.Array){const e=new n.StrictArray2D(o.rows,o.cols,o.opers);let t=a;for(let r=0;r<u;r+=1)t=l(t,e);return t}const d=(c&&void 0!==s?s:r)(e,o);return null==d?a:t(a,d,u)};function l(e,t){let r=e;for(let e=0;e<t.rows;e+=1)for(let n=0;n<t.cols;n+=1){const i=t.get(e,n);void 0!==i&&(r=u(r,i,1,!0))}return r}function c(e,t){let r=e;const n=t.getSparse(),i=t.cols-t.denseCols;for(let e=0;e<t.denseRows;e+=1){for(let n=0;n<t.denseCols;n+=1){const i=t.get(e,n);void 0!==i&&(r=u(r,i,1,!1))}i>0&&void 0!==n&&(r=u(r,n,i,!1))}const a=(t.rows-t.denseRows)*t.cols;return a>0&&void 0!==n&&(r=u(r,n,a,!1)),r}return o.reduce(((e,t)=>(0,a.isRangeValues)(t)?t.arrays.reduce(c,e):u(e,t,1,!1)),void 0)};const n=r(6913),i=r(6592),a=r(9001),o=i.OperKind.Number|i.OperKind.String|i.OperKind.Boolean},314:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chooserows=t.choosecols=t.vstack=t.hstack=t.drop=t.take=t.sequence=void 0,t.address=function(e,[t,r,a,o,s]){const u=e.mathpack,l=a?.kind===i.OperKind.Number?u.sfix(a)-1:0;if(l<0||l>3)return i.valueErrorOper;const c=0!=(1&l),d=0!=(2&l),m=o?.kind!==i.OperKind.Boolean||o.value?i.RefStyle.A1:i.RefStyle.R1C1,g=(e,t,r)=>m===i.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t,p=u.sfix(t);if(!g(d,i.sheetRows,p))return i.valueErrorOper;if(!(0,i.isNumberOper)(r))return i.valueErrorOper;const h=u.sfix(r);if(!g(c,i.sheetCols,h))return i.valueErrorOper;const f=(0,i.gridCell)(p<0?i.sheetRows-1:0,h<0?i.sheetCols-1:0),S=(0,i.pos)(d?i.PosKind.Rel:i.PosKind.Abs,m===i.RefStyle.R1C1&&d?p:p-1),v=(0,i.pos)(c?i.PosKind.Rel:i.PosKind.Abs,m===i.RefStyle.R1C1&&c?h:h-1),y=(0,i.formatCellPos)(e.config.localeInfo,m,f,S,v,!1);return(0,n.assertTrue)("calc.funcs.address: cell wrapped",void 0!==y),s?.kind===i.OperKind.String?""===s.value?(0,i.stringOper)("!"+y):s.value.length>255?i.valueErrorOper:(0,i.stringOper)((0,i.formatQualifier)(e.config.localeInfo,e.config.refStyle,s.value)+"!"+y):(0,i.stringOper)(y)},t.indirect=function(e,[{value:t},r]){const a=r?.value??1?i.RefStyle.A1:i.RefStyle.R1C1;if(t.length>255||(0,n.stringStartsWith)(t," "))return i.valueErrorOper;let s=(0,i.originCell)(e.originSheet,e.originGridCell);const u={lexicalKind:i.LexicalKind.Indirect,originGridCell:(0,n.success)(s.range),originSheet:(0,n.success)(s.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},l=e.parseFormula(a,s.range,u,"="+t);if(!(0,n.isSuccess)(l))return i.refErrorOper;let c=l.value.node,d=!1,m=!1;for(;;){if(!d&&c.kind===i.NodeKind.App&&(0,i.isOperatorNode)(c.head)&&c.head.id===i.OperatorId.Pound&&1===c.args.length&&(d=!0,c=c.args[0]),m||c.kind!==i.NodeKind.Name){if(c.kind===i.NodeKind.CellRef){const t=e.getCellRef(c.qualifier,c.ref,s,!0);return void 0===t?i.refErrorOper:(0,i.isSheetIndex)(t.sheets)?d?(0,o.throwEvaluationError)((0,i.notImplemented)(["# operator in INDIRECT"])):t:i.refErrorOper}if(c.kind===i.NodeKind.StructRef){if(void 0===c.lhs)return i.refErrorOper;const t=e.getStructRef(c.lhs,c.rhs,s);return void 0===t||d?i.refErrorOper:t}return i.refErrorOper}{const t=e.getNameFormula(c.qualifier,c.whole,i.NameSource.Indirect);if(void 0===t)return i.refErrorOper;s=(0,i.originCell)(s.sheet,(0,i.gridCell)(0,0)),c=t[1],m=!0}}},t.expand=function(e,t){const[r,o,s=i.missingOper,u=i.missingOper]=t,l=e.mathpack,c=(0,i.isMissingOper)(o)?r.rows:l.lfix(o),d=(0,i.isMissingOper)(s)?r.cols:l.lfix(s);if(c<r.rows||d<r.cols)return i.valueErrorOper;if(0===c||0===d)return i.calcErrorOper;if(d>i.sheetRows||c>i.sheetRows)return i.numErrorOper;(0,a.validateArraySize)(c,d);const m=(0,i.isMissingOper)(u)?i.naErrorOper:u;return(0,i.isArrayOper)(m)?i.valueErrorOper:(0,i.arrayOper)(c,d,(0,n.array2DToJaggedArray)(new n.StrictSparseArray2D(c,d,r.rows,r.cols,r.opers,m)))},t.tocol=function(e,t){return v(e,i.WorksheetFuncId.TOCOL,t)},t.torow=function(e,t){return v(e,i.WorksheetFuncId.TOROW,t)},t.wrapcols=function(e,t){return y(e,i.WorksheetFuncId.WRAPCOLS,t)},t.wraprows=function(e,t){return y(e,i.WorksheetFuncId.WRAPROWS,t)};const n=r(6913),i=r(6592),a=r(7217),o=r(4624),s=r(9001);function u(e,t){if((0,n.fastAbs)(e)<t){const r=(0,n.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function l(e,t){if((0,n.fastAbs)(e)<t){const r=t-(0,n.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.sequence=(e,t)=>{const[r,n,o,s]=t,u=e.mathpack,l=(0,i.isMissingOper)(r)?1:u.sfix(r),c=void 0===n||(0,i.isMissingOper)(n)?1:u.sfix(n);if(l<0||l>i.sheetRows||c<0||c>i.sheetRows)return i.valueErrorOper;if((0,a.validateArraySize)(l,c),0===l||0===c)return i.calcErrorOper;const d=void 0===o||(0,i.isMissingOper)(o)?u.fromNumber(1):o,m=void 0===s||(0,i.isMissingOper)(s)?u.fromNumber(1):s;let g=d;const p=[];for(let e=0;e<l;e++){const e=[];for(let t=0;t<c;t++){if(e.push(g),(0,i.isErrorOper)(g))continue;const t=u.add(g,m);g=(0,i.isErrorOper)(t)?t:u.checkAlmostCancellation(m,t)}p.push(e)}return(0,i.arrayOper)(l,c,p)},t.take=(e,t)=>{const[r,n,o]=t,s=e.mathpack,l=(0,a.rangeOrArrayToVal)(r,i.valueErrorOper);if(!(0,i.isArrayOper)(l)&&!(0,i.isRangeOper)(l))return l;const c=(0,a.makeSlicer)(l),d=(0,i.isMissingOper)(n)?c.rows:s.lfix(n),m=void 0===o||(0,i.isMissingOper)(o)?c.cols:s.lfix(o),{start:g,count:p}=u(d,c.rows),{start:h,count:f}=u(m,c.cols);return 0===p||0===f?i.calcErrorOper:c.slice(g,p,h,f)},t.drop=(e,t)=>{const[r,n,o]=t,s=e.mathpack,u=(0,a.rangeOrArrayToVal)(r,i.valueErrorOper);if(!(0,i.isArrayOper)(u)&&!(0,i.isRangeOper)(u))return u;const c=(0,a.makeSlicer)(u),d=(0,i.isMissingOper)(n)?0:s.lfix(n),m=void 0===o||(0,i.isMissingOper)(o)?0:s.lfix(o),{start:g,count:p}=l(d,c.rows),{start:h,count:f}=l(m,c.cols);return 0===p||0===f?i.calcErrorOper:c.slice(g,p,h,f)},t.hstack=(e,t)=>d(e,t,!0),t.vstack=(e,t)=>d(e,t,!1);const c=()=>i.naErrorOper;function d(e,t,r){const o=e.dereferenceAllOpers(t).map((e=>(0,s.isRangeValues)(e)?e.arrays:[new n.StrictArray2D(e.rows,e.cols,e.opers)])),u=(0,n.safeConcat)([],o).map((e=>r?(0,n.transposeArray2D)(e):e)),l=u.reduce(((e,t)=>(0,n.fastMax)(t.cols,e)),0),d=u.reduce(((e,t)=>e+t.rows),0);if(l>i.sheetRows||d>i.sheetRows)return i.numErrorOper;(0,a.validateArraySize)(d,l);const m=(0,n.safeConcat)([],u.map((e=>function(e,t,r){return e.cols>=t?e:new n.NonstrictSparseArray2D(e.rows,t,e.rows,e.cols,e.get.bind(e),r)}(e,l,c))).map(n.array2DToJaggedArray)),g=new n.StrictArray2D(m.length,m[0].length,m),p=r?(0,n.transposeArray2D)(g):g;return(0,i.arrayOper)(p.rows,p.cols,(0,n.array2DToJaggedArray)(p))}function m(e,t,r){const n=t.lfix(e),o=n>0?n:-n;return o>r||0===o?i.valueErrorOper:(0,a.getAbsoluteIndex)(r,n)}function g(e,t,r){if(e.rows>1&&e.cols>1)return i.valueErrorOper;const n=[];for(const a of e.opers)for(const e of a){if(!(0,i.isNumberOper)(e))return(0,i.isErrorOper)(e)?e:i.valueErrorOper;const a=m(e,t,r);if("number"!=typeof a)return a;n.push(a)}return n}const p=(e,t)=>{const r=[];for(const n of e){const e=t.opers[n];r.push(e)}return r},h=(e,t)=>t.opers.map((t=>{const r=[];for(const n of e)r.push(t[n]);return r})),f=(e,t,r,o)=>{const[s,...u]=t;if((0,i.isRangeOper)(s)){if(s.ranges.length>1)return i.refErrorOper;(0,n.assertTrue)("calc.funcs.ChooseColRow: not 3D ref",(0,i.isSheetIndex)(s.sheets))}const l=e.dereferenceOper(s,i.OperKind.Array);if(!(0,i.isArrayOper)(l))return l;const c=function(e,t,r){const a=[];for(const o of e)if((0,i.isArrayOper)(o)){const e=g(o,t,r);if(!Array.isArray(e))return e;(0,n.safePush)(a,e)}else{const e=m(o,t,r);if("number"!=typeof e)return e;a.push(e)}return a}(u,e.mathpack,o?l.rows:l.cols);if(!Array.isArray(c))return c;if(c.length>i.sheetRows||(o?l.cols:l.rows)>i.sheetRows)return i.numErrorOper;o?(0,a.validateArraySize)(c.length,l.cols):(0,a.validateArraySize)(l.rows,c.length);const d=r(c,l);return 0===d.length||0===d[0].length?i.calcErrorOper:(0,i.arrayOper)(d.length,d[0].length,d)};function S(e,t){return t?new n.NonstrictArray2D(1,e.length,((t,r)=>e[r])):new n.NonstrictArray2D(e.length,1,(t=>e[t]))}function v(e,t,r){const[o,u,l]=r,c=e.mathpack,[d]=e.dereferenceAllOpers([o]),m=(0,s.isRangeValues)(d)?d.arrays:[new n.StrictSparseArray2D(d.rows,d.cols,d.rows,d.cols,d.opers,i.blankOper)],g=void 0===u||(0,i.isMissingOper)(u)?0:c.lfix(u),p=void 0!==l&&!(0,i.isMissingOper)(l)&&l.value;if(g<0||g>3)return i.valueErrorOper;const h=1===g||3===g,f=2===g||3===g,v=[],y=[],F=(e,t)=>{h&&(0,i.isBlankOper)(e)||f&&(0,i.isErrorOper)(e)||(v.push(e),y.push(t))};for(const e of m){const t=p?(0,n.transposeSparseArray2D)(e):e,{rows:r,cols:i,denseRows:a,denseCols:o}=t;for(let e=0;e<a;++e){for(let r=0;r<o;++r)F(t.get(e,r),1);o<i&&F(t.getSparse(),i-o)}a<r&&i>0&&F(t.getSparse(),i*(r-a))}const b=y.reduce(((e,t)=>e+t),0);if(0===b)return i.calcErrorOper;if(b>i.sheetRows)return i.numErrorOper;t===i.WorksheetFuncId.TOROW?(0,a.validateArraySize)(1,b):(0,a.validateArraySize)(b,1);const C=[];for(let e=0;e<v.length;++e){const t=v[e],r=y[e];for(let e=0;e<r;++e)C.push(t)}const k=S(C,t===i.WorksheetFuncId.TOROW);return(0,i.arrayOper)(k.rows,k.cols,(0,n.array2DToJaggedArray)(k))}function y(e,t,r){const[o,s,u=i.missingOper]=r;if(!(1===o.rows&&o.cols>=1||1===o.cols&&o.rows>=1))return i.valueErrorOper;const l=e.mathpack.lfix(s);if(l<1)return i.numErrorOper;const c=1===o.rows?o.opers[0]:o.opers.map((e=>e[0])),d=c.length;if(l>=d){const e=S(c,t===i.WorksheetFuncId.WRAPROWS);return(0,i.arrayOper)(e.rows,e.cols,(0,n.array2DToJaggedArray)(e))}const m=Math.floor((d+l-1)/l);t===i.WorksheetFuncId.WRAPROWS?(0,a.validateArraySize)(m,l):(0,a.validateArraySize)(l,m);const g=(0,i.isMissingOper)(u)?i.naErrorOper:u,p=(e,t)=>{const r=e*l+t;return r>=c.length?g:c[r]},h=t===i.WorksheetFuncId.WRAPROWS?new n.NonstrictArray2D(m,l,((e,t)=>p(e,t))):new n.NonstrictArray2D(l,m,((e,t)=>p(t,e)));return(0,i.arrayOper)(h.rows,h.cols,(0,n.array2DToJaggedArray)(h))}t.choosecols=(e,t)=>f(e,t,h,!1),t.chooserows=(e,t)=>f(e,t,p,!0)},1382:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortOpers=function e(t,r,u,l,c){if((0,i.isBlankOper)(r))return(0,i.isBlankOper)(u)?0:1;if((0,i.isBlankOper)(u))return-1;if((0,i.isRichOper)(r)||(0,i.isRichOper)(u))return(0,a.throwEvaluationError)((0,i.notImplemented)(["rich value sort"]));if(r.kind!==u.kind)return o(l*(s[r.kind]-s[u.kind]));switch(r.kind){case i.OperKind.Number:return o(l*t.mathpack.cond2(r,u));case i.OperKind.String:return o(l*t.localeInfo.stringCompareCI(r.value,u.value));case i.OperKind.Boolean:return o(l*(r.value-u.value));case i.OperKind.Array:{const i=r,a=u,s=(0,n.fastMin)(i.rows,a.rows),d=(0,n.fastMin)(i.cols,a.cols);for(let r=0;r<s;++r){for(let n=0;n<d;++n){const o=e(t,i.opers[r][n],a.opers[r][n],l,c);if(0!==o)return o}if(i.cols!==a.cols)return o(l*(i.cols-a.cols))}return i.rows!==a.rows?o(l*(i.rows-a.rows)):0}case i.OperKind.Error:return c?o(l*(r.type-u.type)):0}};const n=r(6913),i=r(6592),a=r(4624),o=e=>e<0?-1:e>0?1:0,s={[i.OperKind.Number]:1,[i.OperKind.String]:2,[i.OperKind.Boolean]:3,[i.OperKind.Array]:4,[i.OperKind.Error]:5}},3603:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=void 0,t.right=function(e,[{value:t},r]){if(void 0!==r&&(0,i.isErrorOper)(r))return r;const a=h(e.mathpack,r);if("number"!=typeof a&&(0,i.isErrorOper)(a))return i.valueErrorOper;const o=(0,n.scanCodePointsBack)(t,t.length,a)??0;return(0,i.stringOper)(t.substring(o))},t.left=function(e,[{value:t},r]){if(void 0!==r&&(0,i.isErrorOper)(r))return r;const a=h(e.mathpack,r);if("number"!=typeof a&&(0,i.isErrorOper)(a))return i.valueErrorOper;const o=(0,n.scanCodePoints)(t,0,a)??t.length;return(0,i.stringOper)(t.substring(0,o))},t.mid=function(e,[{value:t},r,a]){const o=e.mathpack,s=o.fix(r)-1,u=o.fix(a);if(o.cond(r)<0||s<0||o.cond(a)<0||u<0)return i.valueErrorOper;const l=(0,n.scanCodePoints)(t,0,s)??t.length,c=(0,n.scanCodePoints)(t,l,u)??t.length;return(0,i.stringOper)(t.substring(l,c))},t.len=function(e,[{value:t}]){return e.mathpack.fromNumber((0,n.countCodePoints)(t,0,t.length))},t.concatenate=function(e,t){let r="";for(let e=0;e<t.length;e+=1){const{value:n}=t[e];if(r.length+n.length>i.cellStringLimit){r+=n.substring(0,i.cellStringLimit-r.length);break}r+=n}return(0,i.stringOper)(r)},t.exact=function(e,[t,r]){return((0,i.isRichOper)(t)||(0,i.isRichOper)(r))&&(0,s.throwEvaluationError)((0,i.notImplemented)(["EXACT rich argument"])),(0,i.booleanOper)(t.value===r.value)},t.rept=function(e,[{value:t},r]){const a=e.mathpack,o=a.fix(r);return a.cond(r)<0||o>p?i.valueErrorOper:""===t?u.emptyStringOper:o*t.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)((0,n.repeat)(t,o))},t.trim=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;){for(;e<t.length&&t.charCodeAt(e)===l;)e+=1;const n=e;for(;e<t.length;){const r=t.charCodeAt(e)===l;if(e+=1,r)break}r+=t.substring(n,e)}return r.length>0&&r.charCodeAt(r.length-1)===l&&(r=r.substring(0,r.length-1)),(0,i.stringOper)(r)},t.clean=function(e,[{value:t}]){let r="";for(let e=0;e<t.length;e+=1){const n=t.charCodeAt(e);(n>=256||(127&n)>=32)&&(r+=t.charAt(e))}return(0,i.stringOper)(r)},t.char=function(e,[t]){const r=e.mathpack.sfix(t);return r<1||r>255?i.valueErrorOper:(0,i.stringOper)(String.fromCharCode(r))},t.unichar=function(e,[t]){const r=e.mathpack,a=r.lfix(r.trunc(t));return r.cond2(t,r.one)<0||a>=1114112?i.valueErrorOper:a<=65535&&(0,n.isAnySurrogate)(a)||a>=64976&&a<=65007||(65535&a)>=65534?i.naErrorOper:(0,i.stringOper)((0,n.stringFromCodePoint)(a))},t.code=function(e,[{value:t}]){if(0===t.length)return i.valueErrorOper;const r=t.charCodeAt(0);return r>255?(0,s.throwEvaluationError)((0,i.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(r)},t.unicode=function(e,[{value:t}]){if(0===t.length)return i.valueErrorOper;const r=t.charCodeAt(0),a=e.mathpack;if(!(0,n.isAnySurrogate)(r))return a.fromNumber(r);if(1===t.length)return i.valueErrorOper;const o=t.charCodeAt(1),s=(0,n.surrogatePairToCodePoint)(r,o);return void 0===s?i.valueErrorOper:a.fromNumber(s)},t.lower=function(e,[{value:t}]){return(0,i.stringOper)(S(t,"LOWER",t.toLowerCase.bind(t)))},t.upper=function(e,[{value:t}]){return(0,i.stringOper)(S(t,"UPPER",t.toUpperCase.bind(t)))},t.proper=function(e,[{value:t}]){return(0,i.stringOper)(S(t,"PROPER",(()=>{const e=t.toLowerCase();let r="",i=0;for(;;){const t=i;for(;i<e.length&&!f(e.charCodeAt(i));)i+=1;if(r+=e.substring(t,i),i===e.length)break;const a=i,o=(0,n.stringCodePointAt)(e,i);for(r+=(0,n.stringFromCodePoint)(o).toUpperCase(),i+=(0,n.numCodeUnits)(o);i<e.length&&f(e.charCodeAt(i));)i+=1;r+=e.substring(a+1,i)}return r})))},t.find=function(e,[{value:t},{value:r},a]){const o=void 0!==a?e.mathpack.sfix(a)-1:0;if(o<0||o>=p)return i.valueErrorOper;const s=(0,n.scanCodePoints)(r,0,o)??r.length,u=r.indexOf(t,s);return u>=0?e.mathpack.fromNumber((0,n.countCodePoints)(r,0,u)+1):i.valueErrorOper},t.replace=function(e,[{value:t},r,a,{value:o}]){const s=e.mathpack.sfix(r)-1;if(s<0||s>=i.cellStringLimit)return i.valueErrorOper;const u=e.mathpack.sfix(a);if(u<0||u>i.cellStringLimit)return i.valueErrorOper;const l=(0,n.scanCodePoints)(t,0,s)??t.length,c=(0,n.scanCodePoints)(t,l,u)??t.length,d=t.slice(0,l),m=t.slice(c);return d.length+o.length+m.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)(d+o+m)},t.search=function(e,[{value:t},{value:r},a]){const s=void 0!==a?e.mathpack.sfix(a)-1:0;if(s<0||s>=p)return i.valueErrorOper;let u=(0,n.scanCodePoints)(r,0,s)??r.length;const l=new o.WildExp(e.config.localeInfo,t,!0);for(;u<r.length;u+=1)if(l.test(r.slice(u)))return e.mathpack.fromNumber((0,n.countCodePoints)(r,0,u)+1);return i.valueErrorOper},t.substitute=function(e,[t,{value:r},{value:n},a]){const{value:o}=t;let s=1/0;if(void 0!==a){const t=e.coerceOper(a,i.OperKind.Number);if((0,i.isErrorOper)(t))return t;if(s=e.mathpack.sfix(t),s<1||s>p-1)return i.valueErrorOper}const u=r.length;if(u>0){let e="",t=0,a=0;for(;s>=0&&-1!==(a=o.indexOf(r,a));)if(s-=1,s===1/0||0===s){const r=o.slice(t,a);if(e.length+r.length+n.length>i.cellStringLimit)return i.valueErrorOper;e+=r,e+=n,a+=u,t=a}else a+=1;const l=o.slice(t);return e.length+l.length>i.cellStringLimit?i.valueErrorOper:(e+=l,(0,i.stringOper)(e))}return t};const n=r(6913),i=r(6592),a=r(7217),o=r(2968),s=r(4624),u=r(199),{codePointSpace:l,codePointCapitalA:c,codePointCapitalZ:d,codePointSmallA:m,codePointSmallZ:g}=n.codePoint,p=2147483647;function h(e,t){return void 0===t?1:e.cond(t)<0?i.valueErrorOper:e.sfix(t)}function f(e){return e>=c&&e<=d||e>=m&&e<=g}function S(e,t,r){return""===e?e:function(e){for(let t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,s.throwEvaluationError)((0,i.notImplemented)([t+" for non-ASCII input"]))}function v(e,t,r){if(void 0===t||(0,i.isMissingOper)(t))return[];if((0,i.isStringOper)(t))return r&&0===t.value.length?i.valueErrorOper:[t.value];const n=[];for(let o=0;o<t.rows;++o){const s=t.opers[o];for(let t=0;t<s.length;++t){const o=s[t],u=e.coerceOper(o,i.OperKind.String);if((0,i.isErrorOper)(u))return u;const l=(0,a.assertString)(u).value;if(r&&0===l.length)return i.valueErrorOper;n.push(l)}}return n.sort(((e,t)=>e.length-t.length)),n}function y(e,t,r){for(const i of r)if((0,n.stringStartsWith)(e,i,t))return i}function F(e,t,r,n,a,o,s,u){const l=function(e,t,r,n,a,o,s){const u=t.value,l=void 0===n||(0,i.isMissingOper)(n)?1:e.mathpack.sfix(n),c=v(e,r,!1);if(!Array.isArray(c))return c;const d=c.reduce(((e,t)=>t.length<e?t.length:e),c[0].length),m=-(u.length-d+1),g=u.length-d+1;if(void 0!==n&&!(0,i.isMissingOper)(n)){if(0!==d&&!(l>=m&&l<=g))return i.valueErrorOper;if(0===l)return i.valueErrorOper}let p,h;if(void 0===a||(0,i.isMissingOper)(a))p=!1;else{const t=e.mathpack.lfix(a);if(0!==t&&1!==t)return i.valueErrorOper;p=1===t}if(void 0===o||(0,i.isMissingOper)(o))h=!1;else{const t=e.mathpack.lfix(o);if(0!==t&&1!==t)return i.valueErrorOper;h=1===t}return function(e,t,r,n,i,a,o){let s=e,u=t;if(0===r)return n>0?[0,0]:[s.length,s.length];if(s.length-r<0)return o;i&&(s=s.toLowerCase(),u=u.map((e=>e.toLowerCase())));let l=n,c=0;const d=s.length;let m=1;for(n<0&&(m=-1,c=d);c<=d&&c>=0;){const e=y(s,c,u);if(void 0!==e){if(l-=m,0===l)return[c,e.length];c+=m*(e.length-1)}c+=m}return a&&n-m==0?1===m?[s.length,0]:[0,0]:o}(u,c,d,l,p,h,void 0===s||(0,i.isMissingOper)(s)?i.naErrorOper:s)}(t,r,n,a,o,s,u);if(Array.isArray(l)){const[t,n]=l;return e===b.TEXTBEFORE?(0,i.stringOper)(r.value.slice(0,t)):(0,i.stringOper)(r.value.slice(t+n))}return l}var b;t.textSplit=(e,t)=>{const[r,a,o,s,u,l]=t,c=r.value;if(0===c.length)return i.valueErrorOper;let d=v(e,a,!0);if(!Array.isArray(d))return d;let m=v(e,o,!0);if(!Array.isArray(m))return m;const g=void 0!==s&&!(0,i.isMissingOper)(s)&&s.value;let p;if(void 0===u||(0,i.isMissingOper)(u))p=!1;else{const t=e.mathpack.lfix(u);if(0!==t&&1!==t)return i.valueErrorOper;p=1===t}const h=void 0===l||(0,i.isMissingOper)(l)?i.naErrorOper:l;if((0,i.isArrayOper)(h))return i.valueErrorOper;let f=c;if(p&&(f=c.toLowerCase(),d=d.map((e=>e.toLowerCase())),m=m.map((e=>e.toLowerCase()))),0===d.length&&0===m.length)return i.valueErrorOper;const S=function(e,t,r,a,o){let s=0,u=0;const l=[];let c;for(;s<=t.length;){let d,m;if(u<t.length&&(d=y(t,u,r),m=void 0===d?y(t,u,a):void 0),(0,n.assertTrue)("calc.runtime.textsplit: current in bounds",u<=t.length),void 0!==d||void 0!==m||u===t.length){(u-s>0||!o)&&(void 0===c&&(c=[],l.push(c)),c.push((0,i.stringOper)(e.slice(s,u))),void 0!==m&&(c=void 0));const t=(d??m??"1").length;(0,n.assertTrue)("calc.runtime.textsplit: matchLength > 0",t>0),u+=t,s=u}else++u}return l}(c,f,d,m,g);if(!Array.isArray(S))return S;if(0===S.length)return i.calcErrorOper;const F=S.reduce(((e,t)=>(0,n.fastMax)(t.length,e)),0);return(0,n.assertTrue)("calc.runtime.textsplit: non-zero cols",F>0),(0,i.arrayOper)(S.length,F,S.map((e=>{for(;e.length<F;)e.push(h);return e})))},function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"}(b||(b={})),t.textBefore=(e,t)=>{const[r,n,i,a,o,s]=t;return F(b.TEXTBEFORE,e,r,n,i,a,o,s)},t.textAfter=(e,t)=>{const[r,n,i,a,o,s]=t;return F(b.TEXTAFTER,e,r,n,i,a,o,s)}},7217:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArraySlicer=t.RangeSlicer=t.atpm1904to1900Days=t.assertError=t.assertString=t.assertNumber=void 0,t.wrap1=function(e){return(t,r)=>e(t)(r[0])},t.wrap2=function(e){return(t,r)=>e(t)(r[0],r[1])},t.chkNumOper=s,t.chkDateOper=function(e,r){let n=s(e,r);if((0,i.isErrorOper)(n))return n;const a=e.mathpack;return a.cond(n)<0?i.numErrorOper:(n=a.floor(n),m(e,n)?(e.config.date1904&&!(0,i.isStringOper)(r)&&(n=a.add(a.fromNumber(t.atpm1904to1900Days),n)),n):i.numErrorOper)},t.chkNumMultiOper=function e(t,r){switch(r.kind){case i.OperKind.Number:return(0,n.success)(new n.StrictSparseArray2D(1,1,1,1,[[r]],i.blankOper));case i.OperKind.String:const a=t.coerceOper(r,i.OperKind.Number);return(0,i.isErrorOper)(a)?(0,n.failure)(i.valueErrorOper):(0,n.success)(new n.StrictSparseArray2D(1,1,1,1,[[a]],i.blankOper));case i.OperKind.Blank:return(0,n.success)(new n.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],i.blankOper));case i.OperKind.Missing:return(0,n.failure)(i.naErrorOper);case i.OperKind.Error:return(0,n.failure)(r);case i.OperKind.Range:return e(t,(0,o.refToVal)(t,r,!1));case i.OperKind.Array:return(0,n.success)(new n.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,i.blankOper));default:return(0,n.failure)(i.valueErrorOper)}},t.validDateRange=m,t.numMod=function(e,t,r){const n=e.div(t,r);if((0,i.isErrorOper)(n))return n;const a=e.mul(e.trunc(n),r);if((0,i.isErrorOper)(a))return a;const o=e.sub(t,a);return!(0,i.isErrorOper)(o)&&e.cond(t)<0?e.abs(o):o},t.numInt=function(e,t){const r=e.sub(e.trunc(t),t);return(0,i.isNumberOper)(r)&&0===e.cond(r)},t.validateArraySize=function(e,t){if(e*t>1048576)return(0,a.throwEvaluationError)((0,i.notImplemented)(["Very large array size"]))},t.makeSlicer=function(e){return(0,i.isArrayOper)(e)?new p(e):new g(e)},t.rangeOrArrayToVal=function(e,t){return(0,i.isRangeOper)(e)?e.ranges.length>1?t:((0,n.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,i.isSheetIndex)(e.sheets)),e):e},t.getAbsoluteIndex=function(e,t){return(0,n.assertTrue)("calc.funcs.getAbsoluteIndex",(0,n.isInteger)(t)&&0!==t&&t<=e&&t>=-e),t>0?t-1:e+t};const n=r(6913),i=r(6592),a=r(4624),o=r(4810);function s(e,t){const r=(0,o.refToVal)(e,t,!1),a=(0,i.isRichOper)(r)?r.getFallback():r;switch(a.kind){case i.OperKind.Number:return a;case i.OperKind.Boolean:return i.valueErrorOper;case i.OperKind.String:const t=e.coerceOper(a,i.OperKind.Number);return(0,i.isNumberOper)(t)?t:i.valueErrorOper;case i.OperKind.Error:return a;case i.OperKind.Array:return i.valueErrorOper;case i.OperKind.Missing:return i.naErrorOper;case i.OperKind.Blank:return e.mathpack.zero;default:return(0,n.assertNever)("calc.funcs.chkNumOper",a)}}t.assertNumber=e=>(0,i.isNumberOper)(e)?e:(0,n.assertFalse)("calc.funcs.assertNumber"),t.assertString=e=>(0,i.isStringOper)(e)?e:(0,n.assertFalse)("calc.funcs.assertString"),t.assertError=e=>(0,i.isErrorOper)(e)?e:(0,n.assertFalse)("calc.funcs.assertError"),t.atpm1904to1900Days=1462;const u=0,l=2958465,c=0,d=2957003;function m(e,t){let r,n;const i=e.mathpack.lfix(t);return e.config.date1904?(r=c,n=d):(r=u,n=l),i>=r&&i<=n}class g{slice(e,t,r,n){const{row:a,col:o}=this.oper.ranges[0];return(0,i.range3DOper)(this.oper.sheets,(0,i.gridRange)(a+e,o+r,t,n))}constructor(e){this.oper=e;const{rows:t,cols:r}=e.ranges[0];this.rows=t,this.cols=r}}t.RangeSlicer=g;class p{slice(e,t,r,n){return(0,i.arrayOper)(t,n,this.oper.opers.slice(e,e+t).map((e=>e.slice(r,r+n))))}constructor(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}}t.ArraySlicer=p},2951:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,[t,r]){const n=(0,a.chkNumOper)(e,t),o=(0,a.chkNumOper)(e,r);if((0,i.isErrorOper)(n))return n;if((0,i.isErrorOper)(o))return o;const s=e.mathpack;if(s.cond2(n,o)>0)return i.numErrorOper;const u=e.getRandom(),l=s.ceil(n),c=s.floor(o),d=s.sub(c,l);return(0,i.isErrorOper)(d)?d:s.add(s.floor((0,a.assertNumber)(s.mul((0,a.assertNumber)(s.add(d,s.one)),u))),l)},t.randarray=function(e,t){const[r=i.missingOper,n=i.missingOper,u=i.missingOper,l=i.missingOper,c=i.missingOper]=t,d=e.mathpack,m=(0,i.isMissingOper)(r)?1:d.sfix(r),g=(0,i.isMissingOper)(n)?1:d.sfix(n);if(m<0||m>i.sheetRows||g<0||g>i.sheetRows)return i.valueErrorOper;if((0,a.validateArraySize)(m,g),0===m||0===g)return i.calcErrorOper;const p=(0,i.isMissingOper)(u)?d.zero:u,h=(0,i.isMissingOper)(l)?d.one:l;if(d.cond2(p,h)>0)return i.valueErrorOper;const f=!(0,i.isMissingOper)(c)&&c.value;if(f&&(!(0,a.numInt)(d,p)||!(0,a.numInt)(d,h)))return i.valueErrorOper;const S=[];for(let t=0;t<m;t++){const t=[];for(let r=0;r<g;r++){const r=f?o(e,p,h):s(e,p,h);t.push(r)}S.push(t)}return(0,i.arrayOper)(m,g,S)},t.now=function(e,t){return e.getTime(i.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(i.TimeGranularity.Day)};const n=r(6913),i=r(6592),a=r(7217);function o(e,t,r){const n=e.mathpack,i=(0,a.assertNumber)(n.add(r,n.one));return n.floor(s(e,t,i))}function s(e,t,r){const o=e.mathpack,s=o.sub(r,t),u=e.getRandom();if((0,i.isErrorOper)(s)){const e=o.div(t,o.fromNumber(3)),s=o.div(r,o.fromNumber(3));(0,n.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,i.isErrorOper)(e)&&!(0,i.isErrorOper)(s));const l=o.sub(s,e);return(0,n.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,i.isErrorOper)(l)&&o.cond(l)>=0),(0,a.assertNumber)(o.mul(o.fromNumber(3),(0,a.assertNumber)(o.add(e,(0,a.assertNumber)(o.mul(u,l))))))}return(0,a.assertNumber)(o.add(t,(0,a.assertNumber)(o.mul(u,s))))}},8099:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=function(e,[t,r]){return e.followHyperlinks?t:r??t}},2968:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;const n=r(6913);var i;!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(i||(i={}));const{codePointTilde:a,codePointQuestionMark:o,codePointAsterisk:s}=n.codePoint;t.WildExp=class{pushBlock(e){if(""===e)return;const t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(let t=1;t<e.length;t+=1)this.bytecode.push(i.OP_DOT)}pushMeta(e){e===o?this.bytecode.push(i.OP_DOT):this.bytecode.push(i.OP_DOTSTAR)}test(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);let t=Object.create(null);this.addState(t,0);for(let r=0;r<e.length;r+=1){const n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(let a=0;a<n.length;a+=1){const o=Number(n[a]);if(o===this.bytecode.length)continue;const s=this.bytecode[o];switch(s){case i.OP_DOT:this.addState(t,o+1);break;case i.OP_DOTSTAR:this.addState(t,o);break;default:const n=this.blocks[s];r+n.length<=e.length&&0===this.localeInfo.stringCompareCI(n,e.substring(r,r+n.length))&&this.addState(t,o+1)}}}return this.bytecode.length in t}addState(e,t){e[t]=!0;const r=this.bytecode;for(let n=t;n<r.length&&r[n]===i.OP_DOTSTAR;n+=1)e[n+1]=!0}testSimple(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))}constructor(e,t,r=!1){this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];let i="";for(let e=0;e<t.length;e+=1){const r=t.charCodeAt(e);if(r===a&&e+1<t.length){const r=(0,n.stringCodePointAt)(t,e+1);i+=(0,n.stringFromCodePoint)(r),e+=(0,n.numCodeUnits)(r)}else r!==a&&(r!==o&&r!==s?i+=t.charAt(e):(this.pushBlock(i),i="",this.pushMeta(r)))}0===this.bytecode.length&&(this.simplePattern=i),this.pushBlock(i),r&&this.pushMeta(s)}}},1475:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=t.LambdaOper=t.RecordOper=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=t.createEvaluator=t.createCompiler=t.PackageName=void 0;const n=r(6533);t.PackageName="excel-online-calc-runtime";var i=r(4927);Object.defineProperty(t,"createCompiler",{enumerable:!0,get:function(){return i.createCompiler}});var a=r(9899);Object.defineProperty(t,"createEvaluator",{enumerable:!0,get:function(){return a.createEvaluator}}),n.__exportStar(r(9001),t);var o=r(4810);Object.defineProperty(t,"singleReadOperType",{enumerable:!0,get:function(){return o.singleReadOperType}}),Object.defineProperty(t,"readOperType",{enumerable:!0,get:function(){return o.readOperType}}),Object.defineProperty(t,"MachineCallKind",{enumerable:!0,get:function(){return o.MachineCallKind}}),Object.defineProperty(t,"machineCall",{enumerable:!0,get:function(){return o.machineCall}}),Object.defineProperty(t,"isMachineCall",{enumerable:!0,get:function(){return o.isMachineCall}}),n.__exportStar(r(4299),t);var s=r(9470);Object.defineProperty(t,"RecordOper",{enumerable:!0,get:function(){return s.RecordOper}}),Object.defineProperty(t,"LambdaOper",{enumerable:!0,get:function(){return s.LambdaOper}});var u=r(9128);Object.defineProperty(t,"getWorksheetFunc",{enumerable:!0,get:function(){return u.getWorksheetFunc}});var l=r(5386);Object.defineProperty(t,"nextFuncs",{enumerable:!0,get:function(){return l.nextFuncs}})},4922:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=function(e,t,r){const n=l(e,t,r);return(0,i.isErrorOper)(n)&&!(0,i.isErrorOper)(t)&&(0,s.traceErrorOper)("calc.runtime.coerceOper",n.type,`kind = ${t.kind}`),n};const n=r(6913),i=r(6592),a=r(1159),o=r(4624),s=r(199);function u(e,t){return 0!=(t&i.OperKind.Number)?e.zero:0!=(t&i.OperKind.String)?s.emptyStringOper:0!=(t&i.OperKind.Boolean)?i.falseOper:i.valueErrorOper}function l(e,t,r){const{localeInfo:s,mathpack:c}=e.globals.config;if(0!=(r&t.kind))return t;if((0,i.isNumberOper)(t)){if(0!=(r&i.OperKind.String)){const e=20;return(0,i.stringOper)(c.formatGeneral(s,t,e))}return 0!=(r&i.OperKind.Boolean)?(0,i.booleanOper)(0!==c.cond(t)):0!=(r&i.OperKind.Array)?(0,i.arrayOper)(1,1,[[t]]):i.valueErrorOper}if((0,i.isStringOper)(t)){if(0!=(r&i.OperKind.Number)){if(0===t.value.length)return i.valueErrorOper;if(t.value.length>255)return i.valueErrorOper;const r=e.numberFormatter.parseGeneral(t.value,!1,!0,a.GetTimeKind.NonVolatile);return(0,n.isSuccess)(r)||(0,o.throwEvaluationError)(r.reason),void 0!==r.value?r.value.value:i.valueErrorOper}if(0!=(r&i.OperKind.Boolean)){if(0===s.stringCompareCI(t.value,s.trueName))return i.trueOper;if(0===s.stringCompareCI(t.value,s.falseName))return i.falseOper}return 0!=(r&i.OperKind.Array)?(0,i.arrayOper)(1,1,[[t]]):i.valueErrorOper}if((0,i.isBooleanOper)(t))return 0!=(r&i.OperKind.Number)?t.value?c.one:c.zero:0!=(r&i.OperKind.String)?(0,i.stringOper)(t.value?s.trueName:s.falseName):0!=(r&i.OperKind.Array)?(0,i.arrayOper)(1,1,[[t]]):i.valueErrorOper;switch(t.kind){case i.OperKind.Error:return t;case i.OperKind.Missing:return 0!=(r&i.OperKind.Blank)?i.blankOper:u(c,r);case i.OperKind.Blank:return u(c,r);case i.OperKind.Rich:return 0!=(r&i.OperKind.Array)?(0,i.arrayOper)(1,1,[[t]]):l(e,t.getFallback(),r);case i.OperKind.Range:case i.OperKind.Array:return i.valueErrorOper;default:return(0,n.assertNever)("calc.runtime.coerceOper",t)}}},4927:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compiledFormula=S,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,n.assertFalse)(`${e}: expected known compiled formula type; given ${(0,n.anonymize)(t)}`):t.term},t.createCompiler=function(e){return{compileFormula:(t,r)=>function(e,t,r){try{const s=t.config?.localeInfo??e.config.localeInfo,{names:u,numNames:l}=function(e,t){const r=t.annotations[t.node.label],a=n.RedBlackMapTree.create(e.stringCompareCI);if(r?.kind===i.AnnotationKind.FormulaRoot){const{contextNames:t=[]}=r;return{names:t.reduce(((t,r,n)=>t.setValue((0,i.getBoundName)(e,r.whole),n)),a),numNames:t.length}}return{names:a,numNames:0}}(s,r),c={globals:e,locals:t,localeInfo:s,annotations:r.annotations,names:u,numNames:l},d=(a=(0,i.reducePledge)(new m(c),r),(0,o.transformBottomUp)(a,f));return(0,n.success)(S(r,d))}catch(e){return e instanceof u?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)(e))}var a}(e,t,r)}};const n=r(6913),i=r(6592),a=r(4299),o=r(2441),s=r(199),u=(0,i.createFailureErrorClass)("CompileError"),l=(0,s.makeStrict)((0,i.getWorksheetFuncType)(i.WorksheetFuncId.IF)),c=(0,s.makeStrict)((0,i.getWorksheetFuncType)(i.WorksheetFuncId.CHOOSE));function d(e){return(0,o.isOperTerm)(e)&&(0,i.isWriteOper)(e)}class m{literalNode(e,t,r){return n.Pledge.resolve(this.noopTerm(e,r))}arrayNode(e,t,r){return n.Pledge.all(e.map((e=>n.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind((e=>this.toArrayTerm(e,r)))}toArrayTerm(e,t){const r=e.length,n=void 0===e[0]?0:e[0].length,a=e.map((e=>e.map((e=>e.kind===o.TermKind.Noop?e.children:e))));return a.every((e=>e.every(d)))?this.noopTerm((0,i.arrayOper)(r,n,a),t):(0,o.arrayTerm)(r,n,e,t)}appNode(e,t,r,a){const s=this.context.annotations[a]?.kind===i.AnnotationKind.FormulaRoot;if((0,i.isOperatorNode)(e)){const r=(0,i.getOperatorType)(e.id);return n.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>(0,o.appTerm)((0,o.operatorIdToName)(e.id),r,s,void 0,t,a)))}const u=(0,i.getArguments)(t);if((0,i.isWSFNode)(e)){const{id:t}=e;switch(t){case i.WorksheetFuncId.IFERROR:case i.WorksheetFuncId.IFNA:{(0,n.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===u.length);const[e,r]=u,o=new m({...this.context,numNames:this.context.numNames+1});return n.Pledge.all([this.lazyVisitFormulaNode(e),n.Pledge.try((()=>(0,i.visitFormulaNode)(o,r)))]).bind((([e,r])=>this.toIfPredicateTerm(t===i.WorksheetFuncId.IFERROR?i.WorksheetFuncId.ISERROR:i.WorksheetFuncId.ISNA,e,r,a)))}case i.WorksheetFuncId._UDF:return(0,n.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return n.Pledge.all(u.map(this.lazyVisitFormulaNode)).bind((e=>{switch(t){case i.WorksheetFuncId.IF:return this.toIfTerm(e,a);case i.WorksheetFuncId.CHOOSE:return this.toChooseTerm(e,a)}const r=(0,i.getWorksheetFuncType)(t);return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),r,!1,void 0,e,a)}))}return this.lazyVisitFormulaNode(e).bind((e=>n.Pledge.all(u.map(this.lazyVisitFormulaNode)).bind((t=>this.toAppTerm(e,t,a)))))}toIfPredicateTerm(e,t,r,n){const a=(0,o.readStackTerm)(0,void 0),s=(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(i.WorksheetFuncId.IF),l,!1,(0,o.appTerm)((0,o.worksheetFunctionIdToName)(e),(0,i.getWorksheetFuncType)(e),!1,void 0,[a],void 0),[r,a],void 0);return(0,o.letTerm)([t],!1,[void 0],s,n)}toIfTerm(e,t){switch(e.length){case 3:return(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(i.WorksheetFuncId.IF),l,!1,e[0],[e[1],e[2]],t);case 2:return(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(i.WorksheetFuncId.IF),l,!1,e[0],[e[1],i.falseOper],t);case 1:throw new u((0,i.notImplemented)(["single-argument IF"]));default:return(0,n.assertFalse)("calc.runtime.toIfTerm: expected wff")}}toChooseTerm(e,t){return(0,n.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,o.conditionalTerm)((0,o.worksheetFunctionIdToName)(i.WorksheetFuncId.CHOOSE),c,!1,e[0],e.slice(1),t)}toAppTerm(e,t,r){return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(i.WorksheetFuncId._UDF),(0,i.higherOrderFunctionType)(),!1,void 0,[e,...t],r)}letNode(e,t,r,s,u,l){const c=e.id===i.WorksheetFuncId.LETREC||e.id!==i.WorksheetFuncId.LET&&(0,n.assertFalse)("calc.runtime.compile");(0,n.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);const d=this.bindNames(t),m=d[t.length],g=t.map((({name:e})=>e.arg.label));let p;return p=c?n.Pledge.all(t.map((({binder:e})=>n.Pledge.try((()=>(0,i.visitFormulaNode)(m,e.arg)))))):n.Pledge.all(t.map((({binder:e},t)=>{const r=d[t];return n.Pledge.try((()=>(0,i.visitFormulaNode)(r,e.arg)))}))),p.bind((e=>(0,i.visitFormulaNode)(m,r.arg).bind((r=>(0,o.letTerm)(e.map(((e,r)=>this.noopTerm(e,(0,a.runtimePositionLetVal)(t[r].name.arg.label,t[r].binder.arg.label)))),c,g,r,l)))))}lambdaNode(e,t,r,a,s,u){(0,n.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);const l=this.bindNames(t),c=l[t.length],d=t.reduce(((e,{name:t},r)=>(0,n.fastMax)(e,t.arg.isOptional?0:r+1)),0),m=t.length;return n.Pledge.all(t.map((({name:e},t)=>{if(void 0===e.arg.def)return n.Pledge.resolve(void 0);const r=l[t],a=e.arg.def.rhs;return n.Pledge.try((()=>(0,i.visitFormulaNode)(r,a)))}))).bind((e=>(0,i.visitFormulaNode)(c,r.arg).bind((r=>{const n=[...e.map(((e,t)=>[e,t])).filter((e=>void 0!==e[0])).map((([e])=>e)),r];return(0,o.lambdaTerm)((e=>e>=d&&e<=m),t.map((({name:e})=>({paramNodeLabel:e.arg.label,paramNameLabel:e.arg.name.name.label,hasDef:void 0!==e.arg.def,isRest:!1}))),n,u)}))))}bindNames(e){const t=this.context.numNames,r=[this];return e.reduce(((e,{name:a},o)=>{(0,n.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==a.arg.wholeName);const s=e.setValue((0,i.getBoundName)(this.context.localeInfo,a.arg.wholeName),t+o);return r.push(new m({...this.context,names:s,numNames:t+o+1})),s}),this.context.names),r}parenNode(e,t,r){return this.lazyVisitFormulaNode(e).bind((e=>this.noopTerm(e,r)))}nameNode(e,t,r){const a=this.context.annotations[r]?.kind===i.AnnotationKind.AppHeadName;return n.Pledge.resolve(this.toNameTerm(e,t,a))}toNameTerm(e,t,r){const{locals:s,names:u,numNames:l}=this.context,c=(0,i.flattenNameParts)(e).parts;if((0,i.canDenoteLocalName)(t,c)){const[e,...t]=c,r=u.getEntry((0,i.getBoundName)(this.context.localeInfo,e.asWhole));if(void 0!==r){const i=r.value,a=(0,o.readStackTerm)(l-i-1,e.qualifiedLabel);return n.Pledge.resolve(t.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),a))}}let d;if(null==t&&(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){const t=(0,i.getEtaFuncId)(this.context.localeInfo,e.asWhole);if(void 0!==t){const r={...(0,i.getWorksheetFuncType)(t)};r.maxArgs=(0,n.fastMin)(254,r.maxArgs),d=(0,o.lambdaTerm)((e=>(0,i.isValidArgsLength)(r,e)),[{paramNodeLabel:void 0,paramNameLabel:void 0,hasDef:!1,isRest:!0}],[(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),r,!1,[{isSpread:!0}],[(0,o.readStackTerm)(0,void 0)],(0,a.runtimePositionEtaLambdaBody)(t))],e.qualifiedLabel)}}if((0,i.canDenoteCellRef)(s,t,c)){const[e,...r]=c,n=null!=t&&t.kind===i.QualifierKind.Ident?(0,i.sheetQualifier)(t.name,void 0,t.isQuoted,t.label):t,a=(0,o.cellRefTerm)(e.ref,n,e.qualifiedLabel);d=r.reduce(((e,t)=>this.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)),a)}return(0,i.canDenoteUserDefinedFunc)(r,t,e)&&(d=(0,o.udfTerm)(e.asWhole,t,d,e.qualifiedLabel)),e.canDenoteNamedObject&&(d=(0,o.nameTerm)(e.asWhole,t,r?i.NameSource.AppHead:i.NameSource.Plain,d,e.qualifiedLabel)),(0,n.assertTrue)("calc.runtime.compile: expected wff NameNode",void 0!==d),n.Pledge.resolve(d)}cellRefNode(e,t,r){return n.Pledge.resolve((0,o.cellRefTerm)(e,t,r))}fieldRefNode(e,t,r){(0,n.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===i.NodeKind.Ident);const a=t.field.whole;return this.lazyVisitFormulaNode(e).bind((e=>this.toFieldRefTerm(e,a,r)))}toFieldRefTerm(e,t,r){const n=i.WorksheetFuncId.FIELDVALUE;return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(n),(0,i.getWorksheetFuncType)(n),!1,void 0,[e,(0,i.stringOper)(t)],r)}noopTerm(e,t){return this.context.locals.emitStepInfo?(0,o.noopTerm)(e,t):e}structRefNode(e,t,r){return n.Pledge.resolve((0,o.structRefTerm)((0,i.structRefNode)(e,t,r),r))}missingNode(e,t){return(0,n.assertFalse)("calc.runtime.compile: unexpected missing node")}badSequenceNode(e,t,r){return(0,n.assertFalse)("calc.runtime.compile: unexpected bad node")}badCharsNode(e,t,r){return(0,n.assertFalse)("calc.runtime.compile: unexpected bad node")}operatorNode(e,t){return n.Pledge.resolve((0,i.operatorNode)(e,t))}wsfNode(e,t,r){return n.Pledge.resolve((0,i.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,i.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>n.Pledge.resolve(e).bind(this.visitFormulaNode)}}const g={[i.OperatorId.At]:i.WorksheetFuncId.SINGLE,[i.OperatorId.Pound]:i.WorksheetFuncId.ANCHORARRAY},p=[function(e){if(!(0,o.isOperTerm)(e)&&e.kind===o.TermKind.App&&(0,o.isOperatorName)(e.data.funName)){const t=g[(0,o.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,o.appTerm)((0,o.worksheetFunctionIdToName)(t),(0,i.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.data.args,e.children,e.position)}return e}],h=(e,t)=>t(e),f=e=>p.reduce(h,e);function S(e,t){return{...e,term:t}}},6563:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellValuesAsArray=p,t.dereference=f,t.dereferenceOper=function(e,t,r){const i=[],s=f(e,t,r,i);if(null==s){if(i.length>0)return(0,o.throwEvaluationError)((0,o.unevaluated)(i));const e=`calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ${(0,n.anonymize)(t)}`;return n.ulsLogger.ULS.assertTag(595980819,a.LogCategory.msoulscat_ES_EWAJS,!1,e)}return s},t.dereferenceOpers=function(e,t,r){const n=[];for(let a=0;a<t.length;a+=1){const o=f(e,t[a],(0,i.getArgType)(r,a,t.length),n);null!=o&&(t[a]=o)}if(n.length>0)return(0,o.throwEvaluationError)((0,o.unevaluated)(n))};const n=r(6913),i=r(6592),a=r(5033),o=r(4624),s=r(4810),u=r(4299),l=r(199),c=r(1007),d=16;function m(e,t){const r=t.map.getValue(e);if(void 0!==r){const e=(0,c.recordCellCycle)(r,t.current);return(0,o.throwEvaluationError)(e)}}function g(e,t,r){e.precedents.cells.push(t);const i=e.globals.getCellValue(t);if(i.kind===n.ResultKind.Failure)return(0,o.throwEvaluationError)(i.reason);const a=i.value;if(a.kind===u.CellKind.FinalValue)return a.oper;m(a.anchor,e.visitedCells),r.push(a.anchor)}function p(e,t,r,a){let s;if(e.precedents.cells.push(t),!a||(0,i.gridRangeSize)(t.range)<=d)s=t;else{const r=e.globals.getUsedRange(t.sheet);let a;(0,n.isSuccess)(r)?a=null==r.value?void 0:r.value.range:(0,o.throwEvaluationError)(r.reason);const u=void 0===a?void 0:(0,i.gridRangeIsect)(t.range,(0,i.gridRange)(0,0,a.row+a.rows,a.col+a.cols));if(void 0===u)return new n.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],i.blankOper);s=(0,i.sheetGridRange)(t.sheet,u)}const l=e.globals.getCellValues(s);if(l.kind===n.ResultKind.Failure)return(0,o.throwEvaluationError)(l.reason);const c=r.length,g=function(e,t,r,a,o){const s=[],l=a.length;let c=0;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",l===r.rows);for(let d=0;d<l;d+=1){s.push([]);const l=a[d].length;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",l===r.cols),c=0===d?l:(0,n.fastMin)(l,c);for(let r=0;r<l;r+=1){const l=a[d][r];u.CellKind.FinalValue===l.kind?s[d][r]=l.oper:(m(l.anchor,e.visitedCells),(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,i.isSheetIndexEqual)(l.anchor.sheet,t.sheet)),o.push(l.anchor),s[d][r]=i.refErrorOper)}}return new n.StrictSparseArray2D(t.range.rows,t.range.cols,l,c,s,i.blankOper)}(e,t,s.range,l.value,r);return c===r.length?g:void 0}function h(e,t,r){const a=p(e,t,r,!1);if(null!=a)return(0,i.arrayOper)(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:(0,n.array2DToJaggedArray)(a))}function f(e,t,r,a){if(0!=(r&i.OperKind.Range))return t;if(!(0,i.isRangeOper)(t))return t;const u=t.sheets;if(!(0,i.isSheetIndex)(u))return(0,l.traceErrorOper)("calc.runtime.dereference",i.ErrorType.REF,`3D range, oper = ${(0,n.anonymize)(t)}`),i.refErrorOper;if(1!==t.ranges.length)return(0,l.traceErrorOper)("calc.runtime.dereference",i.ErrorType.VALUE,`union range, oper = ${(0,n.anonymize)(t)}`),i.valueErrorOper;const c=t.ranges[0];if(0!=(r&s.singleReadOperType)){if((0,i.isGridCell)(c))return g(e,(0,i.sheetGridCell)(u,c),a);if(e.locals.implicitIntersect&&(0,n.isFeatureEnabled)(n.FeatureName.CalcLegacyImplicitIntersection)&&!(0,n.isFeatureEnabled)(n.FeatureName.CalcPreventSpillingHack)){const r=e.locals.originGridCell;if(!(0,n.isSuccess)(r))return(0,o.throwEvaluationError)(r.reason);const s=(0,i.gridCellImplicitIsect)(r.value,c);return null==s?((0,l.traceErrorOper)("calc.runtime.dereference",i.ErrorType.VALUE,`empty intersection, oper = ${(0,n.anonymize)(t)}`),i.valueErrorOper):g(e,(0,i.sheetGridCell)(u,s),a)}return h(e,(0,i.sheetGridRange)(u,c),a)}return 0!=(r&i.OperKind.Array)?h(e,(0,i.sheetGridRange)(u,c),a):((0,l.traceErrorOper)("calc.runtime.dereference",i.ErrorType.VALUE,`bad target type ${r}`),i.valueErrorOper)}},429:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellEvaluationMachine=function(e,t,r,i){return n.Pledge.try((()=>new d(e,t,r,i).evalCell()))};const n=r(6913),i=r(6592),a=r(4624),o=r(4810),s=r(4299),u=r(199),l=r(9470),c=r(1007);class d{evalCell(){const e=this.context.globals.getCellValue(this.cell);if(e.kind===n.ResultKind.Failure)return{kind:a.CellEvaluationResultKind.ReadFailure,failure:e};const t=e.value;if(t.kind===s.CellKind.FinalValue)return{kind:a.CellEvaluationResultKind.ReadOper};const r=this.context.globals.getCellFormula(t.anchor);if(r.kind===n.ResultKind.Failure){const e="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,n.assertFalse)(e)}const i=r.value;if(null==i){const e=`calc.runtime.CellEvaluationMachine.next: client error: expected getCellFormula(${(0,n.anonymize)(t.anchor)}) != null`;return(0,n.assertFalse)(e)}const u=this.visitAnchor(i),l=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,a.evalLocalsGrid)(u.source),u.precedents,(0,c.appendVisitedCell)(this.visitedCells,u),c.emptyVisitedNames,o.readOperType,i.formula);return n.Pledge.fromMachine(l).bind(this.receiveSuccess(u)).catch(this.receiveFailure(u))}visitAnchor(e){const t=(0,i.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){const e=`calc.runtime.CellEvaluationMachine.visitAnchor: unexpected visitValue at ${(0,n.anonymize)(t)}; given ${(0,n.anonymize)(r)}`;return(0,n.assertFalse)(e)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,a.bottomEvalPrecedents)()}}receiveSuccess(e){return t=>{if((0,i.isRangeOper)(t)||(0,i.isMissingOper)(t)){const e=`calc.runtime.CellEvaluationMachine.receiveSuccess: expected ReadOper; given ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}return this.writeSuccess(e.source,t,e.precedents)}}receiveFailure(e){return t=>{const r=t.kind===s.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return this.writeFailure(e.source,r,e.precedents)}}writeSuccess(e,t,r){return this.setCellValue(e,t,r),{kind:a.CellEvaluationResultKind.WroteOper,source:e}}writeFailure(e,t,r){return this.context.globals.setCellFailure(e.range,t,r),{kind:a.CellEvaluationResultKind.WroteFailure,source:e}}setCellValue(e,t,r){const n=this.context.globals.config.mathpack.zero,a=(0,i.isBlankOper)(t)?n:t;if(e.kind===i.LexicalKind.Cell){if((0,i.isArrayOper)(a)){const t=void 0===a.opers[0]?i.naErrorOper:a.opers[0][0],o=(0,i.isBlankOper)(t)?n:t;if(!this.isLambdaEnabled(e,o,r))return;return this.context.globals.setCellValue(e.range,o,r)}if(!this.isLambdaEnabled(e,a,r))return;return this.context.globals.setCellValue(e.range,a,r)}const o=e.range.range,s=(0,u.broadcastWriteOper)(o.rows,o.cols,a).opers,l=e=>(0,i.isBlankOper)(e)?n:e,c=s.map((e=>e.map(l)));if(this.isLambdaEnabled(e,c,r))return this.context.globals.setCellValues(e.range,c,r)}isLambdaEnabled(e,t,r){return!((Array.isArray(t)?t.some((e=>e.some((e=>e instanceof l.LambdaOper)))):t instanceof l.LambdaOper)&&!(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaCellValues)&&(this.context.globals.setCellFailure(e.range,(0,i.notImplemented)(["LAMBDA cell values"]),r),1))}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=n}}},3419:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFormulaEvaluationMachine=function(e,t,r,a,s,u,m,g){const{contextNames:p=[]}=r,h=g.annotations[g.node.label],f=(h?.kind===i.AnnotationKind.FormulaRoot?h.contextNames:void 0)??[];return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",f.length===p.length&&p.every(((e,t)=>e.label===f[t].label))),new S(e,t,r,a,s,u,(0,l.evalUsage)([0],0),m,!1,(0,d.noopTerm)((0,o.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",g),c.runtimePositionFormulaRoot),p)},t.createCallTermEvaluationMachine=function(e,t,r,n,a,o,s,u){return new S(e,t,r,n,a,o,(0,l.evalUsage)(s.lambdaCalls,s.lambdaDepth),i.SignatureType.All,!0,u,[])};const n=r(6913),i=r(6592),a=r(4922),o=r(4927),s=r(6563),u=r(6145),l=r(4624),c=r(4299),d=r(2441),m=r(199),g=r(9470),p=r(1007),h=()=>(0,l.throwEvaluationError)((0,i.notImplemented)(["LETREC cycle"]));function f(e,t){return{context:e,holeIndex:0,locals:t}}class S{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}next(){try{return this.doNext()}catch(e){if(e instanceof l.EvaluationError)return(0,l.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}}receiveResult(e){return(0,n.isSuccess)(e)?this.updateTermTransition(e.value):e}doNext(){if((0,d.isOperTerm)(this.term)){const e=this.continuation;if(0===e.length){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);const e=(0,s.dereferenceOper)(this,this.term,this.target),t=(0,a.coerceOper)(this,e,this.target);return this.precedents.bound=i.PrecsBound.Exact,!(0,n.isFeatureEnabled)(n.FeatureName.CalcPreventSpillingHack)||this.isNested||this.locals.lexicalSource.kind!==i.LexicalKind.Cell||!(0,i.isArrayOper)(t)||1===t.rows&&1===t.cols?(0,n.success)(t):(0,n.failure)((0,i.notImplemented)(["spilling"]))}const t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)}applyContinuation(e,t){const r=t.context;switch(r.kind){case d.TermKind.App:{const a=t.holeIndex,o=r.children.length;(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",a<=o);const s=t.locals;if(a===o)return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,i.isMissingOper)(e)),this.dispatchFunction(s,r.data,r.position);const l=r.data.args[a]?.isSpread;return!0===l?((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",e instanceof u.RestArgsOper),(0,n.safePush)(s,e.opers)):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",!(e instanceof u.RestArgsOper)),s.push(e)),a+1<o?this.nextHoleTransition(t,r.children[a+1]):this.nextHoleTransition(t,i.missingOper)}case d.TermKind.Conditional:{const o=t.holeIndex;if(0===o){const u=(0,d.worksheetFunctionNameToId)(r.data.funName),l=u===i.WorksheetFuncId.IF?i.OperKind.Boolean:i.OperKind.Number;let c=(0,s.dereferenceOper)(this,e,l);if((0,i.isArrayOper)(c))return t.locals=[c],this.nextHoleTransition(t,r.children[o+1]);if((0,i.isRichOper)(c))return(0,n.failure)((0,i.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(c=(0,a.coerceOper)(this,c,l),u===i.WorksheetFuncId.IF&&(0,i.isBooleanOper)(c))return this.popContextTransition(r.children[c.value?1:2]);if(u===i.WorksheetFuncId.CHOOSE&&(0,i.isNumberOper)(c)){const e=this.context.globals.config.mathpack.fix(c);if(e<1||e>r.children.length-1){const t=`CHOOSE; out of bounds option = ${(0,n.anonymize)(e)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",i.ErrorType.VALUE,t),this.popContextTransition(i.valueErrorOper)}return this.popContextTransition(r.children[e])}return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,i.isErrorOper)(c)),this.popContextTransition(c)}const u=t.locals;return u[o]=e,o+1<r.children.length?this.nextHoleTransition(t,r.children[o+1]):this.dispatchFunction(u,r.data,r.position)}case d.TermKind.CallName:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.visitedNames=r.visitedNames,this.popContextTransition(e)}case d.TermKind.Let:{const n=t.holeIndex,i=r.children.length-1;if(n>=i){const r=t.locals;return this.restoreStack(r),this.popContextTransition(e)}if(r.data.rec){const t=this.stackEnv.getCount()-i+n;this.stackEnv.getValue(t).value=e,this.stackEnv=this.stackEnv.setValue(t,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return n+1>=i&&this.isLetTcoPossible()?this.popContextTransition(r.children[n+1]):this.nextHoleTransition(t,r.children[n+1])}case d.TermKind.Array:{const n=(0,s.dereferenceOper)(this,e,m.writeOperType),{rows:o,cols:u}=r.data,l=t.holeIndex,c=l%u,d=u===c+1,g=(l-c)/u,p=t.locals;if(p[g][c]=(0,a.coerceOper)(this,n,m.writeOperType),o===g+1&&d)return this.popContextTransition((0,i.arrayOper)(o,u,p));const h=d?g+1:g,f=d?0:c+1;return this.nextHoleTransition(t,r.children[h][f])}case d.TermKind.CallLambda:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.usage.lambdaDepth-=1,this.popContextTransition(e)}case d.TermKind.CallFirstOrderFunc:{const r=t.locals;return this.locals=r.locals,this.caller=r.caller,this.restoreStack(r),this.popContextTransition(e)}case d.TermKind.PostStep:{const r=t.locals;return this.stepConfig?.postStep(r,e),this.popContextTransition(e)}default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}}reduceFormula(e){switch(e.kind){case d.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case d.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case d.TermKind.App:{const t=e.data.funName;if(!(0,d.isOperatorName)(t)){const e=(0,d.worksheetFunctionNameToId)(t);if(e!==i.WorksheetFuncId._UDF){const t=this.globals.getWorksheetFunc(e);if(t.kind===n.ResultKind.Failure)return(0,l.throwEvaluationError)(t.reason)}}if(0===e.children.length){const r=new u.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.position),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(t,e.data.funType,e.data.isFormulaRoot,[]);return this.updateTermTransition(r)}return this.pushContextTransition(e,e.children[0],[])}case d.TermKind.CallLambda:{const t=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>(this.globals.limits.maxLambdaCalls??1/0))return(0,l.throwEvaluationError)((0,c.limitExceeded)(c.LimitKind.LambdaCalls));if(!t&&this.usage.lambdaDepth+1>(this.globals.limits.maxLambdaDepth??1/0))return(0,l.throwEvaluationError)((0,c.limitExceeded)(c.LimitKind.LambdaDepth));t||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;const r=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;const n=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;const i=this.locals;this.locals=(0,l.evalLocalsLambda)(e.data.capturedLocals,this.locals);const a=this.caller;return this.switchCaller(e.data.caller,t),t?this.updateTermTransition(e.children):this.pushContextTransition(e,e.children,{locals:i,caller:a,stackEnv:r,stackMap:n})}case d.TermKind.CallFirstOrderFunc:{const t=this.locals;this.locals=(0,l.evalLocalsFirstOrderFunc)(e.data.source,this.locals);const r=this.caller;this.switchCaller(e.data.caller,!1);const n=this.stackEnv;this.stackEnv=l.emptyStackEnv;const i=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(e,e.children,{locals:t,caller:r,stackEnv:n,stackMap:i})}case d.TermKind.CallMachine:return(0,n.callMachineTransition)(e.data.machine,this);case d.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case d.TermKind.Let:{const t=e.children.length-1;if(0===t)return this.updateTermTransition(e.children[0]);const r=this.stackEnv,n=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=n,e.data.rec){for(let e=0;e<t;e+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new l.LazyOper(h));this.stackMapNumPushed+=t}return this.pushContextTransition(e,e.children[0],{stackEnv:r,stackMap:n})}case d.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case d.TermKind.CallName:{const t=e.data.loc,r=this.checkForNameCycle(t),n=this.stackFrameList(e.position),a=this.locals;this.locals=(0,l.evalLocalsName)((0,i.lexicalSourceName)(t),a);const o=this.caller;this.switchCaller(n,!1);const s=this.stackEnv;this.stackEnv=l.emptyStackEnv;const u=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;const c=this.visitedNames;return this.visitedNames=r,this.pushContextTransition(e,e.children,{locals:a,caller:o,stackEnv:s,stackMap:u,visitedNames:c})}case d.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case d.TermKind.ReadStack:{const t=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==t),this.updateTermTransition(t instanceof l.LazyOper?t.value:t)}case d.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((()=>[])));case d.TermKind.Lambda:return this.updateTermTransition(new g.LambdaOper(e.data.checkArity,e.position,e.data.params??[],this.locals,this.stackEnv,this.stackMapList(),e.children));case d.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}}dispatchFunction(e,t,r){const{funName:n,funType:i,isFormulaRoot:a}=t;(0,s.dereferenceOpers)(this,e,i);const o=new u.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,i,a,e);return this.popContextTransition(o)}stackFrameList(e){return(0,l.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)}stackMapList(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,l.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext}noopTerm(e,t){return null!=this.stepConfig?(0,d.noopTerm)(e,t):e}pushContextTransition(e,t,r){const n=f(e,r);return this.continuation.push(n),this.updateTermTransition(t)}popContextTransition(e){return this.continuation.pop(),this.updateTermTransition(e)}nextHoleTransition(e,t){return e.holeIndex+=1,this.updateTermTransition(t)}updateTermTransition(e){if(this.term=e,null!=this.stepConfig&&!(0,d.isOperTerm)(e)&&void 0!==e.position&&e.kind!==d.TermKind.Name&&e.kind!==d.TermKind.Udf){const t=function(e,t,r,n,i){const a=(0,l.stackFrameList)(e,t,r,n,i);return{stack:new l.IterableStackFrame(a)}}(this.locals.lexicalSource,e.position,this.stackEnv,this.stackMapList(),this.caller);if(this.continuation.push(f(d.postStepTerm,t)),this.stepConfig.preStep(t)===c.StepAction.Break)return n.breakTransition}return n.nextTransition}switchCaller(e,t){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",e.caller===this.caller),t||(this.caller=e)}restoreStack({stackEnv:e,stackMap:t}){this.stackEnv=e,this.stackMapLabels=t?.labels,this.stackMapNumPushed=t?.numPushed??0,this.stackMapNext=t?.next}isLetTcoPossible(){const e=this.continuation[this.continuation.length-2];if(void 0===e)return!1;const t=e.context;return t.kind===d.TermKind.Let?e.holeIndex>=t.children.length-1:t.kind===d.TermKind.CallLambda||t.kind===d.TermKind.CallName}isCallLambdaTcoPossible(){const e=this.continuation[this.continuation.length-1];return void 0!==e&&e.context.kind===d.TermKind.CallLambda}getNameFormulaAsTerm(e,t){const r=this.globals.getNameFormula(e,t);if(r.kind===n.ResultKind.Failure)return(0,l.throwEvaluationError)(r.reason);const i=r.value;return null!=i?(0,o.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",i):void 0}checkForNameCycle(e){const t=this.visitedNames,r=t.map.getValue(e);if(void 0!==r){const e=(0,p.recordNameCycle)(r,t.current);return(0,l.throwEvaluationError)(e)}return this.visitedNames.map.getCount()+1>(this.globals.limits.maxNameChain??1/0)?(0,l.throwEvaluationError)((0,c.limitExceeded)(c.LimitKind.NameChain)):(0,p.appendVisitedName)(this.visitedNames,e)}evalNameTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveName(this.locals,(0,i.nameNode)((0,i.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source);if((0,n.safePush)(this.precedents.names,r),!(0,n.isSuccess)(t)){if(t.reason.kind===i.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,n.anonymize)(e.data.qualifier)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",i.ErrorType.REF,t),this.noopTerm(i.refErrorOper,e.position)}const r=e.children;return t.reason.kind===i.ResolveReasonKind.InvalidQualifier&&void 0!==r?r:(0,l.throwEvaluationError)(t.reason)}const a=t.value;let o;if(void 0===a||void 0===(o=this.getNameFormulaAsTerm(a,e.data.source))){const t=e.children;if(void 0===t){const t=`error ref, qualifier = ${(0,n.anonymize)(e.data.qualifier)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",i.ErrorType.NAME,t),this.noopTerm(i.nameErrorOper,e.position)}return t}return(0,d.callNameTerm)(a,this.noopTerm(o,c.runtimePositionFormulaRoot),e.position)}evalCellRefTerm(e){const{resolution:t}=this.context.resolver.resolveCellRef(this.locals,(0,i.cellRefNode)(e.data.ref,e.data.qualifier));if(!(0,n.isSuccess)(t)){if(t.reason.kind===i.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, qualifier = ${(0,n.anonymize)(e.data.qualifier)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",i.ErrorType.REF,t),i.refErrorOper}return(0,l.throwEvaluationError)(t.reason)}const r=t.value;if(!r){const t=`error ref, qualifier = ${(0,n.anonymize)(e.data.qualifier)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",i.ErrorType.REF,t),i.refErrorOper}return(0,i.range3DOper)(r.sheet,r.range)}evalStructRefTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveStructRef(this.locals,e.data);if((0,n.safePush)(this.precedents.names,r),!(0,n.isSuccess)(t)){if(t.reason.kind===i.ResolveReasonKind.NoOriginSheet){const t=`error ref, no sheet, struct ref = ${(0,n.anonymize)(e.data)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",i.ErrorType.REF,t),i.refErrorOper}if(t.reason.kind===i.ResolveReasonKind.EmptyIntersection){const t=`error ref, empty intersection, struct ref = ${(0,n.anonymize)(e.data)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",i.ErrorType.VALUE,t),i.valueErrorOper}return(0,l.throwEvaluationError)(t.reason)}const a=t.value;if(!a){const t=`error ref, struct ref = ${(0,n.anonymize)(e.data)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",i.ErrorType.REF,t),i.refErrorOper}return(0,i.range3DOper)(a.sheet,a.range)}evalUdfTerm(e){const{resolution:t,precedents:r}=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,i.nameNode)((0,i.identNamePart)(e.data.name,!0),e.data.qualifier));if((0,n.safePush)(this.precedents.udfs,r),!(0,n.isSuccess)(t)){const r=e.children;if(t.reason.kind===i.ResolveReasonKind.InvalidQualifier&&void 0!==r)return r;(0,l.throwEvaluationError)(t.reason)}const a=t.value;if(!a){const t=e.children;if(void 0===t){const t=`UDF resolution, qualifier = ${(0,n.anonymize)(e.data.qualifier)}`;return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",i.ErrorType.NAME,t),this.noopTerm(i.nameErrorOper,e.position)}return t}if(a.length>1){const t="UDF resolution, ambiguous name";return(0,m.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",i.ErrorType.NAME,t),this.noopTerm(i.nameErrorOper,e.position)}const o=a[0],s=this.globals.getUserDefinedFunc(o);return(0,n.isSuccess)(s)||(0,l.throwEvaluationError)(s.reason),new u.UdfOper(o,s.value)}constructor(e,t,r,i,a,o,s,u,c,m,g){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=i,this.visitedCells=a,this.visitedNames=o,this.usage=s,this.target=u,this.isNested=c,this.runStatus=!1,this.stackEnv=l.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],m.kind!==d.TermKind.CallLambda&&m.kind!==d.TermKind.CallFirstOrderFunc?(this.term=null!=t?(0,d.noopTerm)(m,void 0):m,this.caller=void 0):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",void 0===m.position),this.term=m,this.caller=m.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,g.length>0&&(this.stackEnv=g.reduce(((e,{value:t})=>e.setValue(e.getCount(),t)),this.stackEnv),this.stackMapLabels=g.map((({label:e})=>e)),this.stackMapNumPushed=g.length)}}},6145:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.RestArgsOper=t.UdfOper=void 0;const n=r(6913),i=r(6592),a=r(1159),o=r(391),s=r(4922),u=r(6563),l=r(4624),c=r(9001),d=r(4810),m=r(9110),g=r(4299),p=r(2441),h=r(199),f=r(9470);class S{getFallback(){return(0,n.assertFalse)("calc.runtime.UdfOper.getFallback")}getField(e){return(0,n.assertFalse)("calc.runtime.UdfOper.getField")}constructor(e,t){this.kind=i.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}}t.UdfOper=S;class v{getFallback(){return(0,n.assertFalse)("calc.runtime.RestArgsOper.getFallback")}getField(e){return(0,n.assertFalse)("calc.runtime.RestArgsOper.getField")}constructor(e){this.opers=e,this.kind=i.OperKind.Rich}}function y(e,t,r,a){(0,n.assertTrue)("calc.runtime.compileCallLambda",e.checkArity(t.length));const o=[];{let r=0,a=0;for(const n of e.params){if(n.isRest){o.push(new v(t.slice(a))),a=t.length;continue}let s=a>=t.length?i.missingOper:t[a++];n.hasDef&&((0,i.isMissingOper)(s)&&(s=e.defsAndBody[r]),++r),o.push(s)}(0,n.assertTrue)("calc.runtime.compileCallLambda",a===t.length&&r===e.defsAndBody.length-1)}const s=a?o.map(((t,r)=>{const n=e.params[r];return void 0===n.paramNodeLabel&&void 0===n.paramNameLabel?t:(0,p.noopTerm)(t,(0,g.runtimePositionLambdaParam)(r,n.paramNodeLabel,n.paramNameLabel))})):o,u=o.map(((t,r)=>e.params[r].paramNodeLabel)),l=e.defsAndBody[e.defsAndBody.length-1],c=(0,p.letTerm)(s,!1,u,l,(0,g.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,t));return(0,p.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,r,c)}t.RestArgsOper=v;class F{get globals(){return this.context.globals}get numberFormatter(){return this.context.numberFormatter}get internalCaller(){return(0,n.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",void 0!==this.internalSource),(0,l.stackFrameList)(this.internalSource,F.internalPosition,l.emptyStackEnv,void 0,this.caller)}get internalContext(){const e=this.internalCaller;return{stack:new l.IterableStackFrame(e)}}get calcingArray(){return this.locals.calcingArray}get originGridCell(){const e=this.locals.originGridCell;return(0,n.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get originSheet(){const e=this.locals.originSheet;return(0,n.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get reflectionGridCell(){const e=this.locals.reflectionGridCell;return(0,n.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get reflectionSheet(){const e=this.locals.reflectionSheet;return(0,n.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}get followHyperlinks(){const e=this.locals.followHyperlinks;return(0,n.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)}makeChildDispatcher(e){return new F(this.context,this.stepConfig,this.locals,e,this.precedents,this.visitedCells,this.visitedNames,this.usage)}useAsFuncContext(e){return(0,n.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this}applyFunction(e,t){const r=this.makeChildDispatcher(this.internalCaller),n=(0,i.getWorksheetFuncType)(e),a=t.some(i.isRangeOper)?t.slice(0):t;return(0,u.dereferenceOpers)(r,a,n),r.termToFuncResult(r.dispatchFunction((0,p.worksheetFunctionIdToName)(e),n,!1,a))}applyLambda(e,t){return this.termToFuncResult(y(e,t,this.internalCaller,null!=this.stepConfig))}throwEvaluationError(e){throw new l.EvaluationError(e)}handleEvaluationError(e){if(e instanceof l.EvaluationError)return(0,l.handleEvaluationError)(this.context,this.visitedCells,e.reason)}applyOperatorOrFunction(e,t,r){if((0,p.isOperatorName)(e))return(0,m.applyOperator)(this.globals,(0,p.operatorNameToId)(e),t,r);const a=(0,p.worksheetFunctionNameToId)(e);if(a===i.WorksheetFuncId._UDF){if(t[0]instanceof f.LambdaOper){const e=t[0],r=t.slice(1);return e.checkArity(r.length)?((0,n.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",void 0===this.internalSource),y(e,r,this.caller,null!=this.stepConfig)):i.valueErrorOper}if(t[0]instanceof S){const e=t[0];if(t.length-1!==e.arity)return i.valueErrorOper;const r=e.func(this.useAsFuncContext((0,i.lexicalSourceUDF)(e.loc)),t.slice(1));if(r.kind===i.OperKind.Error){const e="UDF function return value";(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",r.type,e)}return this.funcContextResultToTerm(r)}switch(t[0].kind){case i.OperKind.Error:return t[0];case i.OperKind.Number:return i.valueErrorOper;case i.OperKind.Rich:return(0,l.throwEvaluationError)((0,i.notImplemented)(["Rich UDF head"]));case i.OperKind.String:case i.OperKind.Boolean:case i.OperKind.Blank:case i.OperKind.Missing:return i.refErrorOper;case i.OperKind.Array:return(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaArrayLifting)?(0,n.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,l.throwEvaluationError)((0,i.notImplemented)(["Array UDF head"]));case i.OperKind.Range:return(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaCellValues)?(0,n.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,l.throwEvaluationError)((0,i.notImplemented)(["Range UDF head"]));default:return(0,n.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}const o=this.globals.getWorksheetFunc(a);if(o.kind===n.ResultKind.Failure)return(0,l.throwEvaluationError)(o.reason);const s=o.value;if(null==s){const e=`nonexistent worksheet function ${a}`;return(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.ErrorType.NAME,e),i.nameErrorOper}try{const e=s(this.useAsFuncContext((0,i.lexicalSourceWSF)(a)),t);if(e.kind===i.OperKind.Error){const t=`worksheet function ${a} return value`;(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",e.type,t)}return this.funcContextResultToTerm(e)}catch(e){throw(0,n.prependErrorMessage)(e,`(in WSF ${(0,i.englishWorksheetFuncIdToName)(a)})`)}}termToFuncResult(e){switch(e.kind){case p.TermKind.CallLambda:case p.TermKind.CallFirstOrderFunc:return(0,d.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e));case p.TermKind.CallMachine:return(0,d.machineCall)(e.data.machine)}return e}funcContextResultToTerm(e){return(0,n.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,d.isMachineCall)(e)?(0,p.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,p.callMachineTerm)(e.machine,F.internalPosition)):e}dispatchFunction(e,t,r,a){if(!(0,i.isValidArgsLength)(t,a.length)){const r=JSON.stringify(t),i=`calc.runtime.FunctionDispatcher.dispatchFunction: bad application of ${JSON.stringify(e)} to ${a.length} arguments, ftype = ${r}`;return(0,n.assertFalse)(i)}const o=a.length;let s=i.SignatureType.None;for(let e=0;e<o;e+=1){const r=a[e],n=r.kind,u=(0,i.getArgType)(t,e,o);0==(n&u)&&(s|=n),(0,i.isRangeOper)(r)&&0==(t.flags&i.FunctionFlags.Allow3dRef)&&0==(u&i.SignatureType.Ref3D)&&!(0,i.isSheetIndex)(r.sheets)&&(s|=n),(0,i.isStringOper)(r)&&0==(t.flags&i.FunctionFlags.AllowLStrs)&&r.value.length>255&&(s|=n)}if(s===i.SignatureType.None)return this.applyOperatorOrFunction(e,a,r);if(0!=(s&i.OperKind.Array)){const r=r=>{const n=this.makeChildDispatcher(this.caller);return n.termToFuncResult(n.dispatchFunction(e,t,!1,r))},{machine:n}=(0,h.arrayLift)(this.useAsFuncContext(void 0),t,r,a);return(0,p.callMachineTerm)(n,void 0)}s&=~i.OperKind.Array;const u=[];for(let e=0;e<o;e+=1){let r=a[e];if(0!=(s&r.kind)){const a=(0,i.getArgType)(t,e,o);if(r=this.coerceOper(r,a),(0,i.isErrorOper)(r)&&0==(a&i.OperKind.Error))return r;if((0,i.isRangeOper)(r)&&0==(t.flags&i.FunctionFlags.Allow3dRef)&&0==(a&i.SignatureType.Ref3D)&&!(0,i.isSheetIndex)(r.sheets)){const e=`3D reference, oper = ${(0,n.anonymize)(r)}`;return(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",i.ErrorType.VALUE,e),i.valueErrorOper}if((0,i.isStringOper)(r)&&0==(t.flags&i.FunctionFlags.AllowLStrs)&&r.value.length>255){const e=`LStr, oper = ${(0,n.anonymize)(r)}`;return(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",i.ErrorType.VALUE,e),i.valueErrorOper}}u[e]=r}return this.applyOperatorOrFunction(e,u,r)}getAvailableFormula(e){const t=this.globals.getCellFormula(e);return(0,n.isSuccess)(t)?(0,n.isNone)(t.value)?void 0:t.value:(0,l.throwEvaluationError)(t.reason)}getNameFormula(e,t,r){const{resolution:a,precedents:o}=this.context.resolver.resolveName(this.locals,(0,i.nameNode)((0,i.identNamePart)(t,!0),e),r);if((0,n.safePush)(this.precedents.names,o),!(0,n.isSuccess)(a))switch(a.reason.kind){case i.ResolveReasonKind.NoOriginSheet:case i.ResolveReasonKind.InvalidQualifier:return;default:return(0,l.throwEvaluationError)(a.reason)}const s=a.value;if(!s)return;const u=this.globals.getNameFormula(s,r);(0,n.isSuccess)(u)||(0,l.throwEvaluationError)(u.reason);const c=u.value;return(0,n.isNone)(c)?void 0:[s,c.node]}getCellRef(e,t,r,a){const o={originGridCell:(0,n.success)(r.range),originSheet:(0,n.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:a},{resolution:s}=this.context.resolver.resolveCellRef(o,(0,i.cellRefNode)(t,e));if(!(0,n.isSuccess)(s))switch(s.reason.kind){case i.ResolveReasonKind.NoOriginSheet:case i.ResolveReasonKind.InvalidQualifier:return;default:return(0,l.throwEvaluationError)(s.reason)}const u=s.value;if(u)return(0,i.range3DOper)(u.sheet,u.range)}getStructRef(e,t,r){const a={originGridCell:(0,n.success)(r.range),originSheet:(0,n.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},{resolution:o,precedents:s}=this.context.resolver.resolveStructRef(a,(0,i.structRefNode)(e,t));if((0,n.safePush)(this.precedents.names,s),!(0,n.isSuccess)(o))switch(o.reason.kind){case i.ResolveReasonKind.NoOriginSheet:case i.ResolveReasonKind.InvalidQualifier:case i.ResolveReasonKind.InvalidStructRef:case i.ResolveReasonKind.EmptyIntersection:return;default:return(0,l.throwEvaluationError)(o.reason)}const u=o.value;if(u)return(0,i.range3DOper)(u.sheet,u.range)}dereferenceOper(e,t){return(0,u.dereferenceOper)(this,e,t)}dereferenceOpers(e,t){(0,u.dereferenceOpers)(this,e,t)}getCellFormula(e){this.precedents.cells.push(e);const t=this.globals.getCellValue(e);return(0,n.isSuccess)(t)?this.getAvailableFormula(e):(0,l.throwEvaluationError)(t.reason)}getSheetIndex(e,t){const r=this.globals.getSheetIndex(e,t);return(0,n.isSuccess)(r)?(this.precedents.special|=i.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,i.sheetIndex)(e,r.value)):(0,l.throwEvaluationError)(r.reason)}getSheetRangePosition(e){this.precedents.special|=i.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,n.isSuccess)(t)?t.value.position:(0,l.throwEvaluationError)(t.reason)}getSheetRangeIndexes(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=i.SpecialPrecs.OwnDocSheets;const t=this.globals.getSheetRangeIndexes(e);return(0,n.isSuccess)(t)?t.value.sheets:(0,l.throwEvaluationError)(t.reason)}dereferenceAllOpersInner(e,t,r=!1){const a=[],o=[];for(let s=0;s<e.length;s+=1){const d=e[s];if(!(0,i.isRangeOper)(d)){o.push(d);continue}const m=[],g=e=>{const r=(0,u.getCellValuesAsArray)(this,e,a,!0);void 0!==r&&m.push(t(r,e))},p=this.getSheetRangeIndexes(d.sheets);for(let e=0;e<p.length;e+=1){const t=(0,i.sheetIndex)(d.sheets.document,p[e]);for(let e=0;e<d.ranges.length;e+=1){const a=d.ranges[e];if(!r){g((0,i.sheetGridRange)(t,a));continue}const o=this.globals.tryGetHiddenRows(t,a.row,a.row+a.rows);if(!(0,n.isSuccess)(o))return(0,l.throwEvaluationError)(o.reason);const s=o.value;if(0===s.length){g((0,i.sheetGridRange)(t,a));continue}const u=(e,r)=>{const n=(0,i.gridRange)(e,a.col,r-e,a.cols);g((0,i.sheetGridRange)(t,n))};for(let e=0;e<s.length;e+=1){const{start:r,end:o}=s[e],l=0===e?a.row:s[e-1].end;(0,n.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",l<=r&&r<o&&o<=a.row+a.rows),l!==r&&u(l,r);const c=(0,i.gridRange)(r,a.col,o-r,a.cols);this.precedents.cells.push((0,i.sheetGridRange)(t,c))}const c=s[s.length-1].end;c!==a.row+a.rows&&u(c,a.row+a.rows)}}o.push({kind:c.DerefOperKind.RangeValues,arrays:m})}return a.length>0?(0,l.throwEvaluationError)((0,l.unevaluated)(a)):o}dereferenceAllOpers(e,t){return this.dereferenceAllOpersInner(e,n.identity,t)}dereferenceAllOpersAndFormulae(e,t){return this.dereferenceAllOpersInner(e,((e,t)=>new n.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,((r,n)=>{const a=e.get(r,n),o=(0,i.sheetGridCell)(t.sheet,(0,i.gridCell)(t.range.row+r,t.range.col+n));return[a,this.getAvailableFormula(o)]}),(()=>[e.getSparse(),void 0])).strict()),t)}parseFormula(e,t,r,a){const s=this.context.parser.parseFormula((0,o.parseLocals)(r.lexicalKind,t,{refStyle:e}),a);if(!(0,n.isSuccess)(s))return s;const u=this.context.analyzer.checkFormula(r,s.value);return(0,n.isSuccess)(u)?(0,i.isWellFormed)(u.value)?(u.value,u):(0,n.failure)((0,g.illFormedFormula)("ill-formed indirect formula","indirect")):u}getRandom(){this.precedents.special|=i.SpecialPrecs.Calc;const e=this.internalContext,t=this.globals.getRandom(e);return(0,n.isSuccess)(t)||(0,l.throwEvaluationError)(t.reason),t.value}getTime(e){this.precedents.special|=i.SpecialPrecs.Time;const t=this.globals.getTime(e,a.GetTimeKind.Volatile);return(0,n.isSuccess)(t)||(0,l.throwEvaluationError)(t.reason),t.value}coerceOper(e,t){return(0,s.coerceOper)(this,e,t)}parseGeneral(e,t){const r=this.numberFormatter.parseGeneral(e,!1,t,a.GetTimeKind.NonVolatile);return(0,n.isSuccess)(r)||(0,l.throwEvaluationError)(r.reason),r.value?.value}parseDate(e){const t=this.numberFormatter.parseDate(e,a.GetTimeKind.NonVolatile);return(0,n.isSuccess)(t)||(0,l.throwEvaluationError)(t.reason),t.value?.value}getBinaryOperator(e){const t=(0,i.getOperatorType)(e),r=[i.falseOper,i.falseOper];return(i,a)=>{r[0]=i,r[1]=a,(0,u.dereferenceOpers)(this,r,t);const o=this.dispatchFunction((0,p.operatorIdToName)(e),t,!1,r);return(0,n.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,p.isOperTerm)(o)),o}}getUnaryOperator(e){const t=(0,i.getOperatorType)(e),r=[i.falseOper];return i=>{r[0]=i,(0,u.dereferenceOpers)(this,r,t);const a=this.dispatchFunction((0,p.operatorIdToName)(e),t,!1,r);return(0,n.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,p.isOperTerm)(a)),a}}isInFilterMode(e){this.precedents.special|=i.SpecialPrecs.InFilterMode;for(const t of e)if((0,i.isRangeOper)(t))for(const e of this.getSheetRangeIndexes(t.sheets)){const r=this.globals.isInFilterMode((0,i.sheetIndex)(t.sheets.document,e));if(!(0,n.isSuccess)(r))return(0,l.throwEvaluationError)(r.reason);if(r.value)return!0}return!1}printFormula(e,t){const r=(0,i.sheetGridCell)(e.source.range.sheet,t),a=(0,i.adjustFormulaOrigin)(this.globals,(0,o.analyzeLocalsGrid)(i.LexicalKind.Cell,(0,i.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,n.isSuccess)(a))return(0,l.throwEvaluationError)(a.reason);const s=this.context.printer.printFormula((0,i.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),a.value);return(0,n.isSuccess)(s)?s.value:(0,l.throwEvaluationError)(s.reason)}applyFormat(e,t,r,i){let o;if("number"==typeof t){const r=this.globals.getKnownFormat(e,t);if(!(0,n.isSuccess)(r))return(0,l.throwEvaluationError)(r.reason);o=r.value}else{const r=(0,a.getFormatString)(this.context.numberFormatter,this.globals,e,t,i);if(!(0,n.isSuccess)(r))switch(r.reason.kind){case a.FormatReasonKind.PreviousFormatFailure:case a.FormatReasonKind.NotFormatString:return;default:return(0,l.throwEvaluationError)(r.reason)}o=r.value}const s=(0,a.applyFormatAndRenderToString)(this.context.numberFormatter,o,r);return(0,n.isSuccess)(s)?"string"==typeof s.value?s.value:void 0:(0,l.throwEvaluationError)(s.reason)}constructor(e,t,r,n,a,o,s,u){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=a,this.visitedCells=o,this.visitedNames=s,this.usage=u,this.internalSource=void 0;const l=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return a.special|=i.SpecialPrecs.RefStyle,l},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}}t.FunctionDispatcher=F,F.internalPosition=g.runtimePositionFirstOrderFunc},6314:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNameEvaluationMachine=function(e,t,r,i){return n.Pledge.try((()=>new s(e,t,r,i).evalName()))};const n=r(6913),i=r(6592),a=r(4624),o=r(1007);class s{evalName(){const e=this.context.globals.getNameFormula(this.name,i.NameSource.Plain);if(e.kind===n.ResultKind.Failure)return n.Pledge.reject(e.reason);const t=e.value;if(null==t)return n.Pledge.resolve(void 0);const r=(0,a.bottomEvalPrecedents)(),s=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,a.evalLocalsName)((0,i.lexicalSourceName)(this.name),(0,a.evalLocalsGrid)(this.origin)),r,o.emptyVisitedCells,(0,o.appendVisitedName)(o.emptyVisitedNames,this.name),i.SignatureType.All,t);return n.Pledge.fromMachine(s).catch(this.receiveFailure())}receiveFailure(){return e=>{if(e.kind===a.RuntimeInternalReasonKind.Unevaluated){const t=`calc.runtime.NameEvaluationMachine.receiveFailure: unexpected reason ${(0,n.anonymize)(e)}`;return(0,n.assertFalse)(t)}return n.Pledge.reject(e)}}constructor(e,t,r,n){this.context=e,this.stepConfig=t,this.name=r,this.origin=n}}},9181:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluationRuntime=void 0,t.createSchedule=function(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,n.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:e=>setTimeout(e,0)}},t.calculateNextDeadline=a,t.runtimeTimer=function(){return{doTimeout:e=>void 0!==e&&(0,n.now)()>=e}};const n=r(6913),i=r(4299);function a(e){if(void 0===e.yieldIntervalMs&&void 0===e.endTimeMs)return;if(void 0===e.yieldIntervalMs)return e.endTimeMs;const t=(0,n.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,n.fastMin)(e.endTimeMs,t)}const o={kind:i.ReasonKind.Timeout},s={kind:i.ReasonKind.Breakpoint};t.EvaluationRuntime=class{evaluateAsync(e){if(this.context.globals.interruptToken[0]===i.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{const t=this.evaluate(a(e));return Array.isArray(t)?Promise.resolve(t):((0,n.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",t.kind===i.ReasonKind.Timeout),new Promise(((t,r)=>e.scheduleFunction((()=>{try{t(this.evaluateAsync(e))}catch(e){r(e)}})))))}catch(e){return Promise.reject(e)}}evaluateSync(e){const t=r=>{if(this.context.globals.interruptToken[0]===i.Interrupt.Stop||this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),this.results;const o=this.evaluate(r);if(Array.isArray(o))return o;switch(o.kind){case i.ReasonKind.Timeout:return(0,i.paused)((r=>t(r??a(e))));case i.ReasonKind.Breakpoint:return(0,i.breaked)((()=>t(a(e))));default:return(0,n.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",o)}};return t(a(e))}evaluate(e){const t=()=>this.context.timer.doTimeout(e);try{for(;this.results.length<this.machineRuntimes.length;){const e=this.machineRuntimes[this.results.length].run(t);if(e.kind===n.TransitionKind.Next)return o;if(e.kind===n.TransitionKind.Break)return s;this.pushResult(e)}return this.results}catch(e){const t=`calc.runtime.EvaluationRuntime.evaluate: unhandled error ${(0,n.messageFromError)(e)}`;return(0,n.assertFalse)(t)}}pushResult(e){return this.results.push(e),n.nextTransition}generatePartialResults(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,n.failure)(i.stopped))}constructor(e,t){(0,n.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((e=>new n.MachineRuntime(e))),this.results=[]}}},4624:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellEvaluationResultKind=t.IterableStackFrame=t.IterableStackValue=t.emptyStackEnv=t.LazyOper=t.EvaluationError=t.RuntimeInternalReasonKind=void 0,t.unevaluated=function(e){return 0===e.length&&(0,n.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:o.Unevaluated,anchors:e}},t.throwEvaluationError=u,t.handleEvaluationError=function(e,t,r){if(r.kind===o.Unevaluated){if(t.map.getCount()+1>(e.globals.limits.maxCellChain??1/0))return(0,n.failure)((0,a.limitExceeded)(a.LimitKind.CellChain));const i=r.anchors.map((r=>new l(e.createCellEvaluationMachine(e,void 0,t,r))));return(0,n.callMachineTransition)(new n.AllMachine(i),(0,n.nextOnSuccessReceiver)())}return(0,n.failure)(r)},t.bottomEvalPrecedents=function(){return(0,i.precedents)([],[],[],i.SpecialPrecs.None,i.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){const t=(0,i.sheetGridRangeAnchor)(e.range),r=(0,n.success)(t.range),o=(0,n.success)(t.sheet);return(0,a.evalLocals)(e,r,o,e.kind===i.LexicalKind.Range,r,o,e.kind===i.LexicalKind.Cell,!0,!1,(0,n.success)(!1),void 0)},t.evalLocalsName=function(e,t){const r=e.name.scope;let o;if(void 0!==r.index)o=(0,n.success)(r);else{const e=t.originSheet;if(!(0,n.isSuccess)(e))return u(e.reason);o=(0,i.isDocumentLocEqual)(e.value.document,r.document)?e:(0,n.success)(r)}const s=t.originGridCell;return(0,a.evalLocals)(e,s,o,t.calcingArray,s,o,!1,!1,!0,(0,n.success)(!1),void 0)},t.evalLocalsLambda=function(e,t){return(0,a.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,n.success)(!1),void 0)},t.evalLocalsFirstOrderFunc=function(e,{originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:s,allowUnqualifiedCell:u,wrapCellReferences:l,followHyperlinks:c}){return(0,a.evalLocals)(e,t,r,n,i,o,s,u,l,c,void 0)},t.evalLocalsSlice=function({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:o,implicitIntersect:s,allowUnqualifiedCell:u,wrapCellReferences:l,followHyperlinks:c,contextNames:d}){return(0,a.evalLocals)(e,t,r,n,i,o,s,u,l,c,d)},t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,i){return{stackDepth:1+(i?.stackDepth??0),lexicalSource:e,position:t,localValues:new d(r,n),caller:i}};const n=r(6913),i=r(6592),a=r(4299);var o,s;function u(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(o||(t.RuntimeInternalReasonKind=o={})),t.EvaluationError=(0,i.createFailureErrorClass)("EvaluationError");class l{next(){return(0,n.callMachineTransition)(this.machine,this)}receiveResult(e){if(!(0,n.isSuccess)(e))return e;switch(e.value.kind){case s.ReadFailure:return e.value.failure;case s.WroteFailure:return(0,n.failure)((0,a.previousFailure)(e.value.source.range))}return n.successUndefined}constructor(e){this.machine=e,this.runStatus=!1}}class c{get value(){return void 0===this._value?this.fallback():this._value}set value(e){this._value=e}get valueOrUndefined(){return this._value}constructor(e){this.fallback=e}}t.LazyOper=c,t.emptyStackEnv=n.RedBlackMapTree.create(((e,t)=>e-t));class d{*[Symbol.iterator](){let e=this.stackEnv.getCount()-1;for(let t=this.stackMap;void 0!==t;t=t.next)for(let r=t.numPushed-1;r>=0;r--){const n=t.labels[r],i=this.stackEnv.getValue(e--);if(void 0===n||void 0===i)continue;const o=i instanceof c?i.valueOrUndefined:i;void 0!==o&&(yield(0,a.stackValue)(n,o))}}constructor(e,t){this.stackEnv=e,this.stackMap=t}}t.IterableStackValue=d;class m{*[Symbol.iterator](){for(let e=this.leafFrame;void 0!==e;e=e.caller)yield e}constructor(e){this.leafFrame=e}}t.IterableStackFrame=m,function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"}(s||(t.CellEvaluationResultKind=s={}))},9899:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimeEvaluationContext=h,t.evaluationMachineContext=f,t.evalFormula=v,t.evalCells=F,t.evalCellsAsync=b,t.evalName=k,t.createEvaluator=function(e){return{evalFormula:(t,r)=>v(e,t,r),evalCells:(t,r)=>F(e,t,r),evalName:(t,r,n)=>k(e,t,r,n),evalCellsAsync:(t,r)=>b(e,t,r)}};const n=r(6913),i=r(6592),a=r(1159),o=r(391),s=r(429),u=r(3419),l=r(6314),c=r(9181),d=r(4624),m=r(4810),g=r(4299),p=r(1007);function h(e){return{globals:e,timer:(0,c.runtimeTimer)(),machineContext:f(e)}}function f(e){return{globals:e,resolver:(0,i.createResolver)(e),numberFormatter:(0,a.createNumberFormatter)(e),parser:(0,o.createParser)(e),printer:(0,i.createPrinter)(e),analyzer:(0,o.createAnalyzer)(e),createCellEvaluationMachine:s.createCellEvaluationMachine,createFormulaEvaluationMachine:u.createFormulaEvaluationMachine,createCallTermEvaluationMachine:u.createCallTermEvaluationMachine}}function S(e){if(Array.isArray(e)){const t=e[0];if(t.kind===n.ResultKind.Success){if((0,i.isRangeOper)(t.value)||(0,i.isMissingOper)(t.value)){const e=`calc.runtime.evalFormula: expected ReadOper; given ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}return t}return t}return e.kind===n.ResultKind.Paused?(0,g.paused)((t=>S(e.resume(t)))):(0,g.breaked)((()=>S(e.resume())))}function v(e,t,r){const n=h(e),i=(0,d.bottomEvalPrecedents)(),a=(0,u.createFormulaEvaluationMachine)(n.machineContext,t.stepConfig,(0,d.evalLocalsSlice)(t),i,p.emptyVisitedCells,p.emptyVisitedNames,m.readOperType,r),o=new c.EvaluationRuntime(n,[a]),s=(0,c.createSchedule)(t.schedulerConfig??e.schedulerConfig);return S(o.evaluateSync(s))}function y(e,t,r){const i=h(e),a=[];for(let e=0;e<r.length;e+=1)a.push(new n.VoidMachine((0,s.createCellEvaluationMachine)(i.machineContext,t,p.emptyVisitedCells,r[e])));return new c.EvaluationRuntime(i,a)}function F(e,t,r){if(0===r.length)return[];const n=y(e,t.stepConfig,r),i=(0,c.createSchedule)(t.schedulerConfig??e.schedulerConfig);return n.evaluateSync(i)}function b(e,t,r){if(0===r.length)return Promise.resolve([]);const n=y(e,void 0,r),i=(0,c.createSchedule)(t.schedulerConfig??e.schedulerConfig);return n.evaluateAsync(i)}function C(e){return Array.isArray(e)?e[0]:e.kind===n.ResultKind.Paused?(0,g.paused)((t=>C(e.resume(t)))):(0,g.breaked)((()=>C(e.resume())))}function k(e,t,r,n){const i=h(e),a=(0,l.createNameEvaluationMachine)(i.machineContext,t.stepConfig,r,n),o=new c.EvaluationRuntime(i,[a]),s=(0,c.createSchedule)(t.schedulerConfig??e.schedulerConfig);return C(o.evaluateSync(s))}},9001:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DerefOperKind=void 0,t.rangeValues=function(e){return{kind:r.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===r.RangeValues},function(e){e.RangeValues="RangeValues"}(r||(t.DerefOperKind=r={}))},4810:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayMachine=t.EarlyReturnKind=t.ThenMachine=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0,t.machineCall=function(e){return{kind:a.MachineCall,machine:e}},t.isMachineCall=s,t.earlyReturn=function(e){return{kind:o.EarlyReturn,value:e}},t.refToVal=function(e,t,r){if(!(0,i.isRangeOper)(t))return t;if(!(0,i.isSheetIndex)(t.sheets))return i.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,i.isGridCell)(t.ranges[0])?e.dereferenceOper(t,i.SignatureType.All&~i.OperKind.Range):e.dereferenceOper(t,i.OperKind.Array);const n=e.dereferenceOper(t,i.SignatureType.All&~(i.OperKind.Range|i.OperKind.Array));return(0,i.isArrayOper)(n)?i.naErrorOper:n};const n=r(6913),i=r(6592);var a,o;function s(e){return e.kind===a.MachineCall}t.singleReadOperType=i.OperKind.Number|i.OperKind.String|i.OperKind.Boolean|i.OperKind.Error|i.OperKind.Blank|i.OperKind.Rich,t.readOperType=t.singleReadOperType|i.OperKind.Array,function(e){e.MachineCall="MachineCall"}(a||(t.MachineCallKind=a={})),t.ThenMachine=class{next(){try{if(void 0===this.oper1){const e=this.f1();if(s(e))return(0,n.callMachineTransition)(e.machine,this);this.oper1=e}if(void 0===this.oper2){const e=this.f2(this.oper1);if(s(e))return(0,n.callMachineTransition)(e.machine,this);this.oper2=e}return(0,n.success)(this.oper2)}catch(e){return this.context.handleEvaluationError(e)??(0,n.failure)((0,n.javaScriptError)(e))}}receiveResult(e){return(0,n.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),n.nextTransition):e}constructor(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}},function(e){e.EarlyReturn="EarlyReturn"}(o||(t.EarlyReturnKind=o={})),t.ArrayMachine=class{next(){try{if(void 0!==this.toDeref){const e=this.coercer(this.toDeref,this.opers.length,this.row.length);if(e.kind===o.EarlyReturn)return e.value;this.row.push(e),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,n.success)((0,i.arrayOper)(this.rows,this.cols,this.opers));const e=this.func(this.opers.length,this.row.length);return s(e)?(0,n.callMachineTransition)(e.machine,this):(this.toDeref=e,n.nextTransition)}catch(e){return this.context.handleEvaluationError(e)??(0,n.failure)((0,n.javaScriptError)(e))}}receiveResult(e){return(0,n.isSuccess)(e)?(this.toDeref=e.value,n.nextTransition):e}constructor(e,t,r,n,i){this.context=e,this.rows=t,this.cols=r,this.func=n,this.coercer=i,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}}},9110:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cmpInt=void 0,t.cmpBool=o,t.cmpStr=s,t.cmpNum=u,t.applyOperator=function(e,r,c,d=!1){const{mathpack:m}=e.config;if(1===c.length){const e=c[0];switch(r){case i.OperatorId.Percent:return m.percent(e);case i.OperatorId.Neg:return m.neg(e);case i.OperatorId.Pos:return e;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 1 argument`;return n.ulsLogger.ULS.assertTag(593372496,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}if(2===c.length){const g=c[0],p=c[1];switch(r){case i.OperatorId.Add:{const e=m.add(g,p);return d&&(0,i.isNumberOper)(e)?m.checkAlmostCancellation(g,e):e}case i.OperatorId.Sub:{const e=m.sub(g,p);return d&&(0,i.isNumberOper)(e)?m.checkAlmostCancellation(g,e):e}case i.OperatorId.Mul:return m.mul(g,p);case i.OperatorId.Div:return m.div(g,p);case i.OperatorId.Pow:return m.power(g,p);case i.OperatorId.Concat:return(0,i.stringOper)((g.value+p.value).substring(0,i.cellStringLimit));case i.OperatorId.Eq:case i.OperatorId.Ne:case i.OperatorId.Lt:case i.OperatorId.Le:case i.OperatorId.Gt:case i.OperatorId.Ge:return(0,i.booleanOper)(function(e,r,n,l){const{localeInfo:c,mathpack:d}=e.config;if(n.kind!==l.kind){if((0,i.isBlankOper)(n))switch(l.kind){case i.OperKind.Number:return u(d,r,d.zero,l);case i.OperKind.String:return s(c,r,a.emptyStringOper,l);case i.OperKind.Boolean:return o(r,i.falseOper,l)}if((0,i.isBlankOper)(l))switch(n.kind){case i.OperKind.Number:return u(d,r,n,d.zero);case i.OperKind.String:return s(c,r,n,a.emptyStringOper);case i.OperKind.Boolean:return o(r,n,i.falseOper)}return(0,t.cmpInt)(r,n.kind-l.kind)}switch(n.kind){case i.OperKind.Number:return u(d,r,n,l);case i.OperKind.String:return s(c,r,n,l);case i.OperKind.Boolean:return o(r,n,l);case i.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,g,p));case i.OperatorId.Range:return function(e,t){const r=l("calc.runtime.applyRangeOp",e,t);if(null==r)return i.valueErrorOper;const n=(0,i.gridRangesJoin)(e.ranges),a=(0,i.gridRangesJoin)(t.ranges),o=[(0,i.gridRangeJoin)(n,a)];return(0,i.rangeSeqOper)(r,o)}(g,p);case i.OperatorId.Isect:return function(e,t){const r=l("calc.runtime.applyIsectOp",e,t);if(null==r)return i.valueErrorOper;const o=[];for(let r=0;r<e.ranges.length;r+=1)for(let n=0;n<t.ranges.length;n+=1){const a=(0,i.gridRangeIsect)(e.ranges[r],t.ranges[n]);null!=a&&o.push(a)}if(0===o.length){const r=`empty intersection, range1 = ${(0,n.anonymize)(e)}, range2 = ${(0,n.anonymize)(t)}`;return(0,a.traceErrorOper)("calc.runtime.applyIsectOp",i.ErrorType.NULL,r),i.nullErrorOper}return(0,i.rangeSeqOper)(r,o)}(g,p);case i.OperatorId.Union:return function(e,t){const r=l("calc.runtime.applyUnionOp",e,t);return null==r?i.valueErrorOper:(0,i.rangeSeqOper)(r,e.ranges.concat(t.ranges))}(g,p);case i.OperatorId.And:return(0,i.booleanOper)(g.value&&p.value);case i.OperatorId.Or:return(0,i.booleanOper)(g.value||p.value);case i.OperatorId.Xor:return(0,i.booleanOper)(g.value!==p.value);case i.OperatorId.Min:return m.cond2(g,p)<=0?g:p;case i.OperatorId.Max:return m.cond2(g,p)>=0?g:p;default:{const e=`calc.runtime.applyOperator: bad application of ${r} to 2 arguments`;return n.ulsLogger.ULS.assertTag(593372497,i.LogCategory.msoulscat_ES_EWAJS,!1,e)}}}const g=`calc.runtime.applyOperator: bad application of ${r} to ${c.length} arguments`;return n.ulsLogger.ULS.assertTag(593372498,i.LogCategory.msoulscat_ES_EWAJS,!1,g)};const n=r(6913),i=r(6592),a=r(199);function o(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function s(e,r,n,i){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,i.value))}function u(e,r,n,i){return(0,t.cmpInt)(r,e.compare(n,i))}function l(e,t,r){if((0,i.isSheetIndex)(t.sheets))if((0,i.isSheetIndex)(r.sheets))if((0,i.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,i.sheetIndex)(t.sheets.document,t.sheets.index);{const o=`different sheet, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,a.traceErrorOper)(e,i.ErrorType.VALUE,o)}}else{const o=`different document, range1 = ${(0,n.anonymize)(t)}, range2 = ${(0,n.anonymize)(r)}`;(0,a.traceErrorOper)(e,i.ErrorType.VALUE,o)}else(0,a.traceErrorOper)(e,i.ErrorType.VALUE,`3D reference, range2 = ${(0,n.anonymize)(r)}`);else(0,a.traceErrorOper)(e,i.ErrorType.VALUE,`3D reference, range1 = ${(0,n.anonymize)(t)}`)}t.cmpInt=i.applyComparison},4299:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.evalLocals=t.stopped=t.LimitKind=t.StepAction=t.RuntimePositionKind=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.ReasonKind=void 0,t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:r??void 0,lexicalKind:e,originGridCell:(0,n.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:t??void 0,lexicalKind:i.LexicalKind.NameManager,originGridCell:(0,n.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:s.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:s.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,a,o,s,l,c,d,m,g,p,h,f,S,v,y,F,b,C,k,E,A,T,R,N,I,P,O,M){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:a,getSheetRangeIndexes:o,getNameLoc:s,getUserDefinedFuncLoc:l,getCellValue:c,getCellValues:d,getWorksheetFunc:m,getUserDefinedFunc:g,getNameFormula:p,getCellFormula:h,getUsedRange:f,interruptToken:[u.Continue],tryGetHiddenRows:S,tryGetHiddenCols:v,isInFilterMode:y,getKnownFormat:F,getIformat:b,getFormatString:C,getRandom:k,getTime:E,schedulerConfig:null!=O?O:{},limits:null!=M?M:{},setCellValue:A,setCellValues:T,setCellFailure:R,getContainingTable:N,getStructRefColumn:I,getStructRefSpecialRef:P,getIntersectingTables:()=>(0,n.failure)((0,i.notImplemented)(["getIntersectingTables"]))}},t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:n.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:n.ResultKind.Breaked,resume:e}},t.runtimePositionLetVal=function(e,t){return{kind:l.LetVar,varNamePosition:e,varBinderPosition:t}},t.runtimePositionLambdaRoot=function(e,t,r){return{kind:l.LambdaRoot,lambdaNodePosition:e,head:t,args:r}},t.runtimePositionLambdaParam=function(e,t,r){return{kind:l.LambdaParam,idx:e,paramNodePosition:t,paramNamePosition:r}},t.runtimePositionEtaLambdaBody=function(e){return{kind:l.EtaLambdaBody,wsfId:e}};const n=r(6913),i=r(6592),a=r(1159);var o,s,u,l,c,d;!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(o||(o={})),t.ReasonKind={...i.ReasonKind,...o,...a.FormatReasonKind,...i.ResolveReasonKind},t.interval=(0,n.typedInstanceCreator)()(((e,t)=>((0,n.assertPositiveInteger)("calc.runtime.interval: end",t),(0,n.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}))),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(s||(t.CellKind=s={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(u||(t.Interrupt=u={})),t.stackValue=(0,n.typedInstanceCreator)()(((e,t)=>({label:e,value:t}))),function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.EtaLambdaBody="EtaLambdaBody",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"}(l||(t.RuntimePositionKind=l={})),function(e){e.Continue="Continue",e.Break="Break"}(c||(t.StepAction=c={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(d||(t.LimitKind=d={})),t.stopped={kind:t.ReasonKind.Stopped},t.evalLocals=(0,n.typedInstanceCreator)()(((e,t,r,n,i,a,o,s,u,l,c)=>({lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:a,implicitIntersect:o,allowUnqualifiedCell:s,wrapCellReferences:u,followHyperlinks:l,contextNames:c}))),t.runtimePositionFormulaRoot={kind:l.FormulaRoot},t.runtimePositionFirstOrderFunc={kind:l.FirstOrderFunc}},2441:function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.postStepTerm=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0,t.isOperatorName=function(e){return e>0},t.arrayTerm=u,t.lambdaTerm=l,t.letTerm=c,t.appTerm=m,t.nameTerm=g,t.udfTerm=p,t.cellRefTerm=function(e,t,r){const n=s(o.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){const r=s(o.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){const r=s(o.ReadStack,t);return r.data=e,r},t.conditionalTerm=h,t.noopTerm=f,t.callNameTerm=function(e,t,r){const n=s(o.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,i){const a=s(o.CallLambda,void 0);return a.children=i,a.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},a},t.callFirstOrderFuncTerm=function(e,t,r){const n=s(o.CallFirstOrderFunc,void 0);return n.children=r,n.data={source:e,caller:t},n},t.callMachineTerm=function(e,t){const r=s(o.CallMachine,t);return r.data={machine:e},r},t.isOperTerm=S,t.transformBottomUp=function(e,t){function r(e){if(S(e))return a.Pledge.resolve(e);switch(e.kind){case o.Let:return a.Pledge.all(e.children.map(n)).bind((t=>c(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.position)));case o.App:return a.Pledge.all(e.children.map(n)).bind((t=>m(e.data.funName,e.data.funType,e.data.isFormulaRoot,e.data.args,t,e.position)));case o.Conditional:return a.Pledge.all(e.children.map(n)).bind((([t,...r])=>h(e.data.funName,e.data.funType,e.data.isFormulaRoot,t,r,e.position)));case o.Lambda:return a.Pledge.all(e.children.map(n)).bind((t=>l(e.data.checkArity,e.data.params,t,e.position)));case o.Array:return a.Pledge.all(e.children.map((e=>a.Pledge.all(e.map(n))))).bind((t=>u(e.data.rows,e.data.cols,t,e.position)));case o.Name:return(void 0===e.children?a.Pledge.resolve(void 0):n(e.children)).bind((t=>g(e.data.name,e.data.qualifier,e.data.source,t,e.position)));case o.Udf:return(void 0===e.children?a.Pledge.resolve(void 0):n(e.children)).bind((t=>p(e.data.name,e.data.qualifier,t,e.position)));case o.CellRef:case o.StructRef:case o.ReadStack:return a.Pledge.resolve(e);case o.Noop:return n(e.children).bind((t=>f(t,e.position)));default:return(0,a.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return a.Pledge.resolve(e).bind(r).bind(t)}return a.Pledge.settleOrThrow(n(e))};const a=r(6913);var o;function s(e,t){return{kind:e,data:void 0,children:void 0,position:t}}function u(e,t,r,n){const i=s(o.Array,n);return i.children=r,i.data={rows:e,cols:t},i}function l(e,t,r,n){(0,a.assertTrue)("calc.runtime.lambdaTerm: defsAndBody",r.length===1+t.reduce(((e,t)=>e+(t.hasDef?1:0)),0)),(0,a.assertTrue)("calc.runtime.lambdaTerm: params",t.every(((e,t,r)=>!(e.hasDef&&e.isRest||e.isRest&&t!==r.length-1))));const i=s(o.Lambda,n);return i.children=r,i.data={checkArity:e,params:t},i}function c(e,t,r,n,i){(0,a.assertTrue)("calc.runtime.letTerm",e.length===r.length);const u=s(o.Let,i);return u.children=[...e,n],u.data={rec:t,varLabels:r},u}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"}(o||(t.TermKind=o={})),n=(0,a.makeNewtypeIso)(a.identity,a.identity),t.operatorIdToName=n.wrap,t.operatorNameToId=n.unwrap,i=(0,a.makeNewtypeIso)((e=>-e),(e=>-e)),t.worksheetFunctionIdToName=i.wrap,t.worksheetFunctionNameToId=i.unwrap;const d=[];function m(e,t,r,n=d,i,a){const u=s(o.App,a);return u.children=i,u.data={funName:e,funType:t,isFormulaRoot:r,args:n},u}function g(e,t,r,n,i){const a=s(o.Name,i);return a.data={name:e,qualifier:t,source:r},a.children=n,a}function p(e,t,r,n){const i=s(o.Udf,n);return i.data={name:e,qualifier:t},i.children=r,i}function h(e,t,r,n,i,a){const u=s(o.Conditional,a);return u.children=[n,...i],u.data={funName:e,funType:t,isFormulaRoot:r,args:d},u}function f(e,t){const r=s(o.Noop,t);return r.children=e,r}function S(e){return e.kind>0}t.postStepTerm=s(o.PostStep,void 0)},199:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringOper=t.writeOperType=t.singleWriteOperType=void 0,t.traceErrorOper=function(e,t,r){const a=`${e}: generated Excel error, type ${t}; ${r}`;n.ulsLogger.ULS.traceTag(596120270,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,a)},t.isEmptyStringOper=function(e){return(0,i.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){const a=(0,i.isArrayOper)(r)?(0,n.broadcastArray)(r.rows,r.cols,e,t,r.opers,i.naErrorOper):(0,n.constantArray)(e,t,r);return(0,i.arrayOper)(e,t,a)},t.makeStrict=function(e){const t=e=>e&~(i.OperKind.Array|i.OperKind.Range);return(0,i.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,o){let s=0,u=0;for(let e=0;e<o.length;e+=1){const r=o[e];(0,i.isArrayOper)(r)&&0==((0,i.getArgType)(t,e,o.length)&i.OperKind.Array)?(s=(0,n.fastMax)(s,r.rows),u=(0,n.fastMax)(u,r.cols)):(s=(0,n.fastMax)(s,1),u=(0,n.fastMax)(u,1))}const l=o.map(((r,a,o)=>function(e,t,r,a,o){switch(a.kind){case i.OperKind.Missing:case i.OperKind.Blank:return(0,n.constantArray2D)(t,r,e.zero);case i.OperKind.Array:return 0!=(o&i.OperKind.Array)?(0,n.constantArray2D)(t,r,a):(0,n.broadcastArray2D)(t,r,new n.StrictArray2D(a.rows,a.cols,a.opers),i.naErrorOper);case i.OperKind.Range:default:return(0,n.constantArray2D)(t,r,a)}}(e.mathpack,s,u,r,(0,i.getArgType)(t,a,o.length))));return(0,a.machineCall)(new a.ArrayMachine(e,s,u,((e,t)=>r(l.map((r=>r.get(e,t))))),(t=>{const r=e.coerceOper((0,a.refToVal)(e,t,!0),a.readOperType);return(0,n.assertTrue)("calc.runtime.arrayLift",!(0,i.isMissingOper)(r)&&!(0,i.isRangeOper)(r)),(0,i.isArrayOper)(r)?r.opers[0][0]:r})))};const n=r(6913),i=r(6592),a=r(4810);t.singleWriteOperType=i.OperKind.Number|i.OperKind.String|i.OperKind.Boolean|i.OperKind.Error|i.OperKind.Rich,t.writeOperType=t.singleWriteOperType|i.OperKind.Array,t.emptyStringOper=(0,i.stringOper)("")},9470:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;const n=r(6592);t.RecordOper=class{getFallback(){return this._fallback}getField(e){return this._fields.getValue(e)}constructor(e,t=n.valueErrorOper){this._fields=e,this._fallback=t,this.kind=n.OperKind.Rich}},t.LambdaOper=class{getFallback(){return n.valueErrorOper}getField(e){}constructor(e,t,r,i,a,o,s){this.checkArity=e,this.lambdaNodeLabel=t,this.params=r,this.locals=i,this.stackEnv=a,this.stackMap=o,this.defsAndBody=s,this.kind=n.OperKind.Rich}}},1007:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyVisitedNames=t.emptyVisitedCells=void 0,t.appendVisitedCell=function(e,t){return(0,n.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),l(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){const r=[],n=(0,i.cellCycle)(r);for(let i=t;r.push(i.cell),i.cycle=n,i!==e;i=i.previous);return r.reverse(),n},t.appendVisitedName=function(e,t){const r={name:t,previous:e.current};return c(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){const r=[];for(let n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,i.nameCycle)(r)};const n=r(6913),i=r(4299);function a(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function o(e,t){return e<t?-1:e===t?0:1}function s(e,t){return"string"==typeof e?"string"!=typeof t?1:o(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function u(e,t){let r;return 0!==(r=o(e.name,t.name))?r:a(e.path,t.path,o)}function l(e,t){return{current:e,map:t}}function c(e,t){return{current:e,map:t}}t.emptyVisitedCells=l(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=s(e.sheet.index,t.sheet.index))?r:u(e.sheet.document,t.sheet.document)}))),t.emptyVisitedNames=c(void 0,n.RedBlackMapTree.create((function(e,t){let r;return 0!==(r=o(e.name,t.name))||0!==(r=a(e.scope.index,t.scope.index,s))?r:u(e.scope.document,t.scope.document)})))},5897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=function(e){return{checkFormula:(t,r)=>(0,i.checkFormula)(e,t,r),checkFormulaWithDiagnostics:(t,r)=>(0,i.checkFormulaWithDiagnostics)(e,t,r),autocorrectFormula:(t,r)=>(0,n.autocorrectFormula)(e,t,r),resolveStaticPrecedents:(t,r)=>(0,a.resolveStaticPrecedents)(e,t,r)}};const n=r(4091),i=r(1507),a=r(6447)},4091:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=function(e,t,r){try{const{spans:a,annotations:o,depthUpperBound:s}=r,l=new u(e,t,r).autocorrect();return(0,n.success)((0,i.formula)(l,a,o,s))}catch(e){return e instanceof o?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a={getDocumentLoc:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes"),getContainingTable:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")},o=(0,i.createFailureErrorClass)("AutocorrectError"),s={...(0,i.binaryVisitor)((0,i.constVisitor)(!1),((e,t)=>e||t)),badSequenceNode:(e,t,r)=>!0,badCharsNode:(e,t,r)=>!0};class u extends i.IdentityVisitor{autocorrect(){return(0,i.reduceBottomUp)(s,this.f)?this.f.node:(0,i.reduceBottomUp)(this,this.f)}literalNode(e,t,r){return t||(this.seenUnclosed=!0),!this.locals.allowUnqualifiedCell&&e.kind===i.OperKind.Error&&e.type===i.ErrorType.REF&&this.qualifyCellRef()?(0,i.cellRefNode)((0,i.cellRefError)(),this.qualifyCellRef(),r):(0,i.literalNode)(e,t,r)}nameNode(e,t,r){const a=(0,i.nameNode)(e,t,r),o=(0,i.flattenNameParts)(e).parts,s={...this.locals,allowUnqualifiedCell:!0},{headResolved:u,fieldsResolved:l}=this.resolver.resolveDottedName(s,a,this.f.annotations);if((0,i.canDenoteCellRef)(s,t,o)){const[e,t,...r]=o;if(u.kind===i.ResolvedKind.ResolvedCellRef){const{ref:a,qualifier:s,label:c}=u.node,{ref:d,qualifier:m}=this.cellRefNode(a,s,c);(0,n.assertTrue)("calc.analyze.autocorrectFormula: resolved CellRefKind correct",a.kind===e.ref.kind),(0,n.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't change CellRefKind",d.kind===a.kind),(0,n.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't generate ErrorQualifier",m?.kind!==i.QualifierKind.Error),(0,n.assertTrue)("calc.analyze.autocorrectFormula: all flattened field parts resolved",o.length===1+l.length);const g=(e,{rhs:t,canDenoteNamedObject:r,label:n,qualifiedLabel:a})=>(0,i.fieldRefNamePart)(e,t,r,n,a);return(0,i.nameNode)(r.reduce(g,g((0,i.cellRefNamePart)(d,e.asWhole,e.label,e.qualifiedLabel),t)),m,c)}this.throwIfResolutionUnknown(u.resolution)}if(this.locals.allowRelativeQualifier&&void 0===t){if(u.kind===i.ResolvedKind.ResolvedName&&(0,n.isSuccess)(u.resolution)&&u.resolution.value&&void 0!==u.resolution.value.scope.index)return(0,i.nameNode)(e,this.qualifySheetName(u.resolution.value.scope),r);this.throwIfResolutionUnknown(u.resolution)}if(t&&(t.kind===i.QualifierKind.Sheet||t.kind===i.QualifierKind.Ident)){if(u.kind===i.ResolvedKind.ResolvedName&&(0,n.isSuccess)(u.resolution)&&u.resolution.value&&void 0===u.resolution.value.scope.index&&u.qualifierResolution===i.QualifierKind.Sheet)return(0,i.nameNode)(e,this.qualifyBookName(u.resolution.value.scope),r);this.throwIfResolutionUnknown(u.resolution)}return a}arrayNode(e,t,r){return t||(this.seenUnclosed=!0),(0,i.arrayNode)(e,t,r)}appNode(e,t,r,n){const a=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),(0,i.isOperatorNode)(e)||(this.seenParen=!0),(0,i.isOperatorNode)(e)&&t.some(i.isMissingNode)&&(this.seenMissingOperand=!0),(0,i.appNode)(e,t,a,n)}letNode(e,t,r,n,a,o){const s=this.appNodeBase(e,a,o);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.letNode)(e,t,r,n,s,o)}lambdaNode(e,t,r,n,a,o){const s=this.appNodeBase(e,a,o);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.lambdaNode)(e,t,r,n,s,o)}parenNode(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.parenNode)(e,t,r)}cellRefNode(e,t,r){return e.isBracketed&&"("===this.localeInfo.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,i.cellRefNode)(e,t,r):(0,i.cellRefNode)(e,this.qualifyCellRef(),r)}fieldRefNode(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,i.fieldRefNode)(e,t,r)}structRefNode(e,t,r){if(t.isClosed||(this.seenUnclosed=!0),void 0!==e&&e.qualifier){const{resolution:a,qualifierResolution:o}=this.resolver.resolveName(this.locals,e,i.NameSource.StructRef);if((0,n.isSuccess)(a)&&a.value&&o===i.QualifierKind.Sheet)return(0,i.structRefNode)((0,i.nameNode)(e.parts,void 0,e.label),t,r);this.throwIfResolutionUnknown(a)}return(0,i.structRefNode)(e,t,r)}qualifyCellRef(){const e=this.locals.originSheet;if(!(0,n.isSuccess)(e))throw new o(e.reason);if(void 0===e.value.index)return;const t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,n.isSuccess)(t))throw new o(t.reason);return(0,i.sheetQualifier)(t.value,void 0,(0,i.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifySheetName(e){const t=this.globals.getSheetName(e.document,e.index);if(!(0,n.isSuccess)(t))throw new o(t.reason);return(0,i.sheetQualifier)(t.value,void 0,(0,i.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}qualifyBookName({document:e}){return(0,i.identQualifier)(e.name,(0,i.shouldQuoteQualifier)(this.localeInfo,this.refStyle,e.name))}appNodeBase(e,t,r){return t||!(0,i.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand}isFormulaRoot(e){return this.f.annotations[e]?.kind===i.AnnotationKind.FormulaRoot}throwIfResolutionUnknown(e){if(!(0,n.isSuccess)(e)&&e.reason.kind!==i.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==i.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==i.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==i.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==i.ResolveReasonKind.EmptyIntersection)throw new o(e.reason)}constructor(e,t,r){super(),this.f=r,this.seenUnclosed=!1,this.seenParen=!1,this.seenMissingOperand=!1;const n=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??a.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??a.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??a.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??a.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??a.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??a.getSheetRangeIndexes,getContainingTable:e.getContainingTable?.bind(e)??a.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??a.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??a.getStructRefSpecialRef}}(e);this.globals=n,this.locals=t,this.resolver=(0,i.createResolver)(n),this.localeInfo=t.config?.localeInfo??e.config.localeInfo,this.refStyle=t.config?.refStyle??e.config.refStyle}}},1507:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormulaWithDiagnostics=function(e,t,r){try{const i=b(F(e,t,r,{ok:void 0,isOk:e=>void 0===e,collect:(e,t,r)=>{const n=r??[];return(n[e.label]??(n[e.label]=[])).push(t),n}},!1),r).context.errorData,a={...r,isWellFormed:void 0===i};return(0,n.success)([a,i])}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{const i=b(F(e,t,r,y),r).context.errorData;return(0,n.success)({...r,isWellFormed:i})}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a=r(2140),o={};function s(e,t){return{context:e,result:t}}const u=i.OperKind.String|i.OperKind.Boolean|i.OperKind.Error,l=(c=e=>0!=(e.kind&u),e=>e.kind===i.NodeKind.Literal&&c(e.oper));var c;function d(e,t,r,n=!1){n||(e.errorData=e.reportError(t,r,e.errorData))}function m(e,t){return t!==i.OperKind.Range||0!=(e&i.OperKind.Range)}function g(e,t){if(t.kind===i.NodeKind.Literal)switch(d(e,t,a.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case i.OperKind.Number:case i.OperKind.Boolean:case i.OperKind.String:case i.OperKind.Error:return;case i.OperKind.Missing:break;default:return(0,n.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",t.oper)}d(e,t,a.baseErrors.Illegal_array_literal_element)}function p(e,t,r,i,s){return n.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw o;return v(e,t,s)})).bind((o=>(m(o.result,r)||((0,n.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==i),d(e,t,{kind:a.TypeError.Types_not_related,typeGiven:o.result,typeExpected:r,typeSource:i})),o.result=r,o)))}function h(e,t,r){if(r.kind===i.NodeKind.Ident){const n=(0,i.getBoundName)(e.localeInfo,r.whole);return d(e,r,a.baseErrors.Invalid_binder,n.indexOf(".")<0),d(e,r,a.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return d(e,r,r.kind===i.NodeKind.Missing?a.baseErrors.Missing_binder:a.baseErrors.Invalid_binder),t}const f=e=>0===e.args.length?e:e.args[e.args.length-1];function S(e,t){return n.Pledge.try((()=>(d(e,t,a.baseErrors.Unclosed_application,t.isClosed),(0,i.isWSFNode)(t.head)?function(e,t){return n.Pledge.try((()=>{const r=t.head.id,o=(0,i.getWorksheetFuncType)(r),{minArgs:u,maxArgs:l,headTypes:c,restTypes:m,tailTypes:g,flags:S}=o,y=t.args,F=y.length,b=(0,i.getArguments)(t.args).length;if(d(e,t.head,a.baseErrors.Invalid_function_name,(0==(S&i.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad)&&0==(S&i.FunctionFlags.Chart)&&(0==(S&i.FunctionFlags.Macro)||e.locals.lexicalKind===i.LexicalKind.NameManager)),b<u)switch(r){case i.WorksheetFuncId.IF:case i.WorksheetFuncId.LET:case i.WorksheetFuncId.LETREC:case i.WorksheetFuncId.LAMBDA:break;default:const n=y[F-1];d(e,void 0===n?t:n,{kind:a.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:b,numArgsExpected:u})}if(b>l){const n=y[F-1];d(e,void 0===n?t:n,{kind:a.TypeError.Excess_function_arguments,funcId:r,numArgsGiven:b,numArgsExpected:l})}else if(m.length>1&&b>c.length+m.length){const n=(b-c.length)%m.length;n>g.length&&d(e,f(t),{kind:a.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:b,numArgsExpected:b+(m.length-n)})}let C;if(t.kind===i.NodeKind.App)C=(0,i.getArguments)(t.args).map(((t,n)=>p(e,t,(0,i.getArgType)(o,n,b),{kind:a.TypeSourceKind.WSFArgument,funcId:r,argIndex:n,numArgsGiven:b})));else if(t.kind===i.NodeKind.Let)C=[...t.vars.map((({binder:e})=>e.arg)),...t.body?[t.body.arg]:[]].map((t=>v(e,t)));else{const r=t.params.map((({name:e})=>e.arg.def?.rhs)).filter(n.isDefined),i=t.body?[t.body.arg]:[];C=[...r.map((t=>v(e,t,a.baseErrors.Missing_default_expression))),...i.map((t=>v(e,t)))]}return n.Pledge.all(C).bind((r=>(function(e,t){const r=t.head.id,o=(0,i.getArguments)(t.args).length;switch(r){case i.WorksheetFuncId.IF:const s=e.locals.lexicalKind===i.LexicalKind.NameManager?1:2;return void(o<s&&d(e,f(t),{kind:a.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:o,numArgsExpected:s}));case i.WorksheetFuncId._UDF:return d(e,t,a.baseErrors.Unexpected_application_head);case i.WorksheetFuncId.LET:case i.WorksheetFuncId.LETREC:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===i.NodeKind.Let);let s=n.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(const{name:r}of t.vars)s=h(e,s,r.arg.name);for(const r of t.badArgs)d(e,r.arg,a.baseErrors.Invalid_binder);d(e,f(t),{kind:a.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:o,numArgsExpected:(0,n.fastMax)(3,o+1+o%2)},o>=3&&void 0!==t.body);break}case i.WorksheetFuncId.LAMBDA:{(0,n.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===i.NodeKind.Lambda);let s=n.RedBlackMapTree.create(e.localeInfo.stringCompareCI),u=!1;for(const{name:r}of t.params)d(e,r.arg.name,a.baseErrors.Unclosed_bracket,r.arg.name.isClosed),void 0!==r.arg.def&&d(e,r.arg.name,a.baseErrors.Binder_requires_brackets,r.arg.name.isBracketed),r.arg.isOptional?u=!0:d(e,r.arg,a.baseErrors.Mandatory_binder_after_optional,!u),s=h(e,s,r.arg.name.name);for(const r of t.badArgs)d(e,r.arg,a.baseErrors.Invalid_binder);o>=1&&void 0!==t.body?void 0!==t.body&&(0,i.isMissingLiteralNode)(t.body.arg)&&d(e,t.body.arg,a.baseErrors.Invalid_body):d(e,f(t),{kind:a.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:o,numArgsExpected:o+1});break}}}(e,t),s(e,o.returnType))))}))}(e,t):(0,i.isOperatorNode)(t.head)?function(e,t){return n.Pledge.try((()=>{const{head:r,args:o}=t,u=r.id,l=(0,i.getOperatorType)(u),c=o.length,m=c===l.minArgs;return d(e,r,{kind:a.TypeError.Incorrect_number_of_operator_arguments,opId:u},m),n.Pledge.all(o.map(((t,r)=>n.Pledge.try((()=>p(e,t,(0,i.getArgType)(l,r,c),{kind:a.TypeSourceKind.OperatorArgument,opId:u,argIndex:r,numArgsGiven:c},{kind:a.SyntaxError.Missing_operation_argument,opId:u})))))).bind((t=>m&&!o.some(i.isMissingNode)?s(e,l.returnType):s(e,i.SignatureType.All)))}))}(e,t):function(e,t){return n.Pledge.try((()=>{const r=t.head,o=t.args,u=o.length,c=(0,i.getArguments)(o).length,g=o[u-1],h=(0,i.higherOrderFunctionType)().maxArgs-1;return c>h&&d(e,void 0===g?t:g,{kind:a.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:c,numArgsExpected:h}),n.Pledge.all(o.map((t=>p(e,t,i.SignatureType.All,void 0)))).bind((t=>v(e,r).bind((t=>(m(t.result,i.OperKind.Range)||0!=(t.result&(i.OperKind.Array|i.OperKind.Rich))||d(e,r,l(r)||r.kind===i.NodeKind.Array?a.baseErrors.Unexpected_application_head:a.baseErrors.Unexpected_application_head_with_fix),s(e,i.SignatureType.All))))))}))}(e,t))))}function v(e,t,r,u=!1){return n.Pledge.try((()=>{if(e.earlyExit&&!e.isOk())throw o;switch(t.kind){case i.NodeKind.App:case i.NodeKind.Let:case i.NodeKind.Lambda:return S(e,t);case i.NodeKind.Array:return function(e,t){return n.Pledge.try((()=>{d(e,t,a.baseErrors.Unclosed_array,t.isClosed);const r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,i.isMissingNode)(t.nodes[0][0]));if(d(e,t,a.baseErrors.Empty_array_literal,r),!r)return s(e,i.OperKind.Array);const n=t.nodes[0].length;for(let r=0;r<t.nodes.length;r+=1){const i=t.nodes[r],o=i.length;d(e,t,a.baseErrors.Irregular_array_shape,o===n);for(let t=0;t<o;t+=1)g(e,i[t])}return s(e,i.OperKind.Array)}))}(e,t);case i.NodeKind.BadChars:case i.NodeKind.BadSequence:return function(e,t){return n.Pledge.try((()=>{if(t.kind===i.NodeKind.BadSequence){switch(t.type){case i.BadType.Unexpected:d(e,t,a.baseErrors.Bad_node,t.contents.some((e=>e.kind===i.NodeKind.BadChars||e.kind===i.NodeKind.BadSequence)));break;case i.BadType.StructRef:d(e,t.contents[0]??t,a.baseErrors.Invalid_struct_ref_table_name);break;case i.BadType.FieldRef:return void d(e,t,a.baseErrors.Unexpected_field_ref)}return n.Pledge.all(t.contents.map((t=>v(e,t))))}switch(t.type){case i.BadType.Unexpected:switch(t.chars){case")":return d(e,t,a.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return d(e,t,a.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return d(e,t,a.baseErrors.Unexpected_closing_bracket);case".":return d(e,t,a.baseErrors.Unexpected_dot);default:return d(e,t,{kind:a.SyntaxError.Unexpected_character,text:t.chars})}case i.BadType.NumberLiteral:return d(e,t,a.baseErrors.Invalid_number_literal);case i.BadType.StringLiteral:return d(e,t,a.baseErrors.Invalid_string_literal);case i.BadType.ErrorLiteral:return d(e,t,a.baseErrors.Invalid_error_literal);case i.BadType.FieldName:case i.BadType.ParamName:return d(e,t,a.baseErrors.Bad_node);case i.BadType.Qualifier:return d(e,t,a.baseErrors.Invalid_qualifier);default:(0,n.assertNever)("calc.analyze.diagnoseBadNode",t)}}))}(e,t).bind((()=>s(e,i.SignatureType.All)));case i.NodeKind.Missing:return!1!==r&&d(e,t,r??a.baseErrors.Bad_node),s(e,i.SignatureType.All);case i.NodeKind.CellRef:return e.locals.allowRelativeQualifier||t.qualifier?.kind!==i.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?t.qualifier?.kind===i.QualifierKind.Document||t.qualifier?.kind===i.QualifierKind.Bad?(d(e,t,a.baseErrors.Invalid_qualifier),s(e,i.SignatureType.All)):t.ref.kind===i.CellRefKind.Bad?(d(e,t,a.baseErrors.Invalid_cell_ref),s(e,i.SignatureType.All)):s(e,i.OperKind.Range):(d(e,t,a.baseErrors.Invalid_unqualified_cell),s(e,i.SignatureType.All)):(d(e,t,a.baseErrors.Invalid_rel_sheet_qualifier_in_cell),s(e,i.SignatureType.All));case i.NodeKind.Literal:return d(e,t,a.baseErrors.Unclosed_literal,t.isClosed),(0,i.isErrorOper)(t.oper)&&d(e,t,a.baseErrors.Invalid_error_literal,!((l=t.oper.type)>i.ErrorType.GETTING_DATA&&l!==i.ErrorType.BUSY&&l!==i.ErrorType.EXTERNAL)),s(e,t.oper.kind|((0,i.isErrorOper)(t.oper)&&t.oper.type===i.ErrorType.REF?i.OperKind.Range:0));case i.NodeKind.Name:{const{qualifier:r}=t;if((u||!e.locals.allowRelativeQualifier)&&r?.kind===i.QualifierKind.Relative)return d(e,t,a.baseErrors.Invalid_rel_sheet_qualifier_in_name),s(e,i.SignatureType.All);if(!e.locals.workbookLoad&&r?.kind===i.QualifierKind.Document&&!r.isQuoted)return d(e,t,a.baseErrors.Invalid_qualifier),s(e,i.SignatureType.All);if(r?.kind===i.QualifierKind.SheetRange||r?.kind===i.QualifierKind.Bad)return d(e,t,a.baseErrors.Invalid_qualifier),s(e,i.SignatureType.All);const n=(0,i.flattenNameParts)(t.parts).parts,o=e.annotations[n[0].label],l=e.annotations[t.label],c=l?.kind===i.AnnotationKind.AppHeadName;return o?.kind===i.AnnotationKind.LocalNameUse?d(e,t,a.baseErrors.Invalid_name,(0,i.canDenoteLocalName)(r,n)):d(e,t,u?a.baseErrors.Invalid_struct_ref_table_name:a.baseErrors.Invalid_name,t.parts.canDenoteNamedObject||(0,i.canDenoteUserDefinedFunc)(c,r,t.parts)||(0,i.canDenoteCellRef)(e.locals,r,n)),s(e,i.SignatureType.All)}case i.NodeKind.Paren:return d(e,t,a.baseErrors.Unclosed_paren,t.isClosed),d(e,t,a.baseErrors.Empty_parenthesis,!(0,i.isMissingNode)(t.node)),v(e,t.node,!1);case i.NodeKind.FieldRef:return d(e,t,a.baseErrors.Unclosed_bracket,t.rhs.isClosed),d(e,t,a.baseErrors.Unexpected_field_ref,!(0,i.isMissingNode)(t.lhs)&&!(0,i.isNumberLiteralNode)(t.lhs)),t.rhs.field.kind!==i.NodeKind.Ident&&d(e,t.rhs.field,t.rhs.field.kind===i.NodeKind.Missing?a.baseErrors.Missing_field_name:a.baseErrors.Invalid_field_name),v(e,t.lhs,!1).bind((t=>s(e,i.SignatureType.All)));case i.NodeKind.StructRef:if(d(e,t,a.baseErrors.Missing_struct_ref_table_name,void 0!==t.lhs||e.locals.allowImplicitTable),void 0===t.rhs.innerRef);else{const r=t=>{switch(t?.kind){case void 0:break;case i.StructRefKind.RangeOpRef:r(t.lhs),r(t.rhs);break;case i.StructRefKind.CommaOpRef:d(e,t,a.baseErrors.Invalid_struct_ref_comma_parts,(0,i.isCommaOpRefWellFormed)(t)),t.refs.forEach(r);break;case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:d(e,t,a.baseErrors.Unclosed_bracket,t.isClosed);break;case i.StructRefKind.ThisRowOpRef:r(t.ref);break;case i.StructRefKind.MissingRef:d(e,t,a.baseErrors.Invalid_struct_ref_missing_part);break;case i.StructRefKind.BadRef:d(e,t,a.baseErrors.Unclosed_bracket,t.isClosed),d(e,t,a.baseErrors.Invalid_struct_ref_bad_part)}};r(t.rhs.innerRef)}return d(e,t,a.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?n.Pledge.resolve(void 0):v(e,t.lhs,void 0,!0)).bind((t=>s(e,i.SignatureType.All)));default:return(0,n.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}var l}))}const y={ok:!0,isOk:n.identity,collect:(e,t,r)=>!1};function F(e,t,{annotations:r},n,i=!0){const a={globals:e,locals:t,localeInfo:t.config?.localeInfo??e.config.localeInfo,annotations:r,reportError:n.collect,isOk:()=>n.isOk(a.errorData),earlyExit:i,errorData:n.ok};return a}function b(e,t){try{const r=n.Pledge.settleOrThrow(p(e,t.node,i.SignatureType.All,void 0,a.baseErrors.Empty_formula));return function(e,t){const r=t.annotations[t.node.label];function o(t){for(const r of t)d(e,r,a.baseErrors.Unclosed_comment,r.isClosed)}function s(e){const r=t.spans[e];null!=r&&(r.preComments&&o(r.preComments),r.postComments&&o(r.postComments))}r?.kind===i.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[i.SyntaxFeature.Comments]&&n.Pledge.settleOrThrow(function e(t){return n.Pledge.try((()=>{switch(s(t.label),t.kind){case i.NodeKind.Literal:case i.NodeKind.Missing:case i.NodeKind.BadChars:break;case i.NodeKind.App:case i.NodeKind.Let:case i.NodeKind.Lambda:return t.head.kind===i.NodeKind.Operator&&s(t.head.label),n.Pledge.all(t.args.map(e));case i.NodeKind.Array:return n.Pledge.all((0,n.safeConcat)([],t.nodes.map((t=>t.map(e)))));case i.NodeKind.BadSequence:return n.Pledge.all(t.contents.map(e));case i.NodeKind.CellRef:case i.NodeKind.Name:t.qualifier&&s(t.qualifier.label);break;case i.NodeKind.Paren:return e(t.node);case i.NodeKind.FieldRef:return s(t.rhs.label),s(t.rhs.field.label),e(t.lhs);case i.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case i.NodeKind.Var:s(t.name.label);break;case i.NodeKind.Param:if(s(t.name.label),s(t.name.name.label),t.def)return s(t.def.label),e(t.def.rhs);break;default:return(0,n.assertNever)("calc.analyze.checker.comments",t)}}))}(t.node))}(e,t),r}catch(t){if(t===o)return s(e,i.SignatureType.All);throw t}}},2140:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0,t.formatDiagnostic=function(e){switch(e.kind){case o.Insufficient_function_arguments:case o.Excess_function_arguments:return`${e.kind}: ${(0,i.englishWorksheetFuncIdToName)(e.funcId)}`;case a.Missing_operation_argument:case o.Incorrect_number_of_operator_arguments:return`${e.kind}: ${(0,i.englishOperatorIdToName)(e.opId)}`;case a.Unexpected_character:return`${e.kind}: ${(0,n.anonymizeFormulaString)(e.text)}`;case o.Types_not_related:return`${e.kind}: ${function(e){const{kind:t,argIndex:r}=e;switch(e.kind){case s.WSFArgument:return JSON.stringify({kind:t,funcId:(0,i.englishWorksheetFuncIdToName)(e.funcId),argIndex:r});case s.OperatorArgument:return JSON.stringify({kind:t,opId:(0,i.englishOperatorIdToName)(e.opId),argIndex:r})}}(e.typeSource)}`;default:return e.kind}};const n=r(6913),i=r(6592);var a,o,s;!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Missing_struct_ref_table_name="Missing_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(a||(t.SyntaxError=a={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(o||(t.TypeError=o={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(s||(t.TypeSourceKind=s={})),t.baseErrors={[a.Unclosed_application]:{kind:a.Unclosed_application},[a.Unclosed_paren]:{kind:a.Unclosed_paren},[a.Unclosed_bracket]:{kind:a.Unclosed_bracket},[a.Unclosed_array]:{kind:a.Unclosed_array},[a.Unclosed_literal]:{kind:a.Unclosed_literal},[a.Unclosed_comment]:{kind:a.Unclosed_comment},[a.Invalid_number_literal]:{kind:a.Invalid_number_literal},[a.Invalid_string_literal]:{kind:a.Invalid_string_literal},[a.Invalid_error_literal]:{kind:a.Invalid_error_literal},[a.Invalid_function_name]:{kind:a.Invalid_function_name},[a.Invalid_name]:{kind:a.Invalid_name},[a.Illegal_array_literal_element]:{kind:a.Illegal_array_literal_element},[a.Empty_array_literal]:{kind:a.Empty_array_literal},[a.Irregular_array_shape]:{kind:a.Irregular_array_shape},[a.Empty_parenthesis]:{kind:a.Empty_parenthesis},[a.Bad_node]:{kind:a.Bad_node},[a.Invalid_qualifier]:{kind:a.Invalid_qualifier},[a.Invalid_cell_ref]:{kind:a.Invalid_cell_ref},[a.Invalid_binder]:{kind:a.Invalid_binder},[a.Missing_binder]:{kind:a.Missing_binder},[a.Duplicate_binder]:{kind:a.Duplicate_binder},[a.Invalid_body]:{kind:a.Invalid_body},[a.Mandatory_binder_after_optional]:{kind:a.Mandatory_binder_after_optional},[a.Missing_default_expression]:{kind:a.Missing_default_expression},[a.Binder_requires_brackets]:{kind:a.Binder_requires_brackets},[a.Invalid_field_name]:{kind:a.Invalid_field_name},[a.Missing_field_name]:{kind:a.Missing_field_name},[a.Empty_formula]:{kind:a.Empty_formula},[a.Invalid_rel_sheet_qualifier_in_cell]:{kind:a.Invalid_rel_sheet_qualifier_in_cell},[a.Invalid_rel_sheet_qualifier_in_name]:{kind:a.Invalid_rel_sheet_qualifier_in_name},[a.Invalid_unqualified_cell]:{kind:a.Invalid_unqualified_cell},[a.Unexpected_closing_paren]:{kind:a.Unexpected_closing_paren},[a.Unexpected_closing_brace]:{kind:a.Unexpected_closing_brace},[a.Unexpected_closing_bracket]:{kind:a.Unexpected_closing_bracket},[a.Unexpected_field_ref]:{kind:a.Unexpected_field_ref},[a.Unexpected_dot]:{kind:a.Unexpected_dot},[a.Invalid_struct_ref_table_name]:{kind:a.Invalid_struct_ref_table_name},[a.Missing_struct_ref_table_name]:{kind:a.Missing_struct_ref_table_name},[a.Invalid_struct_ref_comma_parts]:{kind:a.Invalid_struct_ref_comma_parts},[a.Invalid_struct_ref_missing_part]:{kind:a.Invalid_struct_ref_missing_part},[a.Invalid_struct_ref_bad_part]:{kind:a.Invalid_struct_ref_bad_part},[o.Unexpected_application_head]:{kind:o.Unexpected_application_head},[o.Unexpected_application_head_with_fix]:{kind:o.Unexpected_application_head_with_fix}}},6447:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=function(e,t,r){try{const o=new u(e,t,r.annotations);return(0,i.reduceBottomUp)(o,r),(0,n.success)((0,a.staticPrecedents)(o.cells,o.names,o.udfs,o.nameSpecial|o.ownSpecial,o.ownSpecial,i.PrecsBound.Upper,o.resolutions))}catch(e){return e instanceof s?(0,n.failure)(e.reason):(0,n.failure)((0,n.javaScriptError)(e))}};const n=r(6913),i=r(6592),a=r(446),o={getDocumentLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc"),getSheetIndex:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex"),getSheetName:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName"),getNameLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc"),getUserDefinedFuncLoc:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc"),getSheetRangeIndexes:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes"),getContainingTable:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable"),getStructRefColumn:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn"),getStructRefSpecialRef:()=>(0,n.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")},s=(0,i.createFailureErrorClass)("ResolveStaticPrecedentsError");class u extends i.IdentityVisitor{appNode(e,t,r,a){if(e.kind===i.NodeKind.WSF){const r=e.id;let a=(0,i.getWorksheetFuncType)(r).staticPrecs;switch(r){case i.WorksheetFuncId.LOOKUP:case i.WorksheetFuncId.SUMIF:case i.WorksheetFuncId.AVERAGEIF:const e=({label:e})=>{const t=this.resolutions[e],r=t?.kind===i.ResolvedKind.ResolvedCellRef||t?.kind===i.ResolvedKind.ResolvedStructRef?t.resolution:void 0;return r?.kind===n.ResultKind.Success?r.value:void 0},o=(t,r)=>{const n=e(t),a=e(r);return void 0!==n&&void 0!==a&&(0,i.isSheetGridRange)(n)&&(0,i.isSheetGridRange)(a)&&(0,i.isDocumentLocEqual)(n.sheet.document,a.sheet.document)&&n.range.rows===a.range.rows&&n.range.cols===a.range.cols};(t.length<3||t[2].kind===i.NodeKind.Literal||t[2].kind===i.NodeKind.Array||o(t[2],r===i.WorksheetFuncId.LOOKUP?t[1]:t[0]))&&(a&=~i.SpecialPrecs.AllCells)}a!==i.SpecialPrecs.None&&(this.ownSpecial|=a)}return super.appNode(e,t,r,a)}nameNode(e,t,r){const a=this.resolver.resolveDottedName(this.locals,(0,i.nameNode)(e,t,r),this.annotations);this.resolutions[r]=a,(0,n.safePush)(this.names,a.precedents.names),(0,n.safePush)(this.udfs,a.precedents.udfs);const{headResolved:o}=a;switch(o.kind){case i.ResolvedKind.ResolvedName:if(!(0,n.isSuccess)(o.resolution)){this.handleResolutionError(o.resolution.reason);break}void 0!==o.resolution.value&&(this.nameSpecial|=i.SpecialPrecs.All);break;case i.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,n.isSuccess)(o.resolution)){this.handleResolutionError(o.resolution.reason);break}break;case i.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(o.resolution)}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.resolver.resolveCellRef(this.locals,(0,i.cellRefNode)(e,t,r));this.resolutions[r]=n;const{resolution:a}=n;return this.pushResolvedGridRef(a),super.cellRefNode(e,t,r)}structRefNode(e,t,r){const a=this.resolver.resolveStructRef(this.locals,(0,i.structRefNode)(e,t,r));this.resolutions[r]=a,(0,n.safePush)(this.names,a.precedents);const{resolution:o}=a;return this.pushResolvedGridRef(o),super.structRefNode(e,t,r)}pushResolvedGridRef(e){if(e.kind!==n.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){const t=e.value;if((0,i.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=i.SpecialPrecs.OwnDocSheets;const e=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,n.isSuccess)(e))throw new s(e.reason);(0,n.safePush)(this.cells,e.value.sheets.map((e=>(0,i.sheetGridRange)((0,i.sheetIndex)(t.sheet.document,e),t.range))))}}}handleResolutionError(e){switch(e.kind){case i.ResolveReasonKind.NoOriginSheet:case i.ResolveReasonKind.InvalidStructRef:case i.ResolveReasonKind.InvalidCellRef:case i.ResolveReasonKind.InvalidQualifier:case i.ResolveReasonKind.EmptyIntersection:return}throw new s(e)}constructor(e,t,r){super(),this.locals=t,this.annotations=r,this.cells=[],this.names=[],this.udfs=[],this.nameSpecial=i.SpecialPrecs.None,this.ownSpecial=i.SpecialPrecs.None,this.resolutions=[],this.globals=function(e){return{config:e.config,getDocumentLoc:e.getDocumentLoc?.bind(e)??o.getDocumentLoc,getSheetIndex:e.getSheetIndex?.bind(e)??o.getSheetIndex,getSheetName:e.getSheetName?.bind(e)??o.getSheetName,getNameLoc:e.getNameLoc?.bind(e)??o.getNameLoc,getUserDefinedFuncLoc:e.getUserDefinedFuncLoc?.bind(e)??o.getUserDefinedFuncLoc,getSheetRangeIndexes:e.getSheetRangeIndexes?.bind(e)??o.getSheetRangeIndexes,getContainingTable:e.getContainingTable?.bind(e)??o.getContainingTable,getStructRefColumn:e.getStructRefColumn?.bind(e)??o.getStructRefColumn,getStructRefSpecialRef:e.getStructRefSpecialRef?.bind(e)??o.getStructRefSpecialRef}}(e),this.resolver=(0,i.createResolver)(this.globals)}}},446:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diagnostics=void 0,t.summarizeFormulaDiagnostics=function(e){if(void 0===e)return;const t={};return Object.keys(e).forEach((r=>{e[Number(r)].forEach((e=>{const r=o.formatDiagnostic(e);t[r]=(t[r]??0)+1}))})),t},t.staticPrecedents=function(e,t,r,n,i,a,o){return{cells:e,names:t,udfs:r,special:n,ownSpecial:i,bound:a,resolutions:o}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n=!1){return{config:r??void 0,lexicalKind:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r=!1){return{config:t??void 0,lexicalKind:a.LexicalKind.NameManager,originGridCell:(0,i.success)(e.range),originSheet:(0,i.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}};const n=r(6533),i=r(6913),a=r(6592),o=n.__importStar(r(2140));t.diagnostics=o},391:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.token=t.tokenizeFormulaModule=t.analyzeServiceTypes=t.analyzeService=t.parserService=t.parseServiceTypes=t.stopUsingThis=t.createParser=t.parseResultHelper=t.isUnbracketedFieldName=t.createAnalyzer=t.PackageName=void 0;const n=r(6533);t.PackageName="excel-online-calc-syntax";var i=r(5897);Object.defineProperty(t,"createAnalyzer",{enumerable:!0,get:function(){return i.createAnalyzer}}),n.__exportStar(r(446),t),n.__exportStar(r(8555),t);var a=r(8882);Object.defineProperty(t,"isUnbracketedFieldName",{enumerable:!0,get:function(){return a.isUnbracketedFieldName}});var o=r(4489);Object.defineProperty(t,"parseResultHelper",{enumerable:!0,get:function(){return o.parseResultHelper}});var s=r(9041);Object.defineProperty(t,"createParser",{enumerable:!0,get:function(){return s.createParser}}),t.stopUsingThis=n.__importStar(r(6648)),t.parseServiceTypes=n.__importStar(r(8555)),t.parserService=n.__importStar(r(9041)),t.analyzeService=n.__importStar(r(5897)),t.analyzeServiceTypes=n.__importStar(r(446)),t.tokenizeFormulaModule=n.__importStar(r(7402)),t.token=n.__importStar(r(7978))},8853:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=void 0;const n=r(6913),i=r(1368),a=r(7978);function o(e){return(0,i.take)(((t,r)=>r.kind===a.TokenKind.Sep&&r.value===e?r:void 0))}function s(e){return(0,i.take)(((t,r)=>r.kind===a.TokenKind.Left&&r.value===e?r:void 0))}function u(e){return(0,i.take)(((t,r)=>r.kind===a.TokenKind.Right&&r.value===e?r:void 0))}t.parseWhitespace=(0,i.many)((0,i.take)(((e,t)=>(0,a.isWhitespaceToken)(t)?t:void 0))),t.parseSpacesOnly=(0,i.opt)((0,i.take)(((e,t)=>t.kind===a.TokenKind.Spaces?t.chars:void 0)),""),t.parseCharIndex=function(e,t,r,i,a){const o=e.at(t,r);if(void 0===o){const e=`calc.parse.pStart: internal error: expected token at ${t}`;return(0,n.assertFalse)(e)}return i(o.start,t)},t.parseListSep=o(a.SepId.List),t.parseRowSep=o(a.SepId.Row),t.parseColSep=o(a.SepId.Col),t.parseQualSep=o(a.SepId.Qual),t.parseDotSepToken=o(a.SepId.Dot),t.parseAssignToken=o(a.SepId.Assign),t.parseLeftParen=s(a.DelimId.Paren),t.parseRightParen=u(a.DelimId.Paren),t.parseLeftBrace=s(a.DelimId.Brace),t.parseRightBrace=u(a.DelimId.Brace),t.parseLeftSQuote=s(a.DelimId.SQuote),t.parseRightSQuote=u(a.DelimId.SQuote),t.parseLeftBracket=s(a.DelimId.Bracket),t.parseRightBracket=u(a.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,i.takePeek)(((e,t,r)=>(0,a.isDotSepToken)(t)&&!(0,a.isLeftBracketToken)(r)?t:void 0)),t.parseRangeOp=(0,i.take)(((e,t)=>(0,a.isRangeOpToken)(t)?t:void 0)),t.parseAtOp=(0,i.take)(((e,t)=>(0,a.isAtOpToken)(t)?t:void 0)),t.parseEscape=(0,i.take)(((e,t)=>t.kind===a.TokenKind.Escape?t:void 0)),t.parseEnd=(0,i.take)(((e,t)=>t.kind===a.TokenKind.End?t:void 0)),t.parseIdentContinue=(0,i.apply)((0,i.many1)((0,i.take)(((e,t)=>t.isIdentContinue?t:void 0))),((e,t)=>{const r=t[0];return 1===t.length?r:(0,a.identToken)(r.start,t.map((e=>e.chars)).join(""))}))},8882:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=void 0,t.isUnbracketedFieldName=g;const n=r(6913),i=r(6592),a=r(8853),o=r(9119),s=r(1368),u=r(7307),l=r(7978),{codePointQuestionMark:c,codePointBackslash:d,codePointUnderscore:m}=n.codePoint;function g(e,t){function r(t){return t!==c&&t!==d&&e.isIdentContinue(t)}if(0===t.length)return!1;const i=(0,n.stringCodePointAt)(t,0);if((a=i)===m||a===d||!e.isIdentStart(a)&&!e.isNumeral(a))return!1;var a;for(const e of(0,n.codePointIterator)(t,(0,n.numCodeUnits)(i)))if(!r(e))return!1;return!0}const p=(0,s.take)(((e,t)=>t.kind===l.TokenKind.Ident||t.kind===l.TokenKind.Escape||t.kind===l.TokenKind.Unexpected?t:void 0)),h=(0,s.apply)((0,s.tuple)(a.parseLeftBracket,(0,u.withTokenContext)(l.TokenContext.InFieldRef,(0,s.tuple)(a.parseCharIndex,(0,s.many)(p),a.parseCharIndex,(0,s.opt)(a.parseRightBracket,void 0)))),((e,[t,[r,n,a,o]])=>{const s=void 0!==o,c=n.map((e=>e.kind===l.TokenKind.Escape?"":e.chars)).join("");if(!n.every(((e,t,r)=>e.kind===l.TokenKind.Ident||e.kind===l.TokenKind.Escape&&r[t+1]?.kind===l.TokenKind.Ident))||c.length>255){const t=n.map((e=>e.chars)).join("");return[(0,i.badCharsNode)(i.BadType.FieldName,t,(0,u.addSpan)(e,r,a,"","")),!0,s]}return[(0,i.identNode)(c,(0,u.addSpan)(e,r,a,"","")),!0,s]})),f=(0,s.apply)(a.parseIdentContinue,((e,t)=>{const r=t.start,n=t.start+t.chars.length;return!g(e.localeInfo,t.chars)||t.chars.length>255?[(0,i.badCharsNode)(i.BadType.FieldName,t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]:[(0,i.identNode)(t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]}));t.parseFieldRef=(0,s.apply)((0,s.tuple)(a.parseCharIndex,a.parseWhitespace,a.parseDotSepToken,(0,s.any)(f,h),a.parseCharIndex),((e,[t,r,n,[a,s,l],c])=>{const d=(0,u.addSpan)(e,n.start,c,r,""),m=(0,i.fieldRef)(a,s,l,!1,d);return(0,o.fieldRefTerm)(r.length>0,m,t,c)}))},1712:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.parseFormula=void 0,t.runFormulaParser=function(e,t,r,a,o,s,u,c){const m={[i.SyntaxFeature.Comments]:!0===u?.[i.SyntaxFeature.Comments],[i.SyntaxFeature.Statements]:!0===u?.[i.SyntaxFeature.Statements]},h=(0,d.makeState)(e,t,r,a,o,m);if(void 0===c.at(0,h)){const e="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,n.assertFalse)(e)}const f=(0,l.runParser)(p,c,0,h);if(!(0,n.isSuccess)(f)){const e="calc.parse.runTokenParser: internal error: !isSuccess";return(0,n.assertFalse)(e)}const S=f.value.index,v=c.at(S,h);if(void 0===v){const e="calc.parse.runTokenParser: internal error: expected one unconsumed token";return(0,n.assertFalse)(e)}if(v.kind!==g.TokenKind.End){const e=`calc.parse.runTokenParser: internal error: didn't consume up to end at index ${S}`;return(0,n.assertFalse)(e)}if(void 0!==c.at(S+1,h)){const e="calc.parse.runTokenParser: internal error: expected no tokens following End";return(0,n.assertFalse)(e)}const y=f.value.output,F=h.spans,b=(0,i.buildAnnotations)(e,y,s,null==u?void 0:m);return(0,i.formula)(y,F,b)};const n=r(6913),i=r(6592),a=r(8853),o=r(8882),s=r(5893),u=r(9119),l=r(1368),c=r(7203),d=r(7307),m=r(3040),g=r(7978),p=(0,l.apply)((0,l.tuple)(a.parseWhitespace,(0,l.lazy)((()=>t.parseFormula)),a.parseWhitespace),((e,[t,r,i])=>{const a=(0,d.getNodeSpan)(e,r);return(0,n.assertTrue)("calc.parse.parseSpFormula",!(a.pre.length>0&&t.length>0)),(0,n.assertTrue)("calc.parse.parseSpFormula",!(a.post.length>0&&i.length>0)),t.length>0&&([a.pre,a.preComments]=(0,d.addWhitespace)(e,t)),i.length>0&&([a.post,a.postComments]=(0,d.addWhitespace)(e,i)),r})),h=(0,l.apply)((0,l.tuple)(a.parseLeftParen,(0,d.withDelim)(g.DelimId.Paren,d.ListSep.Union,g.TokenContext.InParen,(0,l.tuple)(p,(0,l.opt)(a.parseRightParen,void 0))),a.parseCharIndex),((e,[t,[r,n],a])=>(0,i.parenNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,a,"","")))),f=(0,l.many1)(p,(0,l.right)(a.parseColSep,p)),S=(0,l.many1)(f,(0,l.right)(a.parseRowSep,f)),v=(0,l.apply)((0,l.tuple)(a.parseLeftBrace,(0,d.withDelim)(g.DelimId.Brace,d.ListSep.Union,g.TokenContext.InArray,(0,l.tuple)(S,(0,l.opt)(a.parseRightBrace,void 0))),a.parseCharIndex),((e,[t,[r,n],a])=>(0,i.arrayNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,a,"",""))));function y(e){return(0,l.take)(((t,r)=>e(r)?(0,i.badCharsNode)(i.BadType.Unexpected,r.chars,(0,d.addSpan)(t,r.start,r.start+r.chars.length,"","")):void 0))}const F=(0,l.apply)((0,l.tuple)(a.parseCharIndex,y(g.isLeftBracketToken),(0,d.withDelim)(g.DelimId.Bracket,d.ListSep.Union,g.TokenContext.Normal,(0,l.tuple)(p,(0,l.opt)(y(g.isRightBracketToken),void 0))),a.parseCharIndex),((e,[t,r,[n,a],o])=>{const s=[r,n];return null!=a&&s.push(a),(0,i.badSequenceNode)(i.BadType.Unexpected,s,(0,d.addSpan)(e,t,o,"",""))})),b=(0,l.take)(((e,t)=>{switch(t.kind){case g.TokenKind.End:case g.TokenKind.Operator:case g.TokenKind.Spaces:case g.TokenKind.SingleLineComment:case g.TokenKind.MultiLineComment:return;case g.TokenKind.Sep:if(t.value===g.SepId.Dot)return;if(t.value===g.SepId.Qual||t.value===g.SepId.Assign)break;if(e.delim.delimId===g.DelimId.Brace||t.value!==g.SepId.Col&&t.value!==g.SepId.Row)return;break;case g.TokenKind.Right:if(t.value!==g.DelimId.SQuote&&e.delim.stack[t.value])return}return(0,i.badCharsNode)(i.BadType.Unexpected,t.chars,(0,d.addSpan)(e,t.start,t.start+t.chars.length,"",""))})),C=(0,l.any)(c.parseRef,s.parseLiteral,h,v,o.parseFieldRef,m.parseStructRef,F,c.parseUnqualBadRef,b);function k(e){return(0,l.tuple)(a.parseLeftParen,(0,d.withDelim)(g.DelimId.Paren,d.ListSep.Arg,g.TokenContext.InParen,(0,l.tuple)((0,l.apply)((0,l.many1)(e,(0,l.right)(a.parseListSep,e)),((e,t)=>t.map((e=>e.kind===i.NodeKind.Missing?(0,i.literalNode)(i.missingOper,!0,e.label):e)))),(0,l.opt)(a.parseRightParen,void 0))),a.parseCharIndex)}const E=(0,l.apply)(k(p),((e,[t,[r,n],i])=>(0,u.argsTerm)(r,void 0!==n,t.start,i))),A=(0,l.apply)(k((0,l.any)((0,l.lazy)((()=>t.parseSpParam)),p)),((e,[t,[r,n],i])=>(0,u.lambdaArgsTerm)(r,void 0!==n,t.start,i))),T=(0,l.take)(((e,t)=>t.kind!==g.TokenKind.Operator||t.value!==i.OperatorId.Percent&&t.value!==i.OperatorId.Pound?void 0:t)),R=(0,l.take)(((e,t)=>t.kind===g.TokenKind.Operator||(0,g.isDotSepToken)(t)?t:function(e,t){return t.kind===g.TokenKind.Sep&&t.value===g.SepId.List&&e.delim.listSep===d.ListSep.Union?(0,g.operatorToken)(t.start,e.localeInfo.listSeparator,i.OperatorId.Union):void 0}(e,t))),N=(0,l.many)((0,l.take)(((e,t)=>(0,g.isWhitespaceToken)(t)?t:void 0))),I=(0,l.any)((0,l.concat)((0,l.bind)((0,l.any)(C,T),((e,t)=>{const r=(0,u.isWSFNode)(e.localeInfo,t);return r?.id===i.WorksheetFuncId.LAMBDA?(0,l.concat)((0,l.parseSucceed)([t]),(0,l.opt)((0,l.tuple)(A),[])):(0,l.parseSucceed)([t])})),(0,l.many)((0,l.any)(E,o.parseFieldRef,m.parseStructRef))),(0,l.tuple)(R)),P=(0,l.flatten)((0,l.many1)(I,(0,l.concat)(N,I)));t.parseFormula=(0,l.apply)((0,l.tuple)((0,l.opt)(P,void 0),a.parseCharIndex),((e,[t,r])=>{if(null==t){const t=(0,d.addSpan)(e,r,r,"","");return(0,i.missingNode)("",t)}const n=t;return n.push((0,g.endToken)(r)),(0,u.runOperatorPrecedenceParser)(e,n)}));const O=(0,l.applyTake)((0,l.tuple)(c.parseRef),((e,[t])=>{const r=t.kind===u.TermKind.MaybeWSFTerm?t.node:t;if((0,i.isUnqualifiedNameNode)(r))return(0,i.identNode)(r.whole,r.label)})),M=(0,l.apply)((0,l.many1)((0,l.take)(((e,t)=>t.isIdentContinue||(0,g.isDotSepToken)(t)?t:void 0))),((e,t)=>{const r=t[0].start,n=t.map((e=>e.chars)).join(""),a=(0,d.addSpan)(e,r,r+n.length,"","");return(0,i.badCharsNode)(i.BadType.ParamName,n,a)})),D=(0,l.peek)(((e,t)=>{const r=t.start;return(0,i.missingNode)("",(0,d.addSpan)(e,r,r,"",""))})),w=(0,l.applyTake)((0,l.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,d.withDelim)(g.DelimId.Bracket,d.ListSep.Union,g.TokenContext.Normal,(0,l.tuple)(a.parseWhitespace,(0,l.any)(O,M,D),a.parseWhitespace,(0,l.opt)(a.parseRightBracket,void 0))),a.parseCharIndex),((e,[t,r,[n,a,o,s],u])=>{const l=(0,d.getNodeSpan)(e,a);return[l.pre,l.preComments]=(0,d.addWhitespace)(e,n),[l.post,l.postComments]=(0,d.addWhitespace)(e,o),(0,i.paramName)(a,!0,void 0!==s,(0,d.addSpan)(e,t,u,"",""))})),_=(0,l.applyTake)((0,l.tuple)(a.parseCharIndex,O,a.parseCharIndex),((e,[t,r,n])=>{const a=r.whole,{localeInfo:o}=e,s=a.length>6&&0===o.stringCompareCI(a.substring(0,6),"_xlop.");return(0,i.paramName)(r,s,!0,(0,d.addSpan)(e,t,n,"",""))})),L=(0,l.apply)((0,l.tuple)(a.parseWhitespace,a.parseCharIndex,a.parseAssignToken,a.parseWhitespace,(0,l.lazy)((()=>t.parseFormula)),a.parseCharIndex),((e,[t,r,n,a,o,s])=>{const u=(0,d.getNodeSpan)(e,o);return[u.pre,u.preComments]=(0,d.addWhitespace)(e,a),(0,i.paramDefault)(o,(0,d.addSpan)(e,r,s,t,""))})),x=(0,l.lazy)((()=>(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaDefaultParameters)?L:(0,l.parseFail)()));t.parseSpParam=(0,l.applyTake)((0,l.tuple)(a.parseWhitespace,a.parseCharIndex,(0,l.bind)((0,l.any)(_,w),((e,t)=>t.isClosed?(0,l.apply)((0,l.opt)(x,void 0),((e,r)=>[t,r])):(0,l.parseSucceed)([t,void 0]))),a.parseCharIndex,a.parseWhitespace,(0,l.peek)(((e,t)=>t))),((e,[t,r,[n,a],o,s,u])=>{if(void 0!==a||u.kind===g.TokenKind.End&&n.isBracketed||(0,g.isListSepToken)(u))return(0,i.paramNode)(n,a,(0,d.addSpan)(e,r,o,t,s))}))},5893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;const n=r(6592),i=r(8853),a=r(9119),o=r(1368),s=r(7307),u=r(7978),l=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind!==n.OperKind.Boolean?t:t.kind===u.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,u.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0)),c=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind===n.OperKind.Boolean?t:void 0));t.parseLiteral=(0,o.apply)((0,o.tuple)((0,o.any)(l,(0,o.left)(c,(0,o.fails)(i.parseDotSepTokenNotFollowedByLeftBracket))),i.parseCharIndex),((e,[t,r])=>{const i=(0,s.addSpan)(e,t.start,r,"","");if((0,u.isBadNumberOper)(t.oper))return(0,n.badCharsNode)(n.BadType.NumberLiteral,t.chars,i);if((0,u.isBadErrorOper)(t.oper))return(0,n.badCharsNode)(n.BadType.ErrorLiteral,t.chars,i);if((0,n.isStringOper)(t.oper)&&t.oper.value.length>n.cellStringLimit)return(0,n.badCharsNode)(n.BadType.StringLiteral,t.chars,i);const o=(0,n.literalNode)(t.oper,t.hasRight,i);return(0,n.isBooleanOper)(t.oper)?(0,a.maybeWSFTerm)(o,t.chars):o}))},9119:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermKind=void 0,t.lambdaArgsTerm=function(e,t,r,n){return{kind:u.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:u.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=l,t.structRefTerm=function(e,t,r){return{kind:u.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:u.MaybeWSFTerm,node:e,whole:t}},t.isWSFNode=K,t.runOperatorPrecedenceParser=function(e,t){let r=t.length-1;if(r<1){const e="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,n.assertFalse)(e)}if(t[r].kind!==s.TokenKind.End){const e="calc.parse.runTermParser: internal error: array[n].kind !== End";return(0,n.assertFalse)(e)}if(1===r&&c(t[0]))return t[0];if(d(t[0])){const e="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment";return(0,n.assertFalse)(e)}if(d(t[r-1])){const e="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment";return(0,n.assertFalse)(e)}for(;;){const i=new a.ArraySeq(t),o=(0,a.runParser)(de,i,0,e);if((0,n.isSuccess)(o)&&o.value.index>=r)return o.value.output;if(!(0,n.isSuccess)(o)||0===o.value.index||1===o.value.index&&c(t[0])){const e=`calc.parse.runTermParser: internal error: consumed ${(0,n.isSuccess)(o)?o.value.index:0} out of ${r}`;return(0,n.assertFalse)(e)}r=(t=[o.value.output,...t.slice(o.value.index)]).length-1}};const n=r(6913),i=r(6592),a=r(1368),o=r(7307),s=r(7978);var u;function l(e,t,r,n){return{kind:u.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function c(e){return e.kind!==s.TokenKind.Operator&&e.kind!==s.TokenKind.Sep&&e.kind!==s.TokenKind.End&&e.kind!==s.TokenKind.Spaces&&e.kind!==s.TokenKind.SingleLineComment&&e.kind!==s.TokenKind.MultiLineComment&&!(e.kind in u)}function d(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}function m(e,t){return c(t=t.kind===u.MaybeWSFTerm?t.node:t)?(0,o.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(u||(t.TermKind=u={}));const g=(0,a.many)((0,a.take)(((e,t)=>d(t)?t:void 0))),p=(0,a.many1)((0,a.take)(((e,t)=>d(t)?t:void 0))),h=(0,a.peek)(((e,t)=>t)),f=function(e,t,r,i,a){const o=e.at(t,r);if(void 0===o){const e=`calc.parse.pStart: internal error: expected term at ${t}`;return(0,n.assertFalse)(e)}return i(m(r,o),t)};function S(e){return(0,a.apply)((0,a.tuple)(g,f,(0,a.take)(e),f,g),((e,[t,r,n,a,s])=>(0,i.operatorNode)(n,(0,o.addSpan)(e,r,a,t,s))))}function v(e){return(0,a.apply)((0,a.tuple)(g,f,(0,a.take)(e),f),((e,[t,r,n,a])=>(0,i.operatorNode)(n,(0,o.addSpan)(e,r,a,t,""))))}function y(e){return(0,a.apply)((0,a.tuple)(f,(0,a.take)(e),f,g),((e,[t,r,n,a])=>(0,i.operatorNode)(r,(0,o.addSpan)(e,t,n,"",a))))}const F=S(((e,t)=>t.kind!==s.TokenKind.Operator||t.value!==i.OperatorId.Add&&t.value!==i.OperatorId.Sub?void 0:t.value)),b=y(((e,t)=>{if(t.kind===s.TokenKind.Operator){if(t.value===i.OperatorId.Add)return i.OperatorId.Pos;if(t.value===i.OperatorId.Sub)return i.OperatorId.Neg}})),C=y(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.At?t.value:void 0)),k=v(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.Pound?t.value:void 0)),E=(0,a.take)(((e,t)=>t.kind===u.StructRefTerm?t:void 0)),A=S(((e,t)=>t.kind!==s.TokenKind.Operator||t.value!==i.OperatorId.Mul&&t.value!==i.OperatorId.Div?void 0:t.value)),T=S(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.Pow?t.value:void 0)),R=v(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.Percent?t.value:void 0)),N=S(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.Concat?t.value:void 0)),I=S(((e,t)=>t.kind===s.TokenKind.Operator&&t.value>=i.OperatorId.Eq&&t.value<=i.OperatorId.Ge?t.value:void 0)),P=S(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.Range?t.value:void 0)),O=S(((e,t)=>t.kind===s.TokenKind.Operator&&t.value===i.OperatorId.Union?t.value:void 0)),M=(0,a.applyTake)((0,a.tuple)(p,h),((e,[t,r])=>{if(!(r.kind===s.TokenKind.End||r.kind===s.TokenKind.Operator&&r.value!==i.OperatorId.At||r.kind===s.TokenKind.Sep&&(0,s.isDotSepToken)(r))){if(1!==t.length||t[0].kind!==s.TokenKind.Spaces)return t;const n=m(e,r),a=(0,o.addSpan)(e,n,n,t[0].chars,"");return(0,i.operatorNode)(i.OperatorId.Isect,a)}})),D=(0,a.take)(((e,t)=>t.kind===s.TokenKind.Sep&&(0,s.isDotSepToken)(t)?t:void 0)),w=(0,a.take)(((e,t)=>t.kind===u.ArgsTerm?t:void 0)),_=(0,a.take)(((e,t)=>t.kind===u.LambdaArgsTerm?t:void 0)),L=(0,a.take)(((e,t)=>t.kind===u.ArgsTerm||t.kind===u.FieldRefTerm?t:void 0)),x={[i.WorksheetFuncId.LETREC]:n.FeatureName.CalcLetRecFunction};function K(e,t){if(t.kind===u.MaybeWSFTerm&&void 0!==t.whole){const r=(0,i.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;if((0,n.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==i.WorksheetFuncId._UDF),0!=((0,i.getWorksheetFuncType)(r).flags&i.FunctionFlags.Internal))return;const a=x[r];if(void 0!==a&&!(0,n.isFeatureEnabled)(a))return;return(0,i.wsfNode)(r,t.whole,t.node.label)}}const B=(0,a.take)(((e,t)=>K(e.localeInfo,t))),W=(0,a.take)(((e,t)=>{const r=K(e.localeInfo,t);return r?.id===i.WorksheetFuncId.LAMBDA?r:void 0})),U=(0,a.apply)((0,a.tuple)(W,_),((e,[t,r])=>{const n=(0,o.getNodeSpan)(e,t).start,a=r.nodes,s=(t.id,[]);let u;const l=[];for(let e=0;e<a.length;e+=1){const t=a[e];t.kind===i.NodeKind.Param?s.push((0,i.lambdaParam)((0,i.indexedArg)(t,e))):e===a.length-1?u=(0,i.indexedArg)(t,e):l.push((0,i.indexedArg)(t,e))}const c=(0,o.addSpan)(e,n,r.end,"","");return(0,i.lambdaNode)(t,s,u,l,r.isClosed,c)})),G=(0,a.apply)((0,a.tuple)(B,w),((e,[t,r])=>{const a=(0,o.getNodeSpan)(e,t).start,s=r.nodes;switch(t.id){case i.WorksheetFuncId.LET:case i.WorksheetFuncId.LETREC:{t.id;const n=[],c=[];let d;for(let t=0;t<s.length;t+=1){const r=s[t];t!==s.length-1?!(t+1<s.length&&(0,i.isUnqualifiedNameNode)(r))||t+3<s.length&&(u=e.refStyle,l=s[t+2],!((0,i.isUnqualifiedNameNode)(l)||u===i.RefStyle.A1&&l.kind===i.NodeKind.CellRef&&void 0===l.qualifier&&l.ref.kind===i.CellRefKind.Single&&l.ref.col.kind===i.PosKind.Rel&&l.ref.row.kind===i.PosKind.Rel))&&(0,i.isUnqualifiedNameNode)(s[t+1])?c.push((0,i.indexedArg)(r,t)):(n.push((0,i.letVar)((0,i.indexedArg)((0,i.varNode)((0,i.identNode)(r.whole,r.parts.label),r.label),t),(0,i.indexedArg)(s[t+1],t+1))),t+=1):d=(0,i.indexedArg)(r,t)}const m=(0,o.addSpan)(e,a,r.end,"","");return(0,i.letNode)(t,n,d,c,r.isClosed,m)}case i.WorksheetFuncId.LAMBDA:return(0,n.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var u,l;return q(e,t,s,r.isClosed,a,r.end)}));function j(e,t,r){return(0,a.apply)((0,a.tuple)((0,a.many)(e),t),((e,[t,n])=>t.reduceRight(r(e),n)))}function V(e,t,r){return(0,a.apply)((0,a.tuple)(e,(0,a.many)(t)),((e,[t,n])=>n.reduce(r(e),t)))}function H(e){return(t,[r,a])=>{if(s=r,Array.isArray(s)){const s=(0,o.getNodeSpan)(e,t);(0,n.assertTrue)("calc.parse.makeAppNodeInfix",0===s.post.length),[s.post,s.postComments]=(0,o.addWhitespace)(e,r);const u=(0,o.getNodeSpan)(e,a),l=(0,o.addSpan)(e,s.start,u.end,"","");return(0,i.badSequenceNode)(i.BadType.Unexpected,[t,a],l)}var s;const u=(0,o.getNodeSpan)(e,t).start,l=(0,o.getNodeSpan)(e,a).end,c=(0,o.addSpan)(e,u,l,"","");return(0,i.appNode)(r,[t,a],!0,c)}}function q(e,t,r,n,a,s){const u=(0,o.addSpan)(e,a,s,"","");return(0,i.appNode)(t,r,n,u)}function z(e){return(t,r)=>{const n=(0,o.getNodeSpan)(e,t).start;switch(r.kind){case u.ArgsTerm:return q(e,t,r.nodes,r.isClosed,n,r.end);case u.FieldRefTerm:{const a=(0,o.addSpan)(e,n,r.end,"",""),{start:s,end:u,pre:l}=(0,o.getNodeSpan)(e,r.rhs);if((0,i.isNumberLiteralNode)(t)){const n=(0,o.addSpan)(e,s,s,"",""),l=(0,i.missingNode)("",n),c=r.rhs.label,d=(0,o.addSpan)(e,s,u,"",""),m=!1,g=(0,i.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,m,d);return(0,i.badSequenceNode)(i.BadType.FieldRef,[t,(0,i.fieldRefNode)(l,g,c)],a)}const c=!r.rhs.isBracketed&&(0,i.shouldFieldRefBeBracketed)(t,r.rhs,l),d=(0,i.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,c,r.rhs.label);return(0,i.fieldRefNode)(t,d,a)}case u.StructRefTerm:{const a=(0,o.addSpan)(e,n,r.end,"","");switch(t.kind){case i.NodeKind.Name:return(0,i.structRefNode)(t,r.rhs,a);case i.NodeKind.Missing:return(0,i.structRefNode)(void 0,r.rhs,a)}return(0,i.badSequenceNode)(i.BadType.StructRef,[t,(0,i.structRefNode)(void 0,r.rhs,(0,o.addSpan)(e,r.start,r.end,"",""))],a)}case i.NodeKind.Operator:return q(e,r,[t],!0,n,(0,o.getNodeSpan)(e,r).end)}}}function Q(e){let t=!0;return(r,n)=>{const a=(0,o.getNodeSpan)(e,n).start,s=(0,o.getNodeSpan)(e,r).end,u=(0,o.addSpan)(e,a,s,"","");if((n.id===i.OperatorId.Pos||n.id===i.OperatorId.Neg)&&t&&(t=!1,(0,i.isNumberLiteralNode)(r)&&""===(0,o.getNodeSpan)(e,n).post)){const t=n.id===i.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,i.literalNode)(t,!0,u)}return(0,i.appNode)(n,[r],!0,u)}}const $=(0,a.take)(((e,t)=>t.kind===u.MaybeWSFTerm?t.node:c(t)?t:void 0)),Y=(0,a.apply)((0,a.tuple)(g,D,f,g),((e,[t,r,n,a])=>(0,i.badCharsNode)(i.BadType.Unexpected,r.chars,(0,o.addSpan)(e,r.start,n,t,a)))),J=(0,a.apply)((0,a.tuple)(f,g,D,f),((e,[t,r,n,a])=>{const s=(0,o.addSpan)(e,a,a,"",""),u=(0,o.addSpan)(e,n.start,a,r,""),c=(0,i.fieldRef)((0,i.missingNode)("",s),!1,!0,!1,u);return l(r.length>0,c,t,a)})),X=(0,a.lazy)((()=>(0,a.apply)((0,a.tuple)(f,(0,a.many)((0,a.any)(U,G,$,Y),(0,a.any)(U,G,$,(0,a.right)((0,a.succeeds)(C),ne))),f),((e,[t,r,n])=>{if(1===r.length)return r[0];const a=(0,o.addSpan)(e,t,n,"","");return 0===r.length?(0,i.missingNode)("",a):(0,i.badSequenceNode)(i.BadType.Unexpected,r,a)})))),Z=V((0,a.lazy)((()=>(0,a.any)((0,a.right)((0,a.succeeds)(C),ne),(0,a.right)((0,a.succeeds)(b),ae),X))),(0,a.any)(k,E),z),ee=V(Z,(0,a.tuple)(P,Z),H),te=V(ee,(0,a.tuple)(M,ee),H),re=V(te,(0,a.any)(L,J),z),ne=j(C,re,Q),ie=V(ne,(0,a.tuple)(O,ne),H),ae=j(b,ie,Q),oe=V(ae,R,z),se=V(oe,(0,a.tuple)(T,oe),H),ue=V(se,(0,a.tuple)(A,se),H),le=V(ue,(0,a.tuple)(F,ue),H),ce=V(le,(0,a.tuple)(N,le),H),de=V(ce,(0,a.tuple)(I,ce),H)},7642:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;const n=r(6913),i=r(6592),a=r(8853),o=r(1368),s=r(7307),u=r(7978);function l(e){return e.kind===u.TokenKind.Literal&&e.oper.kind===i.OperKind.Boolean}const{codePointFullStop:c}=n.codePoint,d=(0,o.opt)((0,o.takePeek)(((e,t,r)=>t.kind!==u.TokenKind.Spaces||(0,u.isWhitespaceToken)(r)?void 0:t.chars)),""),m=(0,o.take)(((e,t)=>t.isIdentContinue&&!l(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==c?t.chars:void 0)),g=(0,o.take)(((e,t)=>t.isIdentContinue||(0,u.isDotSepToken)(t)?t.chars:void 0)),p=(0,o.apply)((0,o.many1)(m,g),((e,t)=>t.join(""))),h=(0,o.apply)((0,o.many1)((0,o.take)(((e,t)=>t.kind===u.TokenKind.Ident?t.chars:t.kind===u.TokenKind.Escape?"":void 0))),((e,t)=>t.join(""))),f=(e,t)=>(t.path??"")+e.leftBracket+t.document+e.rightBracket;function S(e,t,r,n,a,o){let s,u;if(null==t)null==n?(s=(0,i.identQualifier)(r,a,o),u=r):(s=(0,i.sheetRangeQualifier)(r,n,void 0,a,o),u=`${r}:${n}`);else{const l=f(e.localeInfo,t);null==n?(s=(0,i.sheetQualifier)(r,t,a,o),u=`${l}${r}`):(s=(0,i.sheetRangeQualifier)(r,n,t,a,o),u=`${l}${r}:${n}`)}return[s,a?(0,i.quoteQualifier)(u):u]}const v=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Ident||(0,u.isRangeOpToken)(t)?t.chars:t.kind===u.TokenKind.Escape?"":void 0)),y=(0,o.apply)((0,o.tuple)(a.parseCharIndex,(0,o.many)(v),a.parseLeftBracket,(0,o.many1)(v),a.parseRightBracket,a.parseCharIndex),((e,[t,r,n,a,o,u])=>{const l=r.join(""),c=a.join("");return(0,i.documentQualifier)(c,""!==l?l:void 0,!0,(0,s.addSpan)(e,t,u,"",""))})),F=(0,o.apply)((0,o.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,o.many1)(g),a.parseRightBracket,a.parseCharIndex),((e,[t,r,n,a,o])=>{const u=n.join("");return(0,i.documentQualifier)(u,void 0,!1,(0,s.addSpan)(e,t,o,"",""))})),b=(0,o.apply)((0,o.tuple)(a.parseCharIndex,(0,o.opt)(F,void 0),p,(0,o.opt)((0,o.right)(a.parseRangeOp,p),void 0),a.parseCharIndex),((e,[t,r,n,i,a])=>S(e,r,n,i,!1,(0,s.addSpan)(e,t,a,"","")))),C=(0,o.apply)((0,o.tuple)(a.parseLeftSQuote,(0,s.withTokenContext)(u.TokenContext.InQuotedQual,(0,o.tuple)((0,o.opt)(y,void 0),h,(0,o.opt)((0,o.right)(a.parseRangeOp,h),void 0),a.parseRightSQuote)),a.parseCharIndex),((e,[t,[r,n,i,a],o])=>S(e,r,n,i,!0,(0,s.addSpan)(e,t.start,o,"","")))),k=(0,o.apply)(F,((e,t)=>[t,f(e.localeInfo,t)])),E=(0,o.apply)((0,o.tuple)(a.parseLeftSQuote,(0,s.withTokenContext)(u.TokenContext.InQuotedQual,(0,o.tuple)(y,a.parseRightSQuote)),a.parseCharIndex),((e,[t,[r,n],a])=>[(0,i.documentQualifier)(r.document,r.path,!0,(0,s.addSpan)(e,t.start,a,"","")),(0,i.quoteQualifier)(f(e.localeInfo,r))])),A=(0,o.take)(((e,t)=>t.kind===u.TokenKind.End||t.kind===u.TokenKind.Right&&t.value===u.DelimId.SQuote?void 0:t.chars)),T=(0,o.bind)((0,o.tuple)(a.parseLeftSQuote,(0,s.withTokenContext)(u.TokenContext.InQuotedQual,(0,o.tuple)((0,o.many)(A),(0,o.opt)(a.parseRightSQuote,void 0)))),((e,[t,[r,n]])=>{const u=void 0!==n;return(0,o.apply)((0,o.tuple)(u?(0,o.opt)((0,o.tuple)(a.parseQualSep,d),[void 0,""]):(0,o.parseSucceed)([void 0,""]),a.parseCharIndex),((e,[[n,a],o])=>{const l=void 0!==n,c=`'${r.join("")}${u?"'":""}${l?"!":""}`,d=(0,s.addSpan)(e,t.start,o-a.length,"",a);return[(0,i.badQualifier)(c,!0,u,l,d),c]}))})),R=(0,o.take)(((e,t)=>{if((0,u.isRefErrorToken)(t)){const r=(0,s.addSpan)(e,t.start,t.start+t.chars.length,"","");return[(0,i.errorQualifier)(r),t.chars]}})),N=(0,o.peek)(((e,t)=>{const r=(0,s.addSpan)(e,t.start,t.start,"","");return[(0,i.relativeQualifier)(r),""]})),I=(0,o.apply)((0,o.tuple)((0,o.any)(b,C,k,E,N),a.parseQualSep,d),((e,[[t,r],i,a])=>{const o=(0,s.getNodeSpan)(e,t);return o.end+=1,(0,n.assertTrue)("calc.parse.parseGoodQualifier",o.end===i.start+i.chars.length),(0,n.assertTrue)("calc.parse.parseGoodQualifier",0===o.post.length),o.post=a,[t,`${r}!`]})),P=(0,o.take)(((e,t)=>t.isIdentContinue||(0,u.isDotSepToken)(t)||l(t)||function(e){return e.kind===u.TokenKind.Literal&&(0,u.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0)),O=(0,o.apply)((0,o.tuple)(a.parseCharIndex,(0,o.many)(P),a.parseQualSep,a.parseCharIndex,d),((e,[t,r,n,a,o])=>{const u=`${r.join("")}!`,l=(0,s.addSpan)(e,t,a,"",o);return[(0,i.badQualifier)(u,!1,!0,!0,l),u]}));t.parseQualifier=(0,o.any)(R,I,O,T)},7203:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=void 0,t.isCompleteCellRefToken=p;const n=r(6913),i=r(6592),a=r(8853),o=r(8882),s=r(9119),u=r(7642),l=r(1368),c=r(7307),d=r(7978);function m(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==i.SpecialPos.A1BadDollar&&t.col!==i.SpecialPos.A1BadDollar}function g(e){return e.refStyle===i.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function p(e,t){return t.kind===d.TokenKind.CellRef&&m(e,t)&&g(t)}const h=(0,i.pos)(i.PosKind.Rel,0);function f(e){return e===i.SpecialPos.RCNoNum?h:e}function S(e,t){if(e.row!==i.SpecialPos.A1BadDollar&&e.col!==i.SpecialPos.A1BadDollar){const r=e.refStyle===i.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,i.cellRefSingle)(f(e.row),f(e.col),r,t);if(null!=e.row){const n=f(e.row);return(0,i.cellRefRow)(n,n,r,t)}if(null!=e.col){const n=f(e.col);return(0,i.cellRefCol)(n,n,r,t)}}const r=`calc.parse.cellRefToken2cellRef: bad token ${(0,n.anonymize)(e)}`;return(0,n.assertFalse)(r)}function v(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,n.stringCodePointAt)(t.chars,0))}const y=(0,l.take)(((e,t)=>p(e,t)&&!v(e,t)||(0,d.isRefErrorToken)(t)?t:void 0)),F=(0,l.take)(((e,t)=>p(e,t)&&v(e,t)?t:void 0)),b=(0,l.apply)((0,l.tuple)((0,l.any)(y,(0,l.withState)((e=>e.cellRefMustBeCellRefNode?F:(0,l.left)(F,(0,l.fails)((0,l.any)(a.parseIdentContinue,a.parseDotSepTokenNotFollowedByLeftBracket)))))),a.parseCharIndex),((e,[t,r])=>{const n=t.kind===d.TokenKind.CellRef?S(t,(0,c.addSpan)(e,t.start,r,"","")):(0,i.cellRefError)((0,c.addSpan)(e,t.start,r,"","")),a=t.kind===d.TokenKind.CellRef?t.chars:void 0;return(0,s.maybeWSFTerm)((0,i.cellRefNode)(n,void 0,(0,c.addSpan)(e,t.start,r,"","")),a)})),C=(0,l.takePeek)(((e,t,r)=>t.kind!==d.TokenKind.CellRef||!m(e,t)||function(e,t,r){return r.kind===d.TokenKind.Left&&r.value===d.DelimId.Paren&&t.isIdentContinue&&null!=(0,i.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start])),k=(0,l.bind)((0,l.tuple)(C,a.parseSpacesOnly,a.parseRangeOp,a.parseSpacesOnly,C),((e,[[t,r],n,a,o,[u,m]])=>{const g=(0,c.addSpan)(e,t.start,r,"",n),p=(0,c.addSpan)(e,u.start,m,o,""),h=S(t,g),f=S(u,p);let v;if(h.kind===i.CellRefKind.Single&&f.kind===i.CellRefKind.Single){const r=(0,c.addSpan)(e,t.start,m,"","");v=(0,i.cellRefRange)(h,f,r)}else if(0===n.length&&0===o.length)if(h.kind===i.CellRefKind.Row&&f.kind===i.CellRefKind.Row){const r=h.isBracketed||f.isBracketed,n=(0,c.addSpan)(e,t.start,m,"","");v=(0,i.cellRefRow)(h.row1,f.row1,r,n)}else if(h.kind===i.CellRefKind.Col&&f.kind===i.CellRefKind.Col){const r=h.isBracketed||f.isBracketed,n=(0,c.addSpan)(e,t.start,m,"","");v=(0,i.cellRefCol)(h.col1,f.col1,r,n)}if(null==v)return(0,l.parseFail)();const y=(0,s.maybeWSFTerm)((0,i.cellRefNode)(v,void 0,(0,c.addSpan)(e,t.start,m,"","")),void 0);return t.isIdentContinue&&u.isIdentContinue?(0,l.peek)(((e,t)=>t.kind===d.TokenKind.Sep&&t.value===d.SepId.Qual?void 0:y)):(0,l.parseSucceed)(y)})),E=(0,l.any)(k,b);t.parseUnqualBadRef=(0,l.apply)((0,l.take)(((e,t)=>t.kind===d.TokenKind.CellRef?t:void 0)),((e,t)=>{const r=t.start+t.chars.length,n=t.refStyle===i.RefStyle.R1C1&&!t.isIdentContinue;return(0,s.maybeWSFTerm)((0,i.cellRefNode)((0,i.cellRefBad)(t.chars,n,(0,c.addSpan)(e,t.start,r,"","")),void 0,(0,c.addSpan)(e,t.start,r,"","")),t.chars)}));const A=(0,l.take)(((e,t)=>t.kind===d.TokenKind.Ident&&e.localeInfo.isIdentStart((0,n.stringCodePointAt)(t.chars,0))||t.kind===d.TokenKind.CellRef&&v(e,t)?t:void 0)),T=(0,l.take)(((e,t)=>t.kind===d.TokenKind.Literal&&t.oper.kind===i.OperKind.Boolean?t:void 0)),R=(0,l.any)(A,(0,l.left)(T,(0,l.succeeds)(a.parseDotSepTokenNotFollowedByLeftBracket))),N=(0,l.peek)(((e,t)=>(0,d.isLeftBracketToken)(t))),I=(0,l.tuple)((0,l.many1)(R,a.parseIdentContinue),(0,l.many)((0,l.any)(a.parseIdentContinue,a.parseDotSepTokenNotFollowedByLeftBracket)),N,a.parseCharIndex),P=(0,l.apply)(I,(function(e,[t,r,a,u]){const l=t[0],p=1===t.length&&r[0]?.kind===d.TokenKind.Sep,h=l.kind!==d.TokenKind.CellRef||(f=l).refStyle===i.RefStyle.A1&&null==f.row&&"object"==typeof f.col&&f.col.kind===i.PosKind.Rel||function(e,t){return t.refStyle===i.RefStyle.A1&&e.refStyle===i.RefStyle.A1&&t.isIdentContinue||t.refStyle===i.RefStyle.R1C1&&(0,i.isR1C1IdentStart)(t.row,t.col)}(e,l)&&p;var f;if(a||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===d.TokenKind.Literal||r.some(((t,r)=>r%2==0?t.kind!==d.TokenKind.Sep:t.kind===d.TokenKind.Sep||!(0,o.isUnbracketedFieldName)(e.localeInfo,t.chars)))}(e,t,r)){const n=[...t,...r].map((e=>e.chars)).join(""),a=(0,c.addSpan)(e,l.start,u,"",""),o=(0,c.addSpan)(e,l.start,u,"",""),d=(0,i.identNamePart)(n,h,a,o),m=(0,i.nameNode)(d,void 0,(0,c.addSpan)(e,l.start,u,"",""));return(0,s.maybeWSFTerm)(m,m.whole)}let v,y=h,F=0,b=r[F]?.start??u,C=(0,c.addSpan)(e,l.start,b,"",""),k=(0,c.addSpan)(e,l.start,b,"","");if(1===t.length&&l.kind===d.TokenKind.CellRef)if(m(e,l))if(g(l)){const t=S(l,(0,c.addSpan)(e,l.start,b,"",""));v=(0,i.cellRefNamePart)(t,l.chars,C,k)}else v=(0,i.identNamePart)(l.chars,y,C,k);else y=!1,v=(0,i.identNamePart)(l.chars,y,C,k);else{let n=t.map((e=>e.chars)).join("");(0===e.localeInfo.stringCompareCI(n,"_xlpm")||0===e.localeInfo.stringCompareCI(n,"_xleta")||0===e.localeInfo.stringCompareCI(n,"_xlop"))&&F+1<r.length&&(n+="."+r[F+1].chars,F+=2,b=r[F]?.start??u,C=(0,c.addSpan)(e,l.start,b,"",""),k=(0,c.addSpan)(e,l.start,b,"","")),v=(0,i.identNamePart)(n,y,C,k)}let E=v;for(;F+1<r.length;F+=2){const t=r[F],n=r[F+1],a=r[F+2]?.start??u;E=(0,i.fieldRefNamePart)(E,(0,i.fieldRef)((0,i.identNode)(n.chars,(0,c.addSpan)(e,n.start,a,"","")),!1,!0,!1,(0,c.addSpan)(e,t.start,a,"","")),F+2>=r.length?h:y,(0,c.addSpan)(e,l.start,a,"",""),(0,c.addSpan)(e,l.start,a,"",""))}if(F<r.length){const t=r[F],n=r[F+1]?.start??u,a=(0,i.fieldRef)((0,i.missingNode)("",(0,c.addSpan)(e,n,n,"","")),!1,!0,!1,(0,c.addSpan)(e,t.start,n,"",""));E=(0,i.fieldRefNamePart)(E,a,h,(0,c.addSpan)(e,l.start,n,"",""),(0,c.addSpan)(e,l.start,n,"","")),F+=1}(0,n.assertTrue)("calc.parse.pUnqualName: i == tailTokens",F===r.length),E.kind===i.NamePartKind.CellRefNamePart&&(0,n.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");const A=(0,i.nameNode)(E,void 0,(0,c.addSpan)(e,l.start,u,"",""));return(0,s.maybeWSFTerm)(A,A.whole)})),O=(0,l.opt)((0,l.any)(E,P,t.parseUnqualBadRef),{node:void 0}),M=(0,l.any)(E,(0,l.right)((0,l.fails)(P),t.parseUnqualBadRef)),D=(0,l.bind)(u.parseQualifier,((e,[t,r])=>(0,l.apply)(t.kind===i.QualifierKind.SheetRange?(0,c.cellRefMustBeCellRefNode)(t.isQuoted?O:M):t.kind===i.QualifierKind.Error?(0,c.cellRefMustBeCellRefNode)(O):O,((e,{node:a})=>{if(null==a)return t.kind===i.QualifierKind.Error?(0,i.literalNode)(i.refErrorOper,!0,t.label):(0,i.badCharsNode)(i.BadType.Qualifier,r,t.label);const o=(0,c.getNodeSpan)(e,t).start,s=(0,c.getNodeSpan)(e,a).end;if(a.kind===i.NodeKind.Name){const r=(0,c.addSpan)(e,o,s,"","");if(t.kind===i.QualifierKind.Error){const e=(0,i.literalNode)(i.refErrorOper,!0,t.label);return(0,i.badSequenceNode)(i.BadType.Unexpected,[e,a],r)}return(0,n.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==i.QualifierKind.SheetRange||t.isQuoted),t.kind===i.QualifierKind.SheetRange&&void 0===t.document&&(t=(0,i.identQualifier)(`${t.sheet1}:${t.sheet2}`,t.isQuoted,t.label)),(0,i.nameNode)(function(e,t,r){let n=t;for(;(0,c.getSpan)(e,n.qualifiedLabel).start=r,n.kind===i.NamePartKind.FieldRefNamePart;)n=n.lhs;return t}(e,a.parts,o),t,r)}const u=(0,c.addSpan)(e,o,s,"","");return t.kind===i.QualifierKind.Ident&&(t=(0,i.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,i.cellRefNode)(a.ref,t,u)})))),w=(0,l.apply)((0,l.any)(E,P),((e,t)=>t.node.kind===i.NodeKind.CellRef&&t.node.ref.kind===i.CellRefKind.Error?(0,i.literalNode)(i.refErrorOper,!0,t.node.label):t));t.parseRef=(0,l.any)(D,w)},4489:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=void 0;const n=r(6913),i=r(6592);function a(e,t){const r=e[t];return(0,n.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}class o extends i.IdentityVisitor{letNode(e,t,r,n,a,o){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let r=0;r<t.length;r+=1){const{binder:n}=t[r];if(this.caretInNode(n.arg)){this.pushNames(e.id===i.WorksheetFuncId.LET?t.slice(0,r):t);break}}return super.letNode(e,t,r,n,a,o)}lambdaNode(e,t,r,n,i,a){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let e=0;e<t.length;e+=1){const{name:r}=t[e];if(void 0!==r.arg.def&&this.caretInNode(r.arg.def.rhs)){this.pushNames(t.slice(0,e));break}}return super.lambdaNode(e,t,r,n,i,a)}caretInNode(e){if(void 0===e)return!1;const t=this.formula.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end}pushNames(e){(0,n.safePush)(this.references,e.map((({name:e})=>e.arg.wholeName)).filter(n.isDefined).reverse())}constructor(e,t){super(),this.formula=e,this.caretPosition=t,this.references=[]}}function s(e,t,r,o,s=!1,u,l){if(!(0,n.isSuccess)(e))return!1;try{!function(e,t,r,o,s,u,l){if(null==e||null==o)return;const c={};null!=r?r.forEach((e=>{c[e]=!0})):c["*"]=!0;const d={};{let t=0;const r=[],n={...i.voidVisitor,letNode(n,i,o,s,u,l){for(const{name:e}of i)d[e.arg.label]=t;r.push({letCount:t,span:a(e.spans,l)}),t+=1},lambdaNode(n,i,o,s,u,l){for(const{name:e}of i)d[e.arg.label]=t;r.push({letCount:t,span:a(e.spans,l)}),t+=1}};(0,i.reduceBottomUp)(n,e),r.sort(((e,t)=>e.span.start-t.span.start));const o={};for(let e=0;e<r.length;e+=1)o[r[e].letCount]=e;for(const e of Object.keys(d).map(Number))d[e]=o[d[e]]}const m={literalNode(e,t,r){const n=i.identityVisitor.literalNode(e,t,r);return g("literal")&&o("literal",{label:r,value:n,valueKind:e.kind}),n},missingNode(e,t){const r=i.identityVisitor.missingNode(e,t);return g("literal")&&o("literal",{label:t,value:(0,i.literalNode)(i.missingOper,!0,t),valueKind:i.OperKind.Missing}),r},arrayNode:(e,t,r)=>i.identityVisitor.arrayNode(e,t,r),appNode(e,t,r,n){const a=i.identityVisitor.appNode(e,t,r,n);return h(e,0,r,n),a},letNode(e,t,r,n,a,s){const u=(0,i.letNode)(e,t,r,n,a,s);h(e,u.args,a,s);for(const{name:e}of t)g("letName")&&o("letName",{label:e.arg.label,name:e.arg.wholeName,number:d[e.arg.label],qualifier:void 0});return u},lambdaNode(e,t,r,n,a,s){const u=(0,i.lambdaNode)(e,t,r,n,a,s);h(e,u.args,a,s);for(const{name:e}of t)g("letName")&&o("letName",{label:e.arg.name.name.label,name:e.arg.wholeName,number:d[e.arg.label],qualifier:void 0});return u},parenNode:(e,t,r)=>i.identityVisitor.parenNode(e,t,r),nameNode(t,r,n){const a=(0,i.nameNode)(t,r,n),s=e.annotations[t.label],u=e.annotations[n];if(u?.kind===i.AnnotationKind.AppHeadName);else if(s?.kind===i.AnnotationKind.LocalNameUse){const e=d[s.label];g("letName")&&null!=e&&o("letName",{label:n,name:s.name,number:e,qualifier:void 0})}else if(g("namedRange")){const e=a.whole.split(".");o("namedRange",{label:n,name:e[0],names:e.slice(1),qualifier:p(a)})}return a},cellRefNode(t,r,n){const s=(0,i.cellRefNode)(t,r,n);return g("range")&&function(t){if(null!=e&&null!=o)switch(t.ref.kind){case i.CellRefKind.Error:break;case i.CellRefKind.Col:const r=t.ref;o("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:a(e.spans,r.label),qualifier:p(t)});break;case i.CellRefKind.Row:const n=t.ref;o("range",{label:t.label,type:"row",startIndex:n.row1,endIndex:n.row2,span:a(e.spans,n.label),qualifier:p(t)});break;case i.CellRefKind.Single:const s=t.ref;o("range",{label:t.label,type:"cell",row:s.row,col:s.col,span:a(e.spans,s.label),qualifier:p(t)});break;case i.CellRefKind.Range:const u=t.ref;o("range",{label:t.label,type:"range",top:u.ref1.row,left:u.ref1.col,bottom:u.ref2.row,right:u.ref2.col,topLeftSpan:a(e.spans,u.ref1.label),bottomRightSpan:a(e.spans,u.ref2.label),qualifier:p(t)})}}(s),s},fieldRefNode:(e,t,r)=>i.identityVisitor.fieldRefNode(e,t,r),structRefNode(t,r,s){const c=(0,i.structRefNode)(t,r,s);if(g("structRefRange")){if(null==l||null==u)return c;const{resolution:r}=l.resolveStructRef(u,c);if(!(0,n.isSuccess)(r)||void 0===r.value)return c;const d=r.value;o("structRefRange",{label:s,type:"range",top:(0,i.pos)(i.PosKind.Rel,d.range.row),left:(0,i.pos)(i.PosKind.Rel,d.range.col),bottom:(0,i.pos)(i.PosKind.Rel,d.range.row+d.range.rows-1),right:(0,i.pos)(i.PosKind.Rel,d.range.col+d.range.cols-1),span:a(e.spans,s),qualifier:void 0!==t?p(t):void 0,name:void 0!==t?t.whole:void 0})}return c},badSequenceNode:(e,t,r)=>i.identityVisitor.badSequenceNode(e,t,r),badCharsNode:(e,t,r)=>i.identityVisitor.badCharsNode(e,t,r),operatorNode:(e,t)=>i.identityVisitor.operatorNode(e,t),wsfNode:(e,t,r)=>i.identityVisitor.wsfNode(e,t,r)};function g(e){return c[e]||c["*"]}function p(e){if(null!=e.qualifier){const t={};switch(e.qualifier.kind){case i.QualifierKind.Sheet:const r=e.qualifier;t.type="Sheet",t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case i.QualifierKind.SheetRange:const n=e.qualifier;t.type="SheetRange",t.sheet1=n.sheet1,t.sheet2=n.sheet2,null!=n.document&&(t.document=n.document.document,null!=n.document.path&&(t.documentPath=n.document.path));break;case i.QualifierKind.Ident:const a=e.qualifier;t.type="Ident",t.name=a.name;break;case i.QualifierKind.Document:const o=e.qualifier;t.type="Document",t.document=o.document,null!=o.path&&(t.documentPath=o.path)}return t}}function h(e,t,r,n){if(null!=o)switch(e.kind){case i.NodeKind.Operator:g("operator")&&o("operator",{label:n,value:e.id});break;case i.NodeKind.WSF:case i.NodeKind.Name:g("function")&&o("function",{label:n,name:e.whole,isClosed:r,args:[]})}}(0,i.reduceBottomUp)(m,e)}(e.value,o??(0,i.getEnglishLocaleInfo)(),t,r,0,u,l)}catch(e){const t=`ParseResultHelper.traverse: unhandled error ${(0,n.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(507381982,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t)}return!0}t.parseResultHelper={isSuccess:n.isSuccess,traverse:s,extractReferences:function(e,t,r=!1,i,o){if(!(0,n.isSuccess)(e))return;const u=[];return s(e,["range","namedRange","letName","literal","function","structRefRange"],((t,r)=>{const n={kind:t,ref:r,span:a(e.value.spans,r.label)};u.push(n)}),t,r,i,o),u.sort(((e,t)=>{let r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),u},extractLetVariables:function(e,t){if((0,n.isSuccess)(e))try{const r=new o(e.value,t);return(0,i.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){const t=`ParseResultHelper.extractLetVariables: unhandled error ${(0,n.messageFromError)(e)}`;return n.ulsLogger.ULS.traceTag(507381983,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t),[]}}}},3040:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;const n=r(6592),i=r(8853),a=r(9119),o=r(1368),s=r(7307),u=r(7978),l=(0,o.take)(((e,t)=>t.isIdentContinue||t.kind===u.TokenKind.Spaces?t:void 0)),c=(0,o.apply)((0,o.many1)(l),((e,t)=>t.map((e=>e.kind===u.TokenKind.Escape?"":e.chars)).join(""))),d=(0,o.take)(((e,t)=>t.isIdentContinue||t.kind===u.TokenKind.Spaces||t.kind===u.TokenKind.Escape||(0,u.isListSepToken)(t)||(0,u.isRangeOpToken)(t)?t:void 0)),m=(0,o.apply)((0,o.many1)(d),((e,t)=>t.map((e=>e.kind===u.TokenKind.Escape?"":e.chars)).join(""))),g=(0,o.take)(((e,t)=>t.kind===u.TokenKind.SpecialRef?t:void 0)),p=(0,o.apply)((0,o.tuple)(i.parseCharIndex,g,i.parseCharIndex),((e,[t,r,i])=>(0,n.specialRef)(r.value,!1,!0,(0,s.addSpan)(e,t,i,"","")))),h=(0,o.apply)((0,o.tuple)(i.parseCharIndex,i.parseLeftBracket,g,(0,o.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,i,a,o])=>(0,n.specialRef)(i.value,!0,void 0!==a,(0,s.addSpan)(e,t,o,"","")))),f=(0,o.any)(p,h),S=(0,o.apply)((0,o.tuple)(i.parseCharIndex,c,i.parseCharIndex),((e,[t,r,i])=>(0,n.columnRef)(r,!1,!0,(0,s.addSpan)(e,t,i,"","")))),v=(0,o.apply)((0,o.tuple)(i.parseCharIndex,i.parseLeftBracket,(0,o.opt)(m,void 0),(0,o.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,i,a,o])=>(0,n.columnRef)(i??"",!0,void 0!==a,(0,s.addSpan)(e,t,o,"","")))),y=(0,o.apply)((0,o.tuple)(i.parseCharIndex,m,i.parseCharIndex),((e,[t,r,i])=>(0,n.columnRef)(r,!1,!0,(0,s.addSpan)(e,t,i,"","")))),F=(0,o.any)(S,v),b=(0,o.apply)(i.parseCharIndex,((e,t)=>(0,n.missingRef)((0,s.addSpan)(e,t,t,"","")))),C=(0,o.any)(F,b),k=(0,o.take)(((e,t)=>"#"===t.chars?t:void 0)),E=(0,o.apply)((0,o.many1)(k,l),((e,t)=>(0,u.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),A=(0,o.apply)((0,o.many1)(k,d),((e,t)=>(0,u.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),T=(0,o.apply)((0,o.tuple)(i.parseCharIndex,E,i.parseCharIndex),((e,[t,r,i])=>(0,n.badRef)(r.chars,!1,!0,(0,s.addSpan)(e,t,i,"","")))),R=(0,o.apply)((0,o.tuple)(i.parseCharIndex,i.parseLeftBracket,A,(0,o.opt)(i.parseRightBracket,void 0),i.parseCharIndex),((e,[t,r,i,a,o])=>(0,n.badRef)(i.chars,!0,void 0!==a,(0,s.addSpan)(e,t,o,"","")))),N=(0,o.any)(T,R),I=(0,o.apply)((0,o.tuple)(i.parseCharIndex,C,i.parseRangeOp,C,i.parseCharIndex),((e,[t,r,i,a,o])=>(0,n.rangeOpRef)(r,a,(0,s.addSpan)(e,t,o,"","")))),P=(0,o.any)(I,F),O=(0,o.any)(f,N,I,F,b),M=(0,o.apply)((0,o.tuple)(i.parseCharIndex,O,(0,o.many1)((0,o.tuple)(i.parseListSep,O)),i.parseCharIndex),((e,[t,r,i,a])=>(0,n.commaOpRef)([r,...i.map((([e,t])=>t))],(0,s.addSpan)(e,t,a,"","")))),D=(0,o.apply)((0,o.tuple)(i.parseCharIndex,i.parseAtOp,(0,o.opt)(P,void 0),i.parseCharIndex),((e,[t,r,i,a])=>(0,n.thisRowOpRef)(i,(0,s.addSpan)(e,t,a,"","")))),w=(0,o.apply)(i.parseSpacesOnly,(()=>{})),_=(0,o.peek)(((e,t)=>t.kind===u.TokenKind.End||(0,u.isRightBracketToken)(t)?t:void 0)),L=(0,o.any)((0,o.left)(w,_),(0,o.left)(y,_),(0,o.left)(M,_),(0,o.left)(D,_),(0,o.left)(I,_),(0,o.left)(f,_),(0,o.left)(N,_),(0,o.left)(v,_));t.parseStructRef=(0,o.apply)((0,o.tuple)(i.parseLeftBracket,(0,s.withTokenContext)(u.TokenContext.InStructRef,(0,o.tuple)(L,(0,o.opt)(i.parseRightBracket,void 0))),i.parseCharIndex),((e,[t,[r,i],o])=>{const u=t.start,l=void 0!==i;return(0,a.structRefTerm)((0,n.structRef)(r,l,(0,s.addSpan)(e,u,o,"","")),u,o)}))},1368:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArraySeq=void 0,t.runParser=function(e,t,r,i){let a;if(function(e){let t=e;for(;null!=t;)t=t()}(e(t,r,i,(function(e,t){a=(0,n.success)({output:e,index:t})}),(function(){a=(0,n.failure)(void 0)}))),void 0===a){const e="calc.parse.runParser: internal error: parser did not call resolve or reject";return(0,n.assertFalse)(e)}return a},t.lazy=function(e){let t;return function(r,n,i,a,o){const s=t??(t=e());return()=>s(r,n,i,a,o)}},t.setDebugging=function(e){i=e},t.warnSucceedOrFail=function(e,t){return function(r,n,a,o,s){return e(r,n,a,((e,r)=>(i&&console.warn(`${t} succeeded, returning index ${r} with`,e),o(e,r))),(()=>(i&&console.warn(`${t} failed at index ${n}`),s)))}},t.parseSucceed=a,t.parseFail=s,t.bind=u,t.apply=l,t.withState=function(e){return(t,r,n,i,a)=>e(n)(t,r,n,i,a)},t.any=function(...e){return 0===e.length?s():e.reduce(c)},t.opt=function(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(()=>a(t,n)))}},t.succeeds=function(e){return function(t,r,n,i,a){return e(t,r,n,(()=>i(!0,r)),a)}},t.fails=function(e){return function(t,r,n,i,a){return e(t,r,n,a,(()=>i(!0,r)))}},t.take=function(e){return d(e,1)},t.peek=function(e){return d(e,0)},t.takePeek=function(e){return function(t,r,n,i,a){const o=t.at(r,n);if(void 0===o)return a;const s=t.at(r+1,n);if(void 0===s)return a;const u=e(n,o,s);return null==u?a:i(u,r+1)}},t.applyTake=function(e,t){return function(r,n,i,a,o){return e(r,n,i,((e,r)=>{const n=t(i,e);return null==n?o:a(n,r)}),o)}},t.reduce=m,t.many=function(e,t){return void 0===t?function(t,r,n,i,a){return g(e,[])(t,r,n,i,a)}:function(r,n,i,a,o){return e(r,n,i,((e,n)=>g(t,[e])(r,n,i,a,o)),(()=>a([],n)))}},t.many1=function(e,t=e){return u(e,((e,r)=>g(t,[r])))},t.tuple=p,t.left=function(e,t){return l(p(e,t),((e,[t])=>t))},t.right=function(e,t){return l(p(e,t),((e,[,t])=>t))},t.middle=function(e,t,r){return l(p(e,t,r),((e,[,t])=>t))},t.flatten=h,t.concat=function(...e){return h(p(...e))};const n=r(6913);t.ArraySeq=class{at(e,t){return this.elems[e]}constructor(e){this.elems=e}};let i=!1;function a(e){return function(t,r,n,i,a){return i(e,r)}}const o=(e,t,r,n,i)=>i;function s(){return o}function u(e,t){return function(r,n,i,a,o){return e(r,n,i,((e,n)=>t(i,e)(r,n,i,a,o)),o)}}function l(e,t){return function(r,n,i,a,o){return e(r,n,i,((e,r)=>a(t(i,e),r)),o)}}function c(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(()=>t(r,n,i,a,o)))}}function d(e,t){return function(r,n,i,a,o){const s=r.at(n,i);if(void 0===s)return o;const u=e(i,s);return void 0===u?o:a(u,n+t)}}function m(e,t,r){return function(i,a,o,s,u){let l=r,c=a;function d(){return e(i,c,o,m,g)}function m(e,r){if(r<=c){const e=`calc.parse.reduce: internal error: no progress made at index ${c}`;return(0,n.assertFalse)(e)}return l=t(o,e,l),c=r,d}function g(){return s(l,c)}return d}}function g(e,t){return m(e,(function(e,t,r){return r.push(t),r}),t)}function p(...e){if(0===e.length)return a([]);if(1===e.length)return l(e[0],((e,t)=>[t]));const t=e.length;return function(r,n,i,a,o){let s=n;const u=[];function l(){return e[u.length](r,s,i,c,o)}function c(e,r){return s=r,u.push(e),u.length<t?l:a(u,s)}return l}}function h(e){return l(e,((e,t)=>(0,n.safeConcat)([],t)))}},9041:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=function(e){return(0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.Parser2024")?{parseFormula:(t,r,a)=>function(e,t,r,a=0){try{const s=a>=0&&a<r.length?g[r.charCodeAt(a)]:void 0;return null==s?(0,n.failure)((0,o.notFormulaString)("first character is not '=', '+', '-' or '@'")):s<0?(0,n.failure)((0,i.notImplemented)(["Lotus 1-2-3 syntax"])):p(e,t,r,a+s)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}}(e,t,r,a),parseFormulaExpression:(t,r,i)=>function(e,t,r,i=0){try{return p(e,t,r,i)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}}(e,t,r,i)}:(0,u.createParser)(e)};const n=r(6913),i=r(6592),a=r(1712),o=r(8555),s=r(7402),u=r(4059),{codePointEqualsSign:l,codePointPlusSign:c,codePointMinusSign:d,codePointAtSign:m}=n.codePoint,g={[l]:1,[c]:0,[d]:0,[m]:-1};function p(e,t,r,i){const o=t.config?.localeInfo??e.config.localeInfo,u=t.config?.refStyle??e.config.refStyle,l=e.config.mathpack,c=new s.TokenSeq(r,i),d=(0,a.runFormulaParser)(o,l,u,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,c);return(0,n.success)(d)}},7307:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListSep=void 0,t.makeState=function(e,t,r,n,i,s){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:i,syntaxFeatures:s,delim:{delimId:void 0,listSep:o.Union,stack:{[a.DelimId.Paren]:!1,[a.DelimId.Brace]:!1,[a.DelimId.Bracket]:!1}},tokenContext:a.TokenContext.Normal,cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){const r=e.spans[t.label];if(null==r){const e=`calc.parse.getNodeSpan: internal error: expected node to have a span; given ${(0,n.anonymize)(t)}`;(0,n.assertFalse)(e)}return r},t.getSpan=function(e,t){const r=e.spans[t];return(0,n.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r},t.addWhitespace=u,t.addSpan=l,t.withDelim=function(e,t,r,n){return c((n=>{const{delimId:i,listSep:a,stack:o}=n.delim,s=n.tokenContext;return n.delim.delimId=e,n.delim.listSep=t,n.delim.stack={...o,[e]:!0},n.tokenContext=r,{oldDelimId:i,oldListSep:a,oldStack:o,oldTokenContext:s}}),((e,{oldDelimId:t,oldListSep:r,oldStack:n,oldTokenContext:i})=>{e.delim.delimId=t,e.delim.listSep=r,e.delim.stack=n,e.tokenContext=i}),n)},t.withTokenContext=function(e,t){return c((t=>{const r=t.tokenContext;return t.tokenContext=e,r}),((e,t)=>{e.tokenContext=t}),t)},t.cellRefMustBeCellRefNode=function(e){return c((e=>{const t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),((e,t)=>{e.cellRefMustBeCellRefNode=t}),e)};const n=r(6913),i=r(6592),a=r(7978);var o;!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(o||(t.ListSep=o={}));const s=[];function u(e,t){const r="string"==typeof t?s:t.filter(a.isCommentToken);return["string"==typeof t?t:t.map((e=>e.chars)).join(""),r.length>0?r.map((t=>function(e,t){const r=l(e,t.start,t.start+t.chars.length,"","");return t.kind===a.TokenKind.SingleLineComment?(0,i.singleLineComment)(t.chars,r):(0,i.multiLineComment)(t.chars,t.isClosed,r)}(e,t))):void 0]}function l(e,t,r,n,a){const o=e.label;e.label+=1;const[s,l]=u(e,n),[c,d]=u(e,a);return e.spans[o]=(0,i.formulaSpan)(t,r,s,c,l,d),o}function c(e,t,r){return(n,i,a,o,s)=>{const u=e(a);return r(n,i,a,((e,r)=>(t(a,u),o(e,r))),(()=>(t(a,u),s)))}}},8555:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=void 0,t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,i,a){return{config:r??void 0,lexicalKind:e,originGridCell:(0,n.success)(t),contextNames:i,syntaxFeatures:a}},t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}};const n=r(6913),i=r(6592);var a;!function(e){e.NotFormulaString="NotFormulaString"}(a||(a={})),t.ReasonKind={...i.ReasonKind,...a}},7978:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundOperatorToken=t.atOperatorToken=t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.badNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=t.TokenContext=void 0,t.isBadNumberOper=function(e){return e.kind===p.BadNumber},t.isNumberLikeOper=h,t.isBadErrorOper=function(e){return e.kind===p.BadError},t.cellRefA1Token=function(e,t,r,n){return v(e,t,(null==r||"object"==typeof r&&r.kind===i.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===i.PosKind.Rel),r,n,i.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,a=!1){return v(e,t,!(r!==i.SpecialPos.RCNoNum&&null!=r&&r.kind!==i.PosKind.Abs||n!==i.SpecialPos.RCNoNum&&null!=n&&n.kind!==i.PosKind.Abs),r,n,i.RefStyle.R1C1,a)},t.literalToken=y,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?y(r,n,i.falseOper):0===e.stringCompareCI(e.trueName,n)?y(r,n,i.trueOper):(0,t.identToken)(r,n)},t.operatorToken=F,t.isDotSepToken=function(e){return e.kind===d.Sep&&e.value===g.Dot},t.isListSepToken=function(e){return e.kind===d.Sep&&e.value===g.List},t.isRangeOpToken=function(e){return e.kind===d.Operator&&e.value===i.OperatorId.Range},t.isAtOpToken=function(e){return e.kind===d.Operator&&e.value===i.OperatorId.At},t.isRefErrorToken=function(e){return e.kind===d.Literal&&e.oper.kind===i.OperKind.Error&&e.oper.type===i.ErrorType.REF},t.isLeftBracketToken=function(e){return e.kind===d.Left&&e.value===m.Bracket},t.isRightBracketToken=function(e){return e.kind===d.Right&&e.value===m.Bracket},t.isBracketToken=function(e){return(e.kind===d.Left||e.kind===d.Right)&&e.value===m.Bracket},t.isCommentToken=function(e){return e.kind===d.SingleLineComment||e.kind===d.MultiLineComment},t.isWhitespaceToken=function(e){return e.kind===d.Spaces||e.kind===d.SingleLineComment||e.kind===d.MultiLineComment};const n=r(6913),i=r(6592),{codePointAsterisk:a,codePointMinusSign:o,codePointPlusSign:s,codePointSlash:u,codePointSpace:l}=n.codePoint;var c,d,m,g,p;function h(e){return e.kind===p.BadNumber||e.kind===i.OperKind.Number}function f(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}function S(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}function v(e,t,r,n,i,a,o){return{kind:d.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:i,refStyle:a,isBadLocale:o}}function y(e,t,r,c=!0){const m=r.kind===i.OperKind.Boolean||h(r)&&function(e){for(const t of(0,n.codePointIterator)(e))if(t===s||t===o||t===a||t===l||t===u)return!1;return!0}(t);return{kind:d.Literal,start:e,chars:t,isIdentContinue:m,oper:r,hasRight:c}}function F(e,t,r){return{kind:d.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function b(e){const t=i.operatorStrings[e];if(null==t)throw new Error(`operatorTokenMaker: invalid operator ${e}`);return r=>F(r,t,e)}!function(e){e[e.Normal=0]="Normal",e[e.InParen=1]="InParen",e[e.InArray=2]="InArray",e[e.InStructRef=3]="InStructRef",e[e.InQuotedQual=4]="InQuotedQual",e[e.InFieldRef=5]="InFieldRef"}(c||(t.TokenContext=c={})),function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(d||(t.TokenKind=d={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(m||(t.DelimId=m={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(g||(t.SepId=g={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(p||(t.TokenOperKind=p={})),t.badNumberOper={kind:p.BadNumber},t.badErrorOper={kind:p.BadError},t.endToken=e=>f(d.End,e,"",!1),t.spacesToken=(e,t)=>f(d.Spaces,e,t,!1),t.unexpectedToken=(e,t)=>f(d.Unexpected,e,t,!1),t.escapeToken=(e,t)=>f(d.Escape,e,t,!1),t.singleLineCommentToken=(e,t)=>f(d.SingleLineComment,e,t,!1),t.multiLineCommentToken=(e,t,r)=>({kind:d.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}),t.identToken=(e,t)=>f(d.Ident,e,t,!0),t.leftParenToken=e=>S(d.Left,e,"(",m.Paren),t.leftBracketToken=(e,t)=>S(d.Left,e,t,m.Bracket),t.leftBraceToken=(e,t)=>S(d.Left,e,t,m.Brace),t.leftSQuoteToken=e=>S(d.Left,e,"'",m.SQuote),t.rightParenToken=e=>S(d.Right,e,")",m.Paren),t.rightBracketToken=(e,t)=>S(d.Right,e,t,m.Bracket),t.rightBraceToken=(e,t)=>S(d.Right,e,t,m.Brace),t.rightSQuoteToken=e=>S(d.Right,e,"'",m.SQuote),t.listSepToken=(e,t)=>S(d.Sep,e,t,g.List),t.colSepToken=(e,t)=>S(d.Sep,e,t,g.Col),t.rowSepToken=(e,t)=>S(d.Sep,e,t,g.Row),t.qualSepToken=e=>S(d.Sep,e,"!",g.Qual),t.dotSepToken=e=>S(d.Sep,e,".",g.Dot),t.assignSepToken=e=>S(d.Sep,e,":=",g.Assign),t.specialRefToken=(e,t,r)=>S(d.SpecialRef,e,t,r),t.addOperatorToken=b(i.OperatorId.Add),t.subOperatorToken=b(i.OperatorId.Sub),t.mulOperatorToken=b(i.OperatorId.Mul),t.divOperatorToken=b(i.OperatorId.Div),t.powOperatorToken=b(i.OperatorId.Pow),t.percentOperatorToken=b(i.OperatorId.Percent),t.concatOperatorToken=b(i.OperatorId.Concat),t.eqOperatorToken=b(i.OperatorId.Eq),t.ltOperatorToken=b(i.OperatorId.Lt),t.gtOperatorToken=b(i.OperatorId.Gt),t.neOperatorToken=b(i.OperatorId.Ne),t.leOperatorToken=b(i.OperatorId.Le),t.geOperatorToken=b(i.OperatorId.Ge),t.rangeOperatorToken=b(i.OperatorId.Range),t.atOperatorToken=b(i.OperatorId.At),t.poundOperatorToken=b(i.OperatorId.Pound)},7402:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenSeq=void 0,t.tokenizeFormula=function(e,t,r,s,u,l,c){return function(e,t,r,i,s,u,l){const c=[],d=[];let m=u;const g=(0,o.makeProgressAsserter)("calc.parse.tokenize_Eager",m);for(;m<s.length;){g(m);const o=G({localeInfo:e,mathpack:t,refStyle:r,origin:i,syntaxFeatures:l,tokenContext:d.length>0?d[d.length-1].context:a.TokenContext.Normal},c,s,m);if(c.push(o),m=T(o),o.kind===a.TokenKind.Left&&o.value===a.DelimId.Paren)d.push({delim:a.DelimId.Paren,context:a.TokenContext.InParen,lastParen:d.length,lastBrace:d.length>0?d[d.length-1].lastBrace:void 0});else if(o.kind===a.TokenKind.Right&&o.value===a.DelimId.Paren){const e=d.length>0?d[d.length-1].lastParen:void 0;void 0!==e&&(d.length=e)}else if(o.kind===a.TokenKind.Left&&o.value===a.DelimId.Brace)d.push({delim:a.DelimId.Brace,context:a.TokenContext.InArray,lastParen:d.length>0?d[d.length-1].lastParen:void 0,lastBrace:d.length});else if(o.kind===a.TokenKind.Right&&o.value===a.DelimId.Brace){const e=d.length>0?d[d.length-1].lastBrace:void 0;void 0!==e&&(d.length=e)}else if(o.kind===a.TokenKind.Left&&o.value===a.DelimId.Bracket){c.pop(),(0,n.safePush)(c,x(e,t,r,i,s,o.start,l));const a=c[c.length-1];m=T(a)}else if(o.kind===a.TokenKind.Left&&o.value===a.DelimId.SQuote){c.pop(),(0,n.safePush)(c,K(e,t,r,i,s,o.start,l));const a=c[c.length-1];m=T(a)}else if(o.kind===a.TokenKind.End)return c}return c.push((0,a.endToken)(m)),c}(e,t,r,s,u,l,{[i.SyntaxFeature.Comments]:!0===c?.[i.SyntaxFeature.Comments],[i.SyntaxFeature.Statements]:!0===c?.[i.SyntaxFeature.Statements]})};const n=r(6913),i=r(6592),a=r(7978),o=r(4423),{codePointAsterisk:s,codePointAtSign:u,codePointColon:l,codePointDoubleQuote:c,codePointExclamationMark:d,codePointHash:m,codePointLeftParen:g,codePointQuestionMark:p,codePointRightParen:h,codePointSingleQuote:f,codePointFullStop:S,codePointDigitZero:v,codePointSlash:y,codePointMinusSign:F,codePointSpace:b,codePointInvertedExclamationMark:C,codePointInvertedQuestionMark:k,codePointLeftSingleQuotationMark:E,codePointRightSingleQuotationMark:A}=n.codePoint,T=e=>e.start+e.chars.length;let R;const N={"+":a.addOperatorToken,"-":a.subOperatorToken,"*":a.mulOperatorToken,"/":a.divOperatorToken,"^":a.powOperatorToken,"%":a.percentOperatorToken,"&":a.concatOperatorToken,"=":a.eqOperatorToken,"<":a.ltOperatorToken,">":a.gtOperatorToken,":":a.rangeOperatorToken,".":a.dotSepToken,"@":a.atOperatorToken,"#":a.poundOperatorToken},I={"<>":a.neOperatorToken,"<=":a.leOperatorToken,">=":a.geOperatorToken};function P(e,t){if(t<e.length-1){const r=I[e.substring(t,t+2)];if(void 0!==r)return r(t)}const r=N[e.charAt(t)];return void 0!==r?r(t):(0,n.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}const O=(e,t)=>e.charCodeAt(t)!==c,M=(e,t)=>e.charCodeAt(t)===c;function D(e,t,r){const a=t.charCodeAt(r);return!((0,i.isSpace)(a)||a===f||a===m||a===l||a===u||(0,n.stringStartsWith)(t,e.listSeparator,r)||(0,n.stringStartsWith)(t,e.leftBracket,r)||(0,n.stringStartsWith)(t,e.rightBracket,r))}const w=(e,t)=>(0,i.isSpace)((0,n.stringCodePointAt)(e,t)),_=(e,t)=>!(0,i.isLineBreak)((0,n.stringCodePointAt)(e,t)),L=(e,t)=>!(t+1<e.length&&e.charCodeAt(t)===s&&e.charCodeAt(t+1)===y);function x(e,t,r,n,i,s,u){const l=[];let c=0,d=s;const m=(0,o.makeProgressAsserter)("calc.parse.tokenizeBracketedRef_Eager",d);for(;d<i.length;){m(d);const o=G({localeInfo:e,mathpack:t,refStyle:r,origin:n,syntaxFeatures:u,tokenContext:a.TokenContext.InStructRef},l,i,d);if(l.push(o),d=T(o),o.kind===a.TokenKind.Right&&o.value===a.DelimId.Bracket&&(c-=1,0===c))break;o.kind===a.TokenKind.Left&&o.value===a.DelimId.Bracket&&c<2&&(c+=1)}return l}function K(e,t,r,n,i,s,u){const l=[(0,a.leftSQuoteToken)(s)];let c=T(l[0]);const d=(0,o.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier_Eager",c);for(;c<i.length;){d(c);const o=G({localeInfo:e,mathpack:t,refStyle:r,origin:n,syntaxFeatures:u,tokenContext:a.TokenContext.InQuotedQual},l,i,c);if(l.push(o),c=T(o),o.kind===a.TokenKind.Right&&o.value===a.DelimId.SQuote)break}return l}function B(e,t,r){return t.charCodeAt(r)!==f&&!(0,n.stringStartsWith)(t,e.leftBracket,r)&&!(0,n.stringStartsWith)(t,e.rightBracket,r)}const W=e=>!(0,n.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,n.stringStartsWith)(e.statementSeparator,e.rowSeparator),U=e=>!(0,n.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,n.stringStartsWith)(e.statementSeparator,e.decimalSeparator);function G(e,t,r,n){const i=j(e,t,r,n);if(i.kind!==a.TokenKind.Unexpected)return i;const s=(0,o.makeProgressAsserter)("calc.parse.tokenize",n);let u=T(i);for(;u<r.length;){s(u);const n=j(e,t,r,u);if(n.kind!==a.TokenKind.Unexpected)break;u=T(n)}return(0,a.unexpectedToken)(i.start,r.substring(i.start,u))}function j(e,t,r,T){const{localeInfo:x,mathpack:K,refStyle:G,origin:j,syntaxFeatures:V}=e,{tokenContext:H}=e;if(H===a.TokenContext.InStructRef)return function(e,t,r,s){const c=(t,r)=>D(e,t,r),d=(0,n.stringCodePointAt)(t,r);if(s.length>0&&s[s.length-1].kind===a.TokenKind.Escape&&((t,r)=>!D(e,t,r))(t,r))return(0,a.identToken)(r,t.substring(r,r+(0,n.numCodeUnits)(d)));if(d===u)return(0,a.atOperatorToken)(r);if(d===m){const n=function(e,t,r){for(let n=1;n<e.specialRefNames.length;n+=1){const i=e.specialRefNames[n];if(null==i)continue;if(r+i.length>t.length)continue;const o=t.substring(r,r+i.length);if(0===e.stringCompareCI(i,o))return(0,a.specialRefToken)(r,o,n)}}(e,t,r);if(void 0!==n)return n}if(d===f)return(0,a.escapeToken)(r,"'");if((0,n.stringStartsWith)(t,e.rightBracket,r))return(0,a.rightBracketToken)(r,e.rightBracket);if(c(t,r)){const e=(0,o.scanWhile)(t,r,c);return(0,a.identToken)(r,e)}if((0,i.isSpace)(d)){const e=(0,o.scanWhile)(t,r,w);return(0,a.spacesToken)(r,e)}return d===l?(0,a.rangeOperatorToken)(r):(0,n.stringStartsWith)(t,e.listSeparator,r)?(0,a.listSepToken)(r,e.listSeparator):(0,n.stringStartsWith)(t,e.leftBracket,r)?(0,a.leftBracketToken)(r,e.leftBracket):(0,a.unexpectedToken)(r,t.substring(r,r+(0,n.numCodeUnits)(d)))}(x,r,T,t);if(H===a.TokenContext.InQuotedQual)return function(e,t,r,i){const u=(t,r)=>function(e,t,r){const i=t.charCodeAt(r);return i!==f&&i!==l&&i!==s&&i!==p&&!(0,n.stringStartsWith)(t,e.leftBracket,r)&&!(0,n.stringStartsWith)(t,e.rightBracket,r)}(e,t,r),c=(e,t)=>e.charCodeAt(t)===f,d=(0,n.stringCodePointAt)(t,r);if(i.length>0&&i[i.length-1].kind===a.TokenKind.Escape&&c(t,r))return(0,a.identToken)(r,t.substring(r,r+(0,n.numCodeUnits)(d)));if(d===f)return r+1<t.length&&c(t,r+1)?(0,a.escapeToken)(r,"'"):(0,a.rightSQuoteToken)(r);if(d===l)return(0,a.rangeOperatorToken)(r);if((0,n.stringStartsWith)(t,e.leftBracket,r))return(0,a.leftBracketToken)(r,e.leftBracket);if((0,n.stringStartsWith)(t,e.rightBracket,r))return(0,a.rightBracketToken)(r,e.rightBracket);if(u(t,r)){const e=(0,o.scanWhile)(t,r,u);return(0,a.identToken)(r,e)}return(0,a.unexpectedToken)(r,t.substring(r,r+(0,n.numCodeUnits)(d)))}(x,r,T,t);if(H===a.TokenContext.InFieldRef)return function(e,t,r,i){const s=(t,r)=>B(e,t,r),u=(t,r)=>!B(e,t,r),l=(0,n.stringCodePointAt)(t,r);if(i.length>0&&i[i.length-1].kind===a.TokenKind.Escape&&u(t,r))return(0,a.identToken)(r,t.substring(r,r+(0,n.numCodeUnits)(l)));if(l===f&&r+1<t.length&&u(t,r+1))return(0,a.escapeToken)(r,"'");if((0,n.stringStartsWith)(t,e.rightBracket,r))return(0,a.rightBracketToken)(r,e.rightBracket);if(s(t,r)){const e=(0,o.scanWhile)(t,r,s);return(0,a.identToken)(r,e)}return(0,a.unexpectedToken)(r,t.substring(r,r+(0,n.numCodeUnits)(l)))}(x,r,T,t);const q=V[i.SyntaxFeature.Comments],z=V[i.SyntaxFeature.Statements];{const e=function(e,t,r,n,o){const s=(0,i.parseCellRef)(e,t,r,n,o);if(null!=s){const e=s.i,t=n.substring(o,e);return s.refStyle===i.RefStyle.A1?(0,a.cellRefA1Token)(o,t,s.row,s.col):(0,a.cellRefR1C1Token)(o,t,s.row,s.col,s.enLocale)}}(x,G,j,r,T);if(void 0!==e)return e}const Q=(0,n.stringCodePointAt)(r,T),$=H===a.TokenContext.InArray,Y=H===a.TokenContext.Normal;if(function(e,t,r,i){let o=i.length-1,s=i[o];if(null==s)return!0;if(s.kind===a.TokenKind.Sep&&s.value===a.SepId.Dot)return!1;if((0,n.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=s&&(0,a.isWhitespaceToken)(s);)s=i[--o];return null==s||s.kind!==a.TokenKind.Ident&&s.kind!==a.TokenKind.CellRef&&s.kind!==a.TokenKind.Right&&!(s.kind===a.TokenKind.Literal&&!(0,a.isNumberLikeOper)(s.oper))}return e.isNumeral((0,n.stringCodePointAt)(t,r))}(x,r,T,t)){const e=function(e,t,r,n){const o=(0,i.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0===o)return;const{value:s,i:u}=o,l=r.substring(n,u);return(0,a.literalToken)(n,l,s??a.badNumberOper,!0)}(x,K,r,T);if(void 0!==e)return e}if(Q===c)return function(e,t){const[r,n]=(0,o.scanEscapedWhile)(e,t+1,O,'"',M),s=n<e.length,u=e.substring(t,s?n+1:n);return(0,a.literalToken)(t,u,(0,i.stringOper)(r),s)}(r,T);if(x.isIdentContinue(Q)&&!(0,n.stringStartsWith)(r,x.listSeparator,T)&&(!$||!(0,n.stringStartsWith)(r,x.columnSeparator,T))&&(!$||!(0,n.stringStartsWith)(r,x.rowSeparator,T))){const e=(0,o.scanWhile)(r,T,((e,t)=>x.isIdentContinue((0,n.stringCodePointAt)(e,t))));return(0,a.identOrBooleanToken)(x,T,e)}if(Q===m){const e=function(e,t,r){for(let n=1;n<e.errorNames.length;n+=1){const o=e.errorNames[n];if(null==o)continue;if(r+o.length>t.length)continue;const s=t.substring(r,r+o.length);if(0===e.stringCompareCI(o,s))return(0,a.literalToken)(r,s,(0,i.errorOper)(n))}let o=r+1,s=!1;for(;o<t.length;){const i=(0,n.stringCodePointAt)(t,o);if(o!==r+1||i!==C&&i!==k)if(!(o>r+1)||i!==y&&i!==F&&i!==b||s)if(o>r+1&&i===S)o+=1;else{if(o>r+1&&i===v){o+=1,o<t.length&&t.charCodeAt(o)===d&&(o+=1);break}if(i===d||i===p){o!==r+1&&(o+=1);break}if(!e.isIdentContinue(i)||e.isNumeral(i)){if(i!==E&&i!==A)break;o+=1}else o+=(0,n.numCodeUnits)(i)}else s=!0,o+=1;else o+=1}for(;o>r+1&&t.charCodeAt(o-1)===b;)--o;if(o>r+1){const e=t.substring(r,o);return(0,a.literalToken)(r,e,a.badErrorOper)}}(x,r,T);return void 0!==e?e:P(r,T)}if((0,i.isSpace)(Q)){const e=(0,o.scanWhile)(r,T,w);return(0,a.spacesToken)(T,e)}if(Q===g)return(0,a.leftParenToken)(T);if(Q===h)return(0,a.rightParenToken)(T);if((0,n.stringStartsWith)(r,x.leftBrace,T))return(0,a.leftBraceToken)(T,x.leftBrace);if((0,n.stringStartsWith)(r,x.rightBrace,T))return(0,a.rightBraceToken)(T,x.rightBrace);if((0,n.stringStartsWith)(r,x.leftBracket,T))return(0,a.leftBracketToken)(T,x.leftBracket);if((0,n.stringStartsWith)(r,x.rightBracket,T))return(0,a.rightBracketToken)(T,x.rightBracket);if($){if(z&&(0,n.stringStartsWith)(r,x.statementSeparator,T)&&W(x))return(0,a.endToken)(T);if((0,n.stringStartsWith)(r,x.columnSeparator,T))return(0,a.colSepToken)(T,x.columnSeparator);if((0,n.stringStartsWith)(r,x.rowSeparator,T))return(0,a.rowSepToken)(T,x.rowSeparator)}if(z&&(0,n.stringStartsWith)(r,x.statementSeparator,T)&&(U(x)||Y))return(0,a.endToken)(T);if((0,n.stringStartsWith)(r,x.listSeparator,T))return(0,a.listSepToken)(T,x.listSeparator);if(Q===d)return(0,a.qualSepToken)(T);if(Q===f)return(0,a.leftSQuoteToken)(T);if(Q===y&&T+1<r.length&&q){const e=r.charCodeAt(T+1);if(e===y){const e=(0,o.scanWhile)(r,T,_);return(0,a.singleLineCommentToken)(T,e)}if(e===s){const e=(0,o.scanWhile)(r,T+2,L),t=T+2+e.length,i=(0,n.stringStartsWith)(r,"*/",t);return(0,n.assertTrue)("calc.parse.tokenize: /**/",i||t===r.length),(0,a.multiLineCommentToken)(T,"/*"+e+(i?"*/":""),i)}}return function(e){if(!R){R=(0,n.makeStringMap)();for(const e of Object.getOwnPropertyNames(N))R[e.charCodeAt(0)]=!0;for(const e of Object.getOwnPropertyNames(I))R[e.charCodeAt(0)]=!0}return!0===R[e]}(Q)?(0,n.stringStartsWith)(r,":=",T)&&(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaDefaultParameters)?(0,a.assignSepToken)(T):P(r,T):(0,a.unexpectedToken)(T,r.substring(T,T+(0,n.numCodeUnits)(Q)))}t.TokenSeq=class{at(e,t){const{preceding:r,precedingContext:i}=this;if(e<r.length&&i[e]!==t.tokenContext)for(;e<r.length;)r.pop(),i.pop();if(e>r.length)return(0,n.assertFalse)("calc.parse.TokenSeq: index out of bounds");if(e===r.length){if(e>0&&r[e-1].kind===a.TokenKind.End)return;const{formula:o,i0:s}=this,u=0===e?s:T(r[e-1]),l=u===o.length?(0,a.endToken)(u):G(t,r,o,u);return l.start!==u&&(0,n.assertFalse)("calc.parse.TokenSeq: tok start"),l.kind===a.TokenKind.End!=(0===l.chars.length)&&(0,n.assertFalse)("calc.parse.TokenSeq: tok len"),r.push(l),i.push(t.tokenContext),l}return r[e]}constructor(e,t){this.formula=e,this.i0=t,this.preceding=[],this.precedingContext=[]}}},4423:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeProgressAsserter=function(e,t){let r=t-1;return function(t){if(t<=r){const r=`${e}: internal error: no progress made at index ${t}`;return(0,n.assertFalse)(r)}r=t}},t.scanWhile=function(e,t,r){let i=t;for(;i<e.length&&r(e,i);)i+=(0,n.numCodeUnits)((0,n.stringCodePointAt)(e,i));return e.substring(t,i)},t.scanEscapedWhile=function(e,t,r,a,o){const s=[];let u=t,l=t;for(;l<e.length;){const t=i(e,l,r,a,o);if(0===t)break;2===t&&(u!==l&&s.push(e.substring(u,l)),u=l+a.length,l+=a.length),l+=(0,n.numCodeUnits)((0,n.stringCodePointAt)(e,l))}return u!==l&&s.push(e.substring(u,l)),[s.join(""),l]};const n=r(6913);function i(e,t,r,i,a){return r(e,t)?1:(0,n.stringStartsWith)(e,i,t)&&t+i.length<e.length&&a(e,t+i.length)?2:0}},8539:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=void 0,t.isDotSepToken=s,t.isListSepToken=function(e){return e.kind===o.TokenKind.Sep&&e.value===o.SepId.List},t.isRangeOpToken=u,t.isAtOpToken=l,t.isRefErrorToken=function(e){return e.kind===o.TokenKind.Literal&&e.oper.kind===i.OperKind.Error&&e.oper.type===i.ErrorType.REF},t.isLeftBracketToken=c,t.isRightBracketToken=function(e){return e.kind===o.TokenKind.Right&&e.value===o.DelimId.Bracket},t.isBracketToken=d,t.isCommentToken=function(e){return e.kind===o.TokenKind.SingleLineComment||e.kind===o.TokenKind.MultiLineComment},t.isWhitespaceToken=m;const n=r(6913),i=r(6592),a=r(9654),o=r(1748);function s(e){return e.kind===o.TokenKind.Sep&&e.value===o.SepId.Dot}function u(e){return e.kind===o.TokenKind.Operator&&e.value===i.OperatorId.Range}function l(e){return e.kind===o.TokenKind.Operator&&e.value===i.OperatorId.At}function c(e){return e.kind===o.TokenKind.Left&&e.value===o.DelimId.Bracket}function d(e){return(e.kind===o.TokenKind.Left||e.kind===o.TokenKind.Right)&&e.value===o.DelimId.Bracket}function m(e){return e.kind===o.TokenKind.Spaces||e.kind===o.TokenKind.SingleLineComment||e.kind===o.TokenKind.MultiLineComment}function g(e){return(0,a.take)(((t,r)=>r.kind===o.TokenKind.Sep&&r.value===e?r:void 0))}function p(e){return(0,a.take)(((t,r)=>r.kind===o.TokenKind.Left&&r.value===e?r:void 0))}function h(e){return(0,a.take)(((t,r)=>r.kind===o.TokenKind.Right&&r.value===e?r:void 0))}t.parseWhitespace=(0,a.many)((0,a.take)(((e,t)=>m(t)?t:void 0))),t.parseSpacesOnly=(0,a.opt)((0,a.take)(((e,t)=>t.kind===o.TokenKind.Spaces?t.chars:void 0)),""),t.parseCharIndex=function(e,t,r,i,a){const o=e[t];if(null==o){const r=`calc.parse.pStart: internal error: expected token at ${t} in ${(0,n.anonymize)(e)}`;return(0,n.assertFalse)(r)}return i(o.start,t)},t.parseListSep=g(o.SepId.List),t.parseRowSep=g(o.SepId.Row),t.parseColSep=g(o.SepId.Col),t.parseQualSep=g(o.SepId.Qual),t.parseDotSepToken=g(o.SepId.Dot),t.parseAssignToken=g(o.SepId.Assign),t.parseLeftParen=p(o.DelimId.Paren),t.parseRightParen=h(o.DelimId.Paren),t.parseLeftBrace=p(o.DelimId.Brace),t.parseRightBrace=h(o.DelimId.Brace),t.parseLeftSQuote=p(o.DelimId.SQuote),t.parseRightSQuote=h(o.DelimId.SQuote),t.parseLeftBracket=p(o.DelimId.Bracket),t.parseRightBracket=h(o.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,a.takePeek)(((e,t,r)=>s(t)&&!c(r)?t:void 0)),t.parseRangeOp=(0,a.take)(((e,t)=>u(t)?t:void 0)),t.parseAtOp=(0,a.take)(((e,t)=>l(t)?t:void 0)),t.parseEscape=(0,a.take)(((e,t)=>t.kind===o.TokenKind.Escape?t:void 0)),t.parseEnd=(0,a.take)(((e,t)=>t.kind===o.TokenKind.End?t:void 0)),t.parseIdentContinue=(0,a.apply)((0,a.many1)((0,a.take)(((e,t)=>t.isIdentContinue?t:void 0))),((e,t)=>{const r=t[0];return 1===t.length?r:(0,o.identToken)(r.start,t.map((e=>e.chars)).join(""))}));const f=(0,a.take)(((e,t)=>d(t)||t.kind===o.TokenKind.End?void 0:t)),S=(0,a.lazy)((()=>(0,a.flatten)((0,a.many)((0,a.any)((0,a.many1)(f),(0,a.concat)((0,a.tuple)(t.parseLeftBracket),S,(0,a.opt)((0,a.tuple)(t.parseRightBracket),[])))))));t.parseBracketedTokens=(0,a.apply)((0,a.tuple)(t.parseLeftBracket,S,t.parseCharIndex,(0,a.opt)(t.parseRightBracket,void 0)),((e,[t,r,n,i])=>(r.push((0,o.endToken)(n)),[r,void 0!==i])))},3711:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=void 0,t.isUnbracketedFieldName=g;const n=r(6913),i=r(6592),a=r(8539),o=r(2429),s=r(9654),u=r(3089),l=r(1748),{codePointQuestionMark:c,codePointBackslash:d,codePointUnderscore:m}=n.codePoint;function g(e,t){function r(t){return t!==c&&t!==d&&e.isIdentContinue(t)}if(0===t.length)return!1;const i=(0,n.stringCodePointAt)(t,0);if((a=i)===m||a===d||!e.isIdentStart(a)&&!e.isNumeral(a))return!1;var a;for(const e of(0,n.codePointIterator)(t,(0,n.numCodeUnits)(i)))if(!r(e))return!1;return!0}const p=(0,s.take)(((e,t)=>(0,a.isBracketToken)(t)||t.kind===l.TokenKind.Escape||t.kind===l.TokenKind.End?void 0:t.chars)),h=(0,s.take)(((e,t)=>t.kind!==l.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars)),f=(0,s.any)(p,(0,s.right)(a.parseEscape,h)),S=(0,s.apply)((0,s.tuple)((0,s.many)(f),a.parseEnd),((e,[t,r])=>t.join(""))),v=(0,s.applyTake)(a.parseBracketedTokens,((e,[t,r])=>{const a=(0,s.runParser)(S,t,0,e);if(!(0,n.isSuccess)(a))return;const o=t[0].start,l=t[t.length-1].start,c=a.value.output;if(c.length>255){const r=t.map((e=>e.chars)).join("");return[(0,i.badCharsNode)(i.BadType.FieldName,r,(0,u.addSpan)(e,o,l,"","")),!1,!0]}return[(0,i.identNode)(c,(0,u.addSpan)(e,o,l,"","")),!0,r]})),y=(0,s.apply)(a.parseIdentContinue,((e,t)=>{const r=t.start,n=t.start+t.chars.length;return!g(e.localeInfo,t.chars)||t.chars.length>255?[(0,i.badCharsNode)(i.BadType.FieldName,t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]:[(0,i.identNode)(t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]}));t.parseFieldRef=(0,s.apply)((0,s.tuple)(a.parseCharIndex,a.parseWhitespace,a.parseDotSepToken,(0,s.any)(y,v),a.parseCharIndex),((e,[t,r,n,[a,s,l],c])=>{const d=(0,u.addSpan)(e,n.start,c,r,""),m=(0,i.fieldRef)(a,s,l,!1,d);return(0,o.fieldRefTerm)(r.length>0,m,t,c)}))},662:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.parseFormula=void 0,t.runFormulaParser=function(e,t,r,a,o,s,u,c){const m=c.length-1;if(m<0){const e="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,n.assertFalse)(e)}if(c[m].kind!==g.TokenKind.End){const e=`calc.parse.runTokenParser: internal error: array[n] !== End in ${(0,n.anonymize)(c)}`;return(0,n.assertFalse)(e)}const h=(0,d.makeState)(e,t,r,a,o),f=(0,l.runParser)(p,c,0,h);if(!(0,n.isSuccess)(f)||f.value.index<m){const e=`calc.parse.runTokenParser: internal error: consumed ${(0,n.isSuccess)(f)?f.value.index:0} out of ${m} in ${(0,n.anonymize)(c)}`;return(0,n.assertFalse)(e)}const S=f.value.output,v=h.spans,y=(0,i.buildAnnotations)(e,S,s,void 0===u?void 0:{[i.SyntaxFeature.Comments]:!0===u[i.SyntaxFeature.Comments],[i.SyntaxFeature.Statements]:!0===u[i.SyntaxFeature.Statements]});return(0,i.formula)(S,v,y)};const n=r(6913),i=r(6592),a=r(8539),o=r(3711),s=r(1195),u=r(2429),l=r(9654),c=r(8645),d=r(3089),m=r(6390),g=r(1748),p=(0,l.apply)((0,l.tuple)(a.parseWhitespace,(0,l.lazy)((()=>t.parseFormula)),a.parseWhitespace),((e,[t,r,i])=>{const a=(0,d.getNodeSpan)(e,r);return(0,n.assertTrue)("calc.parse.parseSpFormula",!(a.pre.length>0&&t.length>0)),(0,n.assertTrue)("calc.parse.parseSpFormula",!(a.post.length>0&&i.length>0)),t.length>0&&([a.pre,a.preComments]=(0,d.addWhitespace)(e,t)),i.length>0&&([a.post,a.postComments]=(0,d.addWhitespace)(e,i)),r})),h=(0,l.apply)((0,l.tuple)(a.parseLeftParen,(0,d.withDelim)({delimId:g.DelimId.Paren,listSep:d.ListSep.Union},p),(0,l.opt)(a.parseRightParen,void 0),a.parseCharIndex),((e,[t,r,n,a])=>(0,i.parenNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,a,"","")))),f=(0,l.many1)(p,(0,l.right)(a.parseColSep,p)),S=(0,l.many1)(f,(0,l.right)(a.parseRowSep,f)),v=(0,l.apply)((0,l.tuple)(a.parseLeftBrace,(0,d.withDelim)({delimId:g.DelimId.Brace,listSep:d.ListSep.Union},S),(0,l.opt)(a.parseRightBrace,void 0),a.parseCharIndex),((e,[t,r,n,a])=>(0,i.arrayNode)(r,void 0!==n,(0,d.addSpan)(e,t.start,a,"",""))));function y(e){return(0,l.takePeek)(((t,r,n)=>e(r)?(0,i.badCharsNode)(i.BadType.Unexpected,r.chars,(0,d.addSpan)(t,r.start,n.start,"","")):void 0))}const F=(0,l.apply)((0,l.tuple)(a.parseCharIndex,y(a.isLeftBracketToken),(0,d.withDelim)({delimId:g.DelimId.Bracket,listSep:d.ListSep.Union},p),(0,l.opt)(y(a.isRightBracketToken),void 0),a.parseCharIndex),((e,[t,r,n,a,o])=>{const s=[r,n];return null!=a&&s.push(a),(0,i.badSequenceNode)(i.BadType.Unexpected,s,(0,d.addSpan)(e,t,o,"",""))})),b=(0,l.takePeek)(((e,t,r)=>{switch(t.kind){case g.TokenKind.End:case g.TokenKind.Operator:case g.TokenKind.Spaces:case g.TokenKind.SingleLineComment:case g.TokenKind.MultiLineComment:return;case g.TokenKind.Sep:if(t.value===g.SepId.Dot)return;if(t.value===g.SepId.Qual||t.value===g.SepId.Assign)break;if(e.delim.delimId===g.DelimId.Brace||t.value!==g.SepId.Col&&t.value!==g.SepId.Row)return;break;case g.TokenKind.Right:if(t.value!==g.DelimId.SQuote&&e.delim.stack[t.value])return}return(0,i.badCharsNode)(i.BadType.Unexpected,t.chars,(0,d.addSpan)(e,t.start,r.start,"",""))})),C=(0,l.any)(c.parseRef,s.parseLiteral,h,v,o.parseFieldRef,m.parseStructRef,F,c.parseUnqualBadRef,b);function k(e){return(0,l.tuple)(a.parseLeftParen,(0,d.withDelim)({delimId:g.DelimId.Paren,listSep:d.ListSep.Arg},(0,l.apply)((0,l.many1)(e,(0,l.right)(a.parseListSep,e)),((e,t)=>t.map((e=>e.kind===i.NodeKind.Missing?(0,i.literalNode)(i.missingOper,!0,e.label):e))))),(0,l.opt)(a.parseRightParen,void 0),a.parseCharIndex)}const E=(0,l.apply)(k(p),((e,[t,r,n,i])=>(0,u.argsTerm)(r,void 0!==n,t.start,i))),A=(0,l.apply)(k((0,l.any)((0,l.lazy)((()=>t.parseSpParam)),p)),((e,[t,r,n,i])=>(0,u.lambdaArgsTerm)(r,void 0!==n,t.start,i))),T=(0,l.take)(((e,t)=>t.kind!==g.TokenKind.Operator||t.value!==i.OperatorId.Percent&&t.value!==i.OperatorId.Pound?void 0:t)),R=(0,l.take)(((e,t)=>t.kind===g.TokenKind.Operator||(0,a.isDotSepToken)(t)?t:function(e,t){return t.kind===g.TokenKind.Sep&&t.value===g.SepId.List&&e.delim.listSep===d.ListSep.Union?(0,g.operatorToken)(t.start,e.localeInfo.listSeparator,i.OperatorId.Union):void 0}(e,t))),N=(0,l.many)((0,l.take)(((e,t)=>(0,a.isWhitespaceToken)(t)?t:void 0))),I=(0,l.any)((0,l.concat)((0,l.bind)((0,l.any)(C,T),((e,t)=>{const r=(0,u.isWSFNode)(e.localeInfo,t);return r?.id===i.WorksheetFuncId.LAMBDA?(0,l.concat)((0,l.parseSucceed)([t]),(0,l.opt)((0,l.tuple)(A),[])):(0,l.parseSucceed)([t])})),(0,l.many)((0,l.any)(E,o.parseFieldRef,m.parseStructRef))),(0,l.tuple)(R)),P=(0,l.flatten)((0,l.many1)(I,(0,l.concat)(N,I)));t.parseFormula=(0,l.apply)((0,l.tuple)((0,l.opt)(P,void 0),a.parseCharIndex),((e,[t,r])=>{if(null==t){const t=(0,d.addSpan)(e,r,r,"","");return(0,i.missingNode)("",t)}const n=t;return n.push((0,g.endToken)(r)),(0,u.runOperatorPrecedenceParser)(e,n)}));const{codePointFullStop:O}=n.codePoint,M=(0,l.apply)((0,l.many1)((0,l.take)(((e,t)=>t.isIdentContinue||(0,a.isDotSepToken)(t)?t:void 0))),((e,t)=>{const r=t[0].start,a=t.map((e=>e.chars)).join(""),o=(0,d.addSpan)(e,r,r+a.length,"","");return function(e,t){if(!e.localeInfo.isIdentStart((0,n.stringCodePointAt)(t,0)))return!1;for(const r of(0,n.codePointIterator)(t))if(r!==O&&!e.localeInfo.isIdentContinue(r))return!1;const r=(0,i.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){const n=r.refStyle===i.RefStyle.A1?(0,g.cellRefA1Token)(0,t,r.row,r.col):(0,g.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,c.isCompleteCellRefToken)(e,n))return!1}return!0}(e,a)?(0,i.identNode)(a,o):(0,i.badCharsNode)(i.BadType.ParamName,a,o)})),D=(0,l.applyTake)((0,l.tuple)(a.parseCharIndex,a.parseLeftBracket,a.parseCharIndex,a.parseSpacesOnly,(0,l.opt)(M,void 0),a.parseSpacesOnly,a.parseCharIndex,(0,l.opt)(a.parseRightBracket,void 0),a.parseCharIndex),((e,[t,r,n,a,o,s,u,l,c])=>{if(void 0!==o){const t=(0,d.getNodeSpan)(e,o);t.pre=a,t.post=s}const m=o??(0,i.missingNode)(a+s,(0,d.addSpan)(e,n,u,"",""));return(0,i.paramName)(m,!0,void 0!==l,(0,d.addSpan)(e,t,c,"",""))})),w=(0,l.applyTake)((0,l.tuple)(a.parseCharIndex,c.parseRef,a.parseCharIndex),((e,[t,r,n])=>{const a=r.kind===u.TermKind.MaybeWSFTerm?r.node:r;if((0,i.isUnqualifiedNameNode)(a))return(0,i.paramName)((0,i.identNode)(a.whole,a.label),!1,!0,(0,d.addSpan)(e,t,n,"",""))})),_=(0,l.apply)((0,l.tuple)(a.parseWhitespace,a.parseCharIndex,a.parseAssignToken,a.parseWhitespace,(0,l.lazy)((()=>t.parseFormula)),a.parseCharIndex),((e,[t,r,n,a,o,s])=>{const u=(0,d.getNodeSpan)(e,o);return[u.pre,u.preComments]=(0,d.addWhitespace)(e,a),(0,i.paramDefault)(o,(0,d.addSpan)(e,r,s,t,""))})),L=(0,l.lazy)((()=>(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaDefaultParameters)?_:(0,l.parseFail)()));t.parseSpParam=(0,l.applyTake)((0,l.tuple)(a.parseWhitespace,a.parseCharIndex,(0,l.bind)((0,l.any)(w,D),((e,t)=>t.isClosed?(0,l.apply)((0,l.opt)(L,void 0),((e,r)=>[t,r])):(0,l.parseSucceed)([t,void 0]))),a.parseCharIndex,a.parseWhitespace,(0,l.peek)(((e,t)=>t))),((e,[t,r,[n,o],s,u,l])=>{if(void 0!==o||l.kind===g.TokenKind.End&&n.isBracketed||(0,a.isListSepToken)(l)&&n.isClosed)return(0,i.paramNode)(n,o,(0,d.addSpan)(e,r,s,t,u))}))},1195:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;const n=r(6592),i=r(8539),a=r(2429),o=r(9654),s=r(3089),u=r(1748),l=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind!==n.OperKind.Boolean?t:t.kind===u.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,u.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0)),c=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Literal&&t.oper.kind===n.OperKind.Boolean?t:void 0));t.parseLiteral=(0,o.apply)((0,o.tuple)((0,o.any)(l,(0,o.left)(c,(0,o.fails)(i.parseDotSepTokenNotFollowedByLeftBracket))),i.parseCharIndex),((e,[t,r])=>{const i=(0,s.addSpan)(e,t.start,r,"","");if((0,u.isBadNumberOper)(t.oper))return(0,n.badCharsNode)(n.BadType.NumberLiteral,t.chars,i);if((0,u.isBadErrorOper)(t.oper))return(0,n.badCharsNode)(n.BadType.ErrorLiteral,t.chars,i);if((0,n.isStringOper)(t.oper)&&t.oper.value.length>n.cellStringLimit)return(0,n.badCharsNode)(n.BadType.StringLiteral,t.chars,i);const o=(0,n.literalNode)(t.oper,t.hasRight,i);return(0,n.isBooleanOper)(t.oper)?(0,a.maybeWSFTerm)(o,t.chars):o}))},2429:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermKind=void 0,t.lambdaArgsTerm=function(e,t,r,n){return{kind:l.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:l.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=c,t.structRefTerm=function(e,t,r){return{kind:l.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:l.MaybeWSFTerm,node:e,whole:t}},t.isWSFNode=B,t.runOperatorPrecedenceParser=function(e,t){let r=t.length-1;if(r<1){const e="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,n.assertFalse)(e)}if(t[r].kind!==u.TokenKind.End){const e=`calc.parse.runTermParser: internal error: array[n].kind !== End in ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}if(1===r&&d(t[0]))return t[0];if(m(t[0])){const e=`calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}if(m(t[r-1])){const e=`calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}for(;;){const i=(0,o.runParser)(me,t,0,e);if((0,n.isSuccess)(i)&&i.value.index>=r)return i.value.output;if(!(0,n.isSuccess)(i)||0===i.value.index||1===i.value.index&&d(t[0])){const e=`calc.parse.runTermParser: internal error: consumed ${(0,n.isSuccess)(i)?i.value.index:0} out of ${r} in ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}r=(t=[i.value.output,...t.slice(i.value.index)]).length-1}};const n=r(6913),i=r(6592),a=r(8539),o=r(9654),s=r(3089),u=r(1748);var l;function c(e,t,r,n){return{kind:l.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function d(e){return e.kind!==u.TokenKind.Operator&&e.kind!==u.TokenKind.Sep&&e.kind!==u.TokenKind.End&&e.kind!==u.TokenKind.Spaces&&e.kind!==u.TokenKind.SingleLineComment&&e.kind!==u.TokenKind.MultiLineComment&&!(e.kind in l)}function m(e){return e.kind===u.TokenKind.Spaces||e.kind===u.TokenKind.SingleLineComment||e.kind===u.TokenKind.MultiLineComment}function g(e,t){return d(t=t.kind===l.MaybeWSFTerm?t.node:t)?(0,s.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(l||(t.TermKind=l={}));const p=(0,o.many)((0,o.take)(((e,t)=>m(t)?t:void 0))),h=(0,o.many1)((0,o.take)(((e,t)=>m(t)?t:void 0))),f=(0,o.peek)(((e,t)=>t)),S=function(e,t,r,i,a){const o=e[t];if(null==o){const r=`calc.parse.pStart: internal error: expected term at ${t} in ${(0,n.anonymize)(e)}`;return(0,n.assertFalse)(r)}return i(g(r,o),t)};function v(e){return(0,o.apply)((0,o.tuple)(p,S,(0,o.take)(e),S,p),((e,[t,r,n,a,o])=>(0,i.operatorNode)(n,(0,s.addSpan)(e,r,a,t,o))))}function y(e){return(0,o.apply)((0,o.tuple)(p,S,(0,o.take)(e),S),((e,[t,r,n,a])=>(0,i.operatorNode)(n,(0,s.addSpan)(e,r,a,t,""))))}function F(e){return(0,o.apply)((0,o.tuple)(S,(0,o.take)(e),S,p),((e,[t,r,n,a])=>(0,i.operatorNode)(r,(0,s.addSpan)(e,t,n,"",a))))}const b=v(((e,t)=>t.kind!==u.TokenKind.Operator||t.value!==i.OperatorId.Add&&t.value!==i.OperatorId.Sub?void 0:t.value)),C=F(((e,t)=>{if(t.kind===u.TokenKind.Operator){if(t.value===i.OperatorId.Add)return i.OperatorId.Pos;if(t.value===i.OperatorId.Sub)return i.OperatorId.Neg}})),k=F(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.At?t.value:void 0)),E=y(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.Pound?t.value:void 0)),A=(0,o.take)(((e,t)=>t.kind===l.StructRefTerm?t:void 0)),T=v(((e,t)=>t.kind!==u.TokenKind.Operator||t.value!==i.OperatorId.Mul&&t.value!==i.OperatorId.Div?void 0:t.value)),R=v(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.Pow?t.value:void 0)),N=y(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.Percent?t.value:void 0)),I=v(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.Concat?t.value:void 0)),P=v(((e,t)=>t.kind===u.TokenKind.Operator&&t.value>=i.OperatorId.Eq&&t.value<=i.OperatorId.Ge?t.value:void 0)),O=v(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.Range?t.value:void 0)),M=v(((e,t)=>t.kind===u.TokenKind.Operator&&t.value===i.OperatorId.Union?t.value:void 0)),D=(0,o.applyTake)((0,o.tuple)(h,f),((e,[t,r])=>{if(!(r.kind===u.TokenKind.End||r.kind===u.TokenKind.Operator&&r.value!==i.OperatorId.At||r.kind===u.TokenKind.Sep&&(0,a.isDotSepToken)(r))){if(1!==t.length||t[0].kind!==u.TokenKind.Spaces)return t;const n=g(e,r),a=(0,s.addSpan)(e,n,n,t[0].chars,"");return(0,i.operatorNode)(i.OperatorId.Isect,a)}})),w=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Sep&&(0,a.isDotSepToken)(t)?t:void 0)),_=(0,o.take)(((e,t)=>t.kind===l.ArgsTerm?t:void 0)),L=(0,o.take)(((e,t)=>t.kind===l.LambdaArgsTerm?t:void 0)),x=(0,o.take)(((e,t)=>t.kind===l.ArgsTerm||t.kind===l.FieldRefTerm?t:void 0)),K={[i.WorksheetFuncId.LETREC]:n.FeatureName.CalcLetRecFunction};function B(e,t){if(t.kind===l.MaybeWSFTerm&&void 0!==t.whole){const r=(0,i.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;if((0,n.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==i.WorksheetFuncId._UDF),0!=((0,i.getWorksheetFuncType)(r).flags&i.FunctionFlags.Internal))return;const a=K[r];if(void 0!==a&&!(0,n.isFeatureEnabled)(a))return;return(0,i.wsfNode)(r,t.whole,t.node.label)}}const W=(0,o.take)(((e,t)=>B(e.localeInfo,t))),U=(0,o.take)(((e,t)=>{const r=B(e.localeInfo,t);return r?.id===i.WorksheetFuncId.LAMBDA?r:void 0})),G=(0,o.apply)((0,o.tuple)(U,L),((e,[t,r])=>{const n=(0,s.getNodeSpan)(e,t).start,a=r.nodes,o=(t.id,[]);let u;const l=[];for(let e=0;e<a.length;e+=1){const t=a[e];t.kind===i.NodeKind.Param?o.push((0,i.lambdaParam)((0,i.indexedArg)(t,e))):e===a.length-1?u=(0,i.indexedArg)(t,e):l.push((0,i.indexedArg)(t,e))}const c=(0,s.addSpan)(e,n,r.end,"","");return(0,i.lambdaNode)(t,o,u,l,r.isClosed,c)})),j=(0,o.apply)((0,o.tuple)(W,_),((e,[t,r])=>{const a=(0,s.getNodeSpan)(e,t).start,o=r.nodes;switch(t.id){case i.WorksheetFuncId.LET:case i.WorksheetFuncId.LETREC:{t.id;const n=[],c=[];let d;for(let t=0;t<o.length;t+=1){const r=o[t];t!==o.length-1?!(t+1<o.length&&(0,i.isUnqualifiedNameNode)(r))||t+3<o.length&&(u=e.refStyle,l=o[t+2],!((0,i.isUnqualifiedNameNode)(l)||u===i.RefStyle.A1&&l.kind===i.NodeKind.CellRef&&void 0===l.qualifier&&l.ref.kind===i.CellRefKind.Single&&l.ref.col.kind===i.PosKind.Rel&&l.ref.row.kind===i.PosKind.Rel))&&(0,i.isUnqualifiedNameNode)(o[t+1])?c.push((0,i.indexedArg)(r,t)):(n.push((0,i.letVar)((0,i.indexedArg)((0,i.varNode)((0,i.identNode)(r.whole,r.parts.label),r.label),t),(0,i.indexedArg)(o[t+1],t+1))),t+=1):d=(0,i.indexedArg)(r,t)}const m=(0,s.addSpan)(e,a,r.end,"","");return(0,i.letNode)(t,n,d,c,r.isClosed,m)}case i.WorksheetFuncId.LAMBDA:return(0,n.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}var u,l;return z(e,t,o,r.isClosed,a,r.end)}));function V(e,t,r){return(0,o.apply)((0,o.tuple)((0,o.many)(e),t),((e,[t,n])=>t.reduceRight(r(e),n)))}function H(e,t,r){return(0,o.apply)((0,o.tuple)(e,(0,o.many)(t)),((e,[t,n])=>n.reduce(r(e),t)))}function q(e){return(t,[r,a])=>{if(o=r,Array.isArray(o)){const o=(0,s.getNodeSpan)(e,t);(0,n.assertTrue)("calc.parse.makeAppNodeInfix",0===o.post.length),[o.post,o.postComments]=(0,s.addWhitespace)(e,r);const u=(0,s.getNodeSpan)(e,a),l=(0,s.addSpan)(e,o.start,u.end,"","");return(0,i.badSequenceNode)(i.BadType.Unexpected,[t,a],l)}var o;const u=(0,s.getNodeSpan)(e,t).start,l=(0,s.getNodeSpan)(e,a).end,c=(0,s.addSpan)(e,u,l,"","");return(0,i.appNode)(r,[t,a],!0,c)}}function z(e,t,r,n,a,o){const u=(0,s.addSpan)(e,a,o,"","");return(0,i.appNode)(t,r,n,u)}function Q(e){return(t,r)=>{const n=(0,s.getNodeSpan)(e,t).start;switch(r.kind){case l.ArgsTerm:return z(e,t,r.nodes,r.isClosed,n,r.end);case l.FieldRefTerm:{const a=(0,s.addSpan)(e,n,r.end,"",""),{start:o,end:u,pre:l}=(0,s.getNodeSpan)(e,r.rhs);if((0,i.isNumberLiteralNode)(t)){const n=(0,s.addSpan)(e,o,o,"",""),l=(0,i.missingNode)("",n),c=r.rhs.label,d=(0,s.addSpan)(e,o,u,"",""),m=!1,g=(0,i.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,m,d);return(0,i.badSequenceNode)(i.BadType.FieldRef,[t,(0,i.fieldRefNode)(l,g,c)],a)}const c=!r.rhs.isBracketed&&(0,i.shouldFieldRefBeBracketed)(t,r.rhs,l),d=(0,i.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,c,r.rhs.label);return(0,i.fieldRefNode)(t,d,a)}case l.StructRefTerm:{const a=(0,s.addSpan)(e,n,r.end,"","");switch(t.kind){case i.NodeKind.Name:return(0,i.structRefNode)(t,r.rhs,a);case i.NodeKind.Missing:return(0,i.structRefNode)(void 0,r.rhs,a)}return(0,i.badSequenceNode)(i.BadType.StructRef,[t,(0,i.structRefNode)(void 0,r.rhs,(0,s.addSpan)(e,r.start,r.end,"",""))],a)}case i.NodeKind.Operator:return z(e,r,[t],!0,n,(0,s.getNodeSpan)(e,r).end)}}}function $(e){let t=!0;return(r,n)=>{const a=(0,s.getNodeSpan)(e,n).start,o=(0,s.getNodeSpan)(e,r).end,u=(0,s.addSpan)(e,a,o,"","");if((n.id===i.OperatorId.Pos||n.id===i.OperatorId.Neg)&&t&&(t=!1,(0,i.isNumberLiteralNode)(r)&&""===(0,s.getNodeSpan)(e,n).post)){const t=n.id===i.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,i.literalNode)(t,!0,u)}return(0,i.appNode)(n,[r],!0,u)}}const Y=(0,o.take)(((e,t)=>t.kind===l.MaybeWSFTerm?t.node:d(t)?t:void 0)),J=(0,o.apply)((0,o.tuple)(p,w,S,p),((e,[t,r,n,a])=>(0,i.badCharsNode)(i.BadType.Unexpected,r.chars,(0,s.addSpan)(e,r.start,n,t,a)))),X=(0,o.apply)((0,o.tuple)(S,p,w,S),((e,[t,r,n,a])=>{const o=(0,s.addSpan)(e,a,a,"",""),u=(0,s.addSpan)(e,n.start,a,r,""),l=(0,i.fieldRef)((0,i.missingNode)("",o),!1,!0,!1,u);return c(r.length>0,l,t,a)})),Z=(0,o.lazy)((()=>(0,o.apply)((0,o.tuple)(S,(0,o.many)((0,o.any)(G,j,Y,J),(0,o.any)(G,j,Y,(0,o.right)((0,o.succeeds)(k),ie))),S),((e,[t,r,n])=>{if(1===r.length)return r[0];const a=(0,s.addSpan)(e,t,n,"","");return 0===r.length?(0,i.missingNode)("",a):(0,i.badSequenceNode)(i.BadType.Unexpected,r,a)})))),ee=H((0,o.lazy)((()=>(0,o.any)((0,o.right)((0,o.succeeds)(k),ie),(0,o.right)((0,o.succeeds)(C),oe),Z))),(0,o.any)(E,A),Q),te=H(ee,(0,o.tuple)(O,ee),q),re=H(te,(0,o.tuple)(D,te),q),ne=H(re,(0,o.any)(x,X),Q),ie=V(k,ne,$),ae=H(ie,(0,o.tuple)(M,ie),q),oe=V(C,ae,$),se=H(oe,N,Q),ue=H(se,(0,o.tuple)(R,se),q),le=H(ue,(0,o.tuple)(T,ue),q),ce=H(le,(0,o.tuple)(b,le),q),de=H(ce,(0,o.tuple)(I,ce),q),me=H(de,(0,o.tuple)(P,de),q)},9660:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;const n=r(6913),i=r(6592),a=r(8539),o=r(9654),s=r(3089),u=r(1748);function l(e){return e.kind===u.TokenKind.Literal&&e.oper.kind===i.OperKind.Boolean}const{codePointFullStop:c}=n.codePoint,d=(0,o.opt)((0,o.takePeek)(((e,t,r)=>t.kind!==u.TokenKind.Spaces||(0,a.isWhitespaceToken)(r)?void 0:t.chars)),""),m=(0,o.take)(((e,t)=>t.isIdentContinue&&!l(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==c?t.chars:void 0)),g=(0,o.take)(((e,t)=>t.isIdentContinue||(0,a.isDotSepToken)(t)?t.chars:void 0)),p=(0,o.apply)((0,o.many1)(m,g),((e,t)=>t.join(""))),h=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Ident?t.chars:void 0)),f=(e,t)=>(t.path??"")+e.leftBracket+t.document+e.rightBracket;function S(e,t,r,n,a,o){let s,u;if(null==t)null==n?(s=(0,i.identQualifier)(r,a,o),u=r):(s=(0,i.sheetRangeQualifier)(r,n,void 0,a,o),u=`${r}:${n}`);else{const l=f(e.localeInfo,t);null==n?(s=(0,i.sheetQualifier)(r,t,a,o),u=`${l}${r}`):(s=(0,i.sheetRangeQualifier)(r,n,t,a,o),u=`${l}${r}:${n}`)}return[s,a?(0,i.quoteQualifier)(u):u]}const v=(0,o.take)(((e,t)=>t.kind===u.TokenKind.Ident||(0,a.isRangeOpToken)(t)?t.chars:void 0)),y=(0,o.apply)((0,o.tuple)(a.parseCharIndex,(0,o.many)(v),a.parseLeftBracket,(0,o.many1)(v),a.parseRightBracket,a.parseCharIndex),((e,[t,r,n,a,o,u])=>{const l=r.join(""),c=a.join("");return(0,i.documentQualifier)(c,""!==l?l:void 0,!0,(0,s.addSpan)(e,t,u,"",""))})),F=(0,o.apply)((0,o.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,o.many1)(g),a.parseRightBracket,a.parseCharIndex),((e,[t,r,n,a,o])=>{const u=n.join("");return(0,i.documentQualifier)(u,void 0,!1,(0,s.addSpan)(e,t,o,"",""))})),b=(0,o.apply)((0,o.tuple)(a.parseCharIndex,(0,o.opt)(F,void 0),p,(0,o.opt)((0,o.right)(a.parseRangeOp,p),void 0),a.parseCharIndex),((e,[t,r,n,i,a])=>S(e,r,n,i,!1,(0,s.addSpan)(e,t,a,"","")))),C=(0,o.apply)((0,o.tuple)(a.parseLeftSQuote,(0,o.opt)(y,void 0),h,(0,o.opt)((0,o.right)(a.parseRangeOp,h),void 0),a.parseRightSQuote,a.parseCharIndex),((e,[t,r,n,i,a,o])=>S(e,r,n,i,!0,(0,s.addSpan)(e,t.start,o,"","")))),k=(0,o.apply)(F,((e,t)=>[t,f(e.localeInfo,t)])),E=(0,o.apply)((0,o.tuple)(a.parseLeftSQuote,y,a.parseRightSQuote,a.parseCharIndex),((e,[t,r,n,a])=>[(0,i.documentQualifier)(r.document,r.path,!0,(0,s.addSpan)(e,t.start,a,"","")),(0,i.quoteQualifier)(f(e.localeInfo,r))])),A=(0,o.take)(((e,t)=>t.kind===u.TokenKind.End||t.kind===u.TokenKind.Right&&t.value===u.DelimId.SQuote?void 0:t.chars)),T=(0,o.apply)((0,o.tuple)(a.parseLeftSQuote,(0,o.many)(A),(0,o.opt)((0,o.tuple)(a.parseRightSQuote,(0,o.opt)((0,o.tuple)(a.parseQualSep,d),[void 0,""])),[void 0,[void 0,""]]),a.parseCharIndex),((e,[t,r,[n,[a,o]],u])=>{const l=void 0!==n,c=void 0!==a,d=`'${r.join("")}${l?"'":""}${c?"!":""}`,m=(0,s.addSpan)(e,t.start,u-o.length,"",o);return[(0,i.badQualifier)(d,!0,l,c,m),d]})),R=(0,o.takePeek)(((e,t,r)=>{if((0,a.isRefErrorToken)(t)){const n=(0,s.addSpan)(e,t.start,r.start,"","");return[(0,i.errorQualifier)(n),t.chars]}})),N=(0,o.peek)(((e,t)=>{const r=(0,s.addSpan)(e,t.start,t.start,"","");return[(0,i.relativeQualifier)(r),""]})),I=(0,o.apply)((0,o.tuple)((0,o.any)(b,C,k,E,N),a.parseQualSep,d),((e,[[t,r],i,a])=>{const o=(0,s.getNodeSpan)(e,t);return o.end+=1,(0,n.assertTrue)("calc.parse.parseGoodQualifier",o.end===i.start+i.chars.length),(0,n.assertTrue)("calc.parse.parseGoodQualifier",0===o.post.length),o.post=a,[t,`${r}!`]})),P=(0,o.take)(((e,t)=>t.isIdentContinue||(0,a.isDotSepToken)(t)||l(t)||function(e){return e.kind===u.TokenKind.Literal&&(0,u.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0)),O=(0,o.apply)((0,o.tuple)(a.parseCharIndex,(0,o.many)(P),a.parseQualSep,a.parseCharIndex,d),((e,[t,r,n,a,o])=>{const u=`${r.join("")}!`,l=(0,s.addSpan)(e,t,a,"",o);return[(0,i.badQualifier)(u,!1,!0,!0,l),u]}));t.parseQualifier=(0,o.any)(R,I,O,T)},8645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=void 0,t.isCompleteCellRefToken=p;const n=r(6913),i=r(6592),a=r(8539),o=r(3711),s=r(2429),u=r(9660),l=r(9654),c=r(3089),d=r(1748);function m(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==i.SpecialPos.A1BadDollar&&t.col!==i.SpecialPos.A1BadDollar}function g(e){return e.refStyle===i.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function p(e,t){return t.kind===d.TokenKind.CellRef&&m(e,t)&&g(t)}const h=(0,i.pos)(i.PosKind.Rel,0);function f(e){return e===i.SpecialPos.RCNoNum?h:e}function S(e,t){if(e.row!==i.SpecialPos.A1BadDollar&&e.col!==i.SpecialPos.A1BadDollar){const r=e.refStyle===i.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,i.cellRefSingle)(f(e.row),f(e.col),r,t);if(null!=e.row){const n=f(e.row);return(0,i.cellRefRow)(n,n,r,t)}if(null!=e.col){const n=f(e.col);return(0,i.cellRefCol)(n,n,r,t)}}const r=`calc.parse.cellRefToken2cellRef: bad token ${(0,n.anonymize)(e)}`;return(0,n.assertFalse)(r)}function v(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,n.stringCodePointAt)(t.chars,0))}const y=(0,l.take)(((e,t)=>p(e,t)&&!v(e,t)||(0,a.isRefErrorToken)(t)?t:void 0)),F=(0,l.take)(((e,t)=>p(e,t)&&v(e,t)?t:void 0)),b=(0,l.apply)((0,l.tuple)((0,l.any)(y,(0,l.withState)((e=>e.cellRefMustBeCellRefNode?F:(0,l.left)(F,(0,l.fails)((0,l.any)(a.parseIdentContinue,a.parseDotSepTokenNotFollowedByLeftBracket)))))),a.parseCharIndex),((e,[t,r])=>{const n=t.kind===d.TokenKind.CellRef?S(t,(0,c.addSpan)(e,t.start,r,"","")):(0,i.cellRefError)((0,c.addSpan)(e,t.start,r,"","")),a=t.kind===d.TokenKind.CellRef?t.chars:void 0;return(0,s.maybeWSFTerm)((0,i.cellRefNode)(n,void 0,(0,c.addSpan)(e,t.start,r,"","")),a)})),C=(0,l.takePeek)(((e,t,r)=>t.kind!==d.TokenKind.CellRef||!m(e,t)||function(e,t,r){return r.kind===d.TokenKind.Left&&r.value===d.DelimId.Paren&&t.isIdentContinue&&null!=(0,i.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start])),k=(0,l.bind)((0,l.tuple)(C,a.parseSpacesOnly,a.parseRangeOp,a.parseSpacesOnly,C),((e,[[t,r],n,a,o,[u,m]])=>{const g=(0,c.addSpan)(e,t.start,r,"",n),p=(0,c.addSpan)(e,u.start,m,o,""),h=S(t,g),f=S(u,p);let v;if(h.kind===i.CellRefKind.Single&&f.kind===i.CellRefKind.Single){const r=(0,c.addSpan)(e,t.start,m,"","");v=(0,i.cellRefRange)(h,f,r)}else if(0===n.length&&0===o.length)if(h.kind===i.CellRefKind.Row&&f.kind===i.CellRefKind.Row){const r=h.isBracketed||f.isBracketed,n=(0,c.addSpan)(e,t.start,m,"","");v=(0,i.cellRefRow)(h.row1,f.row1,r,n)}else if(h.kind===i.CellRefKind.Col&&f.kind===i.CellRefKind.Col){const r=h.isBracketed||f.isBracketed,n=(0,c.addSpan)(e,t.start,m,"","");v=(0,i.cellRefCol)(h.col1,f.col1,r,n)}if(null==v)return(0,l.parseFail)();const y=(0,s.maybeWSFTerm)((0,i.cellRefNode)(v,void 0,(0,c.addSpan)(e,t.start,m,"","")),void 0);return t.isIdentContinue&&u.isIdentContinue?(0,l.peek)(((e,t)=>t.kind===d.TokenKind.Sep&&t.value===d.SepId.Qual?void 0:y)):(0,l.parseSucceed)(y)})),E=(0,l.any)(k,b);t.parseUnqualBadRef=(0,l.apply)((0,l.take)(((e,t)=>t.kind===d.TokenKind.CellRef?t:void 0)),((e,t)=>{const r=t.start+t.chars.length,n=t.refStyle===i.RefStyle.R1C1&&!t.isIdentContinue;return(0,s.maybeWSFTerm)((0,i.cellRefNode)((0,i.cellRefBad)(t.chars,n,(0,c.addSpan)(e,t.start,r,"","")),void 0,(0,c.addSpan)(e,t.start,r,"","")),t.chars)}));const A=(0,l.take)(((e,t)=>t.kind===d.TokenKind.Ident&&e.localeInfo.isIdentStart((0,n.stringCodePointAt)(t.chars,0))||t.kind===d.TokenKind.CellRef&&v(e,t)?t:void 0)),T=(0,l.take)(((e,t)=>t.kind===d.TokenKind.Literal&&t.oper.kind===i.OperKind.Boolean?t:void 0)),R=(0,l.any)(A,(0,l.left)(T,(0,l.succeeds)(a.parseDotSepTokenNotFollowedByLeftBracket))),N=(0,l.peek)(((e,t)=>(0,a.isLeftBracketToken)(t))),I=(0,l.tuple)((0,l.many1)(R,a.parseIdentContinue),(0,l.many)((0,l.any)(a.parseIdentContinue,a.parseDotSepTokenNotFollowedByLeftBracket)),N,a.parseCharIndex),P=(0,l.apply)(I,(function(e,[t,r,a,u]){const l=t[0],p=1===t.length&&r[0]?.kind===d.TokenKind.Sep,h=l.kind!==d.TokenKind.CellRef||(f=l).refStyle===i.RefStyle.A1&&null==f.row&&"object"==typeof f.col&&f.col.kind===i.PosKind.Rel||function(e,t){return t.refStyle===i.RefStyle.A1&&e.refStyle===i.RefStyle.A1&&t.isIdentContinue||t.refStyle===i.RefStyle.R1C1&&(0,i.isR1C1IdentStart)(t.row,t.col)}(e,l)&&p;var f;if(a||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===d.TokenKind.Literal||r.some(((t,r)=>r%2==0?t.kind!==d.TokenKind.Sep:t.kind===d.TokenKind.Sep||!(0,o.isUnbracketedFieldName)(e.localeInfo,t.chars)))}(e,t,r)){const n=[...t,...r].map((e=>e.chars)).join(""),a=(0,c.addSpan)(e,l.start,u,"",""),o=(0,c.addSpan)(e,l.start,u,"",""),d=(0,i.identNamePart)(n,h,a,o),m=(0,i.nameNode)(d,void 0,(0,c.addSpan)(e,l.start,u,"",""));return(0,s.maybeWSFTerm)(m,m.whole)}let v,y=h,F=0,b=r[F]?.start??u,C=(0,c.addSpan)(e,l.start,b,"",""),k=(0,c.addSpan)(e,l.start,b,"","");if(1===t.length&&l.kind===d.TokenKind.CellRef)if(m(e,l))if(g(l)){const t=S(l,(0,c.addSpan)(e,l.start,b,"",""));v=(0,i.cellRefNamePart)(t,l.chars,C,k)}else v=(0,i.identNamePart)(l.chars,y,C,k);else y=!1,v=(0,i.identNamePart)(l.chars,y,C,k);else{let n=t.map((e=>e.chars)).join("");(0===e.localeInfo.stringCompareCI(n,"_xlpm")||0===e.localeInfo.stringCompareCI(n,"_xleta"))&&F+1<r.length&&(n+="."+r[F+1].chars,F+=2,b=r[F]?.start??u,C=(0,c.addSpan)(e,l.start,b,"",""),k=(0,c.addSpan)(e,l.start,b,"","")),v=(0,i.identNamePart)(n,y,C,k)}let E=v;for(;F+1<r.length;F+=2){const t=r[F],n=r[F+1],a=r[F+2]?.start??u;E=(0,i.fieldRefNamePart)(E,(0,i.fieldRef)((0,i.identNode)(n.chars,(0,c.addSpan)(e,n.start,a,"","")),!1,!0,!1,(0,c.addSpan)(e,t.start,a,"","")),F+2>=r.length?h:y,(0,c.addSpan)(e,l.start,a,"",""),(0,c.addSpan)(e,l.start,a,"",""))}if(F<r.length){const t=r[F],n=r[F+1]?.start??u,a=(0,i.fieldRef)((0,i.missingNode)("",(0,c.addSpan)(e,n,n,"","")),!1,!0,!1,(0,c.addSpan)(e,t.start,n,"",""));E=(0,i.fieldRefNamePart)(E,a,h,(0,c.addSpan)(e,l.start,n,"",""),(0,c.addSpan)(e,l.start,n,"","")),F+=1}(0,n.assertTrue)("calc.parse.pUnqualName: i == tailTokens",F===r.length),E.kind===i.NamePartKind.CellRefNamePart&&(0,n.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");const A=(0,i.nameNode)(E,void 0,(0,c.addSpan)(e,l.start,u,"",""));return(0,s.maybeWSFTerm)(A,A.whole)})),O=(0,l.opt)((0,l.any)(E,P,t.parseUnqualBadRef),{node:void 0}),M=(0,l.any)(E,(0,l.right)((0,l.fails)(P),t.parseUnqualBadRef)),D=(0,l.bind)(u.parseQualifier,((e,[t,r])=>(0,l.apply)(t.kind===i.QualifierKind.SheetRange?(0,c.cellRefMustBeCellRefNode)(t.isQuoted?O:M):t.kind===i.QualifierKind.Error?(0,c.cellRefMustBeCellRefNode)(O):O,((e,{node:a})=>{if(null==a)return t.kind===i.QualifierKind.Error?(0,i.literalNode)(i.refErrorOper,!0,t.label):(0,i.badCharsNode)(i.BadType.Qualifier,r,t.label);const o=(0,c.getNodeSpan)(e,t).start,s=(0,c.getNodeSpan)(e,a).end;if(a.kind===i.NodeKind.Name){const r=(0,c.addSpan)(e,o,s,"","");if(t.kind===i.QualifierKind.Error){const e=(0,i.literalNode)(i.refErrorOper,!0,t.label);return(0,i.badSequenceNode)(i.BadType.Unexpected,[e,a],r)}return(0,n.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==i.QualifierKind.SheetRange||t.isQuoted),t.kind===i.QualifierKind.SheetRange&&void 0===t.document&&(t=(0,i.identQualifier)(`${t.sheet1}:${t.sheet2}`,t.isQuoted,t.label)),(0,i.nameNode)(function(e,t,r){let n=t;for(;(0,c.getSpan)(e,n.qualifiedLabel).start=r,n.kind===i.NamePartKind.FieldRefNamePart;)n=n.lhs;return t}(e,a.parts,o),t,r)}const u=(0,c.addSpan)(e,o,s,"","");return t.kind===i.QualifierKind.Ident&&(t=(0,i.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,i.cellRefNode)(a.ref,t,u)})))),w=(0,l.apply)((0,l.any)(E,P),((e,t)=>t.node.kind===i.NodeKind.CellRef&&t.node.ref.kind===i.CellRefKind.Error?(0,i.literalNode)(i.refErrorOper,!0,t.node.label):t));t.parseRef=(0,l.any)(D,w)},6390:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;const n=r(6913),i=r(6592),a=r(8539),o=r(2429),s=r(9654),u=r(3089),l=r(1748),c=(0,s.take)(((e,t)=>t.isIdentContinue||t.kind===l.TokenKind.Spaces?t:void 0)),d=(0,s.apply)((0,s.many1)(c),((e,t)=>{const r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map((e=>e.kind===l.TokenKind.Escape?"":e.chars)).join(""))})),m=(0,s.take)(((e,t)=>t.isIdentContinue||t.kind===l.TokenKind.Spaces||t.kind===l.TokenKind.Escape||(0,a.isListSepToken)(t)||(0,a.isRangeOpToken)(t)?t:void 0)),g=(0,s.apply)((0,s.many1)(m),((e,t)=>{const r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map((e=>e.kind===l.TokenKind.Escape?"":e.chars)).join(""))})),p=(0,s.take)(((e,t)=>t.kind===l.TokenKind.SpecialRef?t:void 0)),h=(0,s.apply)((0,s.tuple)(a.parseCharIndex,p,a.parseCharIndex),((e,[t,r,n])=>(0,i.specialRef)(r.value,!1,!0,(0,u.addSpan)(e,t,n,"","")))),f=(0,s.apply)((0,s.tuple)(a.parseCharIndex,a.parseLeftBracket,p,(0,s.opt)(a.parseRightBracket,void 0),a.parseCharIndex),((e,[t,r,n,a,o])=>(0,i.specialRef)(n.value,!0,void 0!==a,(0,u.addSpan)(e,t,o,"","")))),S=(0,s.any)(h,f),v=(0,s.apply)((0,s.tuple)(a.parseCharIndex,d,a.parseCharIndex),((e,[t,r,n])=>(0,i.columnRef)(r.chars,!1,!0,(0,u.addSpan)(e,t,n,"","")))),y=(0,s.apply)((0,s.tuple)(a.parseCharIndex,a.parseLeftBracket,(0,s.opt)(g,void 0),(0,s.opt)(a.parseRightBracket,void 0),a.parseCharIndex),((e,[t,r,n,a,o])=>(0,i.columnRef)(n?.chars??"",!0,void 0!==a,(0,u.addSpan)(e,t,o,"","")))),F=(0,s.apply)((0,s.tuple)(a.parseCharIndex,g,a.parseCharIndex),((e,[t,r,n])=>(0,i.columnRef)(r.chars,!1,!0,(0,u.addSpan)(e,t,n,"","")))),b=(0,s.any)(v,y),C=(0,s.apply)(a.parseCharIndex,((e,t)=>(0,i.missingRef)((0,u.addSpan)(e,t,t,"","")))),k=(0,s.any)(b,C),E=(0,s.take)(((e,t)=>"#"===t.chars?t:void 0)),A=(0,s.apply)((0,s.many1)(E,c),((e,t)=>(0,l.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),T=(0,s.apply)((0,s.many1)(E,m),((e,t)=>(0,l.unexpectedToken)(t[0].start,t.map((e=>e.chars)).join("")))),R=(0,s.apply)((0,s.tuple)(a.parseCharIndex,A,a.parseCharIndex),((e,[t,r,n])=>(0,i.badRef)(r.chars,!1,!0,(0,u.addSpan)(e,t,n,"","")))),N=(0,s.apply)((0,s.tuple)(a.parseCharIndex,a.parseLeftBracket,T,(0,s.opt)(a.parseRightBracket,void 0),a.parseCharIndex),((e,[t,r,n,a,o])=>(0,i.badRef)(n.chars,!0,void 0!==a,(0,u.addSpan)(e,t,o,"","")))),I=(0,s.any)(R,N),P=(0,s.apply)((0,s.tuple)(a.parseCharIndex,k,a.parseRangeOp,k,a.parseCharIndex),((e,[t,r,n,a,o])=>(0,i.rangeOpRef)(r,a,(0,u.addSpan)(e,t,o,"","")))),O=(0,s.any)(P,b),M=(0,s.any)(S,I,P,b,C),D=(0,s.apply)((0,s.tuple)(a.parseCharIndex,M,(0,s.many1)((0,s.tuple)(a.parseListSep,M)),a.parseCharIndex),((e,[t,r,n,a])=>(0,i.commaOpRef)([r,...n.map((([e,t])=>t))],(0,u.addSpan)(e,t,a,"","")))),w=(0,s.apply)((0,s.tuple)(a.parseCharIndex,a.parseAtOp,(0,s.opt)(O,void 0),a.parseCharIndex),((e,[t,r,n,a])=>(0,i.thisRowOpRef)(n,(0,u.addSpan)(e,t,a,"","")))),_=(0,s.apply)(a.parseSpacesOnly,(()=>{})),L=(0,s.any)((0,s.left)(_,a.parseEnd),(0,s.left)(F,a.parseEnd),(0,s.left)(D,a.parseEnd),(0,s.left)(w,a.parseEnd),(0,s.left)(P,a.parseEnd),(0,s.left)(S,a.parseEnd),(0,s.left)(I,a.parseEnd),(0,s.left)(y,a.parseEnd));t.parseStructRef=(0,s.applyTake)((0,s.tuple)(a.parseCharIndex,a.parseBracketedTokens,a.parseCharIndex),((e,[t,[r,a],l])=>{const c=(0,s.runParser)(L,r,0,e);return(0,n.isSuccess)(c)?(0,o.structRefTerm)((0,i.structRef)(c.value.output,a,(0,u.addSpan)(e,t,l,"","")),t,l):void 0}))},9654:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runParser=function(e,t,r,i){let a;if(function(e){let t=e;for(;null!=t;)t=t()}(e(t,r,i,(function(e,t){a=(0,n.success)({output:e,index:t})}),(function(){a=(0,n.failure)(void 0)}))),null==a){const e=`calc.parse.runParser: internal error: parser did not call resolve or reject on ${(0,n.anonymize)(t)}`;return(0,n.assertFalse)(e)}return a},t.lazy=function(e){let t;return function(r,n,i,a,o){const s=t??(t=e());return()=>s(r,n,i,a,o)}},t.setDebugging=function(e){i=e},t.warnSucceedOrFail=function(e,t){return function(r,n,a,o,s){return e(r,n,a,((e,n)=>(i&&console.warn(`${t} succeeded, returning index ${n} (of ${r.length}) with`,e),o(e,n))),(()=>(i&&console.warn(`${t} failed at index ${n} (of ${r.length})`),s)))}},t.parseSucceed=a,t.parseFail=s,t.bind=u,t.apply=l,t.withState=function(e){return(t,r,n,i,a)=>e(n)(t,r,n,i,a)},t.any=function(...e){return 0===e.length?s():e.reduce(c)},t.opt=function(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(()=>a(t,n)))}},t.succeeds=function(e){return function(t,r,n,i,a){return e(t,r,n,(()=>i(!0,r)),a)}},t.fails=function(e){return function(t,r,n,i,a){return e(t,r,n,a,(()=>i(!0,r)))}},t.take=function(e){return d(e,1)},t.peek=function(e){return d(e,0)},t.takePeek=function(e){return function(t,r,n,i,a){const o=t[r],s=t[r+1];if(null==o||null==s)return a;const u=e(n,o,s);return null==u?a:i(u,r+1)}},t.applyTake=function(e,t){return function(r,n,i,a,o){return e(r,n,i,((e,r)=>{const n=t(i,e);return null==n?o:a(n,r)}),o)}},t.reduce=m,t.many=function(e,t){return void 0===t?function(t,r,n,i,a){return g(e,[])(t,r,n,i,a)}:function(r,n,i,a,o){return e(r,n,i,((e,n)=>g(t,[e])(r,n,i,a,o)),(()=>a([],n)))}},t.many1=function(e,t=e){return u(e,((e,r)=>g(t,[r])))},t.tuple=p,t.left=function(e,t){return l(p(e,t),((e,[t])=>t))},t.right=function(e,t){return l(p(e,t),((e,[,t])=>t))},t.middle=function(e,t,r){return l(p(e,t,r),((e,[,t])=>t))},t.flatten=h,t.concat=function(...e){return h(p(...e))};const n=r(6913);let i=!1;function a(e){return function(t,r,n,i,a){return i(e,r)}}const o=(e,t,r,n,i)=>i;function s(){return o}function u(e,t){return function(r,n,i,a,o){return e(r,n,i,((e,n)=>t(i,e)(r,n,i,a,o)),o)}}function l(e,t){return function(r,n,i,a,o){return e(r,n,i,((e,r)=>a(t(i,e),r)),o)}}function c(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(()=>t(r,n,i,a,o)))}}function d(e,t){return function(r,n,i,a,o){const s=r[n];if(null==s)return o;const u=e(i,s);return null==u?o:a(u,n+t)}}function m(e,t,r){return function(i,a,o,s,u){let l=r,c=a;function d(){return e(i,c,o,m,g)}function m(e,r){if(r<=c){const e=(0,n.anonymize)(i),t=`calc.parse.reduce: internal error: no progress made at index ${c} on ${e}`;return(0,n.assertFalse)(t)}return l=t(o,e,l),c=r,d}function g(){return s(l,c)}return d}}function g(e,t){return m(e,(function(e,t,r){return r.push(t),r}),t)}function p(...e){if(0===e.length)return a([]);if(1===e.length)return l(e[0],((e,t)=>[t]));const t=e.length;return function(r,n,i,a,o){let s=n;const u=[];function l(){return e[u.length](r,s,i,c,o)}function c(e,r){return s=r,u.push(e),u.length<t?l:a(u,s)}return l}}function h(e){return l(e,((e,t)=>(0,n.safeConcat)([],t)))}},4059:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=function(e){return{parseFormula:(t,r,a)=>function(e,t,r,a=0){try{const s=a>=0&&a<r.length?m[r.charCodeAt(a)]:void 0;return null==s?(0,n.failure)((0,o.notFormulaString)("first character is not '=', '+', '-' or '@'")):s<0?(0,n.failure)((0,i.notImplemented)(["Lotus 1-2-3 syntax"])):g(e,t,r,a+s)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}}(e,t,r,a),parseFormulaExpression:(t,r,i)=>function(e,t,r,i=0){try{return g(e,t,r,i)}catch(e){return(0,n.failure)((0,n.javaScriptError)(e))}}(e,t,r,i)}};const n=r(6913),i=r(6592),a=r(662),o=r(929),s=r(4732),{codePointEqualsSign:u,codePointPlusSign:l,codePointMinusSign:c,codePointAtSign:d}=n.codePoint,m={[u]:1,[l]:0,[c]:0,[d]:-1};function g(e,t,r,i){const o=t.config?.localeInfo??e.config.localeInfo,u=t.config?.refStyle??e.config.refStyle,l=e.config.mathpack,c=(0,s.tokenizeFormula)(o,l,u,t.originGridCell.value,r,i,t.syntaxFeatures),d=(0,a.runFormulaParser)(o,l,u,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,c);return(0,n.success)(d)}},3089:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListSep=void 0,t.makeState=function(e,t,r,n,i){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:i,delim:{delimId:void 0,listSep:s.Union,stack:{[o.DelimId.Paren]:!1,[o.DelimId.Brace]:!1,[o.DelimId.Bracket]:!1}},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){const r=e.spans[t.label];if(null==r){const e=`calc.parse.getNodeSpan: internal error: expected node to have a span; given ${(0,n.anonymize)(t)}`;(0,n.assertFalse)(e)}return r},t.getSpan=function(e,t){const r=e.spans[t];return(0,n.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r},t.addWhitespace=l,t.addSpan=c,t.withDelim=function({delimId:e,listSep:t},r){return d((r=>{const n=r.delim;return r.delim={delimId:e,listSep:t,stack:{...n.stack,[e]:!0}},n}),((e,t)=>e.delim=t),r)},t.cellRefMustBeCellRefNode=function(e){return d((e=>{const t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),((e,t)=>e.cellRefMustBeCellRefNode=t),e)};const n=r(6913),i=r(6592),a=r(8539),o=r(1748);var s;!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(s||(t.ListSep=s={}));const u=[];function l(e,t){const r="string"==typeof t?u:t.filter(a.isCommentToken);return["string"==typeof t?t:t.map((e=>e.chars)).join(""),r.length>0?r.map((t=>function(e,t){const r=c(e,t.start,t.start+t.chars.length,"","");return t.kind===o.TokenKind.SingleLineComment?(0,i.singleLineComment)(t.chars,r):(0,i.multiLineComment)(t.chars,t.isClosed,r)}(e,t))):void 0]}function c(e,t,r,n,a){const o=e.label;e.label+=1;const[s,u]=l(e,n),[c,d]=l(e,a);return e.spans[o]=(0,i.formulaSpan)(t,r,s,c,u,d),o}function d(e,t,r){return(n,i,a,o,s)=>{const u=e(a);return r(n,i,a,((e,r)=>(t(a,u),o(e,r))),(()=>(t(a,u),s)))}}},929:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=void 0,t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,i,a){return{config:r??void 0,lexicalKind:e,originGridCell:(0,n.success)(t),contextNames:i,syntaxFeatures:a}},t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}};const n=r(6913),i=r(6592);var a;!function(e){e.NotFormulaString="NotFormulaString"}(a||(a={})),t.ReasonKind={...i.ReasonKind,...a}},1748:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundOperatorToken=t.atOperatorToken=t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.badNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.isBadNumberOper=function(e){return e.kind===g.BadNumber},t.isNumberLikeOper=p,t.isBadErrorOper=function(e){return e.kind===g.BadError},t.cellRefA1Token=function(e,t,r,n){return S(e,t,(null==r||"object"==typeof r&&r.kind===i.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===i.PosKind.Rel),r,n,i.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,a=!1){return S(e,t,!(r!==i.SpecialPos.RCNoNum&&null!=r&&r.kind!==i.PosKind.Abs||n!==i.SpecialPos.RCNoNum&&null!=n&&n.kind!==i.PosKind.Abs),r,n,i.RefStyle.R1C1,a)},t.literalToken=v,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?v(r,n,i.falseOper):0===e.stringCompareCI(e.trueName,n)?v(r,n,i.trueOper):(0,t.identToken)(r,n)},t.operatorToken=y,t.appendToken=function(e,t,r){return r.push(t),t.start+e};const n=r(6913),i=r(6592),{codePointAsterisk:a,codePointMinusSign:o,codePointPlusSign:s,codePointSlash:u,codePointSpace:l}=n.codePoint;var c,d,m,g;function p(e){return e.kind===g.BadNumber||e.kind===i.OperKind.Number}function h(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}function f(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}function S(e,t,r,n,i,a,o){return{kind:c.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:i,refStyle:a,isBadLocale:o}}function v(e,t,r,d=!0){const m=r.kind===i.OperKind.Boolean||p(r)&&function(e){for(const t of(0,n.codePointIterator)(e))if(t===s||t===o||t===a||t===l||t===u)return!1;return!0}(t);return{kind:c.Literal,start:e,chars:t,isIdentContinue:m,oper:r,hasRight:d}}function y(e,t,r){return{kind:c.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function F(e){const t=i.operatorStrings[e];if(null==t)throw new Error(`operatorTokenMaker: invalid operator ${e}`);return r=>y(r,t,e)}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(c||(t.TokenKind=c={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(d||(t.DelimId=d={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(m||(t.SepId=m={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(g||(t.TokenOperKind=g={})),t.badNumberOper={kind:g.BadNumber},t.badErrorOper={kind:g.BadError},t.endToken=e=>h(c.End,e,"",!1),t.spacesToken=(e,t)=>h(c.Spaces,e,t,!1),t.unexpectedToken=(e,t)=>h(c.Unexpected,e,t,!1),t.escapeToken=(e,t)=>h(c.Escape,e,t,!1),t.singleLineCommentToken=(e,t)=>h(c.SingleLineComment,e,t,!1),t.multiLineCommentToken=(e,t,r)=>({kind:c.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}),t.identToken=(e,t)=>h(c.Ident,e,t,!0),t.leftParenToken=e=>f(c.Left,e,"(",d.Paren),t.leftBracketToken=(e,t)=>f(c.Left,e,t,d.Bracket),t.leftBraceToken=(e,t)=>f(c.Left,e,t,d.Brace),t.leftSQuoteToken=e=>f(c.Left,e,"'",d.SQuote),t.rightParenToken=e=>f(c.Right,e,")",d.Paren),t.rightBracketToken=(e,t)=>f(c.Right,e,t,d.Bracket),t.rightBraceToken=(e,t)=>f(c.Right,e,t,d.Brace),t.rightSQuoteToken=e=>f(c.Right,e,"'",d.SQuote),t.listSepToken=(e,t)=>f(c.Sep,e,t,m.List),t.colSepToken=(e,t)=>f(c.Sep,e,t,m.Col),t.rowSepToken=(e,t)=>f(c.Sep,e,t,m.Row),t.qualSepToken=e=>f(c.Sep,e,"!",m.Qual),t.dotSepToken=e=>f(c.Sep,e,".",m.Dot),t.assignSepToken=e=>f(c.Sep,e,":=",m.Assign),t.specialRefToken=(e,t,r)=>f(c.SpecialRef,e,t,r),t.addOperatorToken=F(i.OperatorId.Add),t.subOperatorToken=F(i.OperatorId.Sub),t.mulOperatorToken=F(i.OperatorId.Mul),t.divOperatorToken=F(i.OperatorId.Div),t.powOperatorToken=F(i.OperatorId.Pow),t.percentOperatorToken=F(i.OperatorId.Percent),t.concatOperatorToken=F(i.OperatorId.Concat),t.eqOperatorToken=F(i.OperatorId.Eq),t.ltOperatorToken=F(i.OperatorId.Lt),t.gtOperatorToken=F(i.OperatorId.Gt),t.neOperatorToken=F(i.OperatorId.Ne),t.leOperatorToken=F(i.OperatorId.Le),t.geOperatorToken=F(i.OperatorId.Ge),t.rangeOperatorToken=F(i.OperatorId.Range),t.atOperatorToken=F(i.OperatorId.At),t.poundOperatorToken=F(i.OperatorId.Pound)},4732:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=function(e,t,r,a,l,c,h){const[v,y]=function(e,t,r,a,l,c,h){const v=[],y=[];let b=c;const C=!0===h?.[i.SyntaxFeature.Comments],k=!0===h?.[i.SyntaxFeature.Statements],E=!(0,n.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,n.stringStartsWith)(e.statementSeparator,e.rowSeparator),A=!(0,n.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,n.stringStartsWith)(e.statementSeparator,e.decimalSeparator),T=(0,s.makeProgressAsserter)("calc.parse.tokenize",b);for(;b<l.length;){T(b);const c=V(e,r,a,l,b,v);if(null!=c){b=c;continue}const h=(0,n.stringCodePointAt)(l,b),R=y.length>0&&y[y.length-1].delim===o.DelimId.Brace;if(H(e,l,b,v)){const r=M(e,t,l,b,v);if(null!=r){b=r;continue}}if(h!==d)if(!e.isIdentContinue(h)||(0,n.stringStartsWith)(l,e.listSeparator,b)||R&&(0,n.stringStartsWith)(l,e.columnSeparator,b)||R&&(0,n.stringStartsWith)(l,e.rowSeparator,b))if(h!==g)if((0,i.isSpace)(h)){const[e,t]=(0,s.scanWhile)(l,b,B);b=(0,o.appendToken)(t-b,(0,o.spacesToken)(b,e),v)}else if(h!==p)if(h!==f)if((0,n.stringStartsWith)(l,e.leftBrace,b))y.push({delim:o.DelimId.Brace,lastParen:y.length>0?y[y.length-1].lastParen:void 0,lastBrace:y.length}),b=(0,o.appendToken)(e.leftBrace.length,(0,o.leftBraceToken)(b,e.leftBrace),v);else if((0,n.stringStartsWith)(l,e.rightBrace,b)){const t=y.length>0?y[y.length-1].lastBrace:void 0;void 0!==t&&(y.length=t),b=(0,o.appendToken)(e.rightBrace.length,(0,o.rightBraceToken)(b,e.rightBrace),v)}else if((0,n.stringStartsWith)(l,e.leftBracket,b))b=G(e,l,b,v);else if((0,n.stringStartsWith)(l,e.rightBracket,b))b=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(b,e.rightBracket),v);else{if(R){if(k&&E&&(0,n.stringStartsWith)(l,e.statementSeparator,b))break;if((0,n.stringStartsWith)(l,e.columnSeparator,b)){b=(0,o.appendToken)(e.columnSeparator.length,(0,o.colSepToken)(b,e.columnSeparator),v);continue}if((0,n.stringStartsWith)(l,e.rowSeparator,b)){b=(0,o.appendToken)(e.rowSeparator.length,(0,o.rowSepToken)(b,e.rowSeparator),v);continue}}if(k&&(0,n.stringStartsWith)(l,e.statementSeparator,b)&&(A||0===y.length))break;if((0,n.stringStartsWith)(l,e.listSeparator,b))b=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(b,e.listSeparator),v);else if(h!==m)if(h!==S){if(h===F&&b+1<l.length&&C){const e=l.charCodeAt(b+1);if(e===F){const[e,t]=(0,s.scanWhile)(l,b,W);b=(0,o.appendToken)(t-b,(0,o.singleLineCommentToken)(b,e),v);continue}if(e===u){let[e,t]=(0,s.scanWhile)(l,b+2,U);const r=(0,n.stringStartsWith)(l,"*/",t);(0,n.assertTrue)("calc.parse.tokenize: /**/",r||t===l.length),t+=r?2:0,e="/*"+e+(r?"*/":""),b=(0,o.appendToken)(t-b,(0,o.multiLineCommentToken)(b,e,r),v);continue}}if(N(h)){if((0,n.stringStartsWith)(l,":=",b)&&(0,n.isFeatureEnabled)(n.FeatureName.CalcLambdaDefaultParameters)){b=(0,o.appendToken)(2,(0,o.assignSepToken)(b),v);continue}b=O(l,b,v)}else b=(0,o.appendToken)((0,n.numCodeUnits)(h),(0,o.unexpectedToken)(b,(0,n.stringFromCodePoint)(h)),v)}else b=j(e,l,b,v);else b=(0,o.appendToken)(1,(0,o.qualSepToken)(b),v)}else{const e=y.length>0?y[y.length-1].lastParen:void 0;void 0!==e&&(y.length=e),b=(0,o.appendToken)(1,(0,o.rightParenToken)(b),v)}else y.push({delim:o.DelimId.Paren,lastParen:y.length,lastBrace:y.length>0?y[y.length-1].lastBrace:void 0}),b=(0,o.appendToken)(1,(0,o.leftParenToken)(b),v);else{const t=L(e,l,b,v);if(null!=t){b=t;continue}b=O(l,b,v)}else{const[t,r]=(0,s.scanWhile)(l,b,((t,r)=>e.isIdentContinue((0,n.stringCodePointAt)(t,r))));b=(0,o.appendToken)(r-b,(0,o.identOrBooleanToken)(e,b,t),v)}else b=_(l,b,v)}return[v,b]}(e,t,r,a,l,c,h),b=[];let C=0;for(;C<v.length;){const e=v[C];if(e.kind!==o.TokenKind.Unexpected)b.push(e),C+=1;else{const[e,t]=q(v,C,o.TokenKind.Unexpected,((e,t)=>{const r=e,n=t;return(0,o.unexpectedToken)(r.start,r.chars+n.chars)}));b.push(e),C=t}}return b.push((0,o.endToken)(y)),b};const n=r(6913),i=r(6592),a=r(8539),o=r(1748),s=r(9825),{codePointAsterisk:u,codePointAtSign:l,codePointColon:c,codePointDoubleQuote:d,codePointExclamationMark:m,codePointHash:g,codePointLeftParen:p,codePointQuestionMark:h,codePointRightParen:f,codePointSingleQuote:S,codePointFullStop:v,codePointDigitZero:y,codePointSlash:F,codePointMinusSign:b,codePointSpace:C,codePointInvertedExclamationMark:k,codePointInvertedQuestionMark:E,codePointLeftSingleQuotationMark:A,codePointRightSingleQuotationMark:T}=n.codePoint;let R;function N(e){if(!R){R=(0,n.makeStringMap)();for(const e of Object.getOwnPropertyNames(I))R[e.charCodeAt(0)]=!0;for(const e of Object.getOwnPropertyNames(P))R[e.charCodeAt(0)]=!0}return!0===R[e]}const I={"+":o.addOperatorToken,"-":o.subOperatorToken,"*":o.mulOperatorToken,"/":o.divOperatorToken,"^":o.powOperatorToken,"%":o.percentOperatorToken,"&":o.concatOperatorToken,"=":o.eqOperatorToken,"<":o.ltOperatorToken,">":o.gtOperatorToken,":":o.rangeOperatorToken,".":o.dotSepToken,"@":o.atOperatorToken,"#":o.poundOperatorToken},P={"<>":o.neOperatorToken,"<=":o.leOperatorToken,">=":o.geOperatorToken};function O(e,t,r){if(t<e.length-1){const n=P[e.substring(t,t+2)];if(null!=n)return(0,o.appendToken)(2,n(t),r)}const i=I[e.charAt(t)];return null!=i?(0,o.appendToken)(1,i(t),r):(0,n.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function M(e,t,r,n,a){const s=(0,i.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0===s)return;const{value:u,i:l}=s,c=r.substring(n,l);return(0,o.appendToken)(l-n,(0,o.literalToken)(n,c,u??o.badNumberOper,!0),a),l}const D=(e,t)=>e.charCodeAt(t)!==d,w=(e,t)=>e.charCodeAt(t)===d;function _(e,t,r){const[n,a]=(0,s.scanEscapedWhile)(e,t+1,D,'"',w),u=e.substring(t,a+1);return a<e.length?(0,o.appendToken)(a+1-t,(0,o.literalToken)(t,u,(0,i.stringOper)(n),!0),r):(0,o.appendToken)(a-t,(0,o.literalToken)(t,u,(0,i.stringOper)(n),!1),r)}function L(e,t,r,a){for(let n=1;n<e.errorNames.length;n+=1){const s=e.errorNames[n];if(null==s)continue;const u=t.substring(r,r+s.length);if(0===e.stringCompareCI(s,u))return(0,o.appendToken)(s.length,(0,o.literalToken)(r,u,(0,i.errorOper)(n)),a)}let s=r+1,u=!1;for(;s<t.length;){const i=(0,n.stringCodePointAt)(t,s);if(s!==r+1||i!==k&&i!==E)if(!(s>r+1)||i!==F&&i!==b&&i!==C||u)if(s>r+1&&i===v)s+=1;else{if(s>r+1&&i===y){s+=1,s<t.length&&t.charCodeAt(s)===m&&(s+=1);break}if(i===m||i===h){s!==r+1&&(s+=1);break}if(!e.isIdentContinue(i)||e.isNumeral(i)){if(i!==A&&i!==T)break;s+=1}else s+=(0,n.numCodeUnits)(i)}else u=!0,s+=1;else s+=1}for(;s>r+1&&t.charCodeAt(s-1)===C;)--s;if(s>r+1){const e=t.substring(r,s);return(0,o.appendToken)(s-r,(0,o.literalToken)(r,e,o.badErrorOper),a)}}function x(e,t,r,n){for(let i=1;i<e.specialRefNames.length;i+=1){const a=e.specialRefNames[i];if(null==a)continue;const s=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,s))return(0,o.appendToken)(a.length,(0,o.specialRefToken)(r,s,i),n)}}function K(e,t,r){const a=t.charCodeAt(r);return!((0,i.isSpace)(a)||a===S||a===g||a===c||a===l||(0,n.stringStartsWith)(t,e.listSeparator,r)||(0,n.stringStartsWith)(t,e.leftBracket,r)||(0,n.stringStartsWith)(t,e.rightBracket,r))}const B=(e,t)=>(0,i.isSpace)((0,n.stringCodePointAt)(e,t)),W=(e,t)=>!(0,i.isLineBreak)((0,n.stringCodePointAt)(e,t)),U=(e,t)=>!(t+1<e.length&&e.charCodeAt(t)===u&&e.charCodeAt(t+1)===F);function G(e,t,r,a){let u=r,d=0;const m=(t,r)=>K(e,t,r),p=(t,r)=>!K(e,t,r),h=(0,s.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",u);for(;u<t.length;){h(u);const r=(0,n.stringCodePointAt)(t,u);if(a.length>0&&a[a.length-1].kind===o.TokenKind.Escape&&p(t,u))u=(0,o.appendToken)((0,n.numCodeUnits)(r),(0,o.identToken)(u,(0,n.stringFromCodePoint)(r)),a);else if(r!==l){if(r===g){const r=x(e,t,u,a);if(null!=r){u=r;continue}}if(r!==S)if((0,n.stringStartsWith)(t,e.rightBracket,u)){if(u=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(u,e.rightBracket),a),d-=1,0===d)return u}else if(m(t,u)){const[e,r]=(0,s.scanWhile)(t,u,m);u=(0,o.appendToken)(r-u,(0,o.identToken)(u,e),a)}else if((0,i.isSpace)(r)){const[e,r]=(0,s.scanWhile)(t,u,B);u=(0,o.appendToken)(r-u,(0,o.spacesToken)(u,e),a)}else r!==c?(0,n.stringStartsWith)(t,e.listSeparator,u)?u=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(u,e.listSeparator),a):(0,n.stringStartsWith)(t,e.leftBracket,u)&&d<2?(u=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(u,e.leftBracket),a),d+=1):u=(0,o.appendToken)((0,n.numCodeUnits)(r),(0,o.unexpectedToken)(u,(0,n.stringFromCodePoint)(r)),a):u=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(u),a);else u=(0,o.appendToken)(1,(0,o.escapeToken)(u,"'"),a)}else u=(0,o.appendToken)(1,(0,o.atOperatorToken)(u),a)}return u}function j(e,t,r,i){let a=(0,o.appendToken)(1,(0,o.leftSQuoteToken)(r),i);const l=(t,r)=>function(e,t,r){const i=t.charCodeAt(r);return i!==S&&i!==c&&i!==u&&i!==h&&!(0,n.stringStartsWith)(t,e.leftBracket,r)&&!(0,n.stringStartsWith)(t,e.rightBracket,r)}(e,t,r),d=(e,t)=>e.charCodeAt(t)===S,m=(0,s.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",a);for(;a<t.length;){m(a);const r=(0,n.stringCodePointAt)(t,a);if(r===S&&!(a+1<t.length&&t.charCodeAt(a+1)===S))return(0,o.appendToken)(1,(0,o.rightSQuoteToken)(a),i);if(r!==c)if((0,n.stringStartsWith)(t,e.leftBracket,a))a=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(a,e.leftBracket),i);else if((0,n.stringStartsWith)(t,e.rightBracket,a))a=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(a,e.rightBracket),i);else if((0,s.getEscapedSkip)(t,a,l,"'",d)>0){const[e,r]=(0,s.scanEscapedWhile)(t,a,l,"'",d);a=(0,o.appendToken)(r-a,(0,o.identToken)(a,e),i)}else a=(0,o.appendToken)((0,n.numCodeUnits)(r),(0,o.unexpectedToken)(a,(0,n.stringFromCodePoint)(r)),i);else a=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(a),i)}return a}function V(e,t,r,n,a,s){const u=(0,i.parseCellRef)(e,t,r,n,a);if(null!=u){const e=u.i,t=n.substring(e,a),r=u.refStyle===i.RefStyle.A1?(0,o.cellRefA1Token)(a,t,u.row,u.col):(0,o.cellRefR1C1Token)(a,t,u.row,u.col,u.enLocale);return(0,o.appendToken)(e-a,r,s)}}function H(e,t,r,i){let s=i.length-1,u=i[s];if(null==u)return!0;if(u.kind===o.TokenKind.Sep&&u.value===o.SepId.Dot)return!1;if((0,n.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=u&&(0,a.isWhitespaceToken)(u);)u=i[--s];return null==u||u.kind!==o.TokenKind.Ident&&u.kind!==o.TokenKind.CellRef&&u.kind!==o.TokenKind.Right&&(u.kind!==o.TokenKind.Literal||(0,o.isNumberLikeOper)(u.oper))}return e.isNumeral((0,n.stringCodePointAt)(t,r))}function q(e,t,r,n){let i=e[t],a=t+1;for(;a<e.length;a+=1){const t=e[a];if(t.kind!==r)break;i=n(i,t)}return[i,a]}},9825:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeProgressAsserter=function(e,t){let r=t-1;return function(t){if(t<=r){const r=`${e}: internal error: no progress made at index ${t}`;return(0,n.assertFalse)(r)}r=t}},t.scanWhile=function(e,t,r){let i=t;for(;i<e.length&&r(e,i);)i+=(0,n.numCodeUnits)((0,n.stringCodePointAt)(e,i));return[e.substring(t,i),i]},t.getEscapedSkip=i,t.scanEscapedWhile=function(e,t,r,a,o){const s=[];let u=t,l=t;for(;l<e.length;){const t=i(e,l,r,a,o);if(0===t)break;2===t&&(u!==l&&s.push(e.substring(u,l)),u=l+a.length,l+=a.length),l+=(0,n.numCodeUnits)((0,n.stringCodePointAt)(e,l))}return u!==l&&s.push(e.substring(u,l)),[s.join(""),l]};const n=r(6913);function i(e,t,r,i,a){return r(e,t)?1:(0,n.stringStartsWith)(e,i,t)&&t+i.length<e.length&&a(e,t+i.length)?2:0}},6648:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6533);n.__exportStar(r(7978),t),n.__exportStar(r(7402),t)},8968:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzer=void 0;var n=r(391);Object.defineProperty(t,"createAnalyzer",{enumerable:!0,get:function(){return n.createAnalyzer}}),Object.defineProperty(t,"analyzeLocalsGrid",{enumerable:!0,get:function(){return n.analyzeLocalsGrid}}),Object.defineProperty(t,"analyzeLocalsName",{enumerable:!0,get:function(){return n.analyzeLocalsName}}),Object.defineProperty(t,"diagnostics",{enumerable:!0,get:function(){return n.diagnostics}}),Object.defineProperty(t,"summarizeFormulaDiagnostics",{enumerable:!0,get:function(){return n.summarizeFormulaDiagnostics}}),Object.defineProperty(t,"staticPrecedents",{enumerable:!0,get:function(){return n.staticPrecedents}}),Object.defineProperty(t,"createAnalyzeGlobals",{enumerable:!0,get:function(){return n.createAnalyzeGlobals}})},3313:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLocaleInfo=g,t.localeInfoFromData=function(e){return g(e,{})},t.sheetRangeLocationToGridRange=h,t.sheetCellLocationToGridCell=function(e,t){const{row:r,column:n}=t;return(0,o.sheetGridCell)((0,o.sheetIndex)(e,t.sheetId),(0,o.gridCell)(r,n))},t.unusedCellsUpdateToUsedRange=function(e,t){const{sheetId:r,usedRange:i}=t;return(0,n.isDefined)(i)?h(e,{sheetId:r,...i}):(0,u.sheetUsedRange)((0,o.sheetIndex)(e,r),s.emptyUsedRange)},t.sheetGridRangeToCellSet=function({sheet:e,range:t},r,n){const i=function(e,t,r){const n=(0,a.createFromProduct)({row:t}),i=(0,a.createFromProduct)({col:r}),o=(0,a.unionProduct)(n,i);return(0,a.exceptProduct)((0,c.createCellSetFromRange)(e),o)}(t,r,n);return{sheet:e,set:i}},t.sheetGridRangeToHiddenRows=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToHiddenCols=function({sheet:e,range:t},r){return{sheet:e,range:t,hidden:r}},t.sheetGridRangeToLocation=f,t.gridCellToCellLocation=function({row:e,col:t}){return{row:e,column:t}},t.createExcludeCellSet=function(e,t,r,a){let o=i.empty;if((0,n.isNone)(a))return o;for(let s=0;s<a.length;s+=1){const u=a[s];if(e<=u&&u<e+t){let e=1;for(;s+e<a.length&&a[s+e]===u+e;)e+=1;s+=e-1,o=(0,i.union)(o,r((0,n.pair)(u,u+e)))}}return o},t.cellValueToReadOper=function(e,t){switch(typeof t){case"string":return(0,o.stringOper)(t);case"boolean":return(0,o.booleanOper)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return o.blankOper;case"Error":return(0,o.errorOper)(t.type);default:return}},t.readOperToCellValue=function(e,t){switch(t.kind){case o.OperKind.String:case o.OperKind.Boolean:return t.value;case o.OperKind.Number:return e.toNumber(t);case o.OperKind.Error:return(0,m.errorValue)(t.type);case o.OperKind.Blank:return m.blankValue;default:return}},t.namedObjectDataToNamedObject=function(e,t,r,i){if(!(0,n.isNone)(i))switch(i.kind){case"NamedValue":switch(typeof i.value){case"string":return(0,l.namedValue)((0,o.stringOper)(i.value));case"boolean":return(0,l.namedValue)((0,o.booleanOper)(i.value));case"number":return(0,l.namedValue)(e.fromNumber(i.value))}return"Error"===i.value.kind?(0,l.namedValue)((0,o.errorOper)(i.value.type)):(0,n.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",i.value.kind);case"NamedFormula":return(0,l.namedFormula)(i.formulaBarText);case"NamedRange":{const e=h(r,i.range);return(0,l.namedRange)((0,o.range3DOper)(e.sheet,e.range))}case"NamedTable":{const e=h(r,i.range);return(0,l.namedTable)(e,i.hasHeadersRow,i.hasTotalsRow,i.columns,t)}case"NamedFailure":return(0,l.namedFailure)(i.failureReason,(0,n.isNone)(i.objectKind)?void 0:i.objectKind);default:return(0,n.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",i)}},t.namedObjectToNamedObjectData=function(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case o.OperKind.Number:return(0,m.namedValueData)(e.toNumber(r.value));case o.OperKind.String:case o.OperKind.Boolean:return(0,m.namedValueData)(r.value.value);case o.OperKind.Error:return(0,m.namedValueData)(r.value.type);default:return}case"NamedFormula":return(0,m.namedFormulaData)(r.fmla);case"NamedRange":{const e=(0,o.sheetGridRange)((0,o.sheetIndex)(t,r.value.sheets.index),r.value.ranges[0]);return(0,m.namedRangeData)(f(e))}case"NamedTable":{const e=r.specialRefRanges[o.SpecialRefId.Data],t=[];return r.columnIndexes.forEach(((e,r)=>(t.push((0,m.columnData)(e,r)),!0))),(0,m.namedTableData)(f(e),r.hasHeadersRow,r.hasTotalsRow,t)}case"NamedFailure":return(0,m.namedFailureData)(r.failureReason,r.objectKind);default:return(0,n.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",r)}},t.cellFormatToInferredFormat=function(e){if(void 0!==e)return(0,u.isOutputFormatUnavailable)(e.format)?(0,m.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,m.inferredFormat)(e.format,e.valueType,e.decimals)},t.evalFormulaFormatToUnion=function(e){if(null!=e)switch(e.kind){case"Origin":return{kind:u.SpecialFormat.Origin};case"Iformat":return(0,n.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Known":return(0,n.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat","number"==typeof e.knownFormat),{kind:u.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:u.SpecialFormat.Inferred};case"Aggregate":return{kind:u.SpecialFormat.Aggregate};default:return(0,n.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}};const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(6824),u=r(9204),l=r(7214),c=r(8453),d=r(8328),m=r(721);function g(e,t){const r=(0,n.makeStringCompareCI)("en-US"),{getWorksheetFuncId:i,getWorksheetFuncName:a}=function(e,t,r){const n=(0,o.getEnglishWorksheetFuncIdToName)().slice();return(0,d.filterCheck)(t,d.chWorksheetFunctionName,r,"localeData.worksheetFunctionNames").forEach((e=>n[e.functionId]=e.functionName)),(0,o.createWorksheetFuncNameCallbacks)(e,n)}(r,e.worksheetFunctionNames,t),s=(u=e.thousandsData,(0,n.isNone)(u)?e=>e>0&&e%3==0:(0,o.createIsThousandsPositionCallback)(u));var u;const l=function(e,t){const r=o.englishErrorNames.slice();return(0,d.filterCheck)(e,d.chErrorTypeName,t,"localeData.errorTypeNames").forEach((e=>r[e.errorType]=e.errorName)),r}(e.errorTypeNames,t),{lcid:c}=e,m=c===o.LCID.Thailand,g=c===o.LCID.Korea,p=c===o.LCID.Japan,h=c===o.LCID.ChinaT||c===o.LCID.HongKong,f=c===o.LCID.China,S=g||p||f||h,v=c===o.LCID.Hindi||c===o.LCID.Tamil,y=c===o.LCID.Thailand||c===o.LCID.Vietnam||v,F=(c&o.LCID.LANG)==(o.LCID.Hebrew&o.LCID.LANG)||(c&o.LCID.LANG)==(o.LCID.Arabic&o.LCID.LANG)||c===o.LCID.Syriac||y,b=";"===e.listSeparator||";"===e.decimalSeparator?";;":";";return{...e,cultureTag:{primary:e.cultureTagPrimary,userDefault:e.cultureTagUserDefault,instLang:e.cultureTagInstLang,userCurrent:e.cultureTagUserCurrent},leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:i,getWorksheetFuncName:a,isNumeral:o.isNumeral,getOrdinal:o.getOrdinal,getNumberShape:o.getNumberShape,isThousandsPosition:s,isIdentStart:o.isIdentStart,isIdentContinue:o.isIdentContinue,stringCompareCI:r,errorNames:l,statementSeparator:b,isThai:m,isEastAsia:S,isKorea:g,isJapan:p,isChinaT:h,isChinaS:f,isComplexScript:F}}function p(e,t){return(0,n.isNone)(t)?{index:e,length:1}:{index:e,length:(0,n.fastAbs)(t-e)+1}}function h(e,t){const{index:r,length:n}=p(t.row,t.lastRow),{index:i,length:a}=p(t.column,t.lastColumn);return(0,o.sheetGridRange)((0,o.sheetIndex)(e,t.sheetId),(0,o.gridRange)(r,i,n,a))}function f(e){return(0,o.isSheetGridCell)(e)?(0,m.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,m.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}},1436:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExceLintExperiment=void 0;const n=r(6913),i=r(6592),a=r(6736);t.ExceLintExperiment=class{get done(){return!0}setContext({documents:e}){try{n.ulsLogger.ULS.traceTag(578588694,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");const t=function(e){const t=e.getServerDocument(),r=[];for(const a of e.getServerAvailableCells()){let o="UndefinedSheet";if(void 0!==t){const r=e.getSheetName(t,a.sheetIdx.index);r.kind===n.ResultKind.Success&&(o=r.value)}const s=e.getServerUsedRange(a.sheetIdx);if(s.kind===n.ResultKind.Failure||void 0===s.value)continue;const u=s.value.sheet,l={...s.value.range};l.cols=Math.min(l.cols,75),l.rows=Math.min(l.rows,1e3);const c=[],d=[],m=[];let g=0;for(let t=l.row,r=l.row+l.rows-1;t<=r;t+=1){const r=[],a=[],o=[];for(let s=l.col,c=l.col+l.cols-1;s<=c;s+=1){const l=(0,i.sheetGridCell)(u,(0,i.gridCell)(t,s)),c=e.getServerValue(l),d=c.kind===n.ResultKind.Success?JSON.stringify(c.value):"";a.push(d);const m=e.getServerFormat(l),p=m.kind===n.ResultKind.Success?(0,n.fnv1a)(JSON.stringify(m.value)).toString():"";o.push(p);const h=e.getServerFormula(l),f=h.kind===n.ResultKind.Success?h.value?.[1].compiledFmla?.getValue():void 0,S=f?.kind===n.ResultKind.Success?h.value?.[1].fmla??"":"";""!==S&&(g+=1),r.push(S)}c.push(r),d.push(a),m.push(o)}if(0===g)continue;const p={sheetName:o,usedRangeAddress:(0,i.formatGridRange)(e.config.localeInfo,l,i.RefStyle.A1,o),values:d,formulas:c,styles:m};r.push(p)}return{workbookName:"PartialWorkbook",worksheets:r}}(e);this.result=(0,a.detect_errors)(t,void 0,void 0,this.timeLimitMS)}catch(e){this.result=`ExceLint experiment crashed with error: ${e}`}}step(){}get report(){return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((e=>{const t=this.result.worksheets[e],r=t.exampleFixes.map(((e,r)=>{const i=t.proposedFixes[r][0],a=e.rangeSizes,o=a.reduce(((e,t)=>e+t),0);return{anomalousnessIndex:i,categories:e.bin,sizeOfCellRange:o,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(n.anonymizeFormulaString),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),i=r.map((e=>e.sizeOfEachSFRRange.length)).reduce(((e,t)=>e+t),0);return{totalFormulas:t.numFormulaCells,totalSimilarFormulaRanges:i,numberOfAdjacentSFRs:r.length,numberOfAnomalousRanges:t.suspiciousRanges,numberOfCellsInAnomalousRanges:t.suspiciousCells,anomalies:r,elapsedTimeSeconds:t.elapsedTimeSeconds,proposedFixesTimeSeconds:t.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:t.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:t.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:t.exampleFixesTimeSeconds,numCountingTimeSeconds:t.numCountingTimeSeconds,columns:t.columns,rows:t.rows}})).filter((e=>e.totalFormulas>0))}get resultLogMessage(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":`ExceLint experiment done. Result: ${JSON.stringify(this.report)}`}get failedLogMessage(){return this.resultLogMessage+" BTW, experiment ran out of time budget"}constructor(e=75){this.timeLimitMS=e,this.result=void 0}}},2374:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrecisionExperiment=t.PrecisionStopReason=t.PrecisionMessageKind=void 0,t.precisionValue=m;const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(6824),u=r(9204),l=r(8453),c=r(7755),d=r(4352);function m(e,t){switch(t.kind){case o.OperKind.Number:return{kind:"n",magnitude:(0,n.anonymizeMagnitude)(e.toNumber(t))};case o.OperKind.String:return{kind:"s"};case o.OperKind.Boolean:return{kind:"b"};case o.OperKind.Error:return{kind:"e",type:(0,o.englishErrorTypeToName)(t.type)};case o.OperKind.Rich:return{kind:"r"};case o.OperKind.Array:return{kind:"a"};case o.OperKind.Blank:return{kind:"z"};default:return(0,n.assertNever)("calc.calc.precisionValue",t)}}var g,p;function h(e,t){const r=e[t.sheet.index];return void 0!==r&&(0,a.meetsProduct)(r,(0,l.createCellSetFromRange)(t.range))}function f(e,t){const r=e[t.sheet.index]??i.empty;e[t.sheet.index]=(0,a.unionProduct)(r,(0,l.createCellSetFromRange)(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(g||(t.PrecisionMessageKind=g={})),function(e){e.Success="Success",e.Timeout="Timeout"}(p||(t.PrecisionStopReason=p={}));const S={[o.OperatorId.Add]:.05,[o.OperatorId.Sub]:.069,[o.OperatorId.Eq]:.097,[o.OperatorId.Mul]:.1,[o.OperatorId.Div]:.11,[o.OperatorId.Concat]:.36,[o.OperatorId.Gt]:.65,[o.OperatorId.Ne]:.79,[o.OperatorId.Lt]:.89,[o.OperatorId.Le]:1.6,[o.OperatorId.Ge]:1.9,[o.OperatorId.Percent]:2.9,[o.OperatorId.At]:6.2,[o.OperatorId.Pow]:13,[o.OperatorId.Range]:67},v={[o.WorksheetFuncId.IF]:.076,[o.WorksheetFuncId.SUM]:.11,[o.WorksheetFuncId.IFERROR]:.5,[o.WorksheetFuncId.COUNTIF]:.77,[o.WorksheetFuncId.AND]:.82,[o.WorksheetFuncId.VLOOKUP]:1.5,[o.WorksheetFuncId.AVERAGE]:1.5,[o.WorksheetFuncId.HOUR]:1.9,[o.WorksheetFuncId.MINUTE]:1.9,[o.WorksheetFuncId.TEXT]:2,[o.WorksheetFuncId.OR]:2,[o.WorksheetFuncId.NOW]:2.1,[o.WorksheetFuncId.ISBLANK]:2.3,[o.WorksheetFuncId.CONCATENATE]:2.6,[o.WorksheetFuncId.SUMIF]:2.7,[o.WorksheetFuncId.COUNTIFS]:3.3,[o.WorksheetFuncId.LEFT]:3.4,[o.WorksheetFuncId.ISNUMBER]:3.7,[o.WorksheetFuncId.MID]:3.9,[o.WorksheetFuncId.COUNTA]:4,[o.WorksheetFuncId.MONTH]:4.2,[o.WorksheetFuncId.SECOND]:4.3,[o.WorksheetFuncId.LEN]:4.9,[o.WorksheetFuncId.WEEKNUM]:5,[o.WorksheetFuncId.DAY]:5.2,[o.WorksheetFuncId.ROUND]:5.4,[o.WorksheetFuncId.FIND]:5.8,[o.WorksheetFuncId.NETWORKDAYS]:6.2,[o.WorksheetFuncId.COUNT]:6.2,[o.WorksheetFuncId.YEAR]:6.3,[o.WorksheetFuncId.INT]:6.4,[o.WorksheetFuncId.RIGHT]:6.7,[o.WorksheetFuncId.ABS]:7,[o.WorksheetFuncId.CONCAT]:7.2,[o.WorksheetFuncId.CHAR]:7.4,[o.WorksheetFuncId.MAX]:8,[o.WorksheetFuncId.ROW]:8.1,[o.WorksheetFuncId.WEEKDAY]:9.1,[o.WorksheetFuncId.DAYS]:9.2,[o.WorksheetFuncId.MIN]:9.8,[o.WorksheetFuncId.SEARCH]:9.8,[o.WorksheetFuncId.WORKDAY]:11,[o.WorksheetFuncId.DATEDIF]:12,[o.WorksheetFuncId.TIME]:13,[o.WorksheetFuncId.HYPERLINK]:13,[o.WorksheetFuncId.IFS]:13,[o.WorksheetFuncId.ISERROR]:13,[o.WorksheetFuncId.COUNTBLANK]:14,[o.WorksheetFuncId.TODAY]:14,[o.WorksheetFuncId.VALUE]:18,[o.WorksheetFuncId.ROUNDUP]:18,[o.WorksheetFuncId.MATCH]:19,[o.WorksheetFuncId.DATE]:20,[o.WorksheetFuncId.SUBSTITUTE]:20,[o.WorksheetFuncId.INDIRECT]:22,[o.WorksheetFuncId.INDEX]:23,[o.WorksheetFuncId.TRIM]:24,[o.WorksheetFuncId.UPPER]:25,[o.WorksheetFuncId.SUMIFS]:28,[o.WorksheetFuncId.EXACT]:29,[o.WorksheetFuncId.NOT]:32,[o.WorksheetFuncId.PRODUCT]:35,[o.WorksheetFuncId.ROUNDDOWN]:37,[o.WorksheetFuncId.AVERAGEIF]:38,[o.WorksheetFuncId.ISTEXT]:40,[o.WorksheetFuncId.ISOWEEKNUM]:41,[o.WorksheetFuncId.EOMONTH]:42,[o.WorksheetFuncId.MROUND]:45,[o.WorksheetFuncId.COLUMN]:45,[o.WorksheetFuncId.ROWS]:46,[o.WorksheetFuncId.TIMEVALUE]:52,[o.WorksheetFuncId.TRUNC]:53,[o.WorksheetFuncId.LOOKUP]:59,[o.WorksheetFuncId.NA]:59,[o.WorksheetFuncId.DAYS360]:61,[o.WorksheetFuncId.RANK]:67,[o.WorksheetFuncId.EDATE]:72,[o.WorksheetFuncId.MOD]:82,[o.WorksheetFuncId.OFFSET]:83,[o.WorksheetFuncId.STDEV]:87,[o.WorksheetFuncId.SUBTOTAL]:91},y=(0,o.binaryVisitor)({...(0,o.constVisitor)(.01),nameNode:()=>1,operatorNode:e=>S[e]??100,wsfNode:e=>v[e]??100},n.fastMax);t.PrecisionExperiment=class{get done(){return void 0!==this.result}get resultLogMessage(){return this.createResultLogMessage(p.Success)}get failedLogMessage(){return this.createResultLogMessage(p.Timeout)}get readonlyDebugLog(){return this.log}setContext(e){this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new n.MachineRuntime(this.sampleCells().bind((({evalCells:e,printCells:t})=>n.Pledge.all([...e.map(this.testEval),...t.map(this.testPrint)]))).catch((e=>{this.log.push({kind:g.UnhandledFailure,reason:e})})))}step(){if(this.result)return;const e=this.runtime.step();this.result=e.kind===n.TransitionKind.Break||e.kind===n.TransitionKind.Next?void 0:e}sampleCells(){const e=[],t=[],r=[];return this.docs.getServerAvailableCells().forEach((({sheetIdx:a})=>(r.push(n.Pledge.try((()=>{this.docs.forEachServerNonBlankCellInSet(a,i.dense,(r=>{const i=(0,o.sheetGridCell)(a,r),{samplePrecisionEvalRate:s,samplePrecisionPrintFormulaRate:u,samplePrecisionPrintValueRate:l}=this.config;if(s>0){const t=this.getWeight(i),r=void 0===t?void 0:s>=1?1:(0,n.fastMin)(1,s*t);void 0!==r&&this.rng.next()<r&&(f(this.sampledSets,i),e.push({cell:i,p:r}))}const c=(0,n.fastMax)(u,l);if(c>0){const e=this.rng.next();if(e<c){const r=this.isValueCell(i)?l:u;e<r&&t.push({cell:i,p:r})}}return!0}))}))),!0))),n.Pledge.all(r).bind((()=>({evalCells:e,printCells:t})))}getWeight(e){const t=this.getFormula(e);if(!(0,n.isSuccess)(t))return this.onUnavailableObject(t.reason);const[,r]=t.value;return void 0!==r.compiledFmla?function(e){return(0,n.isSuccess)(e)?(0,o.reduceBottomUp)(y,e.value):1}(r.compiledFmla.getValue()):void 0}isValueCell(e){const t=this.getFormula(e);return(0,n.isSuccess)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)}resumeToPledge(e,t){return n.Pledge.try((()=>{try{this.p=t;const r=e();return Array.isArray(r)?r:this.resumeToPledge(r.resume,t)}finally{this.p=void 0}}))}getFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,n.isSuccess)(t))return t;const[r,i]=t.value??[e.range,s.blankCellGridFormula],a=(0,o.lexicalSourceGrid)(i.lexicalKind,(0,o.sheetGridRange)(e.sheet,r));return(0,n.success)([a,i])}onRangeFailure(e,t,r,n,i){const a={samples:[],failures:[t]};this.log.push({kind:g.EvalStatistics,stats:a})}onNameFailure(){}onNumberFormatFailure(){}onInferFormatFailure(){}onReturnCellValue(){}onUnavailableObject(e){const t=(0,o.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.log.push({kind:g.UnhandledFailure,reason:e})}hasWrongPrecedent(e){return e.cells.some((e=>h(this.precisionWrongSets,e)))}onSetCellValue(e,t,r,i,a){const o=this.getFormula(e);if(!(0,n.isSuccess)(o))return this.onUnavailableObject(o.reason);const[s,u]=o.value,l=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,s,u,l)}onSetCellValues(e,t,r,i,a){const s=this.getFormula((0,o.sheetGridRangeAnchor)(e));if(!(0,n.isSuccess)(s))return this.onUnavailableObject(s.reason);const[u,l]=s.value,c=this.hasWrongPrecedent(r);(0,o.forEachCellInRange)(e.range,((r,n,i)=>(this.logPrecisionResult((0,o.sheetGridCell)(e.sheet,r),t[n][i],u,l,c),!0)))}logPrecisionResult(e,t,r,i,a){const o=this.docs.allServerAvailable(e);if(!(0,n.isSuccess)(o))return this.onUnavailableObject(o.reason);if(!0!==o.value)return;const s=this.docs.getServerValue(e);if(!(0,n.isSuccess)(s))return this.onUnavailableObject(s.reason);const u=h(this.sampledSets,e),l=this.precisionResult(t,s.value.oper,r,i,u,a);(function(e){return void 0===e.sampled})(l)||f(this.precisionWrongSets,e);const c={samples:[l],failures:[]};this.log.push({kind:g.EvalStatistics,stats:c})}precisionResult(e,t,r,i,a,s){const u=this.p,{mathpack:l}=this.docs.config,c=m(l,t),[d,g]=this.docs.anonymizeFormula(r,i);if((0,o.isReadOperEqual)(l,e,t,!0))return{expected:c,formula:d,functions:g,root:a,cascaded:s,p:u};const p=m(l,e);if((0,o.isNumberOper)(t)&&(0,o.isNumberOper)(e)){const r=l.toNumber(t),i=l.toNumber(e);return{expected:c,sampled:p,relMagnitude:(0,n.anonymizeMagnitude)(0===r?i:(i-r)/r),formula:d,functions:g,root:a,cascaded:s,p:u}}return{expected:c,sampled:p,formula:d,functions:g,root:a,cascaded:s,p:u}}createResultLogMessage(e){if(0===this.log.length&&e===p.Success)return;const t={samples:[],failures:{}},r={samples:[],failures:{}},i={};for(const e of this.log)switch(e.kind){case g.EvalStatistics:t.samples.push(...e.stats.samples);for(const r of e.stats.failures)(0,c.incrementFailure)(t.failures,r);break;case g.PrintFormulaStatistics:r.samples.push(...e.stats.samples);for(const t of e.stats.failures)(0,c.incrementFailure)(r.failures,t);break;case g.UnhandledFailure:(0,c.incrementFailure)(i,e.reason);break;default:(0,n.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",e)}return["PrecisionExperiment",e,`stateId = ${this.stateId}`,`evalStats = ${JSON.stringify(t)}`,`printStats = ${JSON.stringify(r)}`,`unhandledFailures = ${JSON.stringify(i)}`].join(", ")}constructor(e){this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=({cell:e,p:t})=>this.resumeToPledge((()=>this.docs.evaluate(u.ComputeKind.EditedCell,[e],d.VolatileMode.PrecisionTest)),t),this.testPrint=({cell:e,p:t})=>n.Pledge.try((()=>{const r=this.getFormula(e);if(!(0,n.isSuccess)(r))return this.onUnavailableObject(r.reason);const[i,a]=r.value;let o;if(void 0===a.compiledFmla){const t=this.docs.getServerValue(e);if(!(0,n.isSuccess)(t))return this.onUnavailableObject(t.reason);o=this.docs.renderValueBarText(e,t.value.oper,a.fmla)}else{const e=a.compiledFmla.getValue();o=(0,n.isSuccess)(e)?this.docs.printFormulaBarText(i,a.origin,e.value):e}if(!(0,n.isSuccess)(o))return void this.log.push({kind:g.PrintFormulaStatistics,stats:{samples:[],failures:[o.reason]}});const s=(0,n.anonymizeFormulaString)(a.fmla),u=o.value===a.fmla?{expected:s,p:t}:{expected:s,sampled:(0,n.anonymizeFormulaString)(o.value),p:t};this.log.push({kind:g.PrintFormulaStatistics,stats:{samples:[u],failures:[]}})})),this.config={samplePrecisionEvalRate:e.samplePrecisionEvalRate??0,samplePrecisionPrintFormulaRate:e.samplePrecisionPrintFormulaRate??0,samplePrecisionPrintValueRate:e.samplePrecisionPrintValueRate??0,rngSeed:e.rngSeed??0|(0,n.now)()},this.rng=new n.JSF32(this.config.rngSeed)}}},3312:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0,function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(r||(t.Messages=r={}))},3769:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConstraintKind=t.UnitExperimentSettings=void 0,t.makeSolverContext=function(e,t,r){const n=new l.UF,i=n.makePoint(v),a=(0,c.createPoisonApplication)(v);return{symbolContext:e,typeContext:t,stats:r,uf:n,errorPoint:i,errorUnit:v,apply:a}},t.isInterestingFormat=R,t.updateFormatStatsFromCellFormat=N,t.valueTypeFromCellFormat=I,t.numberFormatFromCellFormat=P,t.runSolverStep=function(e){return e.kind===u.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){const{apply:t,errorUnit:r}=e.context,n={kind:u.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:(e,i)=>{const a=t(n.substitution,e);if(a===r)return;const o=t(n.substitution,i);if(o===r)return;const s=(0,c.unify)(t,a,o);s.kind!==c.UnificationResultKind.Subst?(n.stats.errorCount+=1,n.stats.enriched.errors.push({error:[t(n.substitution,e),t(n.substitution,i)]})):n.substitution=(0,c.compose)(t,s.substitution,n.substitution)},substitution:w(e.context)};return n}(e):function(e){const{constraints:t,context:r,constraintCursor:n,deferred:o}=e,s=t[n];let u;switch(s.kind){case g.UnitEquality:u=function(e,t){return T(e,t.unit,t.target)}(r,s);break;case g.FormatEquality:u=D(r,s);break;case g.RangeEquality:u=function(e,t){const r=t.type.resolution;if(!(0,a.isSheetIndex)(r.sheet))return h;if((0,a.isGridCell)(r.range)){const n=O(e,r.sheet,r.range);return void 0===n?h:T(e,n,t.target)}const n=e.typeContext.available[r.sheet.index];if(void 0===n)return h;const o=n.usedRange;if(void 0===o)return h;const s=(0,a.gridRangeIsect)(r.range,o);if(void 0===s)return h;const u=(0,i.intersectProduct)((0,i.intersectProduct)((0,m.createCellSetFromRange)(s),m.availableReadProduct),n.availableCells),l=[];return(0,m.forEachCellInSet)(u,(e=>(l.push(e),!0))),{kind:p.Staged,constraint:{kind:g.StagedRangeEquality,cursor:0,index:n.sheetIdx,cells:l,target:t.target},output:void 0}}(r,s);break;case g.StagedRangeEquality:u=function(e,t){const{cursor:r,cells:n}=t;if(r>=n.length)return h;const i=n[r],a=O(e,t.index,i),o=void 0===a?h:T(e,a,t.target);return t.cursor+=1,{kind:p.Staged,constraint:t,output:o}}(r,s)}switch(u.kind){case p.Deferred:o.push(u.constraint);break;case p.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:u.error});break;case p.Staged:if(t[n]=u.constraint,void 0!==u.output)switch(u.output.kind){case p.Deferred:o.push(u.output.constraint);break;case p.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:u.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){const{constraints:t,context:r,constraintCursor:i,unifyNF:a}=e,o=t[i];switch(o.kind){case g.UnitEquality:a(o.unit,o.target.unit);break;case g.FormatEquality:const t=M(r,o.format);if(void 0===t)break;const i=O(r,o.cell.sheet,o.cell.range);if(void 0===i)break;a(t,i);break;default:return e.constraintCursor+=1,(0,n.assertNever)(s.Messages.Root,o)}return e.constraintCursor+=1,e}(e)};const n=r(6913),i=r(9610),a=r(6592),o=r(1159),s=r(3312),u=r(4440),l=r(7265),c=r(5927),d=r(9204),m=r(8453);var g,p;t.UnitExperimentSettings={get UnitlessTimeAndDate(){return(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}},function(e){e[e.RangeEquality=0]="RangeEquality",e[e.StagedRangeEquality=1]="StagedRangeEquality",e[e.UnitEquality=2]="UnitEquality",e[e.FormatEquality=3]="FormatEquality"}(g||(t.ConstraintKind=g={})),function(e){e[e.Solved=0]="Solved",e[e.Failed=1]="Failed",e[e.Deferred=2]="Deferred",e[e.Staged=3]="Staged"}(p||(p={}));const h={kind:p.Solved},f=e=>({kind:p.Failed,error:e}),S=e=>({kind:p.Deferred,constraint:e}),v=(0,c.fromConstants)({error:1}),y=(0,c.fromConstants)({}),F=(0,c.fromConstants)({currency:1}),b=(0,c.fromConstants)({date:1}),C=(0,c.fromConstants)({time:1});function k(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function E(e,t,r,i){return(0,n.assertTrue)(s.Messages.Root,0===r.varCount),e.uf.union(void 0===i?e.uf.makePoint(r):i,t,!0),h}function A(e,t,r,i,a){return t===e.errorUnit?((0,n.assertTrue)(s.Messages.Root,r===e.errorPoint),void 0!==a&&e.uf.union(e.errorPoint,a,!0),h):i===e.errorUnit?((0,n.assertTrue)(s.Messages.Root,a===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),h):0===t.varCount?0===i.varCount?(0,c.areSignaturesEqual)(t,i)?h:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==a&&e.uf.union(e.errorPoint,a,!0),f([t,i])):((0,n.assertTrue)(s.Messages.Root,void 0!==a),E(e,a,t,r)):1===i.varCount?((0,n.assertTrue)(s.Messages.Root,void 0!==r),(0,n.assertTrue)(s.Messages.Root,void 0!==a),e.uf.union(r,a),h):((0,n.assertTrue)(s.Messages.Root,void 0!==r),E(e,r,i,a))}function T(e,t,r){if(!(0,c.isSimpleUnit)(t))return S({kind:g.UnitEquality,unit:t,target:r});const i=k(e,r),[a,o]=e.uf.findWithDescriptor(i);if(1===t.varCount){(0,n.assertTrue)(s.Messages.Root,void 0!==t.name);const r=e.symbolContext.getTable().getValue(t.name);(0,n.assertTrue)(s.Messages.Root,void 0!==r);const[i,u]=e.uf.findWithDescriptor(k(e,r));return A(e,u,i,o,a)}return A(e,t,void 0,o,a)}function R(e,t){if(t===d.SpecialFormat.Unavailable||0===t)return!1;const r=P(e,t);if(void 0===r)return!1;const n=r?.valueType;return void 0!==n&&n!==o.FormatValueType.General&&(n!==o.FormatValueType.Currency&&n!==o.FormatValueType.Accounting||void 0!==r.currencySymbol)}function N(e,t,r,n){n?r.referencedFormatCells+=1:r.allFormatCells+=1;const i=P(e,t),a=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,s=i?.valueType;if(void 0!==s&&(a[s]=(a[s]??0)+1),s===o.FormatValueType.Currency||s===o.FormatValueType.Accounting){const e=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,t=i?.currencySymbol,a=i?.culture?.culture,s=void 0===t?"none":t===o.FormatCurrency.LocaleInfo?"defaultSymbol":t+"_"+a;e[s]=(e[s]??0)+1}}function I(e,t){return P(e,t)?.valueType}function P(e,t){if("number"==typeof t){const r=e.getIformat(t);return(0,n.isSuccess)(r)?r.value:void 0}return t}function O(e,t,r){const i=e.typeContext.types[t.index];if(void 0===i)return(0,n.assertFalse)(s.Messages.Root);const o=i.getValue(r);if(void 0===o){const o=(0,a.sheetGridCell)(t,r),s=e.typeContext.formats(o);if((0,n.isSuccess)(s)){if(!R(e.typeContext,s.value)||e.typeContext.isStringValue(o)){const n=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=i.setValue(r,(0,u.primitiveUnitType)(n)),n}let n=M(e,s.value);return void 0===n?n=e.symbolContext.freshSymbol().unit:N(e.typeContext,s.value,e.stats,!0),e.typeContext.types[t.index]=i.setValue(r,(0,u.primitiveUnitType)(n)),n}const l=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=i.setValue(r,(0,u.primitiveUnitType)(l)),l}return o.kind===u.TypeKind.Scalar?o.unit:void 0}function M(e,r){const n=I(e.typeContext,r);if(void 0!==n)switch(n){case o.FormatValueType.Currency:case o.FormatValueType.Accounting:return F;case o.FormatValueType.Percentage:return y;case o.FormatValueType.Date:return t.UnitExperimentSettings.UnitlessTimeAndDate?y:b;case o.FormatValueType.Time:return t.UnitExperimentSettings.UnitlessTimeAndDate?y:C;default:return}}function D(e,t){const r=M(e,t.format);if(void 0===r)return h;const i=O(e,t.cell.sheet,t.cell.range);if(void 0===i)return h;if(!(0,c.isSimpleUnit)(i))return S(t);if(1===i.varCount){(0,n.assertTrue)(s.Messages.Root,void 0!==i.name);const t=e.symbolContext.getTable().getValue(i.name);(0,n.assertTrue)(s.Messages.Root,void 0!==t);const[a,o]=e.uf.findWithDescriptor(k(e,t));return A(e,o,a,r,void 0)}return A(e,i,void 0,r,void 0)}function w(e){const t=e.symbolContext.getTable();return r=>{const n=t.getValue(r);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=e.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution}}},4440:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentState=t.primitiveUnitType=t.primitiveType=t.topType=t.bottomType=t.oneType=t.errorType=t.dimensionlessNumberType=t.dimensionLess=t.numberType=t.stringType=t.boolType=t.TypeKind=void 0,t.makePrimitiveType=s,t.makeReferenceType=u,t.makeResolvedReferenceType=function(e,t){const r=u(e);return r.resolution=t,r},t.makeArrayType=l,t.dimensionsFromType=d,t.getLiftingDimensionsFromTypes=function(e,t){return m(d(e),d(t))},t.joinDimensions=m,t.typeFromDimensions=function(e,t){return!0===t?e:l(e,t)},t.isResolvedReferenceType=function(e){return void 0!==e.resolution};const n=r(6592),i=r(5927);var a,o;function s(e,t=void 0){return{kind:a.Scalar,flags:e,unit:t}}function u(e){return{kind:a.Reference,reference:e,resolution:void 0}}function l(e,t){return{kind:a.Array,elementType:e,dimensions:t}}function c(e){return{kind:a.Union,flags:e}}function d(e){switch(e.kind){case a.Reference:const t=e.resolution?.range;return void 0!==t&&(!!(0,n.isGridCell)(t)||{rows:t.rows,columns:t.cols,exact:!0});case a.Array:return e.dimensions;case a.Scalar:return!0;case a.Union:return!1}}function m(e,t){return"object"==typeof e?"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:{...e,exact:e.exact&&t}:"object"==typeof t?{...t,exact:t.exact&&e}:e&&t}!function(e){e[e.Scalar=0]="Scalar",e[e.Reference=1]="Reference",e[e.Array=2]="Array",e[e.Union=3]="Union"}(a||(t.TypeKind=a={})),t.boolType=s(n.OperKind.Boolean),t.stringType=s(n.OperKind.String),t.numberType=s(n.OperKind.Number),t.dimensionLess=(0,i.fromConstants)({}),t.dimensionlessNumberType=s(n.OperKind.Number,t.dimensionLess),t.errorType=s(n.OperKind.Error),t.oneType=s(n.OperKind.Missing|n.OperKind.Blank),t.bottomType=c(n.SignatureType.None),t.topType=c(n.SignatureType.All),t.primitiveType=s(n.OperKind.Number|n.OperKind.Boolean|n.OperKind.String),t.primitiveUnitType=e=>s(n.OperKind.Number|n.OperKind.Boolean|n.OperKind.String,e),function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(o||(t.ExperimentState=o={}))},7265:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UF=void 0,t.UF=class{makePoint(e){const t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t}find(e){const t=this.roots;let r=e;for(;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r}findWithDescriptor(e){const t=this.find(e);return[t,this.descriptors[t]]}union(e,t,r=!1){const n=this.find(e),i=this.find(t);if(n===i)return;const a=this.roots,o=this.backlinks,s=this.ranks;if(r){const e=o[i];return o[i]=o[n],o[n]=e,a[i]=n,void(s[n]<=s[i]&&(s[n]=s[i]+1))}if(s[n]<s[i]){const e=o[n];o[n]=o[i],o[i]=e,a[n]=i}else{const e=o[i];o[i]=o[n],o[n]=e,a[i]=n,s[n]===s[i]&&(s[n]+=1)}}forEachInClass(e,t){const r=this.backlinks;let n=e;for(t(n);r[n]!==e;)n=r[n],t(n)}constructor(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}}},780:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnitExperiment=void 0;const n=r(6913),i=r(9610),a=r(6592),o=r(3312),s=r(3769),u=r(4440),l=r(5927),c=r(8453);t.UnitExperiment=class{get done(){return this.isDone}freshCheckingState(e){this.lastStepMessage="freshCheckingState";const t=[],r={};e.getServerAvailableCells().forEach((i=>{const a=e.getServerUsedRange(i.sheetIdx);if(a.kind!==n.ResultKind.Success)return this.isDone=!0,void(this.statsMessage="Unit experiment: getServerUsedRange failed");const o={...i,usedRange:a.value?.range};r[i.sheetIdx.index]=o,t.push(o)}));const i=void 0===e.getServerDocument()?()=>(0,n.failure)(void 0):t=>e.getIformat(e.getServerDocument(),t);return{kind:u.ExperimentState.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:(0,a.createResolver)(e),documentTypeContext:{formats:t=>e.getServerFormat(t),types:{},available:r,getIformat:i,isStringValue:t=>{if(void 0===e.getServerDocument())return!1;const r=e.getServerValue(t);return r.kind===n.ResultKind.Success&&r.value.oper.kind===a.OperKind.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:t,mutableState:{symbolContext:d.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}}freshSolvingState(e){return this.lastStepMessage="freshSolvingState",{kind:u.ExperimentState.SolvingSimple,stats:e.stats,context:(0,s.makeSolverContext)(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}}step(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,(0,n.assertNever)(`${o.Messages.Root}.${o.Messages.Initialised}`,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{const e=this.state;switch(e.kind){case u.ExperimentState.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case u.ExperimentState.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=(0,s.runSolverStep)(e));case u.ExperimentState.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=(0,s.runSolverStep)(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage=`${o.Messages.Root}.${o.Messages.Failure}: ${(0,n.messageFromError)(e)}`,void(this.isDone=!0)}}}setContext({documents:e}){this.documentContext=e}initialiseSheetStep(e){this.lastStepMessage="initialiseSheetStep";const{mutableState:t,sheets:r}=e,{sheetCursor:n}=t,o=r[n],s=o.usedRange,u=[];if(void 0!==s){const e=(0,i.intersectProduct)(o.availableCells,c.availableReadProduct);(0,c.forEachRangeInSet)(e,(e=>{const t=(0,a.gridRangeIsect)(e,s);if(void 0!==t){if((0,a.gridRangeSize)(t)<250)return u.push(t),!0;(0,a.forEachTileInRange)(t,15,(e=>(u.push(e),!0)))}return!0}))}return t.ranges=u,t.rangeCursor=0,e.documentTypeContext.types[o.sheetIdx.index]=(0,a.makeGridRangeTable)(),e}initialiseRangeCells(e,t){this.lastStepMessage="initialiseRangeCells";const{mutableState:r,stats:i,sheets:o}=t,{sheetCursor:u}=r,l=[],d=o[u],m=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(d.sheetIdx,(0,c.createCellSetFromRange)(m),(r=>{const o=(0,a.sheetGridCell)(d.sheetIdx,r),u=e.getServerFormula(o);u.kind===n.ResultKind.Success&&void 0!==u.value?.[1].compiledFmla&&(l.push(u.value[1]),i.formulaCells+=1);const c=e.getServerFormat(o);return c.kind===n.ResultKind.Success&&(0,s.isInterestingFormat)(t.documentTypeContext,c.value)&&(0,s.updateFormatStatsFromCellFormat)(t.documentTypeContext,c.value,i,!1),i.totalCells+=1,!0})),r.cells=l,r.cellCursor=0,t}checkCell(e,t){this.lastStepMessage="checkCell";const{sheets:r,constraints:i,stats:o,mutableState:l}=t,{cells:c,sheetCursor:d,cellCursor:m}=l,g=r[d],p=c[m],S=p.compiledFmla.getValue();if(S.kind===n.ResultKind.Success){const r=(0,a.sheetGridCell)(g.sheetIdx,p.origin),l=function(e,t,r){const{constraints:n,locale:i,mathpack:o,resolver:l,documentTypeContext:c}=e,d=c.types[t.sheet.index],m=e.mutableState.symbolContext.copy(),g={origin:t,locale:i,mathpack:o,resolver:l,symbolContext:m,pushConstraint:e=>void 0!==e&&(n.push(e),!0)},p=function(e,t){return(0,a.reducePledge)(new v(e),t)}(g,r),S=h(g,p);let y=f(g,void 0===S?u.topType:S);if(y.kind===u.TypeKind.Reference){const e=m.freshSymbol(),t={kind:s.ConstraintKind.RangeEquality,type:y,target:e};y=(0,u.primitiveUnitType)(e.unit),n.push(t)}return e.mutableState.symbolContext=m,y.kind===u.TypeKind.Array?d:d.setValue(t.range,y)}(t,r,S.value);t.documentTypeContext.types[g.sheetIdx.index]=l;const c=e.getServerFormat(r);c.kind===n.ResultKind.Success&&(0,s.isInterestingFormat)(t.documentTypeContext,c.value)&&(i.push({kind:s.ConstraintKind.FormatEquality,cell:r,format:c.value}),(0,s.updateFormatStatsFromCellFormat)(t.documentTypeContext,c.value,o,!0))}return t.mutableState.cellCursor+=1,t}runCheckStep(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);const{mutableState:r}=t;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)}statsForLogging(e){return JSON.stringify(e)}get resultLogMessage(){return this.statsMessage??`${o.Messages.Root}.${o.Messages.Default}`}get failedLogMessage(){const e=this.state?.kind,t=this.state?.kind===u.ExperimentState.Checking&&0===this.state?.mutableState.cellCursor;return`Units experiment timed out. Last step: ${this.lastStepMessage}. Experiment state: ${void 0!==e?u.ExperimentState[e]:"NotStarted"}. isCellCursorZero: ${t}. Number of constraints: ${this.state?.constraints.length}. Stats: ${this.statsForLogging(this.state?.stats)}`}constructor(){this.isDone=!1,this.lastStepMessage="before started"}};class d{static init(){return new d(0,n.RedBlackMapTree.create(((e,t)=>e.localeCompare(t))))}getTable(){return this.table}freshSymbol(e){const t=`${void 0===e?"gen":e}@${this.seed+=1}`,r={unit:(0,l.fromVar)(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r}copy(){return new d(this.seed,this.table)}constructor(e,t){this.seed=e,this.table=t}}function m(e,t,r){switch(e.kind){case u.TypeKind.Array:if(e.elementType.kind===u.TypeKind.Reference)return;return r?m(e.elementType,t,!1):void 0;case u.TypeKind.Reference:return{kind:s.ConstraintKind.RangeEquality,type:e,target:t};case u.TypeKind.Scalar:return void 0===e.unit?void 0:{kind:s.ConstraintKind.UnitEquality,unit:e.unit,target:t};case u.TypeKind.Union:return;default:return(0,n.assertNever)(o.Messages.Root,e)}}function g(e,t,r){switch(t.kind){case u.TypeKind.Array:if(t.elementType.kind===u.TypeKind.Reference)return;return r?g(e,t.elementType,!1):void 0;case u.TypeKind.Reference:const i=e.symbolContext.freshSymbol(),a={kind:s.ConstraintKind.RangeEquality,type:t,target:i};return[i.unit,a];case u.TypeKind.Scalar:return void 0===t.unit?void 0:[t.unit,void 0];case u.TypeKind.Union:return;default:return(0,n.assertNever)(o.Messages.Root,t)}}function p(e){const t=e.length;if(0===t)return u.topType;let r=u.bottomType;const n=e[0].length;for(let t=0;t<e.length;t+=1){const n=e[t];for(let e=0;e<n.length;e+=1)i=r,a=n[e],r=i===u.bottomType?a:a===u.bottomType||i===u.topType?i:a===u.topType?a:i.kind===u.TypeKind.Scalar&&a.kind===u.TypeKind.Scalar&&void 0===i.unit&&void 0===a.unit?(0,u.makePrimitiveType)(i.flags|a.flags):u.topType}var i,a;return(0,u.makeArrayType)(r,{rows:t,columns:n,exact:!0})}function h(e,t){if(t.kind===u.TypeKind.Reference&&!(0,u.isResolvedReferenceType)(t)){const r=function(e,t){const r=(0,a.resolveLocalsGrid)(e.origin),{resolution:i}=e.resolver.resolveCellRef(r,t.reference);return!!(0,n.isSuccess)(i)&&(!i.value||i.value)}(e,t);return"object"==typeof r?(0,u.makeResolvedReferenceType)(t.reference,r):r?u.errorType:void 0}if(t.kind===u.TypeKind.Array){const r=h(e,t.elementType);return void 0===r?r:r===t.elementType?t:(0,u.makeArrayType)(r,t.dimensions)}return t}function f(e,t){switch(t.kind){case u.TypeKind.Scalar:if(void 0===t.unit){const r=e.symbolContext.freshSymbol();return(0,u.makePrimitiveType)(t.flags,r.unit)}return t;case u.TypeKind.Array:let r=t;const i=[];for(;r.kind===u.TypeKind.Array;)i.push(r.dimensions),r=r.elementType;const a=f(e,r);return i.reduceRight(u.makeArrayType,a);case u.TypeKind.Reference:case u.TypeKind.Union:return t;default:return(0,n.assertNever)(o.Messages.Root,t)}}function S(e,t,r,n,i){const a=e.symbolContext.freshSymbol(),o=m(t,a,n),s=m(r,a,n);if(void 0!==o&&void 0!==s||i&&(void 0!==o||void 0!==s))return e.pushConstraint(o),e.pushConstraint(s),a}class v{literalNode(e){return n.Pledge.resolve(function(e){switch(e.kind){case a.OperKind.Number:return u.numberType;case a.OperKind.String:return u.stringType;case a.OperKind.Boolean:return u.boolType;case a.OperKind.Error:return u.errorType;default:return u.oneType}}(e))}arrayNode(e){return n.Pledge.all(e.map((e=>n.Pledge.all(e.map(this.lazyVisitFormulaNode))))).bind(p)}appNode(e,t){return e.kind===a.NodeKind.Operator?n.Pledge.all(t.map((e=>this.lazyVisitFormulaNode(e).bind((t=>[t,e]))))).bind((t=>function(e,t,r){switch(t){case a.OperatorId.Add:case a.OperatorId.Sub:case a.OperatorId.Mul:case a.OperatorId.Div:case a.OperatorId.Pow:case a.OperatorId.Eq:case a.OperatorId.Ne:case a.OperatorId.Lt:case a.OperatorId.Le:case a.OperatorId.Gt:case a.OperatorId.Ge:case a.OperatorId.Range:case a.OperatorId.Isect:case a.OperatorId.Union:case a.OperatorId.Concat:case a.OperatorId.And:case a.OperatorId.Or:case a.OperatorId.Xor:case a.OperatorId.Min:case a.OperatorId.Max:return function(e,t,r){if(r.length<2)return u.topType;const i=h(e,r[0][0]),c=h(e,r[1][0]);if(void 0===i||void 0===c)return u.topType;const d=(0,u.getLiftingDimensionsFromTypes)(i,c);if(!1===d)return u.topType;const p="object"==typeof d;switch(t){case a.OperatorId.Add:case a.OperatorId.Sub:case a.OperatorId.Min:case a.OperatorId.Max:{const t=S(e,i,c,p,!0);return(0,u.typeFromDimensions)(void 0===t?u.numberType:(0,u.makePrimitiveType)(a.OperKind.Number,t.unit),d)}case a.OperatorId.Eq:case a.OperatorId.Ne:case a.OperatorId.Lt:case a.OperatorId.Le:case a.OperatorId.Gt:case a.OperatorId.Ge:return S(e,i,c,p,!1),(0,u.typeFromDimensions)(u.boolType,d);case a.OperatorId.Mul:case a.OperatorId.Div:if(s.UnitExperimentSettings.IgnoreDivMul)return u.numberType;{const r=e.symbolContext.freshSymbol(),n=e.symbolContext.freshSymbol(),o=m(i,r,p),s=m(c,n,p);if(e.pushConstraint(o),e.pushConstraint(s),void 0===o&&void 0===s)return(0,u.typeFromDimensions)(u.numberType,d);const g=t===a.OperatorId.Mul?(0,l.prod)(r.unit,n.unit):(0,l.prod)(r.unit,(0,l.inv)(n.unit));return(0,u.typeFromDimensions)((0,u.makePrimitiveType)(a.OperKind.Number,g),d)}case a.OperatorId.Pow:const[,h]=r[1];if((0,a.isNumberLiteralNode)(h)){const t=e.mathpack.toNumber(h.oper);if((0,n.isInteger)(t)){const r=g(e,i,"object"==typeof d);return void 0===r?(0,u.typeFromDimensions)(u.numberType,d):(e.pushConstraint(r[1]),(0,u.typeFromDimensions)((0,u.makePrimitiveType)(a.OperKind.Number,(0,l.pow)(r[0],t,u.dimensionLess)),d))}}return u.topType;case a.OperatorId.Range:case a.OperatorId.Isect:case a.OperatorId.Union:return u.topType;case a.OperatorId.Concat:return(0,u.typeFromDimensions)(u.stringType,d);case a.OperatorId.And:case a.OperatorId.Or:case a.OperatorId.Xor:return(0,u.typeFromDimensions)(u.boolType,d);default:return(0,n.assertNever)(o.Messages.Root,t)}}(e,t,r);case a.OperatorId.Percent:case a.OperatorId.Neg:case a.OperatorId.Pos:case a.OperatorId.At:case a.OperatorId.Pound:return function(e,t,r){if(r.length<1)return u.topType;const[i]=r[0],s=h(e,i);if(void 0===s)return u.topType;const l=(0,u.dimensionsFromType)(s);if(!1===l)return u.topType;switch(t){case a.OperatorId.Percent:return(0,u.typeFromDimensions)(u.dimensionlessNumberType,l);case a.OperatorId.Neg:case a.OperatorId.Pos:const r=g(e,s,"object"==typeof l);return void 0===r?(0,u.typeFromDimensions)(u.numberType,l):(e.pushConstraint(r[1]),(0,u.typeFromDimensions)((0,u.makePrimitiveType)(a.OperKind.Number,r[0]),l));case a.OperatorId.At:case a.OperatorId.Pound:return u.topType;default:return(0,n.assertNever)(o.Messages.Root,t)}}(e,t,r);default:return(0,n.assertNever)(o.Messages.Root,t)}}(this.context,e.id,t))):e.kind===a.NodeKind.WSF?n.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((t=>function(e,t,r){switch(t){case a.WorksheetFuncId.SUM:case a.WorksheetFuncId.AVERAGE:case a.WorksheetFuncId.MAX:case a.WorksheetFuncId.MIN:if(0===r.length)return u.topType;const t=e.symbolContext.freshSymbol();let n=!0;return r.forEach((r=>{const i=h(e,r);i&&e.pushConstraint(m(i,t,!0))&&(n=!1)})),n?u.numberType:(0,u.makePrimitiveType)(a.OperKind.Number,t.unit);case a.WorksheetFuncId.IF:if(r.length<2)return u.topType;const i=h(e,r[0]),o=h(e,r[1]),s=h(e,void 0===r[2]?u.boolType:r[2]);if(void 0===i)return void 0!==o&&void 0!==s&&S(e,o,s,!0,!1),u.topType;const l=(0,u.dimensionsFromType)(i),c="object"==typeof l;if(void 0===o||void 0===s)return u.topType;const d=S(e,o,s,!0,!0),g=d?(0,u.primitiveUnitType)(d.unit):u.primitiveType;return c?(0,u.makeArrayType)(g,l):g;default:return u.topType}}(this.context,e.id,t))):n.Pledge.resolve(u.topType)}letNode(e,t,r,i){return n.Pledge.resolve(u.topType)}lambdaNode(e,t,r,i){return n.Pledge.resolve(u.topType)}parenNode(e){return this.lazyVisitFormulaNode(e)}nameNode(e,t){return n.Pledge.resolve(u.topType)}cellRefNode(e,t){return n.Pledge.resolve((0,u.makeReferenceType)((0,a.cellRefNode)(e,t)))}fieldRefNode(e,t){return n.Pledge.resolve(u.topType)}structRefNode(e,t){return n.Pledge.resolve(u.topType)}missingNode(e){return n.Pledge.resolve(u.topType)}badSequenceNode(e,t){return n.Pledge.resolve(u.topType)}badCharsNode(e,t){return n.Pledge.resolve(u.topType)}operatorNode(e,t){return n.Pledge.resolve((0,a.operatorNode)(e,t))}wsfNode(e,t,r){return n.Pledge.resolve((0,a.wsfNode)(e,t,r))}constructor(e){this.context=e,this.visitFormulaNode=e=>(0,a.visitFormulaNode)(this,e),this.lazyVisitFormulaNode=e=>n.Pledge.resolve(e).bind(this.visitFormulaNode)}}},5927:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unify=t.UnificationResultKind=t.someVar=t.everyVar=t.someConst=t.everyConst=void 0,t.makeSignature=u,t.fromConstants=g,t.fromVar=function(e){const t=u(1,{[e]:1},d);return t.name=e,t},t.isSimpleUnit=function(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===d||(0,t.everyConst)(e,p))){const t=function(e,t){for(const t in e.vars)return 1===e.vars[t]?t:void 0}(e);return void 0!==t&&(e.name=t,!0)}return!1},t.areSignaturesEqual=function(e,t){return h(e,t)&&h(t,e)},t.prod=function(e,t){const r=m(),{vars:n,consts:a}=e,{vars:o,consts:u}=t;for(const e in n){const t=n[e]+(o[e]??0);0!==t&&(r.vars[e]=t,r.varCount+=1)}for(const e in a){const t=a[e]+(u[e]??0);0!==t&&(r.consts[e]=t)}for(const e in o)void 0===n[e]&&(r.vars[e]=o[e],r.varCount+=1);for(const e in u)void 0===a[e]&&(r.consts[e]=u[e]);return s(i.Messages.Root,r),r},t.inv=function(e){const t=m(),{vars:r,consts:n}=e;for(const e in r)t.vars[e]=-r[e];for(const e in n)t.consts[e]=-n[e];return t.varCount=e.varCount,s(i.Messages.Root,t),t},t.pow=function(e,t,r){if(0===t)return r;const n=m(),{vars:a,consts:o}=e;for(const e in a)n.vars[e]=a[e]*t;for(const e in o)n.consts[e]=o[e]*t;return n.varCount=e.varCount,s(i.Messages.Root,n),n},t.shuffleNormalForms=function(e,r){const a=m(),o=m(),u=a.vars,l=o.consts;for(const t in e.vars){const n=e.vars[t]-(r.vars[t]??0);0!==n&&(u[t]=n,a.varCount+=1)}for(const t in r.vars)void 0===e.vars[t]&&(u[t]=-r.vars[t],a.varCount+=1);for(const t in r.consts){const n=r.consts[t]-(e.consts[t]??0);0!==n&&(l[t]=n)}for(const t in e.consts)void 0===r.consts[t]&&(l[t]=-e.consts[t]);return s(i.Messages.Root,a),s(i.Messages.Root,o),(0,n.assertTrue)(i.Messages.Root,(0,t.everyConst)(a,p)),{vars:a,consts:o}},t.toUnitConstraint=f,t.serialiseMeasure=function(e){const t=[],r=[];for(const n in e.vars){const i=e.vars[n];i>0?t.push([n,i]):r.push([n,i])}for(const n in e.consts){const i=e.consts[n];i>0?t.push([n,i]):r.push([n,i])}if(0===r.length)return 0===t.length?"1":t.map((([e,t])=>S(e,t,!0,1))).join("*");let n=r.map((([e,t])=>S(e,t,!1,-1))).join("*");return r.length>1&&(n="("+n+")"),0===t.length?`1/${n}`:`${t.map((([e,t])=>S(e,t,!0,1))).join("*")}/${n}`},t.substituteVariable=v,t.createPoisonApplication=function(e){return(t,r)=>{if(0===r.varCount||t===F)return r;let n=r;for(const i in r.vars){const r=t(i);if(r===e)return e;void 0!==r&&(n=v(i,n,r))}return n}},t.compose=A;const n=r(6913),i=r(3312);function a(e,t){for(const r in e)if(!t(r,e[r]))return!1;return!0}const o=(e,t)=>!a(e,((e,r)=>!t(e,r)));function s(e,t){let r=0;!function(e,t){for(const t in e)e[t],r+=1}(t.vars),(0,n.assertTrue)(e,void 0===t.name||1===t.varCount),(0,n.assertTrue)(e,t.varCount===r)}function u(e,t,r){const n={varCount:e,vars:t,consts:r,name:void 0};return s(i.Messages.Root,n),n}function l(){}function c(){return new l}t.everyConst=(e,t)=>a(e.consts,t),t.someConst=(e,t)=>o(e.consts,t),t.everyVar=(e,t)=>a(e.vars,t),t.someVar=(e,t)=>o(e.vars,t);const d=c();function m(){return u(0,{},c())}function g(e){return u(0,{},e)}const p=()=>!1;function h(e,r){return(0,t.everyVar)(e,((e,t)=>r.vars[e]===t))&&(0,t.everyConst)(e,((e,t)=>r.consts[e]===t))}function f(e,t){const r=m(),{vars:n,consts:a}=e,{vars:o,consts:u}=t;for(const e in n){const t=n[e]-(o[e]??0);0!==t&&(r.vars[e]=t,r.varCount+=1)}for(const e in a){const t=a[e]-(u[e]??0);0!==t&&(r.consts[e]=t)}for(const e in o)void 0===n[e]&&(r.vars[e]=-o[e],r.varCount+=1);for(const e in u)void 0===a[e]&&(r.consts[e]=-u[e]);return s(i.Messages.Root,r),r}function S(e,t,r,n){return r?1===t?e:`${e}^${t}`:-1===t?e:`${e}^${t*n}`}function v(e,t,r){const{vars:n,consts:i}=t,a=n[e];if(void 0===a)return t;let o=0;const{vars:s,consts:l}=m();for(const t in n){const i=r.vars[t],u=void 0===i?0:i,l=(t===e?0:n[t])+u*a;0!==l&&(o+=1,s[t]=l)}for(const e in r.vars)void 0===n[e]&&(o+=1,s[e]=a*r.vars[e]);for(const e in i){const t=r.consts[e],n=i[e]+a*(void 0===t?0:t);0!==n&&(l[e]=n)}for(const e in r.consts)void 0===i[e]&&(l[e]=a*r.consts[e]);return u(o,s,l)}var y;!function(e){e[e.Fail=0]="Fail",e[e.Subst=1]="Subst"}(y||(t.UnificationResultKind=y={}));const F=()=>{},b={kind:y.Subst,substitution:F},C=e=>({kind:y.Subst,substitution:e}),k={kind:y.Fail},E=e=>e<0?-e:e;function A(e,t,r){const n={};return r===F?t:t===F?r:i=>{const a=n[i];if(void 0!==a)return a;const o=r(i);return n[i]=void 0===o?t(i):e(t,o)}}function T(e,t){return r=>e===r?t:void 0}function R(e,r,a){if(e>=100)return(0,n.assertFalse)(i.Messages.UnifyBound);if(0===a.varCount)return(0,t.everyConst)(a,p)?b:k;if(1===a.varCount){let e;for(const t in a.vars){e=t;break}(0,n.assertTrue)(i.Messages.Root,void 0!==e);const t=a.vars[e],r={};for(const e in a.consts){const n=a.consts[e];if(n%t!=0)return k;r[e]=-n/t}return C(T(e,g(r)))}let o,s,l=0;const{vars:c,consts:d,varCount:m}=a;for(const e in c){const t=c[e],r=E(t);(void 0===s||r<s)&&(l=t,s=r,o=e)}(0,n.assertTrue)(i.Messages.Root,void 0!==o),(0,n.assertTrue)(i.Messages.Root,0!==l);const h={},f={};for(const e in c)if(e===o)h[e]=1;else{const t=c[e];h[e]=-Math.floor(t/l)}for(const e in d){const t=d[e];f[e]=-Math.floor(t/l)}const S=u(m,h,f),F=R(e+1,r,v(o,a,S));return F.kind===y.Fail?F:C(A(r,F.substitution,T(o,S)))}t.unify=(e,t,r)=>R(0,e,f(t,r))},3214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMissingJSFeatures=o,t.logMissingJSFeatures=function(e){e().then((e=>{const t={main:o(),worker:e},r=`calc.calc.logMissingJSFeatures: missing = ${JSON.stringify(t)}`;n.ulsLogger.ULS.traceTag(561534152,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)})).catch((e=>{const t=`calc.calc.logMissingJSFeatures: threw ${(0,n.messageFromError)(e)}`;n.ulsLogger.ULS.traceTag(561534153,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}))};const n=r(6913),i=r(6592),a=[{name:"self",test:()=>"undefined"!=typeof self},{name:"setImmediate",test:()=>"function"==typeof setImmediate},{name:"fetch",test:()=>"function"==typeof fetch},{name:"Set",test:()=>"function"==typeof Set},{name:"Map",test:()=>"function"==typeof Map},{name:"WeakMap",test:()=>"function"==typeof WeakMap},{name:"Symbol",test:()=>"function"==typeof Symbol},{name:"WebAssembly",test:()=>"object"==typeof WebAssembly},{name:"Atomics",test:()=>"object"==typeof Atomics},{name:"BigInt",test:()=>"function"==typeof BigInt},{name:"String.startsWith",test:()=>"function"==typeof"".startsWith},{name:"String.codePointAt",test:()=>"function"==typeof"".codePointAt},{name:"Object.assign",test:()=>"function"==typeof Object.assign},{name:"Object.setPrototypeOf",test:()=>"function"==typeof Object.setPrototypeOf},{name:"Number.EPSILON",test:()=>"number"==typeof Number.EPSILON},{name:"Number.isFinite",test:()=>"function"==typeof Number.isFinite},{name:"Number.parseInt",test:()=>"function"==typeof Number.parseInt},{name:"Math.acosh",test:()=>"function"==typeof Math.acosh},{name:"Math.hypot",test:()=>"function"==typeof Math.hypot},{name:"Math.log1p",test:()=>"function"==typeof Math.log1p},{name:"Math.trunc",test:()=>"function"==typeof Math.trunc},{name:"Promise.finally",test:()=>"function"==typeof Promise.resolve().finally},{name:"RegExp_flags",test:()=>(new RegExp("x","i"),!0)},{name:"RegExp.flags",test:()=>"string"==typeof/x/.flags},{name:"Array.of",test:()=>"function"==typeof Array.of},{name:"Array.entries",test:()=>"function"==typeof[].entries},{name:"Array.find",test:()=>"function"==typeof[].find},{name:"performance",test:()=>"object"==typeof performance},{name:"performance.now",test:()=>"function"==typeof performance.now},{name:"performance.timeOrigin",test:()=>"number"==typeof performance.timeOrigin},{name:"performance.memory",test:()=>"object"==typeof performance.memory}];function o(){return a.map((({name:e,test:t})=>{try{return t()?"":e}catch{return e}})).filter((e=>e.length>0))}},3804:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaEvaluationTreeExtractor=t.PartialWorkbook=t.EvalOnClonePropsFromPartialWBDocumentCollection=t.EvalOnClonePropsFromPartialWB=t.MaxStateIdDifferenceForGC=void 0;const n=r(6913),i=r(9610),a=r(6592),o=r(1159),s=r(1475),u=r(391),l=r(5033),c=r(2374),d=r(5677),m=r(6824),g=r(9204),p=r(8453),h=r(1836),f=r(8328),S=r(7755),v=r(3340),y=r(4352),F=r(4691),b=2*a.sheetCols;t.MaxStateIdDifferenceForGC=17;const C=(0,a.gridRange)(0,0,a.sheetRows,a.sheetCols);function k(e,t){let r;return t.kind===s.ReasonKind.Unavailable&&t.objects.length>0&&"kind"in t.objects[0]&&(r=t.objects[0].kind),(0,n.failure)({cell:e,kind:t.kind,innerKind:r})}const E=(0,a.binaryVisitor)({...(0,a.constVisitor)(!1),wsfNode:e=>e===a.WorksheetFuncId.HYPERLINK},((e,t)=>e||t));var A,T;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(A||(A={})),t.EvalOnClonePropsFromPartialWB=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new n.ResolvablePromise,this.stateId=-1,this.cloneLazy=new y.ResettableLazy((()=>e.createSnapshotSync()))}},t.EvalOnClonePropsFromPartialWBDocumentCollection=class{constructor(e,t){this.formatResults=t,this.resultsPromise=new n.ResolvablePromise,this.stateId=-1,this.cloneLazy=new y.ResettableLazy((()=>e.clone(d.voidCallback,m.CloningTarget.Client)))}},function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(T||(T={}));class R{reconfigure(e){this.config=e,this.rng=new n.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,e.maxDereferenceCells??b,e.isServerWorkbookLoad??!1)}getDocs(){return this.docs}setWorksheetFuncOverrides(e){this.docs.setWorksheetFuncOverrides(e)}onNameFailure(e,t,r){r.computeKind!==g.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:g.OutputMessageKind.NameFailure,stateId:this.stateId,name:e,reason:t})}onRangeFailure(e,t,r,n,i){i.computeKind!==g.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:g.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})}onNumberFormatFailure(e){this.outputMessageLog.push({kind:g.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:e})}onInferFormatFailure(e,t){this.outputMessageLog.push({kind:g.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:e,reason:t})}onUnavailableObject(e){const t=(0,a.unavailable)([e]);this.onUnavailable(t)}onUnavailable(e){this.outputMessageLog.push({kind:g.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:e})}onSetCellValue(e,t,r,n,i){if(i.computeKind===g.ComputeKind.EvalFormula)return;const a=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==a?(this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,message:g.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:n}),n!==g.ComputedCellKind.EditedCell&&n!==g.ComputedCellKind.DependentCell||this.outputMessageLog.push({kind:g.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:n,cell:e,...a,formatted:this.formatValue(n,e,t)})):this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,message:g.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:n})}onSetCellValues(e,t,r,n,i){if(i.computeKind===g.ComputeKind.EvalFormula)return;const o=this.outputRange(e,t,n);void 0!==o&&(n!==g.ComputedCellKind.EditedCell&&n!==g.ComputedCellKind.DependentCell||this.outputMessageLog.push({kind:g.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:n,range:e,...o,formatted:t.map(((t,r)=>t.map(((t,i)=>this.formatValue(n,(0,a.sheetGridCell)(e.sheet,(0,a.gridCell)(e.range.row+r,e.range.col+i)),t)))))}))}onReturnCellValue(e,t,r){const n=this.outputCell(e,t,r,(()=>this.printValueProperties(e,t)));void 0!==n?(this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,message:g.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:g.ComputedCellKind.EditedCell}),r===g.ComputedCellKind.EditedCell&&this.outputMessageLog.push({kind:g.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:g.ComputedCellKind.EditedCell,cell:e,...n,formatted:this.formatValue(r,e,t)})):this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,message:g.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:g.ComputedCellKind.EditedCell})}createSnapshot(e,t=m.CloningTarget.Client){return new Promise((r=>{this.scheduler.addTask(T.CompleteDataQuery,h.QueuePos.Back,{onRun:()=>{let n=!1;const i=this.docs.clone(d.voidCallback,t);void 0!==this.latestSnapshot&&-1!==this.latestSnapshotID&&this.latestSnapshot.compareVersion(i)||(n=!0,this.latestSnapshot=i,this.latestSnapshotID=e),F.x10Logger.log({kind:"snapshotCreation",payload:n}),r({snapshot:this.latestSnapshot,correspondingId:this.latestSnapshotID})},onDeleted:()=>{r(void 0)}})}))}createSnapshotSync(e=m.CloningTarget.Client){return this.docs.clone(d.voidCallback,e)}outputCell(e,t,r,i){let a;if(r===g.ComputedCellKind.EditedCell||r===g.ComputedCellKind.DependentCell){const r=this.docs.testAndSetClientValue(e,t);a=(0,n.isSuccess)(r)?r.value?t:void 0:void this.onUnavailableObject(r.reason)}const o=this.outputFormat(e,r),s=this.outputFormulaProperties(e,r,i);return void 0!==a||void 0!==o||void 0!==s?{value:t,format:o,formulaBarText:s?.formulaBarText,hasHyperlink:s?.hasHyperlink}:void 0}outputRange(e,t,r){if(r===g.ComputedCellKind.EditedCell||r===g.ComputedCellKind.DependentCell){const r=this.docs.setClientValue(e,t);(0,n.isSuccess)(r)||this.onUnavailableObject(r.reason)}const i=t.map(((t,n)=>t.map(((t,i)=>this.outputFormat((0,a.sheetGridCell)(e.sheet,(0,a.gridCell)(e.range.row+n,e.range.col+i)),r))))),o=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:i,formulaBarText:o?.formulaBarText}}outputFormat(e,t){if(t!==g.ComputedCellKind.EditedCell)return;const r=this.docs.getEditedFormat(e);if(!(0,n.isSuccess)(r))return void this.onUnavailableObject(r.reason);const i=this.docs.testAndSetClientFormat(e,r.value);if(!(0,n.isSuccess)(i))return void this.onUnavailableObject(i.reason);if(!i.value)return;const s=r.value;if(s===g.SpecialFormat.Unavailable)return{format:(0,a.unavailable)([{kind:g.UnavailableKind.CellFormat}]),valueType:o.FormatValueType.Custom,decimals:0};const u=this.docs.resolveCellFormat(e.sheet.document,s);return(0,n.isSuccess)(u)?{format:"number"==typeof s?s:s.formatString,valueType:u.value.valueType,decimals:u.value.decimals}:void 0}outputFormulaProperties(e,t,r){if(t!==g.ComputedCellKind.EditedCell)return;const i=r(e);if(void 0===i)return;const{formulaBarText:a,hasHyperlink:o,isFormula:s}=i,u=this.docs.testAndSetClientFormula(e,a,o);if(!(0,n.isSuccess)(u))return void this.onUnavailableObject(u.reason);const{hasFmlaChanged:l,hasHyperlinkChanged:c}=u.value;return l||c?{formulaBarText:l?a:void 0,hasHyperlink:c?o:void 0,isFormula:s}:void 0}formatValue(e,t,r,i){const a=i??this.docs,o=a.formatValueCell(t,r);if((0,n.isSuccess)(o))return o.value;a===this.docs&&this.outputMessageLog.push({kind:g.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:o.reason})}getAvailableFormula(e){const t=this.docs.getEditedFormula(e);if(!(0,n.isSuccess)(t))return t;if(void 0===t.value)return(0,n.failure)({kind:g.UnavailableKind.CellMissingFormula});const[r,i]=t.value;if(void 0===i.compiledFmla)return(0,n.failure)({kind:g.UnavailableKind.CellEvaluatingValue});const o=(0,a.lexicalSourceGrid)(i.lexicalKind,(0,a.sheetGridRange)(e.sheet,r));return(0,n.success)([o,i])}formulaHasHyperlink(e){if(e.lexicalKind!==a.LexicalKind.Cell)return!1;const t=e?.compiledFmla.getValue();return(0,n.isSuccess)(t)?(0,a.reduceBottomUp)(E,t.value):void 0}handleSetCellContents(e,t,r,i,o,s,u,l,c,d,m){let p,h,f,S=void 0!==c?(0,a.unavailable)([{kind:g.UnavailableKind.ClientFailure,reason:c}]):void 0,v=u;void 0!==i?(p=i,(0,n.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==o),h=o):void 0===r?((0,n.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===o&&void 0!==u&&void 0===S),p=!1,h=void 0):((0,n.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===S&&v===g.SpecialFormat.Weak),({isFormula:p,oper:h,cellFailure:S,cellFormat:v,inferredFormat:f}=this.parseInferredEdit(t,r,s,S,v,m)));const y=void 0!==m?m.cloneLazy.getValue():this.docs,F=y.setCellContents(e,t,r,p,s,h,S,v,l,d);if(F.kind===n.ResultKind.Failure)return this.onUnavailableObject(F.reason);if(y.onCellModified(e),!e){const e=(0,a.sheetGridCell)(t.sheet,s);let i=void 0===r?(0,n.success)(void 0):p?y.inferFormulaFormat(e):void 0!==f&&f!==a.KnownFormat.General?y.resolveValueFormat(t.sheet.document,f):(0,n.success)(void 0);i.kind!==n.ResultKind.Success&&(this.onInferFormatFailure(e,i.reason),i=(0,n.success)(g.SpecialFormat.Unavailable)),void 0!==i.value&&y.fillInferredFormat(t,i.value),void 0!==m?(m.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,y,m)):this.enqueueBeforeCompute(d)}}parseInferredEdit(e,t,r,i,s,u){const c=u?u.cloneLazy.getValue().parseInferredEdit((0,a.sheetGridCell)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit((0,a.sheetGridCell)(e.sheet,r),t,this.getVolatileMode());if(!(0,n.isSuccess)(c))return{isFormula:!1,oper:a.blankOper,cellFailure:c.reason,cellFormat:g.SpecialFormat.Unavailable};const d=t.length>0?t.charAt(0):"";switch("="!==d&&"+"!==d&&"-"!==d||c.value.kind!==o.EditKind.Formula&&c.value.kind!==o.EditKind.Number||n.ulsLogger.ULS.dnmTraceTag(541189698,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,JSON.stringify({startChar:d,editKind:String(c.value.kind)})),c.value.kind){case o.EditKind.Formula:return{isFormula:!0,oper:a.blankOper,cellFailure:i,cellFormat:s};case o.EditKind.String:case o.EditKind.Other:return{isFormula:!1,oper:c.value.value,cellFailure:i,cellFormat:s};case o.EditKind.Number:return{isFormula:!1,oper:c.value.value,cellFailure:i,cellFormat:s,inferredFormat:c.value.format}}}handleSetRangeFormula(e,t,r,i,o){const s=(0,f.isFormulaText)(r);(0,n.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||s);const u=e?void 0:a.blankOper,l=e?void 0:g.SpecialFormat.Weak,c=e?void 0:g.SpecialStyle.Weak,d=this.docs.setRangeFormula(e,t,r,i,u,l,c,o);if(d.kind===n.ResultKind.Failure)return this.onUnavailableObject(d.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(o)}handleEditPaste(e,t,r,i){const o=(0,a.sheetGridRange)(t.sheet,(0,a.gridRange)(t.range.row,t.range.col,r.range.rows,r.range.cols)),s=this.docs.copyRange(r);if(s.kind===n.ResultKind.Failure)return this.onUnavailableObject(s.reason);const u=this.docs.pasteRange(o,s.value);if(u.kind===n.ResultKind.Failure)return this.onUnavailableObject(u.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(i)}handleAssumeRecalcFinal(e){this.scheduler.getCount(T.BeforeCompute)<0||this.scheduler.addTask(T.ComputeCellValue,h.QueuePos.Front,(()=>{const t=this.docs.assumeRecalcFinal(e);if(t.kind===n.ResultKind.Failure)return this.onUnavailableObject(t.reason)}))}evalFormula(e,t,r,i,a){return new Promise((o=>{const u=()=>o({value:(0,n.failure)(s.stopped)});this.scheduler.deleteTasks(T.EvalFormula,void 0),this.scheduler.addTask(T.EvalFormula,h.QueuePos.Back,{onRun:()=>{if(!a&&!this.trySetStateId(T.EvalFormula,e))return u();this.enqueueComputeEvalFormula(t,r,i,a,void 0,o)},onDeleted:u}),this.enqueueRecalcFinished()}))}evalFormulaTree(e,t,r,i,a){const o=new N(a??this.docs);return new Promise((u=>{const l=()=>u({value:(0,n.failure)(s.stopped)});this.scheduler.deleteTasks(T.EvalFormula,void 0),this.scheduler.addTask(T.EvalFormula,h.QueuePos.Back,{onRun:()=>{if(!a&&!this.trySetStateId(T.EvalFormula,e))return l();this.enqueueComputeEvalFormula(t,r,i,a,o,u)},onDeleted:l}),this.enqueueRecalcFinished()})).then((e=>o.constructEvaluationTree([[0,t.length],[{value:e.value}]])))}enqueueBeforeCompute(e){this.scheduler.deleteTasks(T.BeforeCompute,void 0),this.scheduler.addTask(T.BeforeCompute,h.QueuePos.Back,(()=>{this.enqueueAfterCompute(),this.restrictToViewport(this.docs.getNonDirtyEditedCells(),e,g.ComputeKind.EditedCell,this.scheduleAvailableValues),this.restrictToViewport(this.docs.getDirtyEditedCells(),e,g.ComputeKind.EditedCell,this.scheduleAvailableFormulas),this.restrictToViewport(this.docs.getDirtyDependentCells(),e,g.ComputeKind.DependentCell,this.scheduleAvailableFormulas)}))}withEvalTiming(e){const t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();const r=(0,n.now)();let i;try{i=e()}finally{this.stateEvalTime+=(0,n.fastMax)(1,(0,n.now)()-r),this.stateEvalTime>=t&&(this.deleteComputeTasks(A.EvalTimedOut),this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:g.RecalcStatisticsMessage.StateTimedOut}),i=[])}return i}enqueueEvalFormulaComputeCellValuesOnDocs(e,t,r){const o=[];(0,p.forEachCellInSet)(e.set,(t=>(o.push((0,a.sheetGridCell)(e.sheet,t)),!0)));let u=(0,a.makeGridRangeTable)();const l=(t,r,n)=>{(0,a.isSheetIndexEqual)(t.sheet,e.sheet)&&(0,i.meetsProduct)(e.set,(0,p.createCellSetFromRange)(t.range))&&(0,a.forEachCellInRange)(t.range,(e=>(u=u.setValue(e,r),!0)))};let c=()=>t.evaluate(g.ComputeKind.EvalFormula,o,this.getVolatileMode(),l);const d={onRun:()=>{const e=this.withEvalTiming(c);if(Array.isArray(e)){const i=e.map(((e,i)=>{const l=o[i].range;if(!(0,n.isSuccess)(e)){if(e.reason.kind===s.ReasonKind.Stopped)return k(l,e.reason);const t=(0,a.unavailable)([{kind:g.UnavailableKind.EvalFailure,reason:e.reason}]);return this.onUnavailable(t),k(l,t)}const c=t.getCellValue(o[i]);if(!(0,n.isSuccess)(c))return k(l,u.getValue(l)??c.reason);try{(0,n.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",c.value.kind===s.CellKind.FinalValue)}catch(e){const t=(0,a.unavailable)([{kind:g.UnavailableKind.EvalFailure,reason:(0,n.javaScriptError)(e)}]);return this.onUnavailable(t),k(l,t)}const d=c.value.oper;if(!0===r.formatResults){const e=this.formatValue(g.ComputedCellKind.EditedCell,o[i],d,t);return(0,n.success)({cell:l,value:d,formatted:e})}return!1===r.formatResults?(0,n.success)({cell:l,value:d,formatted:void 0}):(0,n.success)((0,n.pair)(o[i].range,d))}));r.resultsPromise.resolve({stateId:r.stateId,results:i})}else c=e.resume,this.scheduler.addTask(T.ComputeEvalOnClone,h.QueuePos.Front,d)},onDeleted:()=>r.resultsPromise.resolve({stateId:r.stateId,results:(0,n.arrayFill)(new Array(o.length),(0,n.failure)(s.stopped))})};this.scheduler.addTask(T.ComputeEvalOnClone,h.QueuePos.Front,d)}enqueueComputeCellValue(e,t){const r=t===g.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,n.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0;let i,a=!0,o=()=>this.docs.evaluate(t,[e],this.getVolatileMode());const u=()=>{if(a){a=!1,i=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?(0,n.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;const t=this.docs.getEditedFormula(e);if(!(0,n.isSuccess)(t))return this.onUnavailableObject(t.reason);if(void 0===t.value)return}else this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:g.RecalcStatisticsMessage.ContinueComputation});const t=this.withEvalTiming(o);if(Array.isArray(t)){i?.stop(),r?.stop();for(const e of t)(0,n.isSuccess)(e)||e.reason.kind===s.ReasonKind.Stopped||this.onUnavailableObject({kind:g.UnavailableKind.EvalFailure,reason:e.reason})}else o=t.resume,this.scheduler.addTask(T.ComputeCellValue,h.QueuePos.Front,u)};this.scheduler.addTask(T.ComputeCellValue,h.QueuePos.Back,u)}enqueueComputeEvalFormula(e,t,r,i=this.docs,a,o){const u=this.getVolatileMode();let l=()=>i.evalFormula(e,t,r,u,a);const c={onRun:()=>{const e=l();e.kind===n.ResultKind.Paused||e.kind===n.ResultKind.Breaked?(l=e.resume,this.scheduler.addTask(T.ComputeEvalFormula,h.QueuePos.Front,c)):o(e.value)},onDeleted:()=>o({value:(0,n.failure)(s.stopped)})};this.scheduler.addTask(T.ComputeEvalFormula,h.QueuePos.Back,c)}enqueueReturnCellValue(e,t){const r=this.getVolatileMode();this.scheduler.addTask(T.ComputeCellValue,h.QueuePos.Back,(()=>{this.docs.evalValue(e,t,r)}))}enqueueAfterCompute(){this.scheduler.deleteTasks(T.AfterCompute,A.EditReceived);const e=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,n.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(T.AfterCompute,h.QueuePos.Back,{onRun:()=>{e?.stop(A.EvalFinished),this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,message:g.RecalcStatisticsMessage.EditFinished,stateId:this.stateId})},onDeleted:t=>{e?.stop(t)}})}enqueueRecalcFinished(){this.scheduler.deleteTasks(T.RecalcFinished,void 0),this.scheduler.addTask(T.RecalcFinished,h.QueuePos.Back,(()=>{this.outputMessageLog.push({kind:g.OutputMessageKind.RecalcStatistics,message:g.RecalcStatisticsMessage.RecalcFinished,stateId:this.stateId})}))}promoteCellContents(e,t,r,i){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const a=this.docs.promoteServerAvailability(r,i);if(a.kind===n.ResultKind.Failure)return this.onUnavailableObject(a.reason);this.docs.onCellModified(!0),a.value||this.outputMessageLog.push({kind:g.OutputMessageKind.UpdateRequest,stateId:this.stateId,range:t})}))}writeCellContents(e,t,r,n,i,a,o,s,u,l){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{(l||this.trySetStateId(T.ServerUpdate,e))&&this.handleSetCellContents(!0,t,r,n,a,i,o,s,u,void 0,l)}))}editCellContents(e,t,r,n,i,o=a.blankOper,s=(0,a.sheetGridRange)(t.sheet,C),u){this.lastViewport=s,this.scheduler.addTask(T.ClientEdit,h.QueuePos.Back,(()=>{this.trySetStateId(T.ClientEdit,e)&&this.handleSetCellContents(!1,t,r,n,o,i,g.SpecialFormat.Weak,g.SpecialStyle.Weak,void 0,s,u)})),this.enqueueRecalcFinished()}editCellContentsOnClone(e,t,r,n,i){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,i)}editCellFormats(e,t,r,i,o=(0,a.sheetGridRange)(t.sheet,C)){this.lastViewport=o,this.scheduler.addTask(T.ClientEdit,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ClientEdit,e))return;const s="SetFormat"===r.kind?this.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?this.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,(0,a.sheetGridCell)(t.sheet,i)):"ChangeDecimals"===r.kind?this.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,(0,a.sheetGridCell)(t.sheet,i)):(0,n.assertNever)("calc.calc.PartialWorkbook: editCellFormats",r);(0,n.isSuccess)(s)||(0,p.forEachRangeInSet)(t.set,(e=>(this.onInferFormatFailure((0,a.sheetGridRange)(t.sheet,e),s.reason),!0))),(0,n.isSuccess)(s)&&void 0===s.value||this.handleSetCellContents(!1,t,void 0,void 0,void 0,(0,a.gridCell)(0,0),(0,n.isSuccess)(s)?s.value:g.SpecialFormat.Unavailable,void 0,void 0,o)})),this.enqueueRecalcFinished()}writeArrayFormula(e,t,r,n=(0,a.gridRangeAnchor)(t.range),i=!1){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{this.trySetStateId(T.ServerUpdate,e)&&this.handleSetRangeFormula(!0,t,r,n,void 0)}))}editArrayFormula(e,t,r,n=(0,a.gridRangeAnchor)(t.range),i=(0,a.sheetGridRange)(t.sheet,C)){this.lastViewport=i,this.scheduler.addTask(T.ClientEdit,h.QueuePos.Back,(()=>{this.trySetStateId(T.ClientEdit,e)&&this.handleSetRangeFormula(!1,t,r,n,i)})),this.enqueueRecalcFinished()}editPaste(e,t,r,n,i=(0,a.sheetGridRange)(r.sheet,C)){this.scheduler.addTask(T.ClientEdit,h.QueuePos.Back,(()=>{this.trySetStateId(T.ClientEdit,e)&&this.handleEditPaste(t,r,n,i)})),this.enqueueRecalcFinished()}assumeRecalcFinal(e,t){this.scheduler.addTask(T.ClientEdit,h.QueuePos.Back,(()=>{this.stateId===e&&this.handleAssumeRecalcFinal(t)}))}testAdvanceState(e){this.scheduler.addTask(T.TestAdvanceState,h.QueuePos.Back,(()=>{this.trySetStateId(T.TestAdvanceState,e)}))}step(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};const e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}}trySetStateId(e,t){if(t<this.stateId)return!1;if(e===T.ClientEdit&&(this.deleteComputeTasks(A.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0){const e=this.config.sampleWorkbookStatisticsRate;void 0!==e&&this.shouldSample(e)&&this.outputMessageLog.push({kind:g.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:e})}const e=1;this.stateChanges===e&&this.enqueueRunExperiments(v.ExperimentKind.OneShot),this.stateChanges>=e&&0===this.scheduler.getCount(T.RunExperiment)&&this.enqueueRunExperiments(v.ExperimentKind.Recurring);const r=this.config.samplePrecisionEvalRate??0,n=this.config.samplePrecisionPrintFormulaRate??0,i=this.config.samplePrecisionPrintValueRate??0;if(this.stateChanges>=e&&(r>0||n>0||i>0)&&this.numPrecisionFailures<R.maxPrecisionFailures&&0===this.scheduler.getCount(T.RunExperiment)){const e=this.config.experimentFactories,t=e?.stepBudget??10,a=e?.totalBudget??1e4,o=new c.PrecisionExperiment({samplePrecisionEvalRate:r,samplePrecisionPrintFormulaRate:n,samplePrecisionPrintValueRate:i}),s={stateId:this.stateId,documents:this.docs.clone(o),stepBudget:t,totalBudget:a,viewport:this.lastViewport};o.setContext(s),this.enqueueRunExperiment("PrecisionExperiment",t,a,v.ExperimentKind.Precision,o,(()=>this.numPrecisionFailures=0),(()=>this.numPrecisionFailures+=1))}this.deleteComputeTasks(A.StateIdAdvanced),this.lastViewport=void 0;const a=this.stateId;this.stateId=t,this.docs.advanceState(a),this.outputMessageLog.push({kind:g.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0}deleteComputeTasks(e){this.scheduler.deleteTasks(T.BeforeCompute,void 0),this.scheduler.deleteTasks(T.ComputeCellValue,void 0),this.scheduler.deleteTasks(T.AfterCompute,e),e!==A.EvalTimedOut&&this.scheduler.deleteTasks(T.ComputeEvalFormula,void 0)}enqueueRunExperiment(e,t,r,i,a,o,s){let u=0,l=0;const c=(t,r,n,o)=>{const s=a.failedLogMessage;void 0!==s&&this.outputMessageLog.push({experimentName:e,kind:g.OutputMessageKind.ExperimentRunResult,experimentKind:i,logMessage:s,timeoutReason:{budgetType:t,budget:r,elapsedTime:n,stepsCount:o}})},d=()=>{if(a.done){const t=a.resultLogMessage;return void 0!==t&&this.outputMessageLog.push({experimentName:e,kind:g.OutputMessageKind.ExperimentRunResult,experimentKind:i,logMessage:t}),void o()}const m=(0,n.now)();let p=m;for(let e=0;e<1e3&&p===m;e+=1){a.step(),l+=1;const e=(0,n.now)(),r=e-p;if(r>=t&&!a.done)return c("stepBudget",t,r,l),void s();p=e}if(u+=p>m?p-m:1,u>=r&&!a.done)return c("totalBudget",r,u,l),void s();this.scheduler.addTask(T.RunExperiment,h.QueuePos.Front,d)};this.scheduler.addTask(T.RunExperiment,h.QueuePos.Back,d)}enqueueRunExperiments(e){if(!this.config.experimentFactories)return;const{stepBudget:t,totalBudget:r,factories:n}=this.config.experimentFactories,i=n.filter((t=>t.kind===e&&(t.numFailures??0)<(t.maxFailures??3)));if(0===i.length)return;const a={stateId:this.stateId,documents:this.docs.clone(d.voidCallback,e===v.ExperimentKind.OneShot?m.CloningTarget.Server:m.CloningTarget.Client),stepBudget:t,totalBudget:r,viewport:this.lastViewport};for(const n of i){const i=n.create();i&&(i.setContext(a),this.enqueueRunExperiment(n.experimentName,n.stepBudget??t,r,e,i,(()=>n.numFailures=0),(()=>n.numFailures=(n.numFailures??0)+1)))}}setSheetNames(e,t,r){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,r))return;const i=this.docs.setSheetNames(e,t);i.kind===n.ResultKind.Failure&&this.onUnavailableObject(i.reason),this.deleteComputeTasks(A.SetSheetNames)}))}setLangConfig(e,t){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const r=this.docs.config.localeInfo!==t.localeInfo,n=this.docs.config.refStyle!==t.refStyle;this.docs.setConfig(t),r&&this.docs.clearCompiledNumberFormats(),(r||n)&&(this.docs.clearCompiledFormulas(),this.deleteComputeTasks(A.SetLangConfig))}))}setNumberFormats(e,t,r,i){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,i))return;const a=this.docs.setNumberFormats(e,t,r);return a.kind===n.ResultKind.Failure?this.onUnavailable(a.reason):void 0}))}writeNamedObject(e,t,r,i){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const o=this.docs.setNamedObject(!0,(0,a.nameLoc)(t,r),i);return o.kind===n.ResultKind.Failure?this.onUnavailable(o.reason):void 0}))}writeUndefinedNames(e,t){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const r=this.docs.setUndefinedNames(t);return r.kind===n.ResultKind.Failure?this.onUnavailable(r.reason):void 0}))}promoteNamedObjects(e,t,r){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const i=this.docs.promoteNamedObjects(t,r);if(i.kind===n.ResultKind.Failure)return this.onUnavailable(i.reason);i.value||this.outputMessageLog.push({kind:g.OutputMessageKind.UpdateNamesRequest,stateId:this.stateId,scope:t})}))}extendUnusedRange(e,t){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,t))return;const r=this.docs.extendServerUnused(e.sheet,e.range);if(r.kind===n.ResultKind.Failure)return this.onUnavailableObject(r.reason);this.docs.onCellModified(!0)}))}writeHiddenRows(e,t){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const r=this.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return r.kind===n.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeHiddenCols(e,t){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const r=this.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return r.kind===n.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}writeInFilterMode(e,t){this.scheduler.addTask(T.ServerUpdate,h.QueuePos.Back,(()=>{if(!this.trySetStateId(T.ServerUpdate,e))return;const r=this.docs.writeInFilterMode(t.sheet,t.inFilterMode);return r.kind===n.ResultKind.Failure?this.onUnavailableObject(r.reason):void 0}))}getStatistics(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}}enqueueMaybeCollectGarbage(){this.scheduler.deleteTasks(T.MaybeCollectGarbage,void 0),this.scheduler.addTask(T.MaybeCollectGarbage,h.QueuePos.Back,(()=>{if(this.stateChangesSinceLastGC<t.MaxStateIdDifferenceForGC)return;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:g.OutputMessageKind.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}))}shouldSample(e){return void 0!==e&&this.rng.next()<=e}translateEnglishFormula(e,t){const r=this.englishParser.parseFormula((0,u.parseLocals)(a.LexicalKind.Cell,t.range),e);if(!(0,n.isSuccess)(r))return r;const i=this.englishAnalyzer.checkFormula((0,u.analyzeLocalsGrid)(a.LexicalKind.Cell,(0,a.sheetGridCell)(t.sheet,t.range)),r.value);if(!(0,n.isSuccess)(i))return i;if(!(0,a.isWellFormed)(i.value))return(0,n.failure)((0,s.illFormedFormula)("ill-formed formula"));const o=this.docs.printFormulaBarText((0,a.lexicalSourceGrid)(a.LexicalKind.Cell,t),t.range,i.value);return(0,n.isSuccess)(o)?(0,n.success)(o.value):o}restrictToViewport(e,t,r,n){if(void 0!==t){const{sheet:o,range:s}=t,u=(0,p.createCellSetFromRange)(s);for(const t of e)(0,a.isSheetIndexEqual)(o,t.sheet)&&n((0,g.sheetCellSet)(o,(0,i.intersectProduct)(t.set,u)),r)}else for(const t of e)n(t,r)}getVolatileMode(){return this.config.volatileMode??y.VolatileMode.Estimation}constructor(e,t={}){this.scheduler=new h.PriorityScheduler,this.englishParser=(0,u.createParser)((0,u.createParseGlobals)(S.initialRecalcServiceConfig)),this.englishAnalyzer=(0,u.createAnalyzer)((0,u.createAnalyzeGlobals)(S.initialRecalcServiceConfig)),this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=e=>{const t=(0,a.sheetGridRangeAnchor)(e),r=this.getAvailableFormula(t);if(!(0,n.isSuccess)(r))return void this.onUnavailableObject(r.reason);const[i,o]=r.value,s=o.compiledFmla.getValue(),u=(0,n.isSuccess)(s)?this.docs.printFormulaBarText(i,t.range,s.value):s;return{formulaBarText:u.kind===n.ResultKind.Success?u.value:void this.outputMessageLog.push({kind:g.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:u.reason}),hasHyperlink:this.formulaHasHyperlink(o),isFormula:!0}},this.printValueProperties=(e,t)=>{const r=this.docs.getEditedFormula(e);if(!(0,n.isSuccess)(r))return void this.onUnavailableObject(r.reason);const i=r.value?.[1].fmla??"",a=this.docs.renderValueBarText(e,t,i);return{formulaBarText:(0,n.isSuccess)(a)?a.value:void this.outputMessageLog.push({kind:g.OutputMessageKind.PrintFormulaFailure,stateId:this.stateId,range:e,reason:a.reason}),hasHyperlink:!1,isFormula:!1}},this.scheduleAvailableFormulas=(e,t)=>{const r=this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(r=>{const i=(0,a.sheetGridCell)(e.sheet,r),o=this.docs.getEditedFormula(i);return o.kind===n.ResultKind.Failure?(this.onUnavailableObject(o.reason),!0):(void 0!==o.value&&void 0!==o.value[1].compiledFmla&&this.enqueueComputeCellValue(i,t),!0)}));(0,n.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.scheduleAvailableValues=(e,t)=>{const r=this.docs.forEachEditedCellInSet(e.sheet,e.set,(r=>{const i=(0,a.sheetGridCell)(e.sheet,r),o=this.docs.getEditedFormula(i);return o.kind===n.ResultKind.Failure?(this.onUnavailableObject(o.reason),!0):(void 0!==o.value&&void 0!==o.value[1].compiledFmla||this.enqueueReturnCellValue(i,t),!0)}));(0,n.isSuccess)(r)||this.onUnavailableObject(r.reason)},this.docs=new d.PartialWorkbookDocumentCollection(e,this,t,t,t.maxDereferenceCells??b,t.isServerWorkbookLoad??!1),this.reconfigure(t)}}t.PartialWorkbook=R,R.maxPrecisionFailures=3;class N{setCompiledFormula(e){this.compiledFormula=e}constructEvaluationTree(e){let t=[];for(const{span:e,oper:r}of this.extracted){const i=[],a=[];for(const r of t){const[[t],n]=r;t[0]>=e[0]&&t[1]<=e[1]?i.push(r):a.push(r)}const o=[e,r.kind===n.ResultKind.Failure?[{value:r}]:r.value.map((e=>({value:(0,n.success)(e)})))],s=i.length>0?[o,i]:[o];t=[...a,s]}return[e,t]}preStep(){return s.StepAction.Continue}postStep(e,t){const r=e.stack[Symbol.iterator]().next();var i;i=!0!==r.done,(0,n.assertTrue)("expect at least one frame",i);const a=r.value;if("number"==typeof a.position&&this.compiledFormula){const e=this.compiledFormula.spans[a.position];e&&this.extracted.push({span:[e.start,e.end],oper:this.processOper(t)})}}processOper(e){switch(e.kind){case a.OperKind.Range:if((0,a.isSheetIndex)(e.sheets)){const t=e.sheets,r=e.ranges.map((e=>this.docs.getCellValues({sheet:t,range:e}))),i=[];for(const e of r){if("Failure"===e.kind)return e;const t=[];for(const r of e.value){const e=[];for(const t of r){if(t.kind===s.CellKind.PendingValue)return(0,n.failure)((0,a.internal)("PendingValue is not expected"));e.push(t.oper)}t.push(e)}const r=t.length,o=t.reduce(((e,t)=>e>=t.length?e:t.length),0);r*o==1?i.push(t[0][0]):i.push((0,a.arrayOper)(r,o,t))}return(0,n.success)(i)}return(0,n.failure)((0,a.internal)("RangeOper contains sheets which is not SheetIndex"));case a.OperKind.Missing:return(0,n.failure)((0,a.internal)("MissingOper is not expected"));default:return(0,n.success)([e])}}constructor(e){this.docs=e,this.extracted=[]}}t.FormulaEvaluationTreeExtractor=N},9399:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankStyle=t.genFmt=t.knownFormatData=t.kfToIformat=t.englishLocaleData=t.defaultConfig=t.mathpack=t.locale=void 0,t.assertMessageOrder=function(e){e.reduce(S,g)},t.createRange=function(e,t){return[(0,i.sheetGridRange)(e,t),(0,u.sheetCellSet)(e,(0,l.createCellSetFromRange)(t))]},t.createPartialWorkbook=function(e,r,n){const i=new s.PartialWorkbook({...t.defaultConfig,localeInfo:n?.localeOverride??t.locale},r);return i.setWorksheetFuncOverrides(n?.worksheetFuncOverrides??{}),(n?.setNumberFormats??1)&&i.setNumberFormats(e,t.knownFormatData,!1,-1/0),i};const n=r(6913),i=r(6592),a=r(1159),o=r(1475),s=r(3804),u=r(9204),l=r(8453),c=r(3340),d=r(721);var m;!function(e){e.EditedPhase="EditedPhase",e.DependentPhase="DependentPhase",e.StatisticsPhase="StatisticsPhase",e.Finished="Finished"}(m||(m={}));const g={kind:m.EditedPhase,stateId:-1/0},p=Object.getOwnPropertyNames(u.OutputMessageKind);function h(e,t){const r={};return e.forEach((e=>r[e]=t)),r}const f={[m.EditedPhase]:{[u.OutputMessageKind.StateAdvanced]:()=>m.EditedPhase,[u.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===u.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===u.ComputedCellKind.EditedCell)return m.EditedPhase;if(t.cellKind===u.ComputedCellKind.DependentCell)return m.DependentPhase;if(t.cellKind===u.ComputedCellKind.IndependentCell)return m.EditedPhase;if(t.cellKind===u.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,n.assertNever)("calc.calc.partialWorkbook.testutilsutils.transitions",t.cellKind)}if(t.message===u.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===u.ComputedCellKind.EditedCell)return m.EditedPhase;if(t.cellKind===u.ComputedCellKind.DependentCell)return m.DependentPhase;if(t.cellKind===u.ComputedCellKind.IndependentCell)return m.EditedPhase;if(t.cellKind===u.ComputedCellKind.UnknownNonEditedCell)return e(`a different message.cellKind than ${t.cellKind}`);(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===u.RecalcStatisticsMessage.ContinueComputation?m.EditedPhase:t.message===u.RecalcStatisticsMessage.EditFinished||t.message===u.RecalcStatisticsMessage.StateTimedOut?m.StatisticsPhase:t.message===u.RecalcStatisticsMessage.RecalcFinished?m.Finished:void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},...h([u.OutputMessageKind.CellWrite,u.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===u.ComputedCellKind.EditedCell?m.EditedPhase:t.cellKind===u.ComputedCellKind.DependentCell?m.DependentPhase:void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind))),[u.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===u.ComputedCellKind.EditedCell?m.EditedPhase:t.cellKind===u.ComputedCellKind.DependentCell?m.DependentPhase:t.cellKind===u.ComputedCellKind.IndependentCell?m.EditedPhase:t.cellKind===u.ComputedCellKind.UnknownNonEditedCell?m.DependentPhase:void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[u.OutputMessageKind.PrintFormulaFailure]:()=>m.EditedPhase,[u.OutputMessageKind.InferFormatFailure]:()=>m.EditedPhase,[u.OutputMessageKind.FormatValueFailure]:()=>m.EditedPhase,...h([u.OutputMessageKind.GarbageCollected,u.OutputMessageKind.Alert,u.OutputMessageKind.ExperimentRunResult,u.OutputMessageKind.UpdateRequest,u.OutputMessageKind.WorkbookStatistics,u.OutputMessageKind.UnhandledFailure,u.OutputMessageKind.NumberFormatFailure,u.OutputMessageKind.NameFailure,u.OutputMessageKind.UpdateNamesRequest],(()=>m.EditedPhase))},[m.DependentPhase]:{[u.OutputMessageKind.RecalcStatistics]:(e,t)=>{if(t.message===u.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===u.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===u.ComputedCellKind.DependentCell)return m.DependentPhase;if(t.cellKind===u.ComputedCellKind.IndependentCell)return m.DependentPhase;if(t.cellKind===u.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}if(t.message===u.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===u.ComputedCellKind.EditedCell)return e(`a different cellKind than ${t.cellKind}`);if(t.cellKind===u.ComputedCellKind.DependentCell)return m.DependentPhase;if(t.cellKind===u.ComputedCellKind.IndependentCell)return m.DependentPhase;if(t.cellKind===u.ComputedCellKind.UnknownNonEditedCell)return e(`a different cellKind than ${t.cellKind}`);(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===u.RecalcStatisticsMessage.ContinueComputation?e(`a different message.message than ${t.message}`):t.message===u.RecalcStatisticsMessage.EditFinished?m.StatisticsPhase:t.message===u.RecalcStatisticsMessage.StateTimedOut||t.message===u.RecalcStatisticsMessage.RecalcFinished?e(`a different message.message than ${t.message}`):void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},...h([u.OutputMessageKind.CellWrite,u.OutputMessageKind.RangeWrite],((e,t)=>t.cellKind===u.ComputedCellKind.EditedCell?e(`a different message.cellKind than ${t.cellKind}`):t.cellKind===u.ComputedCellKind.DependentCell?m.DependentPhase:void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind))),[u.OutputMessageKind.RangeFailure]:(e,t)=>t.cellKind===u.ComputedCellKind.EditedCell?t.reason.kind===o.ReasonKind.CellCycle?m.DependentPhase:e(`the current state to be ${m.EditedPhase}, or ${m.DependentPhase} and failure ${o.ReasonKind.CellCycle}`):t.cellKind===u.ComputedCellKind.IndependentCell||t.cellKind===u.ComputedCellKind.DependentCell||t.cellKind===u.ComputedCellKind.UnknownNonEditedCell?m.DependentPhase:void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind),[u.OutputMessageKind.FormatValueFailure]:()=>m.DependentPhase,...h([u.OutputMessageKind.GarbageCollected,u.OutputMessageKind.Alert,u.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`))),...h([u.OutputMessageKind.StateAdvanced,u.OutputMessageKind.UpdateRequest,u.OutputMessageKind.WorkbookStatistics,u.OutputMessageKind.UnhandledFailure,u.OutputMessageKind.NumberFormatFailure,u.OutputMessageKind.NameFailure,u.OutputMessageKind.PrintFormulaFailure,u.OutputMessageKind.InferFormatFailure,u.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))},[m.StatisticsPhase]:{[u.OutputMessageKind.RecalcStatistics]:(e,t)=>t.message===u.RecalcStatisticsMessage.ChangedCell||t.message===u.RecalcStatisticsMessage.UnchangedCell||t.message===u.RecalcStatisticsMessage.ContinueComputation||t.message===u.RecalcStatisticsMessage.EditFinished||t.message===u.RecalcStatisticsMessage.StateTimedOut?e(`a different message.message than ${t.message}`):t.message===u.RecalcStatisticsMessage.RecalcFinished?m.Finished:void(0,n.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message),...h([u.OutputMessageKind.GarbageCollected,u.OutputMessageKind.Alert,u.OutputMessageKind.ExperimentRunResult],((e,t)=>e(`a different message.kind than ${t.kind}`))),...h([u.OutputMessageKind.CellWrite,u.OutputMessageKind.RangeWrite,u.OutputMessageKind.RangeFailure,u.OutputMessageKind.PrintFormulaFailure,u.OutputMessageKind.InferFormatFailure,u.OutputMessageKind.FormatValueFailure,u.OutputMessageKind.StateAdvanced,u.OutputMessageKind.UpdateRequest,u.OutputMessageKind.WorkbookStatistics,u.OutputMessageKind.NumberFormatFailure,u.OutputMessageKind.UnhandledFailure,u.OutputMessageKind.NameFailure,u.OutputMessageKind.UpdateNamesRequest],((e,t)=>e(`a different message.kind than ${t.kind}`)))},[m.Finished]:h(p,(e=>e("no message once recalc finished")))};function S(e,t,r){const{stateId:n,kind:i}=e,a=function(e,t){switch(t.kind){case u.OutputMessageKind.GarbageCollected:return expect(t.minStateIdKept).toBeLessThanOrEqual(e),e;case u.OutputMessageKind.Alert:return e;case u.OutputMessageKind.ExperimentRunResult:return t.experimentKind===c.ExperimentKind.OneShot&&expect(e).toEqual(1),e;default:return expect(e).toBeLessThanOrEqual(t.stateId),t.stateId}}(n,t);return{kind:(0,f[i][t.kind])((function(n){return expect({state:e,message:t,index:r}).toEqual(n)}),t,i),stateId:a}}t.locale=(0,i.getEnglishLocaleInfo)(),t.mathpack=i.xlMathpack,t.defaultConfig={localeInfo:t.locale,mathpack:t.mathpack,refStyle:i.RefStyle.A1,date1904:!1,dateCompatibility:!0,timezone:i.tzUTC,datepack:i.xlDatepack},t.englishLocaleData=(0,d.localeData)([{functionId:0,functionName:"COUNT"}],[{errorType:1,errorName:"#NULL!"}],"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",[3,0],",",1033,1,2,!1," ",!1,"Paren",!0,!1,"$",2,"MDY","/","-",!0,!1,!1,!0,":",null,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["AM/PM","A/P","上午/下午",null,"General","$"],[null,";","#","0",".","%",",",":","/","/"," ","-","+","(",")",null,"\\","*","y","m","d","h","m","s","E","/",'"',"[","]","@","?","_","r","a","g","e",null,null,null,null,null,null,"B","N","ว","ด","ป","b","ค","ช","น","ท","๐",null],["Black","White","Red","Green","Blue","Yellow","Magenta","Cyan","Color"],["DBNum1","DBNum2","DBNum3","DBNum4"],(0,n.partialArray)({[i.SpecialRefId.All]:"#All",[i.SpecialRefId.Data]:"#Data",[i.SpecialRefId.Headers]:"#Headers",[i.SpecialRefId.Totals]:"#Totals",[i.SpecialRefId.ThisRow]:"#This Row"}),"dddd, mmmm dd, yyyy","h:mm:ss AM/PM","en-US","en-US","en-US","en-US"),t.kfToIformat=e=>Math.abs(e),t.knownFormatData=(0,n.numEnumArray)(i.KnownFormat).filter((e=>(0,a.isKnownFormatDefined)(e,(0,i.getEnglishLocaleInfo)()))).map((e=>(0,d.numberFormat)((0,t.kfToIformat)(e),(0,a.getKnownFormat)(t.locale,e),!0))),t.genFmt=(0,t.kfToIformat)(i.KnownFormat.General),t.blankStyle=u.SpecialStyle.Blank},8277:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocument=void 0;const n=r(6913),i=r(9610),a=r(6592),o=r(6824),s=r(9204),u=r(3512),l=r(8453),c=r(4592);class d{clone(e=o.CloningTarget.Server){let t;if(this.grids){t=(0,n.makeStringMap)();for(const r in this.grids){const n=this.grids[r];t[r]=n.clone(e)}}return new d(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),t,void 0,this.nameManager.clone())}getReadonlyNameManager(){return this.nameManager}getReadonlySheets(){return this.sheets}setClientValue(e,t,r){const i=this.getGridById(e.sheet.index);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setClientValue(e.range,t,r))}setClientFormula(e,t,r){const i=this.getGridById(e.sheet.index);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setClientFormula(e.range,e.range,t,r))}setRecalcFailure(e,t){const r=this.getGridById(e);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.setRecalcFailure(t))}setRecalcEditTaint(e,t){const r=this.getGridById(e);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.setRecalcEditTaint(t))}setRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.setRecalcValue(e.range,t))}setEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.setEditedFormat(e.range,t))}setClientFormat(e,t,r){const i=this.getGridById(e.sheet.index);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setClientFormat(e.range,t,r))}setHiddenRows(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setHiddenRows(t,r))}setHiddenCols(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setHiddenCols(t,r))}setMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.setMergeCell(e.range))}setInFilterMode(e,t){const r=this.getGridById(e);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.setInFilterMode(t))}setCellContents(e,t,r,i,o,s,u,l,c){const d=this.getGridById(t.sheet.index);if(d.kind===n.ResultKind.Failure)return d;const m=void 0!==l&&(0,a.isSheetIndexEqual)(t.sheet,l.sheet)?l.range:void 0;return(0,n.success)(d.value.setCellContents(e,t.set,r,i,o,s,u,m,c))}setRangeFormula(e,t,r,i,o,s,u,l){const c=this.getGridById(t.sheet.index);if(c.kind===n.ResultKind.Failure)return c;const d=void 0!==u&&(0,a.isSheetIndexEqual)(t.sheet,u.sheet)?u.range:void 0;return(0,n.success)(c.value.setRangeFormula(e,t.range,r,i,o,s,d,l))}copyRange(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.copyRange(e.range))}pasteRange(e,t,r){const i=this.getGridById(e.sheet.index);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.pasteRange(e.range,t,r))}assumeRecalcFinal(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.assumeRecalcFinal(e.set,t))}getDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyEditedCells()))})),e}getNonDirtyEditedCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e}getDirtyDependentCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyDependentCells()))})),e}setNamedObject(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)}setUndefinedNames(e){return this.nameManager.setUndefinedNames(e)}promoteNamedObjects(e,t){return this.nameManager.promoteNamedObjects(e,t)}setSheetNames(e){const t=this.grids??this.oldGrids,r=(0,n.makeStringMap)();for(const{sheetId:n}of e)r[n]=t?.[n]??o.PartialWorkbookGrid.create();return new d(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(e),r,void 0,this.nameManager.setSheetNames(e))}extendServerUnused(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.extendServerUnused(t,r))}promoteServerAvailability(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.promoteServerAvailability(t,r))}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e,t,r)}getNameFormula(e,t){return this.nameManager.getNameFormula(e,t)}hasRecalcNameFailure(e){return this.nameManager.hasRecalcNameFailure(e)}setRecalcNameFailure(e){return this.nameManager.setRecalcNameFailure(e)}getContainingTable(e){const t=this.nameManager.getContainingTable(e);if(t.kind===n.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,a.unavailable)([r.reason]));const o=(0,i.intersectProduct)((0,l.createCellSetFromRange)(e.range),l.availableSetProduct);return(0,i.meetsProduct)(o,r.value.getServerAvailability())?n.successUndefined:(0,n.failure)((0,a.unavailable)([{kind:s.UnavailableKind.ContainingTable,range:e}]))}getNamedRanges(e){const t=this.nameManager.getNamedRanges(e);if(t.kind===n.ResultKind.Failure||void 0!==t.value)return t;const r=this.getGridById(e.sheet.index);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,a.unavailable)([r.reason]));const o=(0,i.intersectProduct)((0,l.createCellSetFromRange)(e.range),l.availableSetProduct);return(0,i.meetsProduct)(o,r.value.getServerAvailability())?(0,n.success)([]):(0,n.failure)((0,a.unavailable)([{kind:s.UnavailableKind.NamedRanges,range:e}]))}getIntersectingTables(e){return this.nameManager.getIntersectingTables(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getEditedFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getEditedFormula(e.range))}forEachEditedFormula(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.forEachEditedFormula(e.range,t))}getEditedValue(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getEditedValue(e.range))}forEachEditedValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.forEachEditedValue(e.range,t))}getEditedFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getEditedFormat(e.range))}forEachEditedFormat(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.forEachEditedFormat(e.range,t))}getEditedStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getEditedStyle(e.range))}isInFilterMode(e){const t=this.getGridById(e);return t.kind===n.ResultKind.Failure?t:t.value.isInFilterMode()}getHiddenRows(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?o.hiddennessFullyUnavailable:i.value.getHiddenRows(t,r)}tryGetHiddenRows(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:i.value.tryGetHiddenRows(t,r)}getHiddenCols(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?o.hiddennessFullyUnavailable:i.value.getHiddenCols(t,r)}tryGetHiddenCols(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:i.value.tryGetHiddenCols(t,r)}getMergeCell(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getMergeCell(e.range))}getServerFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getServerFormat(e.range))}getServerStyle(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getServerStyle(e.range))}getClientFormat(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getClientFormat(e.range))}getClientValue(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getClientValue(e.range))}getRecalcValues(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getRecalcValues(e.range))}forEachRecalcValue(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.forEachRecalcValue(e.range,t))}getServerValue(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getServerValue(e.range))}getServerFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getServerFormula(e.range))}getClientFormula(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getClientFormula(e.range))}getServerUsedRange(e){const t=this.getGridById(e);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getServerUsedRange())}allServerAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.allServerAvailable(e.range))}allEditedAvailable(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.allEditedAvailable(e.range))}forEachRecalcDirty(e,t){const r=this.getGridById(e.sheet.index);return r.kind===n.ResultKind.Failure?r:(0,n.success)(r.value.forEachRecalcDirty(e.range,t))}hasRecalcDirty(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.hasRecalcDirty(e.range))}hasRecalcFailure(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.hasRecalcFailure(e.range))}hasEditedEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.hasEditedEditTaint(e.range))}hasRecalcEditTaint(e){const t=this.getGridById(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.hasRecalcEditTaint(e.range))}forEachEditedNonBlankCellInSet(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.forEachEditedNonBlankCellInSet(t,r))}forEachServerNonBlankCellInSet(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.forEachServerNonBlankCellInSet(t,r))}forEachEditedCellInSet(e,t,r){const i=this.getGridById(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.forEachEditedCellInSet(t,r))}getSheetIndex(e){const t=this.sheets.getSheetByName(e);return t.kind===n.ResultKind.Failure||void 0===t.value?t:(0,n.success)(t.value.sheetIndex)}getSheetName(e){const t=this.sheets.getSheetById(e);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.name)}getEditedUsedRange(e){const t=this.getGridById(e);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getEditedUsedRange())}getSheetRangeIds(e){return this.sheets.getSheetRangeIds(e)}getIformat(e){return this.formats.getIformat(e)}getIformats(){return this.formats.getIformats()}getKnownFormat(e){return this.formats.getKnownFormat(e)}getFormatString(e){return this.formats.getFormatString(e)}resolveCellStyle(e){return this.styles.resolveCellStyle(e)}setNumberFormats(e,t){this.formats.setNumberFormats(e,t)}setStyles(e,t){this.styles.setStyles(e,t)}setFonts(e,t){this.styles.setFonts(e,t)}setFills(e,t){this.styles.setFills(e,t)}setBorders(e,t){this.styles.setBorders(e,t)}onCellModified(e,t){this.forEachSheet(((r,n)=>{n.onCellModified(e,t)})),this.nameManager.onCellModified(e)}collectGarbage(e,t){this.forEachSheet(((r,n)=>{n.collectGarbage(e,t)})),this.nameManager.collectGarbage(e)}advanceState(e,t){this.forEachSheet(((r,n)=>{n.advanceState(e,t)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0}clearCompiledFormulas(){this.forEachSheet(((e,t)=>{t.clearCompiledFormulas()})),this.nameManager.resetLazyData()}clearCompiledNumberFormats(){this.formats.clearCompiledNumberFormats()}getGridStatistics(){let e=o.emptyGridStatistics;return this.forEachSheet(((t,r)=>e=(0,o.mergeGridStatistics)(e,r.getStatistics()))),e}getNameStatistics(){return this.nameManager.getNameStatistics()}getServerAvailableCells(){const e=[];return this.forEachSheet(((t,r)=>{e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e}forEachSheet(e){const t=this.grids;t&&this.sheets.forEachSheet(((r,n)=>{const i=t[n];i&&e(r,i)}))}getGridById(e){const t=this.grids;if(!t)return(0,n.failure)({kind:s.UnavailableKind.SheetNames});const r=t[e];return void 0===r?(0,n.failure)({kind:s.UnavailableKind.SheetId,document:this.document,sheetId:e}):(0,n.success)(r)}constructor(e,t,r,n,i=new c.PartialWorkbookSheets(e,t),a,o,s=new u.PartialWorkbookNameManager(e,t)){this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=i,this.grids=a,this.oldGrids=o,this.nameManager=s}}t.PartialWorkbookDocument=d},5677:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocumentCollection=t.voidCallback=void 0;const n=r(6913),i=r(6592),a=r(1159),o=r(1475),s=r(391),u=r(8277),l=r(8866),c=r(6824),d=r(9204),m=r(7214),g=r(8453),p=r(362),h=r(4352),f=(0,i.gridCell)(0,0);class S extends i.ConstVisitor{wsfNode(e){this.fns.push((0,i.englishWorksheetFuncIdToName)(e))}operatorNode(e){this.fns.push((0,i.englishOperatorIdToName)(e))}constructor(){super(void 0),this.fns=[]}}function v(e){const t=new S;return(0,i.reduceBottomUp)(t,e),t.fns}const y=(0,i.precedents)([],[],[],i.SpecialPrecs.None,i.PrecsBound.Exact);t.voidCallback={onNameFailure:()=>{},onRangeFailure:()=>{},onNumberFormatFailure:()=>{},onInferFormatFailure:()=>{},onUnavailableObject:()=>{},onUnavailable:()=>{},onSetCellValue:()=>{},onSetCellValues:()=>{},onReturnCellValue:()=>{}};class F{clone(e=t.voidCallback,r=c.CloningTarget.Server){const n=new F(this.config,e,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return n.documentLoc=this.documentLoc,n.document=this.document?.clone(r),n.worksheetFuncOverrides=this.worksheetFuncOverrides,n.userDefinedFuncOverrides=this.userDefinedFuncOverrides,n.version=this.version,n}compareVersion(e){return this.version===e.version}getSingleReadonlyDocument(){return this.document}reconfigure(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n,this.advanceVersion()}setConfig(e){this.config=e}forEachDocument(e){void 0!==this.document&&e(this.document)}getDocumentLoc(e,t){const r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.DocumentLoc,document:(0,i.documentLoc)(e,t)}])):(0,n.success)(r)}getNameLoc(e,t,r){const a=this.getDocument(e.document);return a.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([a.reason])):a.value.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){const r=(0,i.userDefinedFuncLoc)(e,t);return(0,n.success)([r])}return(0,n.failure)((0,i.notImplemented)(["call UDF"]))}getCellFormat(e){const t=this.allEditedAvailable(e);if(t.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([t.reason]));if(!0!==t.value)return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedFormat(e);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([r.reason])):r.value===d.SpecialFormat.Unavailable?(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.CellFormat}])):(0,n.success)(r.value)}getCellStyle(e){const t=this.allEditedAvailable(e);if(!(0,n.isSuccess)(t))return(0,n.failure)((0,i.unavailable)([t.reason]));if(!0!==t.value)return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getEditedStyle(e);return(0,n.isSuccess)(r)?r.value===d.SpecialStyle.Unavailable?(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):(0,n.failure)((0,i.unavailable)([r.reason]))}getIformat(e,t){const r=this.getDocument(e);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const o=r.value.getIformat(t);if(o.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([o.reason]));const s=o.value.getValue();return s.kind===n.ResultKind.Failure?(0,n.failure)((0,a.previousFormatFailure)((0,a.formatLocIFormat)(e,t))):s}getIformats(e,t,r){const a=this.getDocument(e);if(a.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([a.reason]));const o=a.value.getIformats(),s=[];for(let e=t,i=(0,n.fastMin)(o.length,r);e<i;e+=1){const t=o[e];void 0!==t&&s.push({iformat:e,formatString:t.formatString,builtIn:t.builtIn})}return(0,n.success)(s)}getKnownFormat(e,t){const r=this.getDocument(e);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const o=r.value.getKnownFormat(t);if(o.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([o.reason]));const s=o.value.getValue();return s.kind===n.ResultKind.Failure?(0,n.failure)((0,a.previousFormatFailure)((0,a.formatLocKnownFormat)(e,t))):s}getFormatString(e,t){const r=this.getDocument(e);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getFormatString(t);return a.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([a.reason])):a}getNameFormula(e,t){const r=this.getDocument(e.scope.document);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getNameFormula(e,t);if(a.kind===n.ResultKind.Failure)return a;if(void 0===a.value)return(0,n.success)(void 0);const s=a.value.lazyData.getValue();if((0,n.isSuccess)(s))return s;const u=this.hasRecalcNameFailure(e);return(0,n.isSuccess)(u)?u.value||this.setNameFailure(e,s.reason):this.cb.onUnavailable(u.reason),(0,n.failure)((0,o.previousNameFailure)(e))}getCellFormula(e){const t=this.getEditedFormula(e);if(t.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([t.reason]));if(void 0===t.value)return(0,n.success)(void 0);const[r,a]=t.value;if(void 0===a.compiledFmla)return(0,n.success)(void 0);const s=(0,i.sheetGridRange)(e.sheet,r),u=this.readCompiledFmla(s,a.compiledFmla);return(0,n.isSuccess)(u)?(0,n.success)((0,o.cellFormula)((0,i.lexicalSourceGrid)(a.lexicalKind,s),u.value)):u}setCellValue(e,t,r){const i=this.setRecalcValue(e,t);if(i.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);const a=this.propagateEditTaint(e,r);if(a.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)}setCellValues(e,t,r){const i=this.setClientValue(e,t);if(i.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);const a=this.setRecalcValue(e,t);if(a.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const o=this.propagateEditTaint(e,r);if(o.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onSetCellValues(e,t,r,o.value,this.evalParams)}getWorksheetFunc(e){if((0,i.isVolatileFunc)(e)){let t=!1;const r=this.evalParams.volatileMode;switch(e){case i.WorksheetFuncId.RAND:case i.WorksheetFuncId.RANDBETWEEN:case i.WorksheetFuncId.RANDARRAY:case i.WorksheetFuncId.NOW:t=r===h.VolatileMode.GroundTruth;break;case i.WorksheetFuncId.TODAY:t=r===h.VolatileMode.GroundTruth||r===h.VolatileMode.Estimation;break;default:t=void 0===i.WorksheetFuncId[e]}if(!t)return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.VolatileFunction,name:(0,i.englishWorksheetFuncIdToName)(e)}]))}const t=this.worksheetFuncOverrides[e]??(0,o.getWorksheetFunc)(e);return null!=t?(0,n.success)(t):(0,n.failure)((0,i.notImplemented)([(0,i.englishWorksheetFuncIdToName)(e)]))}getUserDefinedFunc(e){const t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?(0,n.success)(this.userDefinedFuncOverrides[t]):(0,n.failure)((0,i.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.getSheetRangeIds(e)}setCellFailure(e,t,r){const a=this.setRecalcFailure(e.sheet,(0,g.createCellSetFromRange)(e.range));if(a.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);const o=this.setClientValue(e,c.clientValueUnknownOper);if(o.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);const s=this.setRecalcValue(e,i.blankOper);if(s.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason);const u=this.propagateEditTaint(e,r);if(u.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason);const l=this.evalParams;l.onRangeFailure?.(e,t,r),this.cb.onRangeFailure(e,t,r,u.value,l)}getUsedRange(e){const t=this.getEditedUsedRange(e);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t}getSheetName(e,t){const r=this.getDocument(e);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getSheetName(t);return a.kind===n.ResultKind.Failure||void 0===a.value?a:(0,n.success)(a.value)}getSheetIndex(e,t){const r=this.getDocument(e);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getSheetIndex(t);return a.kind===n.ResultKind.Failure||void 0===a.value?a:(0,n.success)(a.value.index)}getContainingTable(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.getContainingTable(e)}getNamedRanges(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.getNamedRanges(e)}getStructRefColumn(e,t){const r=this.getDocument(e.scope.document);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([r.reason])):r.value.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){const r=this.getDocument(e.scope.document);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([r.reason])):r.value.getStructRefSpecialRef(e,t)}getIntersectingTables(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.getIntersectingTables(e)}getNamedObject(e,t){const r=this.getDocument(e.scope.document);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getNameFormula(e,t);return a.kind===n.ResultKind.Failure?a:(0,n.success)(a.value?.obj)}getHiddenRows(e,t,r){const i=this.getDocument(e.document);return i.kind===n.ResultKind.Failure?c.hiddennessFullyUnavailable:i.value.getHiddenRows(e.index,t,r)}tryGetHiddenRows(e,t,r){const a=this.getDocument(e.document);if(a.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([a.reason]));const o=a.value.tryGetHiddenRows(e.index,t,r);return o.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([o.reason])):o}getHiddenCols(e,t,r){const i=this.getDocument(e.document);return i.kind===n.ResultKind.Failure?c.hiddennessFullyUnavailable:i.value.getHiddenCols(e.index,t,r)}tryGetHiddenCols(e,t,r){const a=this.getDocument(e.document);if(a.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([a.reason]));const o=a.value.tryGetHiddenCols(e.index,t,r);return o.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([o.reason])):o}getMergeCell(e){const t=this.allEditedAvailable(e);if(t.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([t.reason]));if(!0!==t.value)return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));const r=this.getDocument(e.sheet.document);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getMergeCell(e);return a.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([a.reason])):a}isInFilterMode(e){const t=this.getDocument(e.document);if(t.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([t.reason]));const r=t.value.isInFilterMode(e.index);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([r.reason])):r}getRandom(){return(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===h.VolatileMode.GroundTruth),(0,n.success)(this.config.mathpack.fromNumber(this.random.next()))}getTime(e,t){return(0,h.getTimeImpl)(this.config,e,t,this.evalParams.volatileMode)}withEvalParams(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return Array.isArray(r)?r:r.kind===n.ResultKind.Paused?(0,o.paused)((()=>this.withEvalParams(e,r.resume))):(0,o.breaked)((()=>this.withEvalParams(e,r.resume)))}finally{this.evalParams=r}}withEvalParamsEvalFormula(e,t){const r=this.evalParams;this.evalParams=e;try{const r=t();return r.kind===n.ResultKind.Paused?(0,o.paused)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r.kind===n.ResultKind.Breaked?(0,o.breaked)((()=>this.withEvalParamsEvalFormula(e,r.resume))):r}finally{this.evalParams=r}}evaluate(e,t,r,n){return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r,onRangeFailure:n},(()=>this.evaluator.evalCells({},t)))}evalFormula(e,t,r,a,s){const u={lexicalKind:i.LexicalKind.Other,originGridCell:(0,n.success)(t.range),originSheet:(0,n.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:void 0!==s,contextNames:void 0},l={lexicalSource:{kind:i.LexicalKind.Other},originGridCell:(0,n.success)(t.range),originSheet:(0,n.success)(t.sheet),calcingArray:!1,reflectionGridCell:(0,n.success)(t.range),reflectionSheet:(0,n.success)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,n.success)(!1),contextNames:void 0,stepConfig:s},c=(e,i)=>{if(i.kind===n.ResultKind.Paused)return(0,o.paused)((()=>c(e,i.resume())));if(i.kind===n.ResultKind.Breaked)return(0,o.breaked)((()=>c(e,i.resume())));if(!(0,n.isSuccess)(i))return(0,n.success)({value:i});const a=this.evalFormulaFormat(t,e,i.value,r);return(0,n.success)({value:(0,n.success)(i.value),formatted:a})};return this.withEvalParamsEvalFormula({computeKind:d.ComputeKind.EvalFormula,computeCells:[t],volatileMode:a},(()=>{const t=this.parser.parseFormula(u,e),r=this.checkFormula(u,t,e,d.FormulaMode.EvalFormula),i=this.compileFormula(u,r);return(0,n.isSuccess)(i)?(s&&s.setCompiledFormula(i.value),c(i.value,this.evaluator.evalFormula(l,i.value))):(0,n.success)({value:i})}))}evalFormulaFormat(e,t,r,a){if(void 0===a)return;if("number"==typeof a)return this.formatValueIformat(e.sheet.document,a,r);if(a.kind===d.SpecialFormat.Known)return this.formatValueKnownFormat(e.sheet.document,a.knownFormat,r);let o=r;if((0,i.isBlankOper)(r)&&(a.kind===d.SpecialFormat.Origin||a.kind===d.SpecialFormat.Inferred||a.kind===d.SpecialFormat.Edit)&&a.renderBlanksAsZeros&&(o=this.config.mathpack.zero),a.kind===d.SpecialFormat.Origin||a.kind===d.SpecialFormat.Aggregate){const t=this.ensureCellExists(e);return(0,n.isNone)(t)||!(0,n.isSuccess)(t)?t:a.kind===d.SpecialFormat.Origin?this.formatValueCell(e,o):this.formatValueAggregate(e,o)}return a.kind===d.SpecialFormat.Inferred?this.applyInferredFormat(e,t,o):a.kind===d.SpecialFormat.Edit?this.applyEditFormat(e,t,o,a.isWholeFormula):(0,n.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",a)}evalValue(e,t,r){const i=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{const t=this.getEditedFormula(e);if(!(0,n.isSuccess)(t))return this.cb.onUnavailableObject(t.reason);if(void 0!==t.value?.[1].compiledFmla)return;const r=this.hasRecalcDirty(e);if(!(0,n.isSuccess)(r))return this.cb.onUnavailableObject(r.reason);if(r.value)return;const i=this.tryGetCellValue(e.range,e.sheet);if(void 0===i)return;(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",i.kind===o.CellKind.FinalValue),this.cb.onReturnCellValue(e,i.oper,d.ComputedCellKind.EditedCell)}finally{this.evalParams=i}}advanceVersion(){return this.version++,this.version}setUserDefinedFuncOverrides(e){this.userDefinedFuncOverrides=e,this.advanceVersion()}setWorksheetFuncOverrides(e){this.worksheetFuncOverrides=e,this.advanceVersion()}setSheetNames(e,t){const r=this.ensureDocument(e);return r.kind===n.ResultKind.Failure?r:(this.document=r.value.setSheetNames(t),(0,n.success)(void 0))}advanceState(e){void 0!==this.document&&this.document.advanceState(e,this.advanceVersion())}onCellModified(e){if(void 0!==this.document)return this.document.onCellModified(e,this.advanceVersion())}getServerDocument(){return this.documentLoc}allServerAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.allServerAvailable(e)}forEachEditedNonBlankCellInSet({index:e,document:t},r,i){const a=this.getDocument(t);return a.kind===n.ResultKind.Failure?a:a.value.forEachEditedNonBlankCellInSet(e,r,i)}forEachServerNonBlankCellInSet({index:e,document:t},r,i){const a=this.getDocument(t);return a.kind===n.ResultKind.Failure?a:a.value.forEachServerNonBlankCellInSet(e,r,i)}forEachEditedCellInSet({index:e,document:t},r,i){const a=this.getDocument(t);return a.kind===n.ResultKind.Failure?a:a.value.forEachEditedCellInSet(e,r,i)}clearCompiledFormulas(){if(void 0!==this.document)return this.document.clearCompiledFormulas()}clearCompiledNumberFormats(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()}getGridStatistics(){return void 0!==this.document?this.document.getGridStatistics():c.emptyGridStatistics}getNameStatistics(){return void 0!==this.document?this.document.getNameStatistics():m.emptyNameStatistics}collectGarbage(e){if(void 0!==this.document)return this.document.collectGarbage(e,this.advanceVersion())}getEditedFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getEditedFormula(e)}forEachEditedFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.forEachEditedFormula(e,t)}getEditedValue(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getEditedValue(e)}forEachEditedValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.forEachEditedValue(e,t)}getEditedFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getEditedFormat(e)}forEachEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.forEachEditedFormat(e,t)}getEditedStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getEditedStyle(e)}getServerFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getServerFormat(e)}getServerStyle(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getServerStyle(e)}getClientFormat(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getClientFormat(e)}getClientValue(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getClientValue(e)}getRecalcValues(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getRecalcValues(e)}forEachRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.forEachRecalcValue(e,t)}getServerValue(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getServerValue(e)}getServerFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getServerFormula(e)}getClientFormula(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.getClientFormula(e)}getServerUsedRange(e){const t=this.getDocument(e.document);if(t.kind===n.ResultKind.Failure)return t;const r=t.value.getServerUsedRange(e.index);return r.kind===n.ResultKind.Failure||void 0===r.value?r:(0,n.success)((0,i.sheetGridRange)(e,r.value))}getServerAvailableCells(){const e=[];return this.forEachDocument((t=>{(0,n.safePush)(e,t.getServerAvailableCells())})),e}promoteServerAvailability({sheet:e,set:t},r){const i=this.getDocument(e.document);return i.kind===n.ResultKind.Failure?i:i.value.promoteServerAvailability(e.index,t,r)}extendServerUnused(e,t){const r=this.getDocument(e.document);return r.kind===n.ResultKind.Failure?r:r.value.extendServerUnused(e.index,t,this.advanceVersion())}setCellContents(e,t,r,a,o,s,u,l,d,m){const g=this.getDocument(t.sheet.document);if(g.kind===n.ResultKind.Failure)return g;const p=void 0===r?void 0:a?this.compileFmla(e,i.LexicalKind.Cell,(0,i.sheetGridCell)(t.sheet,o),void 0,r):""===r?c.blankCellGridFormula:{fmla:r,lexicalKind:i.LexicalKind.Cell,origin:o,compiledFmla:void 0,hasHyperlink:c.SpecialBoolean.ClientValueUnknown};return g.value.setCellContents(e,t,p,s,u,l,d,m,this.advanceVersion())}setRangeFormula(e,t,r,a,o,s,u,l){const d=this.getDocument(t.sheet.document);if(d.kind===n.ResultKind.Failure)return d;const m=""===r?c.blankRangeGridFormula:this.compileFmla(e,i.LexicalKind.Range,(0,i.sheetGridCell)(t.sheet,a),(0,i.gridRangeAnchor)(t.range),r);return d.value.setRangeFormula(e,t,m,o,s,u,l,this.advanceVersion())}copyRange(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.copyRange(e)}pasteRange(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.pasteRange(e,t,this.advanceVersion())}assumeRecalcFinal(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.assumeRecalcFinal(e,this.advanceVersion())}getDirtyEditedCells(){return this.document?this.document.getDirtyEditedCells():[]}getNonDirtyEditedCells(){return this.document?this.document.getNonDirtyEditedCells():[]}getDirtyDependentCells(){return this.document?this.document.getDirtyDependentCells():[]}setNamedObject(e,t,r){const a=this.getDocument(t.scope.document);return a.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([a.reason])):a.value.setNamedObject(e,t,r,this.compileNamedObject)}setUndefinedNames(e){const t=this.getDocument(e.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.setUndefinedNames(e)}promoteNamedObjects(e,t){const r=this.getDocument(e.document);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([r.reason])):r.value.promoteNamedObjects(e,t)}setNumberFormats(e,t,r){const a=this.ensureDocument(e);if(a.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([a.reason]));const o=[];return t.forEach((({iformat:e,formatString:t,builtIn:r})=>{const n=this.compileNumberFormat(t,r);o[e]={formatString:t,builtIn:r,compiledFormat:n}})),(0,n.success)(a.value.setNumberFormats(o,r))}setStyles(e,t,r){const i=this.ensureDocument(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setStyles(t,r))}setFonts(e,t,r){const i=this.ensureDocument(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setFonts(t,r))}setFills(e,t,r){const i=this.ensureDocument(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setFills(t,r))}setBorders(e,t,r){const i=this.ensureDocument(e);return i.kind===n.ResultKind.Failure?i:(0,n.success)(i.value.setBorders(t,r))}writeHiddenRows(e,t,r){const i=this.getDocument(e.document);return i.kind===n.ResultKind.Failure?i:i.value.setHiddenRows(e.index,t,r)}writeHiddenCols(e,t,r){const i=this.getDocument(e.document);return i.kind===n.ResultKind.Failure?i:i.value.setHiddenCols(e.index,t,r)}writeMergeCell(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.setMergeCell(e)}writeInFilterMode(e,t){const r=this.getDocument(e.document);return r.kind===n.ResultKind.Failure?r:r.value.setInFilterMode(e.index,t)}resolveCellFormat(e,t){if("number"!=typeof t)return(0,n.success)(t);const r=this.getDocument(e);if(!(0,n.isSuccess)(r))return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.getIformat(t);return(0,n.isSuccess)(a)?a.value.getValue():(0,n.failure)((0,i.unavailable)([a.reason]))}resolveCellStyle(e,t){const r=this.getDocument(e);if(!(0,n.isSuccess)(r))return(0,n.failure)((0,i.unavailable)([r.reason]));const a=r.value.resolveCellStyle(t);return(0,n.isSuccess)(a)?(0,n.success)(a.value):(0,n.failure)((0,i.unavailable)([a.reason]))}resolveValueFormat(e,t){if("string"==typeof t)return this.resolveStringFormat(e,t);const r=this.getKnownFormat(e,t);if(!(0,n.isSuccess)(r))return r;const i=this.getFormatString(e,r.value.formatString);return(0,n.isSuccess)(i)?(0,n.success)(i.value??r.value):i}resolveStringFormat(e,t){const r=this.getFormatString(e,t);return(0,n.isSuccess)(r)?void 0!==r.value?(0,n.success)(r.value):this.formatter.createFormat(t,!1):r}resolveObjectFormat(e,t){const r=this.getFormatString(e,t.formatString);return(0,n.isSuccess)(r)?void 0!==r.value?(0,n.success)(r.value):(0,n.success)(t):r}resolveEditFormat(e,t){return"number"==typeof t?(0,n.success)(t):this.resolveStringFormat(e,t)}resolveRibbonFormat(e,t,r){let i;switch(t){case a.RibbonFormat.GalleryShortDate:case a.RibbonFormat.GalleryLongDate:{const e=this.getCellFormat(r);if(!(0,n.isSuccess)(e))return e;const t=this.resolveCellFormat(r.sheet.document,e.value);if(!(0,n.isSuccess)(t))return t;i=t.value;break}}const o=(0,a.getRibbonFormat)(this.config.localeInfo,t,i);return this.resolveStringFormat(e,o)}resolveChangeDecimals(e,t,r){const i=this.getCellFormat(r);if(!(0,n.isSuccess)(i))return i;const a=this.resolveCellFormat(r.sheet.document,i.value);if(!(0,n.isSuccess)(a))return a;const o=this.formatter.changeFormatDecimals(a.value,t);return(0,n.isSuccess)(o)?void 0===o.value?n.successUndefined:this.resolveObjectFormat(e,o.value):o}parseInferredEdit(e,t,r){const i=this.getCellFormat(e);if(!(0,n.isSuccess)(i))return i;const a=this.resolveCellFormat(e.sheet.document,i.value);if(!(0,n.isSuccess)(a))return a;const o=this.evalParams;this.evalParams={computeKind:d.ComputeKind.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,a.value)}finally{this.evalParams=o}}inferFormulaFormat(e){const t=this.getEditedFormula(e);if(!(0,n.isSuccess)(t))return(0,n.success)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return(0,n.success)(void this.cb.onUnavailableObject({kind:d.UnavailableKind.CellEvaluatingValue}));const r=t.value[1].compiledFmla.getValue();if(!(0,n.isSuccess)(r))return r;const o=(0,i.lexicalSourceGrid)(t.value[1].lexicalKind,(0,i.sheetGridRange)(e.sheet,t.value[0])),s=r.value;return this.formatter.evalFormat((0,a.evalFormatLocalsGrid)(o),s)}fillInferredFormat(e,t){let r=t,o=t===d.SpecialFormat.Unavailable?(0,n.success)(d.SpecialFormat.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!(0,n.isSuccess)(o)){const t=o.reason;(0,g.forEachRangeInSet)(e.set,(r=>{const n=(0,i.sheetGridRange)(e.sheet,r);return this.cb.onInferFormatFailure(n,t),!0})),o=(0,n.success)(d.SpecialFormat.Unavailable),r=d.SpecialFormat.Unavailable}const s=o.value;(0,g.forEachCellInSet)(e.set,(t=>{const o=(0,i.sheetGridCell)(e.sheet,t),u=this.getEditedFormat(o);if(!(0,n.isSuccess)(u))return this.cb.onUnavailableObject(u.reason),!0;if(u.value===d.SpecialFormat.Unavailable)return!0;const l=this.resolveCellFormat(e.sheet.document,u.value);if(!(0,n.isSuccess)(l))return this.cb.onInferFormatFailure(o,l.reason),!0;if((0,a.shouldInstallFormat)(s===d.SpecialFormat.Unavailable?void 0:s,l.value)){const e=this.setEditedFormat(o,r);(0,n.isSuccess)(e)||this.cb.onUnavailableObject(e.reason)}return!0}))}anonymizeFormula(e,t){const r=t.compiledFmla?.getValue();return void 0!==r&&(0,n.isSuccess)(r)?[(0,i.anonymizeFormula)(this.config,r.value,e),v(r.value)]:[(0,n.anonymizeFormulaString)(t.fmla),[]]}compileFmla(e,t,r,n,i){return{fmla:i,lexicalKind:t,origin:n??r.range,compiledFmla:new h.ResettableLazy((()=>{const a=this.parser.parseFormula((0,s.parseLocals)(t,r.range),i),u=e?a:this.autocorrectFormula((0,s.analyzeLocalsGrid)(t,r),a),l=e&&this.isServerWorkbookLoad,c=this.checkFormula((0,s.analyzeLocalsGrid)(t,r,void 0,l),u,i,e?d.FormulaMode.ServerCellFormula:d.FormulaMode.EditCellFormula),m=this.adjustFormulaOrigin(c,r,n);return this.compileFormula((0,o.compileLocalsGrid)(t,r.range),m)})),hasHyperlink:c.SpecialBoolean.ClientValueUnknown}}compileFormula(e,t){return(0,n.isSuccess)(t)?this.compiler.compileFormula(e,t.value):t}checkFormula(e,t,r,a){if(!(0,n.isSuccess)(t))return t;const u=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!(0,n.isSuccess)(u))return u;if(!(0,i.isWellFormed)(u.value[0])){const e="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,n.anonymizeFormulaString)(r);return(0,n.failure)((0,o.illFormedFormula)(e,a,(0,s.summarizeFormulaDiagnostics)(u.value[1])))}return(0,n.success)(u.value[0])}autocorrectFormula(e,t){return(0,n.isSuccess)(t)?this.analyzer.autocorrectFormula(e,t.value):t}adjustFormulaOrigin(e,t,r){if(!(0,n.isSuccess)(e)||void 0===r)return e;const a=(0,i.resolveLocalsGrid)(t);return(0,i.adjustFormulaOrigin)(this,a,r,e.value)}compileNumberFormat(e,t){return new h.ResettableLazy((()=>{const r=this.formatter.createFormat(e,t);return(0,n.isSuccess)(r)||this.cb.onNumberFormatFailure(r.reason),r}))}compileKnownFormats(){return(0,n.numEnumMap)(i.KnownFormat,(e=>this.compileNumberFormat((0,a.getKnownFormat)(this.config.localeInfo,e),!1)))}printFormulaBarText(e,t,r){return this.printer.printFormula((0,i.printLocalsGrid)(e,(0,i.sheetGridCell)(e.range.sheet,t)),r)}renderValueBarText(e,t,r){const i=this.getEditedResolvedFormat(e);return(0,n.isSuccess)(i)?this.formatter.renderFormulaBar(e.sheet.document,t,i.value,(0,n.stringStartsWith)(r,"'")):i}formatValueCell(e,t){if((0,i.isBlankOper)(t))return(0,n.success)((0,a.formattedValue)([],void 0,a.Alignment.Left,a.Clip.All));const r=this.getEditedResolvedFormat(e);return(0,n.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueAggregate(e,t){if(!(0,i.isNumberOper)(t))return(0,n.success)((0,a.hashesValue)(a.aggregationError,void 0));let r;if((0,i.isNumberOper)(t)&&0===this.config.mathpack.cond(t))r=this.getKnownFormat(e.sheet.document,i.KnownFormat.General);else{if(r=this.getEditedResolvedFormat(e),!(0,n.isSuccess)(r))return r;const{valueType:t}=r.value;t===a.FormatValueType.Text?r=this.getKnownFormat(e.sheet.document,i.KnownFormat.General):t===a.FormatValueType.Time&&(r=this.getKnownFormat(e.sheet.document,i.KnownFormat.AbsHMMSS))}return(0,n.isSuccess)(r)?this.formatter.applyFormat(r.value,t,!0):r}formatValueIformat(e,t,r){const i=this.getIformat(e,t);return(0,n.isSuccess)(i)?this.formatter.applyFormat(i.value,r,!0):i}formatValueKnownFormat(e,t,r){const i=this.getKnownFormat(e,t);return(0,n.isSuccess)(i)?this.formatter.applyFormat(i.value,r,!0):i}getEditedResolvedFormat(e){const t=this.getEditedFormat(e);return(0,n.isSuccess)(t)?t.value===d.SpecialFormat.Unavailable?(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):(0,n.failure)((0,i.unavailable)([t.reason]))}getDocument(e){return void 0!==this.documentLoc&&void 0!==this.document&&(0,i.isDocumentLocEqual)(this.documentLoc,e)?(0,n.success)(this.document):(0,n.failure)({kind:d.UnavailableKind.DocumentLoc,document:e})}ensureDocument(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new u.PartialWorkbookDocument(e,this.config.localeInfo.stringCompareCI,new l.PartialWorkbookFormats(this.compileKnownFormats()),new p.PartialWorkbookStyles)),this.getDocument(e)}tryGetCellValues(e,t){const r=(0,i.sheetGridRange)(t,e),{row:a,col:s,rows:u,cols:l}=e,c=this.getRecalcValues(r);if(c.kind===n.ResultKind.Failure)return void this.cb.onUnavailableObject(c.reason);let m=!1;for(let e=0;e<u;e+=1){const r=c.value[e];for(let n=0;n<l;n+=1){const{failure:o}=r[n];void 0!==o&&(this.setCellFailure((0,i.sheetGridCell)(t,(0,i.gridCell)(a+e,s+n)),o,y),m=!0)}}if(m)return;const g=e=>(0,o.finalValue)(e.oper),p=c.value.map((e=>e.map(g))),h=this.forEachRecalcDirty(r,(e=>{const r=(0,i.sheetGridCell)(t,e),u=this.getEditedFormula(r);if(u.kind===n.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason),!1;if(void 0===u.value)return this.setCellFailure(r,(0,i.unavailable)([{kind:d.UnavailableKind.CellMissingFormula}]),y),m=!0,!0;const[l,c]=u.value;if(void 0===c.compiledFmla)return this.cb.onUnavailableObject({kind:d.UnavailableKind.CellEvaluatingValue}),!1;const g=this.readCompiledFmla((0,i.sheetGridRange)(t,l),c.compiledFmla);return(0,n.isSuccess)(g)?(p[e.row-a][e.col-s]=(0,o.pendingValue)((0,i.sheetGridCell)(t,(0,i.gridRangeAnchor)(l))),!0):(m=!0,!0)}));if((0,n.isSuccess)(h)){if(h.value&&!m)return p}else this.cb.onUnavailableObject(h.reason)}tryGetCellValue(e,t){const r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]}makeGetCellValues(e){return t=>{const r=this.allEditedAvailable(t);if(r.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([r.reason]));if(!0!==r.value)return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.GridRange,range:t,unavailableCells:r.value}]));const a=this.hasRecalcFailure(t);if(a.kind===n.ResultKind.Failure)return(0,n.failure)((0,i.unavailable)([a.reason]));if(a.value)return(0,n.failure)((0,o.previousFailure)(t));if((0,i.gridRangeSize)(t.range)>this.maxDereferenceCells)return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.GridRangeSize,range:t}]));const s=e(t.range,t.sheet);return void 0===s?(0,n.failure)((0,o.previousFailure)(t)):(0,n.success)(s)}}readCompiledFmla(e,t){const r=t.getValue();return(0,n.isSuccess)(r)?r:(this.setCellFailure(e,r.reason,y),r.reason.kind===o.ReasonKind.Unavailable?(r.reason,r):(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.CellFormula,reason:r.reason}])))}getEditedUsedRange(e){const t=this.getDocument(e.document);if(t.kind===n.ResultKind.Failure)return t;const r=t.value.getEditedUsedRange(e.index);return r.kind===n.ResultKind.Failure||void 0===r.value?r:(0,n.success)((0,i.sheetGridRange)(e,r.value))}getSheetRangeIds(e){const t=this.getDocument(e.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.getSheetRangeIds(e)}allEditedAvailable(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.allEditedAvailable(e)}forEachRecalcDirty(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.forEachRecalcDirty(e,t)}hasRecalcDirty(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.hasRecalcDirty(e)}hasRecalcFailure(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.hasRecalcFailure(e)}hasEditedEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.hasEditedEditTaint(e)}hasRecalcEditTaint(e){const t=this.getDocument(e.sheet.document);return t.kind===n.ResultKind.Failure?t:t.value.hasRecalcEditTaint(e)}setEditedFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.setEditedFormat(e,t)}setClientFormat(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.setClientFormat(e,t,this.advanceVersion())}setRecalcFailure(e,t){const r=this.getDocument(e.document);return r.kind===n.ResultKind.Failure?r:r.value.setRecalcFailure(e.index,t)}testAndSetClientValue(e,t){const r=this.getClientValue(e);if(r.kind===n.ResultKind.Failure)return r;const a=(0,c.isClientValueUnknownOper)(r.value.oper)||!(0,i.isReadOperEqual)(this.config.mathpack,r.value.oper,t,!0);if(a){const r=this.setClientValue(e,t);if(r.kind===n.ResultKind.Failure)return r}return(0,n.success)(a)}testAndSetClientFormat(e,t){const r=this.getClientFormat(e);if(r.kind===n.ResultKind.Failure)return r;const i=t!==r.value;if(i){const r=this.setClientFormat(e,t);if(r.kind===n.ResultKind.Failure)return r}return(0,n.success)(i)}testAndSetClientFormula(e,t,r){const a=this.getClientFormula((0,i.sheetGridRangeAnchor)(e));if(a.kind===n.ResultKind.Failure)return a;const[o,s]=a.value??[e.range,c.blankClientGridFormula],u=(0,i.gridRangeAnchor)(e.range),l=void 0!==t&&t!==s.fmla||void 0!==s.compiledFmla&&!(0,i.isGridCellEqual)(u,s.origin),d=void 0!==r&&r!==s.hasHyperlink;if(l||d){const{compiledFmla:a}=s,l=this.setClientFormula((0,i.sheetGridRange)(e.sheet,o),{fmla:t??s.fmla,compiledFmla:a,origin:void 0!==t?u:s.origin,hasHyperlink:r??s.hasHyperlink});if(l.kind===n.ResultKind.Failure)return l}return(0,n.success)({hasFmlaChanged:l,hasHyperlinkChanged:d})}setRecalcEditTaint(e,t){const r=this.getDocument(e.document);return r.kind===n.ResultKind.Failure?r:r.value.setRecalcEditTaint(e.index,t)}propagateEditTaint(e,t){const r=this.hasEditedEditTaint(e);if(r.kind===n.ResultKind.Failure)return r;if(r.value)return(0,n.success)(d.ComputedCellKind.EditedCell);for(const r of t.cells){const t=this.hasRecalcEditTaint(r);if(t.kind===n.ResultKind.Failure)return t;if(t.value){const t=this.setRecalcEditTaint(e.sheet,(0,g.createCellSetFromRange)(e.range));return t.kind===n.ResultKind.Failure?t:(0,n.success)(d.ComputedCellKind.DependentCell)}}if(0!=(t.special&(i.SpecialPrecs.Calc|i.SpecialPrecs.Time))){const t=this.setRecalcEditTaint(e.sheet,(0,g.createCellSetFromRange)(e.range));return t.kind===n.ResultKind.Failure?t:(0,n.success)(d.ComputedCellKind.DependentCell)}return t.bound===i.PrecsBound.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===d.ComputeKind.EditedCell?(0,n.success)(d.ComputedCellKind.IndependentCell):(0,n.success)(d.ComputedCellKind.UnknownNonEditedCell)}setClientValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.setClientValue(e,t,this.advanceVersion())}setRecalcValue(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.setRecalcValue(e,t)}setClientFormula(e,t){const r=this.getDocument(e.sheet.document);return r.kind===n.ResultKind.Failure?r:r.value.setClientFormula(e,t,this.advanceVersion())}hasRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.hasRecalcNameFailure(e)}setRecalcNameFailure(e){const t=this.getDocument(e.scope.document);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,i.unavailable)([t.reason])):t.value.setRecalcNameFailure(e)}setNameFailure(e,t){const r=this.setRecalcNameFailure(e);if(r.kind===n.ResultKind.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)}applyInferredFormat(e,t,r){const a=this.getInferredFormat(e,t);return(0,n.isSuccess)(a)?void 0===a.value?this.formatValueKnownFormat(e.sheet.document,i.KnownFormat.General,r):"number"==typeof a.value?this.formatValueIformat(e.sheet.document,a.value,r):this.formatter.applyFormat(a.value,r,!0):a}applyEditFormat(e,t,r,o){if(t.node.kind===i.NodeKind.CellRef&&!o)return this.applyInferredFormat(e,t,r);const s=this.ensureCellExists(e);if((0,n.isNone)(s)||!(0,n.isSuccess)(s))return s;const u=this.getEditedResolvedFormat(e);if(!(0,n.isSuccess)(u))return u;const l=this.getInferredFormat(e,t);if(!(0,n.isSuccess)(l))return l;let c;if(void 0===l.value)c=void 0;else if("number"==typeof l.value){const t=this.getIformat(e.sheet.document,l.value);if(!(0,n.isSuccess)(t))return t;c=t.value}else c=l.value;const d=(0,a.getKnownFormat)(this.config.localeInfo,i.KnownFormat.General)===u.value.formatString;return(o||d)&&(0,n.isDefined)(c)&&(0,a.shouldInstallFormat)(c,u.value)?this.formatter.applyFormat(c,r,!0):this.formatter.applyFormat(u.value,r,!0)}getInferredFormat(e,t){const r={lexicalSource:{kind:i.LexicalKind.Other},originGridCell:(0,n.success)(e.range),originSheet:(0,n.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(r,t)}ensureCellExists(e){const t=this.allEditedAvailable(e);if((0,n.isSuccess)(t))return!0!==t.value?(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.GridRange,unavailableCells:t.value,range:e}])):(0,n.success)(!0);this.cb.onUnavailableObject(t.reason)}constructor(e,t,r,u,l,c){this.cb=t,this.schedulerConfig=r,this.limits=u,this.maxDereferenceCells=l,this.isServerWorkbookLoad=c,this.random=new n.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[o.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=(e,t,r)=>{const a=e?d.FormulaMode.ServerNamedFormula:d.FormulaMode.EditNamedFormula;switch(r.kind){case"NamedFormula":{const t=r.fmla,u=this.parser.parseFormula((0,s.parseLocals)(i.LexicalKind.NameManager,f),t);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);const l=e&&this.isServerWorkbookLoad,c=(0,s.analyzeLocalsName)((0,i.originCell)((0,i.documentScope)(this.documentLoc),f),void 0,l),d=u,m=this.checkFormula(c,d,t,a);return this.compileFormula((0,o.compileLocalsName)(f),m)}case"NamedValue":case"NamedRange":case"NamedTable":{let e,a;if("NamedRange"===r.kind){const o=r.value;(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,i.isDocumentLocEqual)(r.value.sheets.document,t.scope.document));const s=o.sheets,u=this.getDocument(s.document);if(!(0,n.isSuccess)(u))return this.cb.onUnavailableObject(u.reason),(0,n.failure)((0,i.unavailable)([u.reason]));const l=u.value.getSheetName(s.index);if(!(0,n.isSuccess)(l))return this.cb.onUnavailable(l.reason),l;const c=r.value.ranges[0];e=(0,i.formula)((0,i.cellRefNode)((0,i.cellRefRange)((0,i.cellRefSingle)((0,i.pos)(i.PosKind.Abs,c.row),(0,i.pos)(i.PosKind.Abs,c.col)),(0,i.cellRefSingle)((0,i.pos)(i.PosKind.Abs,c.row+c.rows-1),(0,i.pos)(i.PosKind.Abs,c.col+c.cols-1))),(0,i.sheetQualifier)(l.value)),[],[],1),a=(0,i.sheetGridCell)(s,f)}else"NamedTable"===r.kind?(e=(0,i.formula)((0,i.structRefNode)((0,i.nameNode)((0,i.identNamePart)(t.name)),(0,i.structRef)(void 0)),[],[],1),a=(0,i.originCell)((0,i.documentScope)(this.documentLoc),f)):(e=(0,i.formula)((0,i.literalNode)(r.value,!0),[],[],1),a=(0,i.originCell)((0,i.documentScope)(this.documentLoc),f));const u=this.analyzer.checkFormula((0,s.analyzeLocalsName)(a),e);return(0,n.isSuccess)(u)&&(0,i.isWellFormed)(u.value)?this.compileFormula((0,o.compileLocalsName)(f),(0,n.success)(u.value)):(0,n.assertFalse)(`calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ${(0,i.anonymizeFormula)(this.config,e,(0,i.lexicalSourceName)(t))}`)}case"NamedFailure":return(0,n.failure)((0,i.unavailable)([{kind:d.UnavailableKind.ClientFailure,reason:r.failureReason}]));default:return(0,n.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=(0,s.createParser)(this),this.printer=(0,i.createPrinter)(this),this.analyzer=(0,s.createAnalyzer)(this),this.formatter=(0,a.createNumberFormatter)(this),this.compiler=(0,o.createCompiler)(this),this.evaluator=(0,o.createEvaluator)(this)}}t.PartialWorkbookDocumentCollection=F},7796:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFailureOutputMessage=function(e){return i.includes(e.kind)};const n=r(9204),i=[n.OutputMessageKind.RangeFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.UnhandledFailure]},8866:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookFormats=void 0;const n=r(6913),i=r(9204);class a{clone(){const e=new a(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((t=>{e.iformats[t]=this.iformats[t]})),Object.keys(this.formatStrings).forEach((t=>{e.formatStrings[t]=this.formatStrings[t]})),e}clearCompiledNumberFormats(){this.iformats.forEach((e=>{e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((e=>Number(e))).forEach((e=>{this.knownFormats[e].reset()})),this.formatStrings=(0,n.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach((e=>{const t=this.iformats[e];this.formatStrings[t.formatString]=e}))}getIformat(e){const t=this.iformats[e];return void 0===t?(0,n.failure)({kind:i.UnavailableKind.NumberFormat,iformat:e}):(0,n.success)(t.compiledFormat)}getIformats(){return this.iformats}getKnownFormat(e){return(0,n.success)(this.knownFormats[e])}getFormatString(e){return(0,n.success)(this.formatStrings[e])}setNumberFormats(e,t){t||(this.iformats=[],this.formatStrings=(0,n.makeStringMap)()),Object.keys(e).map(Number).forEach((t=>{const r=this.iformats[t];void 0!==r&&delete this.formatStrings[r.formatString];const n=e[t];this.iformats[t]=n,this.formatStrings[n.formatString]=t}))}constructor(e){this.iformats=[],this.formatStrings=(0,n.makeStringMap)(),this.knownFormats=e}}t.PartialWorkbookFormats=a},6824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookGrid=t.CloningTarget=t.denseUsedRange=t.emptyUsedRange=t.emptyGridStatistics=t.hiddennessFullyUnavailable=t.blankGridValue=t.clientValueUnknownOper=t.ClientOperKind=t.blankClientGridFormula=t.isBlankGridFormula=t.blankRangeGridFormula=t.blankCellGridFormula=t.SpecialString=t.SpecialBoolean=t.isBlankCellFormat=t.blankCellFormat=void 0,t.isClientValueUnknownOper=p,t.isBlankGridValue=h,t.mergeGridStatistics=function(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}},t.usedRangeJoin=b,t.usedRangeIsect=C;const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(1475),u=r(9204),l=r(8453);function c(e){return Array.isArray(e)}var d,m,g;function p(e){return e.kind===g.ClientValueUnknown}function h(e,t){return(0,o.isBlankOper)(e)&&void 0===t}function f(e,t,r){return e.setValue(t,r,(e=>e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!(0,o.isGridCellEqual)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)))}function S(e,r){return e.forEachMeets(r,((r,n)=>{if(n.fmla.length>0){const i=n.lexicalKind===o.LexicalKind.Cell?t.blankCellGridFormula:t.blankRangeGridFormula;e=e.setValue(r,i)}return!0})),e}function v(e,r){return e.forEachMeets(r,((r,n)=>((n.fmla===m.ClientValueUnknown||n.fmla.length>0)&&(e=e.setValue(r,t.blankClientGridFormula)),!0))),e}function y(e,t,r,n){const i=(0,a.intersectProduct)(t,l.availableReadProduct),o=(0,a.project)((0,a.intersectProduct)(r,i),"row","col");return(0,l.forEachCellInSet)((0,a.exceptProduct)(t,o),(t=>(e=e.setValue(t,n),!0))),e}t.blankCellFormat=0,t.isBlankCellFormat=e=>0===e,function(e){e.ClientValueUnknown="ClientValueUnknown"}(d||(t.SpecialBoolean=d={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(m||(t.SpecialString=m={})),t.blankCellGridFormula={fmla:"",lexicalKind:o.LexicalKind.Cell,origin:(0,o.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,n.staticAssertExtends)(),t.blankRangeGridFormula={fmla:"",lexicalKind:o.LexicalKind.Range,origin:(0,o.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,n.staticAssertExtends)(),t.isBlankGridFormula=(e,t)=>""===e&&!t,t.blankClientGridFormula=t.blankCellGridFormula,function(e){e.ClientValueUnknown="ClientValueUnknown"}(g||(t.ClientOperKind=g={})),t.clientValueUnknownOper={kind:g.ClientValueUnknown},t.blankGridValue={oper:o.blankOper,failure:void 0},(0,n.staticAssertExtends)(),t.hiddennessFullyUnavailable={hidden:[],available:[]};const F={values:(0,o.makeGridRangeTable)(),formats:(0,o.makeGridRangeTable)(),styles:(0,o.makeGridRangeTable)(),formulae:(0,o.makeGridRangeTable)(),dirty:i.empty};function b(e,r){return e===t.emptyUsedRange?r:r===t.emptyUsedRange?e:(0,o.gridRangeJoin)(e,r)}function C(e,r){return e===t.emptyUsedRange||r===t.emptyUsedRange?t.emptyUsedRange:(0,o.gridRangeIsect)(e,r)}var k;t.emptyGridStatistics={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0},t.emptyUsedRange=void 0,t.denseUsedRange=(0,o.gridRange)(0,0,o.sheetRows,o.sheetCols),function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(k||(t.CloningTarget=k={}));class E{static create(){return new E}clone(e=k.Server){const t=new E(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return e===k.Client&&(t.editedContents=this.editedContents,t.clientContents=this.clientContents,t.recalcValues=this.recalcValues,t.recalcDirty=this.recalcDirty,t.recalcFailures=this.recalcFailures,t.editedTaint=this.editedTaint,t.recalcTaint=this.recalcTaint,t.editedAvailability=this.editedAvailability),t}advanceState(e,r){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=i.empty,this.serverUsed=t.denseUsedRange,this.hiddenRows=this.hiddenRowsAvailability=i.empty,this.hiddenCols=this.hiddenColsAvailability=i.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(r)}rollBackToServerState(e){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=i.empty,this.rollBackToEditedState(e)}rollBackToEditedState(e){this.setClientContents(this.editedContents,e),this.recalcValues=this.editedContents.values,this.recalcFailures=i.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint}allServerAvailable(e){return this.allAvailable(e,this.serverAvailability)}allEditedAvailable(e){return this.allAvailable(e,this.editedAvailability)}allAvailable(e,t){const r=(0,l.createCellSetFromRange)(e),n=(0,a.intersectProduct)(r,l.availableReadProduct),i=(0,a.intersectProduct)(t,n),o=(0,a.project)((0,a.exceptProduct)(n,i),"row","col"),s=(0,a.compareProduct)(i,n);return!!(void 0!==s&&s>=0)||o}forEachRecalcDirty(e,t){return(0,l.forEachCellInSet)((0,a.intersectProduct)(this.recalcDirty,(0,l.createCellSetFromRange)(e)),t)}hasRecalcDirty(e){return(0,a.meetsProduct)(this.recalcDirty,(0,l.createCellSetFromRange)(e))}hasRecalcFailure(e){return(0,a.meetsProduct)(this.recalcFailures,(0,l.createCellSetFromRange)(e))}hasEditedEditTaint(e){return(0,a.meetsProduct)(this.editedTaint,(0,l.createCellSetFromRange)(e))}hasRecalcEditTaint(e){return(0,a.meetsProduct)(this.recalcTaint,(0,l.createCellSetFromRange)(e))}getEditedUsedRange(){return this.editedUsed}getServerUsedRange(){return this.serverUsed}getServerAvailability(){return this.serverAvailability}getHiddenRows(e,t){const r=l.bspFactory.row((0,n.pair)(e,t)),a=(0,i.intersect)(this.hiddenRowsAvailability,r),o=[];(0,l.forEachRow)(a,(([e,t])=>(o.push((0,s.interval)(e,t)),!0)));const u=[];return(0,l.forEachRow)((0,i.intersect)(this.hiddenRows,a),(([e,t])=>(u.push((0,s.interval)(e,t)),!0))),{hidden:u,available:o}}tryGetHiddenRows(e,t){const r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,n.success)(r.hidden):(0,n.failure)({kind:u.UnavailableKind.HiddenRows})}setHiddenRows(e,t){const r=l.bspFactory.row((0,n.pair)(e.row,e.row+e.rows));this.hiddenRows=(0,i.union)((0,i.except)(this.hiddenRows,r),(0,i.intersect)(t,r)),this.hiddenRowsAvailability=(0,i.union)(this.hiddenRowsAvailability,r)}getHiddenCols(e,t){const r=l.bspFactory.col((0,n.pair)(e,t)),a=(0,i.intersect)(this.hiddenColsAvailability,r),o=[];(0,l.forEachCol)(a,(([e,t])=>(o.push((0,s.interval)(e,t)),!0)));const u=[];return(0,l.forEachCol)((0,i.intersect)(this.hiddenCols,a),(([e,t])=>(u.push((0,s.interval)(e,t)),!0))),{hidden:u,available:o}}tryGetHiddenCols(e,t){const r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,n.success)(r.hidden):(0,n.failure)({kind:u.UnavailableKind.HiddenCols})}setHiddenCols(e,t){const r=l.bspFactory.col((0,n.pair)(e.col,e.col+e.cols));this.hiddenCols=(0,i.union)((0,i.except)(this.hiddenCols,r),(0,i.intersect)(t,r)),this.hiddenColsAvailability=(0,i.union)(this.hiddenColsAvailability,r)}setMergeCell(e){this.mergeCells=this.mergeCells.setValue(e,!0)}getMergeCell(e){let t;return this.mergeCells.forEachGe(e,(e=>(t=e,!0))),t}isInFilterMode(){return this.filterModeAvailable?(0,n.success)(this.inFilterMode):(0,n.failure)({kind:u.UnavailableKind.InFilterMode})}setInFilterMode(e){this.inFilterMode=e,this.filterModeAvailable=!0}forEachNonBlankSetCellInSet(e,r,n,i){const s=(0,a.intersectProduct)(e,l.availableSetProduct);return(0,l.forEachRangeInSet)((0,a.intersectProduct)(n,s),(e=>i.formulae.forEachMeets(e,((n,i)=>!!(0,t.isBlankGridFormula)(i.fmla,void 0!==i.compiledFmla)||(0,o.forEachCellInRange)((0,o.gridRangeIsect)(e,n),r)))))}forEachReadableCellInSet(e,t,r){const n=(0,a.intersectProduct)(e,l.availableReadProduct);return(0,l.forEachRangeInSet)((0,a.intersectProduct)(r,n),(e=>(0,o.forEachCellInRange)(e,t)))}forEachEditedNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)}forEachServerNonBlankCellInSet(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)}forEachEditedCellInSet(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)}promoteServerAvailability(e,t){const r=(0,a.intersectProduct)(e,l.availableSetProduct),n=this.oldAvailabilities[t];if(void 0===n)return!1;const o=(0,a.compareProduct)(n,r);return void 0!==o&&o>=0&&(this.unionAvailability(!0,(0,a.intersectProduct)(e,l.availableAllProduct)),this.unionTaint(!0,i.empty),this.unionUsed(!0,(0,l.cellSetBounds)(e)),!0)}extendServerUnused(e,r){const n=e===t.emptyUsedRange?i.empty:(0,l.createCellSetFromRange)(e),o=(0,a.complementProduct)(n);let{values:s,formats:c,styles:d,formulae:m,dirty:g}=this.serverContents;(0,l.forEachRangeInSet)(o,(e=>(s.forEachLe(e,((e,r)=>(h(r.oper,r.failure)||(s=s.setValue(e,t.blankGridValue)),!0))),c.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(c=c.setValue(e,t.blankCellFormat)),!0))),d.forEachLe(e,((e,t)=>(t!==u.SpecialStyle.Blank&&(d=d.setValue(e,u.SpecialStyle.Blank)),!0))),!0))),(0,l.forEachRangeInSet)(o,(e=>(m=S(m,e),!0))),g=(0,a.exceptProduct)(g,o),this.setContents(!0,{values:s,formats:c,styles:d,formulae:m,dirty:g},r);const p=(0,a.intersectProduct)(o,l.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,a.unionProduct)(this.serverAvailability,p),this.editedTaint=this.recalcTaint=i.empty;let f=this.serverUsed;f=C(f,e),this.serverUsed=this.editedUsed=f}setRecalcFailure(e){this.recalcFailures=(0,a.unionProduct)(this.recalcFailures,e)}setRecalcEditTaint(e){this.recalcTaint=(0,a.unionProduct)(this.recalcTaint,e)}setRecalcValue(e,t){(0,o.forEachCellInRange)(e,((e,r,n)=>(this.recalcValues=this.recalcValues.setValue(e,{oper:c(t)?t[r][n]:t,failure:void 0}),!0))),this.recalcDirty=(0,a.exceptProduct)(this.recalcDirty,(0,l.createCellSetFromRange)(e))}setClientContents(e,t){this.clientContents=e}setClientValue(e,t,r){let{values:n}=this.clientContents;(0,o.forEachCellInRange)(e,((e,r,i)=>(n=n.setValue(e,{oper:c(t)?t[r][i]:t,failure:void 0}),!0))),this.setClientContents({...this.clientContents,values:n},r)}setClientFormula(e,t,r,n){let{formulae:i}=this.clientContents;i=v(i,e),void 0!==t?i=i.setValue(t,r):(0,o.forEachCellInRange)(e,(e=>(i=i.setValue(e,r),!0))),this.setClientContents({...this.clientContents,formulae:i},n)}setClientFormat(e,t,r){let{formats:n}=this.clientContents;(0,o.forEachCellInRange)(e,(e=>(n=n.setValue(e,t),!0))),this.setClientContents({...this.clientContents,formats:n},r)}getRecalcValues(e){const{row:r,col:i,rows:a,cols:o}=e,s=new Array(a);for(let e=0;e<a;e+=1)s[e]=(0,n.arrayFill)(new Array(o),t.blankGridValue);return this.recalcValues.forEachLe(e,((e,t)=>(s[e.row-r][e.col-i]=t,!0))),s}forEachRecalcValue(e,t){return this.recalcValues.forEachMeets(e,t)}getClientValue(e){return this.clientContents.values.getValue(e)??t.blankGridValue}getServerValue(e){return this.serverContents.values.getValue(e)??t.blankGridValue}getEditedValue(e){return this.editedContents.values.getValue(e)??t.blankGridValue}forEachEditedValue(e,t){return this.editedContents.values.forEachMeets(e,t)}getServerFormula(e){return this.getFormula(e,this.serverContents.formulae)}getClientFormula(e){return this.getFormula(e,this.clientContents.formulae)}setEditedFormat(e,t){this.editedContents={...this.editedContents,formats:this.editedContents.formats.setValue(e,t)}}getEditedFormat(e){return this.editedContents.formats.getValue(e)??t.blankCellFormat}forEachEditedFormat(e,t){return this.editedContents.formats.forEachMeets(e,t)}getServerFormat(e){return this.serverContents.formats.getValue(e)??t.blankCellFormat}getEditedStyle(e){return this.editedContents.styles.getValue(e)??u.SpecialStyle.Blank}getServerStyle(e){return this.serverContents.styles.getValue(e)??u.SpecialStyle.Blank}getClientFormat(e){return this.clientContents.formats.getValue(e)??t.blankCellFormat}getEditedFormula(e){return this.getFormula(e,this.editedContents.formulae)}forEachEditedFormula(e,t){return this.editedContents.formulae.forEachMeets(e,t)}getFormula(e,r){let n;return r.forEachGe(e,((e,r)=>!!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)||(n=[e,r],!1))),n}setContents(e,t,r){e&&(this.serverContents=t),this.editedContents=t,e&&this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=i.empty}unionAvailability(e,t){let r=e?this.serverAvailability:this.editedAvailability;r=(0,a.unionProduct)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r}unionTaint(e,t){this.editedTaint=e?i.empty:(0,a.unionProduct)(this.editedTaint,t),this.recalcTaint=this.editedTaint}unionUsed(e,t){let r=e?this.serverUsed:this.editedUsed;r=b(r,t),e&&(this.serverUsed=r),this.editedUsed=r}setCellContents(e,t,r,n,i,a,o,s,u){this.setCommon(e,t,void 0,r,n,i,a,o,s,u)}setRangeFormula(e,t,r,n,i,a,o,s){const u=(0,l.createCellSetFromRange)(t);this.setCommon(e,u,t,r,n,void 0,i,a,o,s)}setCommon(e,r,n,o,s,c,d,m,g,p){let{values:v,formats:F,styles:b,formulae:C,dirty:k}=e?this.serverContents:this.editedContents;const E=void 0===o&&void 0!==s||void 0!==o?.compiledFmla;let A=o;void 0!==o&&((0,l.forEachRangeInSet)(r,(e=>(C=S(C,e),!0))),(0,t.isBlankGridFormula)(o.fmla,void 0!==o.compiledFmla)&&(A=void 0));const T=void 0!==A&&void 0===n?o:void 0,R=void 0!==A&&void 0!==n?o:void 0;let N=s;void 0!==s&&h(s,c)&&((0,l.forEachRangeInSet)(r,(e=>(v.forEachLe(e,((e,r)=>(h(r.oper,r.failure)||(v=v.setValue(e,t.blankGridValue)),!0))),!0))),k=E?(0,a.unionProduct)(k,r):(0,a.exceptProduct)(k,r),N=void 0);const I=void 0!==N?{oper:N,failure:c}:void 0;let P=d;void 0!==d&&(0,t.isBlankCellFormat)(d)&&((0,l.forEachRangeInSet)(r,(e=>(F.forEachLe(e,((e,r)=>((0,t.isBlankCellFormat)(r)||(F=F.setValue(e,t.blankCellFormat)),!0))),!0))),P=void 0);const O=P===u.SpecialFormat.Weak?void 0:P,M=P===u.SpecialFormat.Weak?P:void 0;let D=m;void 0!==m&&m===u.SpecialStyle.Blank&&((0,l.forEachRangeInSet)(r,(e=>(b.forEachLe(e,((e,t)=>(t!==u.SpecialStyle.Blank&&(b=b.setValue(e,u.SpecialStyle.Blank)),!0))),!0))),D=void 0);const w=D===u.SpecialStyle.Weak?void 0:D,_=D===u.SpecialStyle.Weak?D:void 0;let L=r;if(!e){const e=(0,a.intersectProduct)(r,l.availableSetProduct),t=(0,a.project)((0,a.intersectProduct)(this.editedAvailability,e),"row","col"),n=(0,a.intersectProduct)(r,void 0!==g?(0,l.createCellSetFromRange)(g):i.empty);L=(0,a.unionProduct)(t,n)}if(void 0===T&&void 0===O&&void 0===w&&void 0===I||((0,l.forEachCellInSet)(L,(e=>(void 0!==T&&(C=f(C,e,T)),void 0!==O&&(F=F.setValue(e,O)),void 0!==w&&(b=b.setValue(e,w)),void 0!==I&&(v=v.setValue(e,I)),!0))),void 0===T&&void 0===I||(k=E?(0,a.unionProduct)(k,L):(0,a.exceptProduct)(k,L))),void 0!==R){C=f(C,n,R);const e=(0,l.createCellSetFromRange)(n);k=E?(0,a.unionProduct)(k,e):(0,a.exceptProduct)(k,e)}void 0!==M&&(F=y(F,L,e?this.serverAvailability:this.editedAvailability,u.SpecialFormat.Unavailable)),void 0!==_&&(b=function(e,t,r){const n=(0,a.intersectProduct)(t,l.availableReadProduct),i=(0,a.project)((0,a.intersectProduct)(r,n),"row","col");return(0,l.forEachCellInSet)((0,a.exceptProduct)(t,i),(t=>(e=e.setValue(t,u.SpecialStyle.Unavailable),!0))),e}(b,L,e?this.serverAvailability:this.editedAvailability));const x=void 0===s?i.empty:L,K=void 0===o?i.empty:L,B=void 0===d?i.empty:L,W=void 0===s&&void 0===d?i.empty:L;e||((0,l.forEachRangeInSet)(x,(e=>(this.setClientValue(e,t.clientValueUnknownOper,p),!0))),void 0!==o&&(void 0!==n?this.setClientFormula(n,n,o,p):(0,l.forEachRangeInSet)(K,(e=>(this.setClientFormula(e,void 0,o,p),!0)))),d===u.SpecialFormat.Weak?this.setClientContents({...this.clientContents,formats:y(this.clientContents.formats,B,this.editedAvailability,u.SpecialFormat.ClientValueUnknown)},p):(0,l.forEachRangeInSet)(B,(e=>(this.setClientFormat(e,u.SpecialFormat.ClientValueUnknown,p),!0)))),this.setContents(e,{values:v,formats:F,styles:b,formulae:C,dirty:k},p),this.unionAvailability(e,(0,a.intersectProduct)(x,l.availableAllProduct)),e||(this.editedAvailability=(0,a.exceptProduct)(this.editedAvailability,(0,a.exceptProduct)(r,L))),this.unionTaint(e,W),this.unionUsed(e,(0,l.cellSetBounds)(r))}copyRange(e){function t(t,r){return t.forEachLe(e,((e,t)=>(r=r.setValue(e,t),!0))),r}let{values:r,formats:n,styles:i,formulae:s}=F;const{values:u,formats:c,styles:d,formulae:m}=this.editedContents;r=t(u,r),n=t(c,n),i=t(d,i),m.forEachMeets(e,((t,r)=>(s=s.setValue((0,o.gridRangeIsect)(t,e),r),!0)));const g=(0,o.gridRangeAnchor)(e),p=(0,a.intersectProduct)(this.editedAvailability,(0,l.createCellSetFromRange)(e)),h=C(this.editedUsed,e);return{origin:g,formats:n,styles:i,values:r,formulae:s,availability:p,used:h}}pasteRange(e,r,n){const s=(0,l.createCellSetFromRange)(e),c=(0,o.gridRange)(r.origin.row,r.origin.col,e.rows,e.cols);let{values:g,formats:p,styles:h,formulae:f,dirty:S}=this.editedContents;const y=this.editedUsed,F=e.row-r.origin.row,k=e.col-r.origin.col;function E(e){return(0,o.gridRange)(e.row+F,e.col+k,e.rows,e.cols)}function A(t,r,n){return r.forEachMeets(e,((e,t)=>(r=r.setValue(e,n),!0))),t.forEachLe(c,((e,t)=>(r=r.setValue(E(e),t),!0))),r}const T=b(y,r.used!==t.emptyUsedRange?E(r.used):t.emptyUsedRange),R=C(T,e);g=A(r.values,g,t.blankGridValue),R!==t.emptyUsedRange&&this.setClientValue(R,t.clientValueUnknownOper,n),p=A(r.formats,p,t.blankCellFormat),h=A(r.styles,h,u.SpecialStyle.Blank),R!==t.emptyUsedRange&&this.setClientFormat(R,u.SpecialFormat.ClientValueUnknown,n),f=A(r.formulae,f,t.blankCellGridFormula),S=(0,a.exceptProduct)(S,s);{let{formulae:t}=this.clientContents;t=v(t,e),f.forEachLe(e,((e,{origin:r,compiledFmla:n})=>(void 0!==n&&(S=(0,a.unionProduct)(S,(0,l.createCellSetFromRange)(e))),t=t.setValue(e,{fmla:m.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:d.ClientValueUnknown}),!0))),this.setClientContents({...this.clientContents,formulae:t},n)}const N=!1;var I;this.setContents(N,{values:g,formats:p,styles:h,formulae:f,dirty:S},n),this.editedAvailability=(0,a.exceptProduct)(this.editedAvailability,s),this.unionAvailability(N,(I=r.availability,(0,l.translateAvailabilitySet)(I,F,k))),this.unionTaint(N,R===t.emptyUsedRange?i.empty:(0,l.createCellSetFromRange)(R)),this.unionUsed(N,T)}assumeRecalcFinal(e,t){this.recalcDirty=(0,a.exceptProduct)(this.recalcDirty,e)}getDirtyEditedCells(){return(0,a.intersectProduct)(this.recalcDirty,this.editedTaint)}getNonDirtyEditedCells(){return(0,a.exceptProduct)(this.editedTaint,this.recalcDirty)}getDirtyDependentCells(){return(0,a.exceptProduct)(this.recalcDirty,this.editedTaint)}onCellModified(e,r){const n=e?this.serverContents:this.editedContents;this.setContents(e,n,r),this.unionAvailability(e,i.empty),this.unionTaint(e,i.empty),this.unionUsed(e,t.emptyUsedRange)}clearCompiledFormulas(){for(const e of[this.serverContents.formulae,this.editedContents.formulae])e.forEach(((e,t)=>(void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0)))}getStatistics(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,a.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,a.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,a.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,a.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,a.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,a.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,i.getNodeCount)(this.hiddenRows)+(0,i.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,i.getNodeCount)(this.hiddenCols)+(0,i.getNodeCount)(this.hiddenColsAvailability)}}collectGarbage(e,r){let n=i.empty;for(const t in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(t)){const r=Number(t);if(r>=e){n=(0,a.unionProduct)(n,this.oldAvailabilities[r]);continue}delete this.oldAvailabilities[r],this.availabilityHistorySize-=1}function o(e){return(0,a.meetsProduct)((0,a.intersectProduct)((0,l.createCellSetFromRange)(e),l.availableSetProduct),n)}function s(e,r){return!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)&&o(e)}function c(e,r){return!(0,t.isBlankCellFormat)(r)&&o(e)}function d(e,t){return t!==u.SpecialStyle.Blank&&o(e)}function m(e,t){return!(!p(t.oper)&&h(t.oper,t.failure))&&o(e)}const g=(0,a.project)(n,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(s),formats:this.serverContents.formats.filter(c),styles:this.serverContents.styles.filter(d),values:this.serverContents.values.filter(m),dirty:(0,a.intersectProduct)(this.serverContents.dirty,g)},this.editedContents={formulae:this.editedContents.formulae.filter(s),formats:this.editedContents.formats.filter(c),styles:this.editedContents.styles.filter(d),values:this.editedContents.values.filter(m),dirty:(0,a.intersectProduct)(this.editedContents.dirty,g)},this.setClientContents({formulae:this.clientContents.formulae.filter(s),formats:this.clientContents.formats.filter(c),values:this.clientContents.values.filter(m)},r),this.recalcValues=this.recalcValues.filter(m),this.recalcDirty=(0,a.intersectProduct)(this.recalcDirty,g)}constructor(e=F,r=i.empty,n=t.denseUsedRange,a=i.empty,s=i.empty,u=i.empty,l=i.empty,c=(0,o.makeGridRangeTable)(),d=!1,m=!1){this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=a,this.hiddenRowsAvailability=s,this.hiddenCols=u,this.hiddenColsAvailability=l,this.mergeCells=c,this.inFilterMode=d,this.filterModeAvailable=m,this.rollBackToServerState(0)}}t.PartialWorkbookGrid=E},9204:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutputMessageKind=t.FormulaMode=t.SpecialStyle=t.SpecialFormat=t.SetMessageKind=t.RecalcStatisticsMessage=t.emptyRecalcStatistics=t.ComputedCellKind=t.ComputeKind=t.UnavailableKind=void 0,t.sheetCellSet=p,t.createSheetCellSetFromRange=function(e){return p(e.sheet,(0,i.createCellSetFromRange)(e.range))},t.sheetUsedRange=function(e,t){return{sheet:e,range:t}},t.sheetHiddenRows=function(e,t,r){return{sheet:e,range:t,hidden:r}},t.sheetInFilterMode=function(e,t){return{sheet:e,inFilterMode:t}},t.mergeRecalcStatistics=function(e,t){switch(t.message){case u.ChangedCell:return{...e,changedCellCount:h(e.changedCellCount,t.cellKind),calculatedCellCount:h(e.calculatedCellCount,t.cellKind)};case u.UnchangedCell:return{...e,calculatedCellCount:h(e.calculatedCellCount,t.cellKind)};case u.ContinueComputation:return{...e,continueCount:e.continueCount+1};case u.StateTimedOut:return{...e,stateTimedOut:!0};case u.EditFinished:return{...e,editFinishedCount:e.editFinishedCount+1};case u.RecalcFinished:return{...e,recalcFinishedCount:e.recalcFinishedCount+1};default:return(0,n.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}},t.isOutputFormatUnavailable=function(e){return"object"==typeof e};const n=r(6913),i=r(8453);var a,o,s,u,l,c,d,m,g;function p(e,t){return{sheet:e,set:t}}function h(e,t){return{...e,[t]:(e[t]??0)+1}}!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(a||(t.UnavailableKind=a={})),function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(o||(t.ComputeKind=o={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(s||(t.ComputedCellKind=s={})),t.emptyRecalcStatistics={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0},function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(u||(t.RecalcStatisticsMessage=u={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(l||(t.SetMessageKind=l={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(c||(t.SpecialFormat=c={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(d||(t.SpecialStyle=d={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(m||(t.FormulaMode=m={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(g||(t.OutputMessageKind=g={}))},3512:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNameManager=void 0;const n=r(6913),i=r(6592),a=r(9204),o=r(7214);class s{clone(){let e;if(this.sheetScopedNames){e=(0,n.makeStringMap)();for(const t in this.sheetScopedNames){const r=this.sheetScopedNames[t];e[t]=r.clone()}}return new s(this.document,this.stringCompareCI,e,void 0,this.globalNames.clone())}setNamedObject(e,t,r,a){const s=this.getNameFormula(t,i.NameSource.StructRef);void 0!==r&&"NamedTable"===r.kind&&(0,n.isSuccess)(s)&&void 0!==s.value&&"NamedTable"===s.value.obj.kind&&(0,o.isNamedTableRangeEqual)(s.value.obj,r)&&(r=(0,o.mergeNamedTables)(s.value.obj,r));const u=this.getNamesBySheetId(t.scope.index);return u.kind===n.ResultKind.Failure?u:u.value.setNamedObject(e,t,r,a,this.onWriteNamedObject)}setUndefinedNames(e){const t=this.getNamesBySheetId(e.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.setUndefinedNames())}promoteNamedObjects(e,t){const r=this.getNamesBySheetId(e.index);return r.kind===n.ResultKind.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)}setSheetNames(e){const t=this.sheetScopedNames??this.oldSheetScopedNames,r=(0,n.makeStringMap)();for(const{sheetId:n}of e)r[n]=t?.[n]??new o.PartialWorkbookNames(this.stringCompareCI,(0,i.sheetIndex)(this.document,n));return new s(this.document,this.stringCompareCI,r,void 0,this.globalNames)}getNameLoc(e,t,r){const i=this.getNamesBySheetId(e);if(i.kind===n.ResultKind.Failure)return i;const a=i.value.getNameLoc(t,r);return a.kind,n.ResultKind.Failure,a}getAvailableNamesInScope(e){const t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===n.ResultKind.Success&&(0,n.safePush)(t,r.value.getAvailableNames((0,i.nameScope)(this.document,e))),t}getAllDocumentNames(){return this.globalNames.getAvailableNames((0,i.documentScope)(this.document))}getAvailableTableColumns(e){const t=this.getNameFormula(e,i.NameSource.StructRef),r=[];if(t.kind!==n.ResultKind.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind)return{cols:r,isPartial:!0};const a=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach((e=>(r.push(e),!0))),{cols:r,isPartial:a}}getNameFormula(e,t){const r=this.getNamesBySheetId(e.scope.index);return r.kind===n.ResultKind.Failure?r:r.value.getNameFormula(e.name,t)}hasRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.hasRecalcFailure(e.name))}setRecalcNameFailure(e){const t=this.getNamesBySheetId(e.scope.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.setRecalcFailure(e.name))}getNamesBySheetId(e){if(void 0===e)return(0,n.success)(this.globalNames);if(!this.sheetScopedNames)return(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.SheetNames}]));const t=this.sheetScopedNames[e];return void 0===t?(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,n.success)(t)}getContainingTable(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getContainingTable(e.range))}getNamedRanges(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getNamedRanges(e.range))}getIntersectingTables(e){const t=this.getNamesBySheetId(e.sheet.index);return t.kind===n.ResultKind.Failure?t:(0,n.success)(t.value.getIntersectingTables(e.range))}getStructRefColumn(e,t){const r=this.getNameFormula(e,i.NameSource.StructRef);if(r.kind===n.ResultKind.Failure)return r;if(void 0===r.value)return(0,n.success)(void 0);if("NamedTable"!==r.value.obj.kind)return(0,n.failure)((0,i.invalidStructRef)(i.InvalidStructRefReason.NamedObjectNotTable));const o=r.value.obj;let s;if("string"==typeof t)s=o.columnNames.getEntry(t);else{const e=o.columnIndexes.getValue(t);s=void 0===e?void 0:(0,n.entry)(e,t)}if(void 0===s)return o.allColumnNamesAvailable?(0,n.success)(void 0):(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.ColumnName,table:e,columnNameOrIndex:t}]));const{sheet:u,range:l}=o.specialRefRanges[i.SpecialRefId.Data],c=(0,i.sheetGridRange)(u,(0,i.gridRange)(l.row,s.value,l.rows,1));return(0,n.success)((0,i.structRefColumnLoc)(s.key,c,o.hasHeadersRow,o.hasTotalsRow))}getStructRefSpecialRef(e,t){const r=this.getNameFormula(e,i.NameSource.StructRef);return r.kind===n.ResultKind.Failure?r:void 0===r.value?(0,n.success)(void 0):"NamedTable"!==r.value.obj.kind?(0,n.failure)((0,i.invalidStructRef)(i.InvalidStructRefReason.NamedObjectNotTable)):(0,n.success)(r.value.obj.specialRefRanges[t])}onCellModified(e){this.forEachSheetScope((t=>{t.onCellModified(e)})),this.globalNames.onCellModified(e)}collectGarbage(e){this.forEachSheetScope((t=>{t.collectGarbage(e)})),this.globalNames.collectGarbage(e)}advanceState(e){this.forEachSheetScope((t=>{t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0}resetLazyData(){this.forEachSheetScope((e=>{e.resetLazyData()})),this.globalNames.resetLazyData()}getNameStatistics(){let e=this.globalNames.getStatistics();return this.forEachSheetScope((t=>e=(0,o.mergeNameStatistics)(e,t.getStatistics()))),e}forEachSheetScope(e){for(const t in this.sheetScopedNames)Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t)&&e(this.sheetScopedNames[t])}constructor(e,t,r,a,s){this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=a,this.onWriteNamedObject=(e,t,r)=>{if("NamedRange"===t.kind){const a=t.value;(0,n.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,i.isDocumentLocEqual)(t.value.sheets.document,e.scope.document));const o=this.getNamesBySheetId(a.sheets.index);if(o.kind===n.ResultKind.Failure)return o;o.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){const a=this.getNamesBySheetId(t.specialRefRanges[i.SpecialRefId.All].sheet.index);if(a.kind===n.ResultKind.Failure)return a;a.value.onWriteNamedTable(e,t,r)}return n.successUndefined},this.globalNames=s??new o.PartialWorkbookNames(t,(0,i.documentScope)(e))}}t.PartialWorkbookNameManager=s},7214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNames=t.emptyNameStatistics=t.namedFailure=t.namedFormula=t.namedRange=t.namedValue=void 0,t.namedTable=function(e,t,r,a,o){const{sheet:u,range:l}=e,c=t?(0,i.gridRange)(l.row-1,l.col,1,l.cols):void 0,d=r?(0,i.gridRange)(l.row+l.rows,l.col,1,l.cols):void 0,m=(0,i.gridRangeJoinOpt)((0,i.gridRangeJoinOpt)(c,e.range),d),g=a.reduce(((t,r)=>((0,n.assertTrue)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name))),s);let p=n.RedBlackMapTree.create(o);g.forEach(((e,t)=>(p=p.setValue(t,e),!0)));const h=g.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:{[i.SpecialRefId.Data]:e,[i.SpecialRefId.Headers]:c?(0,i.sheetGridRange)(u,c):void 0,[i.SpecialRefId.Totals]:d?(0,i.sheetGridRange)(u,d):void 0,[i.SpecialRefId.All]:(0,i.sheetGridRange)(u,m)},columnNames:p,columnIndexes:g,allColumnNamesAvailable:h,hasHeadersRow:t,hasTotalsRow:r}},t.mergeNamedTables=function(e,t){let r=e.columnNames,n=e.columnIndexes;t.columnIndexes.forEach(((t,n)=>{const i=e.columnIndexes.getValue(t);return void 0!==i&&(r=r.remove(i)),!0})),t.columnIndexes.forEach(((e,t)=>(r=r.setValue(t,e),n=n.setValue(e,t),!0)));const a=n.getCount()===t.specialRefRanges[i.SpecialRefId.All].range.cols;return{...t,columnNames:r,columnIndexes:n,allColumnNamesAvailable:a}},t.mergeNameStatistics=function(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}},t.isNamedTableRangeEqual=function(e,t){return(0,i.isSheetGridRangeEqual)(e.specialRefRanges[i.SpecialRefId.Data],t.specialRefRanges[i.SpecialRefId.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow};const n=r(6913),i=r(6592),a=r(9204),o=r(4352);t.namedValue=(0,n.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedRange=(0,n.typedInstanceCreator)()((e=>({kind:"NamedRange",value:e})));const s=n.RedBlackMapTree.create(((e,t)=>e-t));t.namedFormula=(0,n.typedInstanceCreator)()((e=>({kind:"NamedFormula",fmla:e}))),t.namedFailure=(0,n.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t})));const u=(0,i.makeGridRangeTable)(),l=(0,i.makeGridRangeTable)();t.emptyNameStatistics={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};class c{static create(e){return new c(n.RedBlackMapTree.create(e),!1,u,l)}update(e,t,r,n){return e!==this.names||t!==this.allAvailable||r!==this.tables||n!==this.ranges?new c(e,t,r,n):this}getEntry(e,t,r){const o=this.names.getEntry(t);return void 0===o?this.allAvailable?(0,n.success)(void 0):(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.NameLoc,name:(0,i.nameLoc)(e,t),source:r}])):(0,n.success)(!1!==o.value?o:void 0)}getEntryIfDefined(e){const t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0}setValue(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)}remove(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)}getContainingTable(e){let t;return this.tables.forEachGe(e,((e,r)=>(t=r,!1))),t}getIntersectingTables(e){const t=[];return this.tables.forEachMeets(e,((e,r)=>(t.push(r),!0))),t}getNamedRanges(e){return this.ranges.getValue(e)??[]}getAvailableNames(e){const t=[];return this.names.forEach(((r,n)=>(!1!==n&&t.push((0,i.nameLoc)(e,r)),!0))),t}forEachAvailableName(e){return this.names.forEach(((t,r)=>e(t,!1===r?void 0:r)))}setUndefined(){return this.update(this.names,!0,this.tables,this.ranges)}getStatistics(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}}collectGarbage(){return this.update(this.allAvailable?this.names.filter(((e,t)=>!1!==t)):this.names,this.allAvailable,this.tables,this.ranges)}resetLazyData(){this.names.forEach(((e,t)=>(!1!==t&&t.lazyData.reset(),!0)))}onWriteNamedTable(e,t,r){const n=t.specialRefRanges[i.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)}onWriteNamedRange(e,t,r){const n=t.value.ranges[0],a=this.ranges.getValue(n)??[],o="remove"===r?a.filter((t=>(0,i.isNameScopeEqual)(e.scope,t.scope)&&e.name===t.name)):[...a,e];return this.update(this.names,this.allAvailable,this.tables,0===o.length?this.ranges.remove(n):this.ranges.setValue(n,o))}constructor(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}}class d{clone(){const e=new d(this.stringCompareCI,this.scope);return e.contents=this.contents,e}advanceState(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures}getStatistics(){return this.contents.getStatistics(this.recalcFailures.getCount())}collectGarbage(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()}getNameLoc(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,n.isSuccess)(r)?(0,n.success)(void 0!==r.value?(0,i.nameLoc)(this.scope,r.value.key):void 0):r}getNameFormula(e,t){const r=this.contents.getEntry(this.scope,e,t);return(0,n.isSuccess)(r)?(0,n.success)(void 0!==r.value?r.value.value:void 0):r}getContainingTable(e){return this.contents.getContainingTable(e)}getIntersectingTables(e){return this.contents.getIntersectingTables(e)}getNamedRanges(e){return this.contents.getNamedRanges(e)}allAvailable(){return this.contents.allAvailable}getAvailableNames(e){return this.contents.getAvailableNames(e)}hasRecalcFailure(e){return this.recalcFailures.contains(e)}setRecalcFailure(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)}onCellModified(e){this.recalcFailures=this.emptyRecalcFailures}resetLazyData(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()}setNamedObject(e,t,r,a,s){const u=this.contents.getEntryIfDefined(t.name);if(void 0!==u){const e=s((0,i.nameLoc)(this.scope,u.key),u.value.obj,"remove");if(e.kind===n.ResultKind.Failure)return e}if(this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new o.ResettableLazy((()=>a(e,t,r)))}),this.isCurrent=this.isChanged=!0,void 0!==r){const e=s(t,r,"add");if(e.kind===n.ResultKind.Failure)return e}return n.successUndefined}setUndefinedNames(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0}promoteNamedObjects(e,t){if(this.isChanged||e!==this.oldStateId)return(0,n.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;let r=(0,n.success)(!0);return this.contents.forEachAvailableName(((e,a)=>{if(void 0===a)return!0;const o=t((0,i.nameLoc)(this.scope,e),a.obj,"add");return o.kind===n.ResultKind.Success||(r=o,!1)})),r}onWriteNamedTable(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)}onWriteNamedRange(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)}forEachAvailableName(e){return this.contents.forEachAvailableName(e)}constructor(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=c.create(e),this.emptyRecalcFailures=this.recalcFailures=n.ArrayMapTree.create(e)}}t.PartialWorkbookNames=d},8453:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.availableAllProduct=t.availableReadProduct=t.availableSetProduct=t.bspFactory=t.availabilityOperations=t.anyAvailability=t.AvailabilityKind=void 0,t.createCellSetFromRange=function(e){return(0,o.createFromProduct)({row:t.bspFactory.row([e.row,e.row+e.rows]),col:t.bspFactory.col([e.col,e.col+e.cols])})},t.cellSetBounds=function(e){if(e===i.empty)return;const t=e===i.dense?void 0:e.root.bounds.row,r=e===i.dense?void 0:e.root.bounds.col,[a,o]=void 0===t?g.row.top:function(e){const t=[];return p(e,(e=>(t.push(e),!0))),t.reduce(n.ivlJoin)}((0,i.fromUntyped)(g.row,t)),[u,l]=void 0===r?g.col.top:function(e){const t=[];return h(e,(e=>(t.push(e),!0))),t.reduce(n.ivlJoin)}((0,i.fromUntyped)(g.col,r));return(0,s.gridRange)(a,u,o-a,l-u)},t.forEachRow=p,t.forEachCol=h,t.forEachRangeInSet=f,t.forEachCellInSet=function(e,t){return f(e,(e=>(0,s.forEachCellInRange)(e,t)))},t.translateAvailabilitySet=function(e,r,n){let a=i.empty;return(0,o.forEachProduct)(e,(e=>{let s=i.empty;p(e.row,(([e,n])=>(s=(0,i.union)(s,t.bspFactory.row([e+r,n+r])),!0)));let u=i.empty;h(e.col,(([e,r])=>(u=(0,i.union)(u,t.bspFactory.col([e+n,r+n])),!0)));const l=(0,o.createFromProduct)({row:s,col:u,availability:e.availability});return a=(0,o.unionProduct)(a,l),!0}),"row","col","availability"),a};const n=r(6913),i=r(9668),a=r(9556),o=r(9610),s=r(6592);var u;!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(u||(t.AvailabilityKind=u={})),t.anyAvailability=[u.AvailableSet,u.AvailableRead+1];const l=[0,s.sheetRows],c=[0,s.sheetCols];t.availabilityOperations=(0,a.boundedParetoSetOperations)(1,t.anyAvailability[0]+1,t.anyAvailability[1],t.anyAvailability,"Availability operations, alpha = 1");const d=(0,a.boundedParetoSetOperations)(.2,l[0]+1,l[1],l,"Row operations, alpha = 0.2"),m=(0,a.boundedParetoSetOperations)(.35,c[0]+1,c[1],c,"Col operations, alpha = 0.35"),g={availability:t.availabilityOperations,row:d,col:m};function p(e,t){return e!==i.dense?(0,i.forEachKey)(e,t):t(g.row.top)}function h(e,t){return e!==i.dense?(0,i.forEachKey)(e,t):t(g.col.top)}function f(e,t){return(0,o.forEachProduct)(e,(e=>p(e.row,(r=>{const[n,i]=r;return h(e.col,(e=>{const[r,a]=e;return t((0,s.gridRange)(n,r,i-n,a-r))}))}))),"row","col")}t.bspFactory={availability:(0,i.createFromKey)(g.availability),row:(0,i.createFromKey)(g.row),col:(0,i.createFromKey)(g.col)},t.availableSetProduct=(0,o.createFromProduct)({availability:t.bspFactory.availability([u.AvailableSet,u.AvailableSet+1])}),t.availableReadProduct=(0,o.createFromProduct)({availability:t.bspFactory.availability([u.AvailableRead,u.AvailableRead+1])}),t.availableAllProduct=(0,o.createFromProduct)({availability:t.bspFactory.availability([u.AvailableSet,u.AvailableRead+1])})},4592:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookSheets=void 0;const n=r(6913),i=r(6592),a=r(9204);class o{clone(){return new o(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)}setSheetNames(e){const t=this.data??this.oldData,r=(0,n.makeStringMap)(),a=[],s=[];for(let n=0;n<e.length;n+=1){const{sheetName:o,sheetId:u}=e[n];a[n]=u,s.push([o,u]);const l=t?.[u];if(void 0===l){const e=(0,i.sheetIndex)(this.document,u);r[u]={pos:n,name:o,sheetIndex:e}}else r[u]={...l,pos:n,name:o}}const u=n.ArrayMapTree.create(this.stringCompareCI).setValues(s);return new o(this.document,this.stringCompareCI,a,u,r,void 0)}advanceState(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0}getSheetRangeIds(e){let t,r;if(!this.sheetPosToId)return(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{const i=this.getSheetById(e.index);if(!(0,n.isSuccess)(i))return i;const a=this.getSheetById(e.index2);if(!(0,n.isSuccess)(a))return a;t=(0,n.fastMin)(i.value.pos,a.value.pos),r=(0,n.fastMax)(i.value.pos,a.value.pos)+1}const o=[];for(let e=t;e<r;e+=1)o.push(this.sheetPosToId[e]);return(0,n.success)((0,i.sheetRangeIndexes)(o,t))}getSheetById(e){if(!this.data)return(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.SheetNames}]));const t=this.data[e];return void 0===t?(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,n.success)(t)}getSheetByName(e){if(!this.sheetNameToId)return(0,n.failure)((0,i.unavailable)([{kind:a.UnavailableKind.SheetNames}]));const t=this.sheetNameToId.getValue(e);return void 0===t?(0,n.success)(void 0):this.getSheetById(t)}forEachSheet(e){if(this.sheetPosToId&&this.data)for(const t of this.sheetPosToId){const r=this.data[t];r&&e(r,t)}}constructor(e,t,r,n,i,a){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=i,this.oldData=a}}t.PartialWorkbookSheets=o},362:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookStyles=t.blankStyleValue=void 0;const n=r(6913),i=r(6592),a=r(9204),o={type:i.BorderLineType.None,color:{argb:"00000000"}};t.blankStyleValue={font:{name:"Calibri",bold:!1,italic:!1,underline:i.FontUnderline.None,strikethrough:!1,verticalAlign:i.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:i.FillKind.Pattern,pattern:i.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:o,bottom:o,left:o,right:o},alignment:{horizontal:i.HorizontalAlignment.Automatic,vertical:i.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};class s{clone(){function e(e,t){Object.keys(e).map(Number).forEach((r=>{t[r]=e[r]}))}const t=new s;return e(this.styles,t.styles),e(this.fonts,t.fonts),e(this.fills,t.fills),e(this.borders,t.borders),t}resolveCellStyle(e){if(e===a.SpecialStyle.Blank)return(0,n.success)(t.blankStyleValue);const r=this.styles[e];if(void 0===r)return(0,n.failure)({kind:a.UnavailableKind.StyleId,styleId:e});const{fontId:i,fillId:o,borderId:s,alignment:u}=r,l=void 0!==i?this.fonts[i]:t.blankStyleValue.font;if(void 0===l)return(0,n.failure)({kind:a.UnavailableKind.FontId,fontId:i});const c=void 0!==o?this.fills[o]:t.blankStyleValue.fill;if(void 0===c)return(0,n.failure)({kind:a.UnavailableKind.FillId,fillId:o});const d=void 0!==s?this.borders[s]:t.blankStyleValue.border;return void 0===d?(0,n.failure)({kind:a.UnavailableKind.BorderId,borderId:s}):(0,n.success)({font:l,fill:c,border:d,alignment:u})}setStyles(e,t){t||(this.styles=[]),Object.keys(e).map(Number).forEach((t=>{this.styles[t]=e[t]}))}setFonts(e,t){t||(this.fonts=[]),Object.keys(e).map(Number).forEach((t=>{this.fonts[t]=e[t]}))}setFills(e,t){t||(this.fills=[]),Object.keys(e).map(Number).forEach((t=>{this.fills[t]=e[t]}))}setBorders(e,t){t||(this.borders=[]),Object.keys(e).map(Number).forEach((t=>{this.borders[t]=e[t]}))}constructor(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}}t.PartialWorkbookStyles=s},1836:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityScheduler=t.QueuePos=void 0;const n=r(6913);var i;!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(i||(t.QueuePos=i={})),t.PriorityScheduler=class{deleteTasks(e,t){const r=this.taskDeqs[e];if(!r)return;let n;for(;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)}addTask(e,t,r){const a=this.taskDeqs[e]??(this.taskDeqs[e]=new n.Deque);t===i.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)}runTask(){for(let e=this.minPriority;e<this.taskDeqs.length;e+=1){this.minPriority=e;const t=this.taskDeqs[e]?.popFront();if(t)return"function"==typeof t?t():t.onRun(),!0}return!1}getCount(e){return void 0!==e?this.taskDeqs[e]?.getCount()??0:this.taskDeqs.reduce(((e,t)=>t?e+t.getCount():e),0)}constructor(){this.minPriority=0,this.taskDeqs=[]}}},6766:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recalcServiceInsideInit=t.RecalcServiceImpl=void 0;const n=r(6533),i=r(6913),a=r(9668),o=r(9610),s=r(6592),u=r(1475),l=r(5033),c=n.__importStar(r(7882)),d=r(3313),m=r(3214),g=r(3804),p=r(6824),h=r(9204),f=r(8453),S=r(8328),v=r(7755),y=r(3340),F=r(721),b=r(438),C=r(4579),k=r(4352);class E{setOutputStateId(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)}pushCellWrite(e,t){(e!==h.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)}pushRangeWrite(e,t){(0,i.safePush)(e!==h.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)}pushRangeFailure(e,t){(e!==h.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)}pushUpdateRequest(e){this.rangeUpdateRequests.push(e)}pushUpdateNameRequest(e){this.namesUpdateRequests.push(e.index)}pushRecalcFinished(e){this.recalcFinished=this.recalcFinished||e}isRecalcFinished(){return this.recalcFinished}flush(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,F.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,F.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)}sendRecalcResults(e,t,r,n){for(let a=0;a<(0,i.fastMax)((0,i.fastMax)(t.length,r.length),n.length);a+=10)this.onRecalcResults((0,F.recalcResults)(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))}constructor(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}}function A({kind:e}){return{kind:e}}class T{get document(){return this.dataTransformer.document}get mathpack(){return this.dataTransformer.getLangConfig().mathpack}ping(){}setInputStateId(e,t){const r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)}setOutputStateId(e){const t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)}clearAsyncResumeRecalc(){void 0!==this.recalcLoop&&this.recalcLoop.stop()}resumeRecalc(){this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFunction((()=>{const{messages:e,queueEmpty:t}=this.dataModel.step();return e.length>0&&this.processRecalcResults(e),t?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});const e=this.recalcLoop;return(0,i.promiseFinally)(this.recalcLoop.promise,(()=>{this.recalcLoop===e&&(this.recalcLoop=void 0)}))}async testResumeRecalc(e){if(await this.resumeRecalc(),void 0!==e){const t=`calc.calc.RecalcService: resumeRecalc finished; resumeId = ${e}`;i.ulsLogger.ULS.traceTag(574128980,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}}processRecalcResults(e){const t=new E(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId);for(const r of e)if(r.kind!==h.OutputMessageKind.GarbageCollected)if(r.kind!==h.OutputMessageKind.Alert)if(r.kind!==h.OutputMessageKind.ExperimentRunResult){if(this.setOutputStateId(r.stateId))switch(t.setOutputStateId(r.stateId),r.kind){case h.OutputMessageKind.CellWrite:{const{cell:e,value:n,format:a,cellKind:o,formulaBarText:s,formatted:u,hasHyperlink:l}=r,{sheet:c,range:d}=e,m=this.cellWriteToRangeDelta(c.index,d.row,d.col,n,a,s,u,l,"messages.<index>.value");(0,i.isDefined)(m)&&t.pushCellWrite(o,m);break}case h.OutputMessageKind.RangeWrite:{const{range:e,values:n,cellKind:i,formulaBarText:a,formatted:o,formats:s}=r,{sheet:u,range:l}=e;t.pushRangeWrite(i,this.rangeWriteToRangeDeltas(u.index,l,n,s,a,o,"messages.<index>.values"));break}case h.OutputMessageKind.NameFailure:this.nameFailures.push(r);break;case h.OutputMessageKind.RangeFailure:{const{range:e,cellKind:n,reason:i}=r;t.pushRangeFailure(n,this.rangeFailure(e,i)),this.rangeFailures.push(r);break}case h.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(r);break;case h.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(r);break;case h.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(r);break;case h.OutputMessageKind.FormatValueFailure:{const{range:e,cellKind:n,reason:i}=r;t.pushRangeFailure(n,this.rangeFailure(e,i)),this.formatValueFailures.push(r);break}case h.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(r);break;case h.OutputMessageKind.UpdateRequest:t.pushUpdateRequest((0,d.sheetGridRangeToLocation)(r.range));break;case h.OutputMessageKind.UpdateNamesRequest:t.pushUpdateNameRequest(r.scope);break;case h.OutputMessageKind.RecalcStatistics:t.pushRecalcFinished(r.message===h.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,h.mergeRecalcStatistics)(this.recalcStatistics,r);break;case h.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(r.stateId,r.stats,r.p);break;case h.OutputMessageKind.StateAdvanced:break;default:return(0,i.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",r)}}else this.logExperimentRunResult(r.experimentName,JSON.stringify({message:r.logMessage,timeoutReason:r.timeoutReason}));else this.onAlert(r.message);else this.onGC(r.minStateIdKept);t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()}logExperimentRunResult(e,t){i.ulsLogger.ULS.traceTag(594409422,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,`calc.calc.RecalcService: ${e} done; ${t}`),"UnitExperiment"===e&&i.ulsLogger.ULS.traceTag(538567681,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,`calc.calc.RecalcService: UnitExperiment done: ${t}`)}logAllFailureStats(){const e=this.nameFailures;this.nameFailures=[];const t=this.rangeFailures;this.rangeFailures=[];const r=this.numberFormatFailures;this.numberFormatFailures=[];const n=this.printFormulaFailures;this.printFormulaFailures=[];const i=this.inferFormatFailures;this.inferFormatFailures=[];const a=this.formatValueFailures;this.formatValueFailures=[];const o=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",l.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",l.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",l.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",l.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",l.TraceLevel.Info),this.logCellFailureStats(a,590484948,"format-value",l.TraceLevel.Info),this.logGenFailureStats(o,595194338,"unhandled",l.TraceLevel.Warning)}logGenFailureStats(e,t,r,n){if(0===e.length)return;const a={};for(const{reason:t}of e)(0,v.incrementFailure)(a,t);const o=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(a)}`;i.ulsLogger.ULS.traceTag(t,l.LogCategory.msoulscat_ES_EWAJS,n,o),this.logJavaScriptFailures(e,r)}logCellFailureStats(e,t,r,n){if(0===e.length)return;const a={};for(const{reason:t,cellKind:r}of e){const e=a[r]??(a[r]={});(0,v.incrementFailure)(e,t)}Object.getOwnPropertyNames(a).sort().forEach((e=>{const o=a[e],s=`calc.calc.RecalcService: recalc ${r} failures; stateId = ${this.currentOutputStateId}, cell kind = ${e}, stats = ${JSON.stringify(o)}`;i.ulsLogger.ULS.traceTag(t,l.LogCategory.msoulscat_ES_EWAJS,n,s)})),this.logJavaScriptFailures(e,r)}logJavaScriptFailures(e,t){for(const{reason:r}of e)if(r.kind===u.ReasonKind.JavaScriptError){const e=`calc.calc.RecalcService: recalc ${t} JavaScript error: ${(0,i.messageFromError)(r.error)}`;i.ulsLogger.ULS.traceTag(595658721,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,e)}}logIgnoredStats(e,t,r,n){if(0===Object.getOwnPropertyNames(n).length)return;const a=`calc.calc.RecalcService: ignored ${r} data; stateId = ${t}, stats = ${JSON.stringify(n)}`;i.ulsLogger.ULS.traceTag(e,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,a)}logIgnoredInputStats(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}}logIgnoredOutputStats(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}}logRecalcStats(){if(this.currentOutputStateId===-1/0)return;if(this.lastRecalcStatsStateId===this.currentOutputStateId&&this.recalcStatistics===h.emptyRecalcStatistics)return;const e=this.recalcStatistics;this.recalcStatistics=h.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;const t=this.config.sampleRecalcStatisticsRate;if(!this.dataModel.shouldSample(t))return;const r=`calc.calc.RecalcService: recalc statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}, p = ${JSON.stringify(t)}`;i.ulsLogger.ULS.traceTag(595654593,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,r)}logUnavailableStats(){if(this.currentOutputStateId===-1/0)return;if(0===this.rangeFailures.length)return;const e=(0,C.computeUnavailableCellsStats)(this.rangeFailures);if(0===e.numOfUnavailableCellsInTheSameSheet&&0===e.numOfUnavailableCellsInDifferentSheet&&0===e.totalNumOfUnavailableCells)return;const t=`calc.calc.RecalcService: unavailable cells statistics; stateId = ${this.currentOutputStateId}, stats = ${JSON.stringify(e)}`;i.ulsLogger.ULS.traceTag(589632004,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}logWorkbookStats(e,t,r){const n=`calc.calc.RecalcService: workbook statistics; stateId = ${e}, stats = ${JSON.stringify(t)}, p = ${JSON.stringify(r)}`;i.ulsLogger.ULS.traceTag(595359882,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,n)}logInputStateIdDecrease(e){(0,S.incrementStat)(this.ignoredInputStats,`${e}: input stateId went backwards`)}logOutputStateIdDecrease(){(0,S.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")}flushInputLogs(){this.logIgnoredInputStats()}flushOutputLogs(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()}cellWriteToRangeDelta(e,t,r,n,a,o,s,u,l){if(!(0,S.check)(n,S.chReadOper,this.ignoredOutputStats,l))return;const c=(0,d.readOperToCellValue)(this.mathpack,n),m=(0,d.cellFormatToInferredFormat)(a);return(0,i.isDefined)(o)||(0,i.isDefined)(c)||(0,i.isDefined)(m)||(0,i.isDefined)(s)||(0,i.isDefined)(u)?(0,F.rangeDelta)((0,F.sheetRangeLocation)(e,t,r),(0,F.cellDataDelta)(o,c,m,s,u)):void 0}rangeWriteToRangeDeltas(e,t,r,n,a,o,s){const u=`${s}.<index>.<index>`,{row:l,col:c,rows:d,cols:m}=t,g=[];for(let t=0;t<d;t+=1)for(let s=0;s<m;s+=1){const d=this.cellWriteToRangeDelta(e,l+t,c+s,r[t][s],n[t][s],0===t&&0===s?a:void 0,o[t][s],void 0,u);(0,i.isDefined)(d)&&g.push(d)}return g}rangeFailure(e,t){return(0,F.rangeFailure)((0,d.sheetGridRangeToLocation)(e),A(t))}setA1ReferenceStyle(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)}setLocale(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setWorkbookProps(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)}setNumberFormats(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,S.filterCheck)(e,S.chNumberFormat,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)}updateSheetNames(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))}updateNamedObjects(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))}updateUnusedCells(e,t){if(!this.setInputStateId(e,"unusedCellsUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,S.filterCheck)(t,S.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates");for(const t of r)this.dataModel.extendUnusedRange((0,d.unusedCellsUpdateToUsedRange)(this.document,t),e)}updateRanges(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))}updateArrays(e,t){if(!this.setInputStateId(e,"arrayUpdates"))return;this.clearAsyncResumeRecalc();const r=(0,S.filterCheck)(t,S.chArrayUpdate,this.ignoredInputStats,"arrayUpdates");for(const t of r){const{range:r,data:n,fromStateId:a}=t,o=(0,d.sheetRangeLocationToGridRange)(this.document,r);if((0,i.isDefined)(n)){const{formulaBarText:t,isSpilled:r}=n,i=(0,s.gridRangeAnchor)(o.range);this.dataModel.writeArrayFormula(e,o,t,i,r)}else(0,i.isDefined)(a)}}editRangeFormulas(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))}evalOnClonedModel(e,t,r){return this.evalOnClonedModelOnSnapshot(e,t,void 0,r)}evalOnClonedModelOnSnapshot(e,t,r=void 0,n){(0,i.assertPositiveInteger)("edits array should not be empty",t.length);const a=void 0===r?new g.EvalOnClonePropsFromPartialWB(this.dataModel,n):new g.EvalOnClonePropsFromPartialWBDocumentCollection(r,n);return this.applyRangeUpdates(-1,e,a),this.applyRangeFormulaEdits(t,-1,a),a.resultsPromise.toPromise()}applyRangeUpdates(e,t,r){const n=(0,S.filterCheck)(t,S.chRangeUpdate,this.ignoredInputStats,"rangeUpdates");for(const t of n){const{range:n,excludeRows:a,excludeColumns:o,data:u,fromStateId:l}=t,c=(0,d.sheetRangeLocationToGridRange)(this.document,n),m=c.range,g=(0,d.createExcludeCellSet)(m.row,m.rows,f.bspFactory.row,a),S=(0,d.createExcludeCellSet)(m.col,m.cols,f.bspFactory.col,o),v=(0,d.sheetGridRangeToCellSet)(c,g,S),y=(0,i.isDefined)(u)?(0,d.cellValueToReadOper)(this.mathpack,u.value):s.blankOper;(0,i.assertTrue)("calc.calc.RecalcService: updateRanges oper",null!=y);const F=(0,s.gridRangeAnchor)(m);if((0,i.isDefined)(u)){const t=u.iformat,n="ArrayFormula"===u.kind?void 0:u.formulaBarText??void 0,i=u.failureReason??void 0,a="CellFormula"===u.kind;this.dataModel.writeCellContents(e,v,n,a,F,y,t,h.SpecialStyle.Blank,i,r)}else if((0,i.isNone)(l))this.dataModel.writeCellContents(e,v,"",!1,F,s.blankOper,p.blankCellFormat,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,c,v,l)}r||(this.dataModel.writeHiddenRows(e,(0,d.sheetGridRangeToHiddenRows)(c,g)),this.dataModel.writeHiddenCols(e,(0,d.sheetGridRangeToHiddenCols)(c,S)))}}localizeEnglishFormula(e,t){const r=this.dataModel.translateEnglishFormula(e,(0,d.sheetCellLocationToGridCell)(this.document,t));return Promise.resolve(r)}applyRangeFormulaEdits(e,t,r){const n=(0,S.filterCheck)(e,S.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits");for(const e of n){const{kind:n,range:u,formulaBarText:l,value:c,origin:m,viewport:g}=e;let p=a.empty;u.forEach((e=>{p=(0,o.unionProduct)(p,(0,f.createCellSetFromRange)((0,d.sheetRangeLocationToGridRange)(this.document,e).range))}));const S=(0,d.sheetRangeLocationToGridRange)(this.document,u[0]),v=(0,i.isDefined)(m)?(0,s.gridCell)(m.row,m.column):(0,s.gridRangeAnchor)(S.range),y=(0,i.isDefined)(g)?(0,d.sheetRangeLocationToGridRange)(this.document,g):void 0;let F;(0,i.isDefined)(c)?(F=(0,d.cellValueToReadOper)(this.mathpack,c),(0,i.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",null!=F)):F=void 0;const b="CellFormula"===n||"Value"!==n&&void 0;r?this.dataModel.editCellContentsOnClone((0,h.sheetCellSet)(S.sheet,p),l,b,v,r):this.dataModel.editCellContents(t,(0,h.sheetCellSet)(S.sheet,p),l,b,v,F,y)}}editRangeFormats(e,t){if(!this.setInputStateId(e,"rangeFormatEdits"))return;this.clearAsyncResumeRecalc();const r=(0,S.filterCheck)(t,S.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits");for(const t of r){const{range:r,operation:n,origin:u,viewport:l}=t,c="SetFormat"!==n.kind||(0,i.isNone)(n.format)?"RibbonFormat"!==n.kind||(0,i.isNone)(n.ribbon)?"ChangeDecimals"!==n.kind||(0,i.isNone)(n.changeDecimals)?void 0:{kind:n.kind,changeDecimals:n.changeDecimals}:{kind:n.kind,ribbon:n.ribbon}:{kind:n.kind,format:n.format};(0,i.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",null!=c);let m=a.empty;r.forEach((e=>{m=(0,o.unionProduct)(m,(0,f.createCellSetFromRange)((0,d.sheetRangeLocationToGridRange)(this.document,e).range))}));const g=(0,d.sheetRangeLocationToGridRange)(this.document,r[0]),p=null!=u?(0,s.gridCell)(u.row,u.column):(0,s.gridRangeAnchor)(g.range),S=(0,i.isDefined)(l)?(0,d.sheetRangeLocationToGridRange)(this.document,l):void 0;this.dataModel.editCellFormats(e,(0,h.sheetCellSet)(g.sheet,m),c,p,S)}}editArrayFormulas(e,t){if(!this.setInputStateId(e,"arrayFormulaEdits"))return;this.clearAsyncResumeRecalc();const r=(0,S.filterCheck)(t,S.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits");for(const t of r){const{range:r,formulaBarText:n,origin:a,viewport:o}=t,u=(0,d.sheetRangeLocationToGridRange)(this.document,r),l=(0,i.isDefined)(a)?(0,s.gridCell)(a.row,a.column):(0,s.gridCell)(r.row,r.column),c=(0,i.isDefined)(o)?(0,d.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editArrayFormula(e,u,n,l,c)}}editRangePaste(e,t){if(!this.setInputStateId(e,"editRangePaste"))return;this.clearAsyncResumeRecalc();const r=(0,S.filterCheck)(t,S.chPasteEdit,this.ignoredInputStats,"pasteEdits");for(const t of r){const{kind:r,source:n,target:a,viewport:o}=t,s=(0,d.sheetRangeLocationToGridRange)(this.document,n),u=(0,d.sheetCellLocationToGridCell)(this.document,a),l=(0,i.isDefined)(o)?(0,d.sheetRangeLocationToGridRange)(this.document,o):void 0;this.dataModel.editPaste(e,r,u,s,l)}}setConfig(e){const t=Array.isArray(e.runExperiments)?{stepBudget:e.experimentStepBudget??10,totalBudget:e.experimentTotalBudget??1e4,factories:(0,y.getExperimentFactories)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:e.yieldIntervalMs??10,totalTimeMs:e.totalEvalTimeMs??1e4,maxCellChain:2*s.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:e.samplePrecisionEvalRate??.02,samplePrecisionPrintFormulaRate:e.samplePrecisionPrintFormulaRate??.001,samplePrecisionPrintValueRate:e.samplePrecisionPrintValueRate??1e-4,sampleRecalcStatisticsRate:e.sampleRecalcStatisticsRate??.2,sampleWorkbookStatisticsRate:e.sampleWorkbookStatisticsRate??.1,sampleCellEvalStopwatchRate:e.sampleCellEvalStopwatchRate??.003,sampleRecalcEditedStopwatchRate:e.sampleRecalcEditedStopwatchRate??1,sampleRecalcViewportStopwatchRate:e.sampleRecalcViewportStopwatchRate??1,rngSeed:e.rngSeed??1e3*Date.now(),volatileMode:null!=e.volatileMode?k.VolatileMode[e.volatileMode]:k.VolatileMode.Estimation,experimentFactories:t}}reconfigure(e){this.setConfig(e),this.dataModel.reconfigure(this.config)}clearCache(){this.clearAsyncResumeRecalc(),this.dataModel=new g.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=h.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0}processEvalResult({value:e,formatted:t},r){let n,a;if((0,i.isSuccess)(e)){if(!r&&!(0,S.check)(e.value,S.chReadOper,this.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");const t=(0,d.readOperToCellValue)(this.mathpack,e.value);(0,i.assertTrue)("calc.calc.RecalcService.evalFormula",void 0!==t),n=(0,i.success)(t)}else n=(0,i.failure)(A(e.reason));return a=void 0===t?void 0:(0,i.isSuccess)(t)?t:(0,i.failure)(A(t.reason)),(0,F.evalFormulaData)(n,a)}evalFormula(e,t,r,n){return(0,S.check)(r,S.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,S.check)(n,S.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,(0,d.sheetCellLocationToGridCell)(this.document,r),(0,d.evalFormulaFormatToUnion)(n)).then((e=>this.processEvalResult(e,!1))):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))}evalFormulaTree(e,t,r,n){if(!(0,S.check)(r,S.chSheetCellLocation,this.ignoredInputStats,"origin"))return Promise.reject(new Error("ignored input"));if(!(0,S.check)(n,S.chEvalFormulaFormat,this.ignoredInputStats,"format"))return Promise.reject(new Error("ignored format"));const i=(e,t)=>{const[r,n]=e,[a,o]=r,s=[a,o.map((({value:e,formatted:r})=>this.processEvalResult({value:e,formatted:r},!t)))];return void 0!==n?[s,n.map((e=>i(e,!1)))]:[s]};return this.dataModel.evalFormulaTree(e,t,(0,d.sheetCellLocationToGridCell)(this.document,r),(0,d.evalFormulaFormatToUnion)(n)).then((e=>i(e,!0)))}evalFormulaOnSnapshotImpl(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)}evalFormulaTreeOnSnapshotImpl(e,t,r,n){return this.dataModel.evalFormulaTree(-1,e,t,r,n)}testAdvanceState(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())}getMissingJSFeatures(){return(0,m.getMissingJSFeatures)()}constructor(e,t,r,n,a,o={},s="Local"){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.onAlert=n,this.asyncLoopFunction=a,this.twConfig=o,this.dataTransformer=new v.RecalcServiceDataTransformer,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=h.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=async(e,t,r)=>(0,i.initCalcInThread)(e,t,r,this.twConfig),this.setConfig({}),this.dataModel=new g.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}}t.RecalcServiceImpl=T;const R=(0,i.mixin)(T,(e=>new b.RecalcSideGrid(e)),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalFormulaTreeOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,i.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(self.__retries??-1)+1,0===self.__retries))throw"";t.recalcServiceInsideInit=({config:e,connection:t})=>c.Endpoint.createInside(t,(r=>new R(((...e)=>r.post.onRecalcResults(...e)),((...e)=>r.post.onUpdateRequest(...e)),((...e)=>r.post.onGC(...e)),((...e)=>r.post.onAlert(...e)),i.asyncLoop,e,t.createMode)))},7450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRecalcService=async function(e,...[t,r]){const[n,p]="boolean"==typeof t?t?[(new l.PluginSchedulerSingleton).instance(),(new l.GridImportManagerSingleton).instance()]:[void 0,void 0]:[t,r];let h=-1/0,f=!1;const S={onRecalcResults(e){},onUpdateRequest(e){},onGC(e){h=e},onAlert(e){if(f)return;const t=document.createElement("div"),r=document.createElement("p");r.textContent=e,t.appendChild(r);const n=document.createElement("button");n.textContent="OK",t.appendChild(n),t.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),n.onclick=()=>{document.body.removeChild(t)},document.body.appendChild(t),f=!0}},v=await o.createWorker({id:"RecalcService",createMode:e},{local:u.recalcServiceInsideInit,thread:{scriptUrl:(0,i.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(()=>S)),y=[];let F="Requested";function b(e="Requested"){F=e,v.close()}v.onClose=()=>{for(const e of y)try{e()}catch(e){i.ulsLogger.ULS.traceTag(539341771,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`calc.calc.createRecalcService.service.onClose: callback threw ${(0,i.messageFromError)(e)}`)}const e=`calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ${F}`;i.ulsLogger.ULS.traceTag(561534148,a.LogCategory.msoulscat_ES_EWAJS,"Requested"===F?a.TraceLevel.Info:a.TraceLevel.Warning,e)};try{if("Thread"===v.createMode){const e=await(0,i.initCalcThread)(v);y.push((()=>e.close())),(0,s.logMissingJSFeatures)(v.call.getMissingJSFeatures)}v.call.ping.callTimeout=d;let e=m,t=0,r=()=>{};(0,i.promiseLoop)((async()=>{if(await new Promise((e=>setTimeout(e,g))),v.hasBeenClosed())return;const n=v.call.ping.callTimeout,s=(0,i.now)();try{await v.call.ping()}catch(u){if(!o.WorkerError.isWorkerError(u)||"Timeout"!==u.info.cause)throw u;const l=(0,i.now)()-s;t+=1,t>=e&&b("Unresponsive");const c=v.hasBeenClosed(),d={timeout:n,waitTime:l,timeoutCount:t,hasBeenClosed:c},m=`calc.calc.RecalcService: unresponsive; ${JSON.stringify(d)}`;return i.ulsLogger.ULS.traceTag(561534149,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,m),r(n,l,t,c),!0}return t=0,!0}),!0).catch((e=>{const t=`calc.calc.RecalcService: ping loop threw an error: ${(0,i.messageFromError)(e)}`;i.ulsLogger.ULS.traceTag(561534150,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t)})),v.post.updateRanges.onPostMessageError=o.dispatchWorkerError;const u={setOnRecalcResults(e){S.onRecalcResults=e},setOnUpdateRequest(e){S.onUpdateRequest=e},setOnUnresponsive(e){r=e},setA1ReferenceStyle(...e){v.post.setA1ReferenceStyle(...e),void 0!==n&&n.doNotify(c.NotificationKind.setA1ReferenceStyle,e)},setLocale(...e){v.post.setLocale(...e),void 0!==n&&n.doNotify(c.NotificationKind.setLocale,e)},setWorkbookProps(...e){v.post.setWorkbookProps(...e),void 0!==n&&n.doNotify(c.NotificationKind.setWorkbookProps,e)},updateSheetNames(...e){v.post.updateSheetNames(...e),void 0!==n&&n.doNotify(c.NotificationKind.updateSheetNames,e)},updateNamedObjects(...e){v.post.updateNamedObjects(...e),void 0!==n&&n.doNotify(c.NotificationKind.updateNamedObjects,e)},setNumberFormats:v.post.setNumberFormats,updateUnusedCells:v.post.updateUnusedCells,updateRanges:v.post.updateRanges,updateArrays:v.post.updateArrays,editRangeFormulas:v.post.editRangeFormulas,editRangeFormats:v.post.editRangeFormats,editArrayFormulas:v.post.editArrayFormulas,editRangePaste:v.post.editRangePaste,resumeRecalc:v.post.resumeRecalc,reconfigure(t){v.call.ping.callTimeout=t.responsivenessPingTimeout??d,e=t.responsivenessPingAttempts??m,v.post.reconfigure(t)},clearCache(){v.post.clearCache(),h=-1/0},testAdvanceState:v.post.testAdvanceState,testResumeRecalc:v.call.testResumeRecalc,close:b,stateIdAvailable:e=>e>=h,evalFormula:v.call.evalFormula,evalFormulaTree:v.call.evalFormulaTree,evalOnClonedModel:v.call.evalOnClonedModel,localizeEnglishFormula:(...e)=>v.call.localizeEnglishFormula(...e),createIGridExportEndpoint:(e,t)=>(y.push(t),v.call.createIGridExportEndpoint.transfer([e.port],e))};return void 0!==p&&p.onGridExporterCreated(u),u}catch(e){throw b("Error"),e}};const n=r(6533),i=r(6913),a=r(5033),o=n.__importStar(r(7882)),s=r(3214),u=r(6766),l=r(3948),c=r(6410),d=3e4,m=3,g=1e3},8328:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chReadOper=t.chEvalFormulaFormat=t.chWorkbookProps=t.chLocaleData=t.chPasteEdit=t.chArrayFormulaEdit=t.chRangeFormatEdit=t.chRangeFormulaEdit=t.chNamedObjectsUpdate=t.chNamedObject=t.chNamedObjectData=t.chNamedFailureData=t.chNamedTableScope=t.chNamedTableData=t.chColumnData=t.chNamedRangeData=t.chNamedFormulaData=t.chNamedValueData=t.chNamedValue=t.chUnusedCellsUpdate=t.chArrayUpdate=t.chArrayData=t.chRangeUpdate=t.chCellData=t.chCellFormat=t.chCellValue=t.chError=t.chBlank=t.chSheetCellLocation=t.chSheetRangeLocation=t.chRangeLocation=t.chCellLocation=t.chCol=t.chRow=t.chSheetName=t.chSheetId=t.chNumberFormat=t.chErrorTypeName=t.chWorksheetFunctionName=t.chFormulaText=t.chArray=t.chBoolean=t.chNonemptyString=t.chString=t.chNatural=t.chInteger=t.chFiniteNumber=t.chPossiblyInfiniteNumber=t.chNever=void 0,t.incrementStat=o,t.checker=u,t.check=l,t.filterCheck=function(e,r,n,i){if(!l(e,t.chArray,n,i))return[];const a=`${i}.<index>`;return e.filter((e=>l(e,r,n,a)))},t.optChecker=c,t.fromChecker=function(e){return(t,r,n)=>e(t,r,n)},t.objectChecker=d,t.allChecker=m,t.depAllChecker=g,t.arrayChecker=p,t.taggedUnionChecker=h,t.typeofChecker=f,t.intChecker=y,t.eqChecker=F,t.oneOfChecker=b,t.isFormulaText=C;const n=r(6913),i=r(6592),a=r(1159);function o(e,t){e[t]=(e[t]??0)+1}function s(e,t,r){return e.push(`${t.join(".")}: expected ${r}`),!1}function u(e,t){return(r,i,a)=>(0,n.isDefined)(r)&&e(r)||s(i,a,t)}function l(e,t,r,n){const i=[],a=t(e,i,[n]);for(const e of i)o(r,e);return a}function c(e){return(t,r,i)=>!!(0,n.isNone)(t)||e(t,r,i)}function d(e){return(t,r,i)=>{if((0,n.isNone)(t))return s(r,i,"non-null object");const a=i.length;try{let n=!0;for(const o in e)i[a]=o,n=n&&e[o](t[o],r,i);return n}finally{i.length=a}}}function m(...e){return(t,r,n)=>e.reduce(((e,i)=>e&&i(t,r,n)),!0)}function g(e,...t){return(r,n,i)=>t.reduce(((e,t)=>e&&t(r)(r,n,i)),e(r,n,i))}function p(e){return(t,r,n)=>{if(!Array.isArray(t))return s(r,n,"Array");n.push("<index>");try{return t.reduce(((t,i)=>t&&e(i,r,n)),!0)}finally{n.pop()}}}function h(e){const t=`one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,i,a)=>{if((0,n.isNone)(r))return s(i,a,"non-null object");const o=a.length;try{const o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return(0,n.isNone)(o)?(a.push("kind"),s(i,a,t)):o(r,i,a)}finally{a.length=o}}}function f(e){const t=`typeof one of ${JSON.stringify(Object.getOwnPropertyNames(e).sort())}`;return(r,i,a)=>{const o=e[typeof r];return(0,n.isNone)(o)?s(i,a,t):o(r,i,a)}}function S(e){return"number"==typeof e&&e>-1/0&&e<1/0}function v(e){return(0|e)===e||Math.floor(e)===e}function y(e,t,r=(0!==e?`integer >= ${e} and < ${t}`:`natural < ${t}`)){return u((r=>"number"==typeof r&&r>=e&&r<t&&v(r)),r)}function F(e){return u((t=>t===e),JSON.stringify(e))}function b(...e){const t=Object.create(null),r=Object.create(null);for(const n of e)"number"==typeof n?r[n]=!0:t[n]=!0;return u((e=>{switch(typeof e){case"string":case"symbol":return!0===t[e];case"number":return!0===r[e]}return!1}),`one of ${JSON.stringify(e.slice().sort())}`)}function C(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}t.chNever=u((e=>!1),"never"),t.chPossiblyInfiniteNumber=u((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),t.chFiniteNumber=u(S,"finite number"),t.chInteger=u((e=>S(e)&&v(e)),"integer"),t.chNatural=y(0,1/0,"natural"),t.chString=u((e=>"string"==typeof e),"string"),t.chNonemptyString=u((e=>"string"==typeof e&&e.length>0),"nonempty string"),t.chBoolean=u((e=>"boolean"==typeof e),"boolean"),t.chArray=u((e=>Array.isArray(e)),"Array"),t.chFormulaText=u((e=>"string"==typeof e&&C(e)),"formula text"),t.chWorksheetFunctionName=d({functionId:t.chNatural,functionName:t.chNonemptyString});const k=u((e=>"string"==typeof e&&e.length>1&&(0,n.stringStartsWith)(e,"#")),"error name");t.chErrorTypeName=d({errorType:t.chNatural,errorName:k}),t.chNumberFormat=d({iformat:t.chNatural,formatString:t.chString,builtIn:t.chBoolean}),t.chSheetId=u((e=>"string"==typeof e||S(e)),"string or finite number"),t.chSheetName=d({sheetId:t.chSheetId,sheetName:t.chString}),t.chRow=y(0,i.sheetRows),t.chCol=y(0,i.sheetCols),t.chCellLocation=d({row:t.chRow,column:t.chCol});const E=u((e=>null==e.lastRow||e.lastRow>=e.row),"lastRow >= row"),A=u((e=>null==e.lastColumn||e.lastColumn>=e.column),"lastColumn >= column"),T=m(t.chCellLocation,d({lastRow:c(t.chRow),lastColumn:c(t.chCol)}));t.chRangeLocation=g(T,(e=>E),(e=>A)),t.chSheetRangeLocation=m(t.chRangeLocation,d({sheetId:t.chSheetId})),t.chSheetCellLocation=m(t.chSheetRangeLocation,d({lastRow:c(t.chNever),lastColumn:c(t.chNever)})),t.chBlank=d({kind:F("Blank")}),t.chError=d({kind:F("Error"),type:t.chNatural}),t.chCellValue=f({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:h({Blank:t.chBlank,Error:t.chError})}),t.chCellFormat=f({number:t.chNatural,string:t.chString}),t.chCellData=m(d({value:t.chCellValue,iformat:t.chNatural,failureReason:c(t.chString)}),h({CellFormula:d({formulaBarText:t.chFormulaText}),ArrayFormula:d({formulaBarText:c(t.chNever)}),Value:d({formulaBarText:t.chString})})),t.chRangeUpdate=d({range:t.chSheetRangeLocation,excludeRows:c(p(t.chRow)),excludeColumns:c(p(t.chCol)),data:c(t.chCellData),fromStateId:c(t.chInteger)}),t.chArrayData=d({isSpilled:t.chBoolean,formulaBarText:t.chFormulaText}),t.chArrayUpdate=d({range:t.chSheetRangeLocation,data:c(t.chArrayData),fromStateId:c(t.chInteger)}),t.chUnusedCellsUpdate=d({sheetId:t.chSheetId,usedRange:c(t.chRangeLocation)}),t.chNamedValue=f({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:h({Error:t.chError})}),t.chNamedValueData=d({kind:F("NamedValue"),value:t.chNamedValue}),t.chNamedFormulaData=d({kind:F("NamedFormula"),formulaBarText:t.chFormulaText}),t.chNamedRangeData=d({kind:F("NamedRange"),range:t.chSheetRangeLocation}),t.chColumnData=d({column:t.chNatural,name:t.chNonemptyString});const R=e=>(e.lastRow??e.row)-e.row+1,N=e=>(e.lastColumn??e.column)-e.column+1,I=u((e=>(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+R(e.range)<i.sheetRows)),"enough rows for headers and totals"),P=u((e=>{const t=e.range.column,r=e.range.column+N(e.range);return e.columns.every((e=>e.column>=t&&e.column<r))}),"column names in range");t.chNamedTableData=g(d({kind:F("NamedTable"),range:t.chSheetRangeLocation,hasHeadersRow:t.chBoolean,hasTotalsRow:t.chBoolean,columns:p(t.chColumnData)}),(e=>I),(e=>P)),t.chNamedTableScope=e=>u((t=>"NamedTable"!==t.data?.kind||null==e),"NamedTable at global scope"),t.chNamedFailureData=d({kind:F("NamedFailure"),failureReason:t.chString,objectKind:c(b("NamedValue","NamedFormula","NamedRange","NamedTable"))}),t.chNamedObjectData=h({NamedValue:t.chNamedValueData,NamedFormula:t.chNamedFormulaData,NamedRange:t.chNamedRangeData,NamedTable:t.chNamedTableData,NamedFailure:t.chNamedFailureData});const O=d({name:t.chString,data:c(t.chNamedObjectData)});t.chNamedObject=e=>g(O,(r=>(0,t.chNamedTableScope)(e))),t.chNamedObjectsUpdate=d({scope:c(t.chSheetId),objects:c(t.chArray),fromStateId:c(t.chInteger)});const M=u((e=>e.length>0),"a non-empty array"),D=u((e=>e.every((t=>t.sheetId===e[0].sheetId))),"ranges on the same sheet"),w=g(p(t.chSheetRangeLocation),(e=>M),(e=>D));t.chRangeFormulaEdit=m(d({range:w,origin:c(t.chCellLocation),viewport:c(t.chSheetRangeLocation)}),h({CellFormula:d({formulaBarText:t.chFormulaText,value:c(t.chNever)}),Value:d({formulaBarText:t.chString,value:t.chCellValue}),Inferred:d({formulaBarText:t.chString,value:c(t.chNever)})}));const _=h({SetFormat:d({format:t.chCellFormat}),RibbonFormat:d({ribbon:b(...(0,n.strEnumArray)(a.RibbonFormat))}),ChangeDecimals:d({changeDecimals:y(-20,20)})});t.chRangeFormatEdit=d({range:w,operation:_,origin:c(t.chCellLocation),viewport:c(t.chSheetRangeLocation)}),t.chArrayFormulaEdit=d({range:t.chSheetRangeLocation,formulaBarText:u((e=>"string"==typeof e&&(0===e.length||C(e))),"empty string or text denoting formula"),origin:c(t.chCellLocation),viewport:c(t.chSheetRangeLocation)});const L=u((e=>{const t=N(e.source),r=R(e.source);return e.target.column+t<=i.sheetCols&&e.target.row+r<=i.sheetRows}),"(target,source) in range");t.chPasteEdit=g(d({kind:b("CopyPaste"),target:t.chSheetCellLocation,source:t.chSheetRangeLocation,viewport:c(t.chSheetRangeLocation)}),(e=>L));const x=u((e=>2===e.length),"2 AM/PM symbols"),K=u((e=>7===e.length),"7 day symbols"),B=u((e=>12===e.length),"12 month symbols");function W(e){const t=(0,n.numEnumMap)(e,n.identity);return u((e=>e.every(((e,r)=>null==e||r in t))),"indexes in enum")}const U=W(i.SpecialRefId),G=W(i.PictureSpecial),j=W(i.PictureSingle),V=W(i.PictureColor),H=W(i.PictureDbnum);t.chLocaleData=d({worksheetFunctionNames:t.chArray,thousandsData:p(t.chNatural),errorTypeNames:t.chArray,specialRefNames:g(p(c(t.chNonemptyString)),(e=>U)),trueName:t.chNonemptyString,falseName:t.chNonemptyString,rowLetter:t.chNonemptyString,columnLetter:t.chNonemptyString,leftBrace:t.chNonemptyString,rightBrace:t.chNonemptyString,leftBracket:t.chNonemptyString,rightBracket:t.chNonemptyString,decimalSeparator:t.chNonemptyString,listSeparator:t.chNonemptyString,columnSeparator:t.chNonemptyString,rowSeparator:t.chNonemptyString,thousandsSeparator:t.chString,lcid:t.chNatural,country:t.chNatural,numberDecimals:t.chNatural,isExpSepBySpace:t.chBoolean,fractionSeparator:t.chNonemptyString,isPercentSepBySpace:t.chBoolean,currencyFormat:b(i.CurrencyFormat.Paren,i.CurrencyFormat.Lead,i.CurrencyFormat.Intern,i.CurrencyFormat.Trail),isCurrencySymbolLead:t.chBoolean,isCurrencySepBySpace:t.chBoolean,currencySymbol:t.chString,currencyDecimals:t.chNatural,dateOrder:b(i.DateOrder.MDY,i.DateOrder.DMY,i.DateOrder.YMD,i.DateOrder.MYD,i.DateOrder.DYM,i.DateOrder.YDM),dateSeparator:t.chString,dateAltSeparator:t.chString,year4Digits:t.chBoolean,month2Digits:t.chBoolean,day2Digits:t.chBoolean,longDateFormat:t.chBoolean,timeSeparator:t.chString,timeAltSeparator:c(t.chString),hour2Digits:t.chBoolean,clock24Hour:t.chBoolean,isAMPMSepBySpace:t.chBoolean,ampmSymbols:g(p(t.chString),(e=>x)),dayNameShort:g(p(t.chString),(e=>K)),dayNameLong:g(p(t.chString),(e=>K)),monthNameShort:g(p(t.chString),(e=>B)),monthNameLong:g(p(t.chString),(e=>B)),pictureSpecial:g(p(c(t.chNonemptyString)),(e=>G)),pictureSingle:g(p(c(t.chNonemptyString)),(e=>j)),pictureColor:g(p(c(t.chNonemptyString)),(e=>V)),pictureDbnum:g(p(c(t.chNonemptyString)),(e=>H)),sysDateFormat:t.chString,sysTimeFormat:t.chString,cultureTagPrimary:t.chNonemptyString,cultureTagUserDefault:t.chNonemptyString,cultureTagInstLang:t.chNonemptyString,cultureTagUserCurrent:t.chNonemptyString});const q=d({yr:t.chInteger,mon:y(1,13),dom:y(1,6),wdy:y(1,8),hour:y(0,24),min:y(0,60),sec:y(0,60),fracSec:F(0),rounding:y(0,4)}),z=g(d({bias:t.chFiniteNumber,standardDate:c(q),standardBias:t.chFiniteNumber,daylightDate:c(q),daylightBias:t.chFiniteNumber}),(e=>u((e=>(0,n.isNone)(e.standardDate)===(0,n.isNone)(e.daylightDate)),"standardDate iff daylightDate")));t.chWorkbookProps=d({date1904:c(t.chBoolean),dateCompatibility:c(t.chBoolean),timezone:c(z)}),t.chEvalFormulaFormat=c(h({Origin:d({iformat:c(t.chNever),knownFormat:c(t.chNever)}),Iformat:d({iformat:t.chNatural,knownFormat:c(t.chNever)}),Known:d({iformat:c(t.chNever),knownFormat:b(...(0,n.numEnumArray)(i.KnownFormat))}),Inferred:d({iformat:c(t.chNever),knownFormat:c(t.chNever)}),Aggregate:d({iformat:c(t.chNever),knownFormat:c(t.chNever)})}));const Q={[i.OperKind.Number]:!0,[i.OperKind.String]:!0,[i.OperKind.Boolean]:!0,[i.OperKind.Error]:!0,[i.OperKind.Array]:!1,[i.OperKind.Blank]:!0,[i.OperKind.Rich]:!1};t.chReadOper=u((e=>Q[e.kind]),"supported ReadOper")},7755:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecalcServiceDataTransformer=t.initialRecalcServiceConfig=void 0,t.incrementFailure=function(e,t){switch(t.kind){case o.ReasonKind.NotImplemented:for(const r of t.features)(0,c.incrementStat)(e,`${o.ReasonKind.NotImplemented} ${r}`);break;case o.ReasonKind.IllFormedFormula:(0,c.incrementStat)(e,`${o.ReasonKind.IllFormedFormula} ${t.mode??""} ${JSON.stringify({diagnostics:t.diagnostics??{},message:t.mode===l.FormulaMode.ServerCellFormula||t.mode===l.FormulaMode.ServerNamedFormula?t.message:void 0})}`);break;case o.ReasonKind.Unavailable:for(const r of t.objects){const t=[o.ReasonKind.Unavailable];if("string"==typeof r.kind&&r.kind in l.UnavailableKind){const e=r;switch(t.push(e.kind),e.kind){case l.UnavailableKind.SheetId:t.push(e.sheetId);break;case l.UnavailableKind.NameLoc:t.push(e.source),t.push(void 0===e.name.scope.index?"global":"sheet");break;case l.UnavailableKind.ClientFailure:t.push(e.reason);break;case l.UnavailableKind.CellFormula:case l.UnavailableKind.EvalFailure:t.push(e.reason.kind);break;case l.UnavailableKind.VolatileFunction:t.push(e.name);break;case l.UnavailableKind.TimeGranularity:t.push(i.TimeGranularity[e.granularity]);break;case l.UnavailableKind.GetTimeKind:t.push(e.getTimeKind)}}else t.push(JSON.stringify(r));(0,c.incrementStat)(e,t.join(" "))}break;case o.ReasonKind.LimitExceeded:(0,c.incrementStat)(e,`${t.kind} ${o.LimitKind[t.limit]}`);break;case a.FormatReasonKind.NotFormatString:case a.FormatReasonKind.NotValueString:(0,c.incrementStat)(e,`${t.kind} ${t.message}`);break;case o.ReasonKind.InvalidQualifier:case o.ReasonKind.InvalidCellRef:case o.ReasonKind.InvalidStructRef:(0,c.incrementStat)(e,`${t.kind} ${t.reason}`);break;case o.ReasonKind.Internal:(0,c.incrementStat)(e,`${t.kind} ${t.message}`);break;case o.ReasonKind.JavaScriptError:case s.ReasonKind.NotFormulaString:case o.ReasonKind.CellCycle:case o.ReasonKind.NameCycle:case o.ReasonKind.Stopped:case o.ReasonKind.PreviousFailure:case o.ReasonKind.PreviousNameFailure:case a.FormatReasonKind.PreviousFormatFailure:(0,c.incrementStat)(e,t.kind);break;default:(0,n.assertNever)("calc.calc.incrementFailure",t)}};const n=r(6913),i=r(6592),a=r(1159),o=r(1475),s=r(391),u=r(3313),l=r(9204),c=r(8328);t.initialRecalcServiceConfig={localeInfo:(0,i.getEnglishLocaleInfo)(),mathpack:i.xlMathpack,refStyle:i.RefStyle.A1,timezone:i.tzUTC,date1904:!1,dateCompatibility:!0,datepack:i.xlDatepack},t.RecalcServiceDataTransformer=class{getLangConfig(){return this.langConfig}setA1ReferenceStyle(e,t,r){this.langConfig={...this.langConfig,refStyle:r?i.RefStyle.A1:i.RefStyle.R1C1},e.setLangConfig(t,this.langConfig)}setLocaleInfo(e,t,r,n){(0,c.check)(r,c.chLocaleData,n,"localeData")&&(this.langConfig={...this.langConfig,localeInfo:(0,u.createLocaleInfo)(r,n)},e.setLangConfig(t,this.langConfig))}setWorkbookProps(e,r,n,i){(0,c.check)(n,c.chWorkbookProps,i,"workbookProps")&&(this.langConfig={...this.langConfig,date1904:n.date1904??t.initialRecalcServiceConfig.date1904,dateCompatibility:n.dateCompatibility??t.initialRecalcServiceConfig.dateCompatibility,timezone:n.timezone??t.initialRecalcServiceConfig.timezone},e.setLangConfig(r,this.langConfig))}updateSheetNames(e,t,r,n){e.setSheetNames(this.document,(0,c.filterCheck)(r,c.chSheetName,n,"sheetNames"),t)}updateNamedObjects(e,t,r,a){const o=(0,c.filterCheck)(r,c.chNamedObjectsUpdate,a,"namedObjectsUpdates");for(const r of o){const{scope:o,objects:s,fromStateId:l}=r,d=(0,i.nameScope)(this.document,(0,n.isDefined)(o)?o:void 0);if((0,n.isDefined)(s)){const r=(0,c.filterCheck)(s,(0,c.chNamedObject)(o),a,"namedObjectsUpdates.<index>.objects");for(const n of r){const{name:r,data:i}=n;e.writeNamedObject(t,d,r,(0,u.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,i))}}else(0,n.isDefined)(l)?e.promoteNamedObjects(t,d,l):e.writeUndefinedNames(t,d)}}constructor(){this.document=(0,i.documentLoc)(void 0,""),this.langConfig=t.initialRecalcServiceConfig}}},3340:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentKind=void 0,t.getExperimentFactories=function(e){return e.map((({name:e,param:t})=>l[e]?.(t))).filter((e=>void 0!==e))},t.registerExperimentFactory=function(e,t){l[e]=t};const n=r(6913),i=r(5033),a=r(1436),o=r(780);class s{static create(e){if("number"==typeof e)return new s(e);{const t=`calc.calc.TestExperiment: expected number; given ${e}`;n.ulsLogger.ULS.traceTag(591974878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t)}}setContext(){}step(){const e=(0,n.now)();for(;(0,n.now)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)}constructor(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}}var u;!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(u||(t.ExperimentKind=u={}));const l={TestExperiment:e=>({experimentName:"TestExperiment",kind:u.OneShot,create:()=>s.create(e)}),ExceLintExperiment:()=>({experimentName:"ExceLintExperiment",kind:u.OneShot,create:()=>new a.ExceLintExperiment}),UnitExperiment:()=>({experimentName:"UnitExperiment",kind:u.OneShot,create:()=>new o.UnitExperiment,stepBudget:80})}},721:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecalcServiceCreateMode=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaFormat=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditOperation=t.RibbonFormat=t.rangeFormulaEdit=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedTableData=t.columnData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayUpdate=t.arrayData=t.rangeWrite=t.rangeUpdate=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.getCellValueKind=function(e){return"object"==typeof e?e.kind:typeof e},t.getCellFormatKind=function(e){return"object"==typeof e?e.kind:typeof e},t.cellFormulaCellData=function(e,r,n,i){return(0,t.cellData)(e,r,n,i,"CellFormula")},t.arrayFormulaCellData=function(e,r,n){return(0,t.cellData)(void 0,e,r,n,"ArrayFormula")},t.valueCellData=function(e,r,n,i){return(0,t.cellData)(e,r,n,i,"Value")},t.rangePromote=function(e,r,n,i){return(0,t.rangeUpdate)(e,void 0,r,n,i)},t.arrayWrite=function(e,r){return(0,t.arrayUpdate)(e,r,void 0)},t.arrayPromote=function(e,r){return(0,t.arrayUpdate)(e,void 0,r)},t.namedObjectsWrite=function(e,r){return(0,t.namedObjectsUpdate)(e,r,void 0)},t.undefinedNamesWrite=function(e){return(0,t.namedObjectsUpdate)(e,void 0,void 0)},t.namedObjectsPromote=function(e,r){return(0,t.namedObjectsUpdate)(e,void 0,r)},t.cellFormulaRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,void 0,n,i,"CellFormula")},t.valueRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,n,void 0,i,"Value")},t.inferredRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,void 0,n,i,"Inferred")},t.formatEditSetFormat=function(e){return(0,t.formatEditOperation)("SetFormat",e,void 0,void 0)},t.formatEditRibbonFormat=function(e){return(0,t.formatEditOperation)("RibbonFormat",void 0,e,void 0)},t.formatEditChangeDecimals=function(e){return(0,t.formatEditOperation)("ChangeDecimals",void 0,void 0,e)},t.copyPasteRangePasteEdit=function(e,r,n){const i=(0,t.sheetCellLocation)(e.sheetId,e.row,e.column);return(0,t.rangePasteEdit)("CopyPaste",i,r,n)},t.evalFormulaFormatOrigin=function(){return(0,t.evalFormulaFormat)("Origin")},t.evalFormulaFormatIformat=function(e){return(0,t.evalFormulaFormat)("Iformat",e)},t.evalFormulaFormatKnown=function(e){return(0,t.evalFormulaFormat)("Known",void 0,e)},t.evalFormulaFormatInferred=function(){return(0,t.evalFormulaFormat)("Inferred")},t.evalFormulaFormatAggregate=function(){return(0,t.evalFormulaFormat)("Aggregate")},t.evalFormulaData=function(e,t){return{value:e,formatted:t}};const n=r(6913),i=r(1159);var a;Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return i.RibbonFormat}}),t.worksheetFunctionName=(0,n.typedInstanceCreator)()(((e,t)=>({functionId:e,functionName:t}))),t.errorTypeName=(0,n.typedInstanceCreator)()(((e,t)=>({errorType:e,errorName:t}))),t.localeData=(0,n.typedInstanceCreator)()(((e,t,r,n,i,a,o,s,u,l,c,d,m,g,p,h,f,S,v,y,F,b,C,k,E,A,T,R,N,I,P,O,M,D,w,_,L,x,K,B,W,U,G,j,V,H,q,z,Q,$,Y,J,X,Z,ee)=>({worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:Q,trueName:r,falseName:n,rowLetter:i,columnLetter:a,leftBrace:o,rightBrace:s,leftBracket:u,rightBracket:l,decimalSeparator:c,listSeparator:d,columnSeparator:m,rowSeparator:g,thousandsData:p,thousandsSeparator:h,lcid:f,country:S,numberDecimals:v,isExpSepBySpace:y,fractionSeparator:F,isPercentSepBySpace:b,currencyFormat:C,isCurrencySymbolLead:k,isCurrencySepBySpace:E,currencySymbol:A,currencyDecimals:T,dateOrder:R,dateSeparator:N,dateAltSeparator:I,year4Digits:P,month2Digits:O,day2Digits:M,longDateFormat:D,timeSeparator:w,timeAltSeparator:_,hour2Digits:L,clock24Hour:x,isAMPMSepBySpace:K,ampmSymbols:B,dayNameShort:W,dayNameLong:U,monthNameShort:G,monthNameLong:j,pictureSpecial:V,pictureSingle:H,pictureColor:q,pictureDbnum:z,sysDateFormat:$,sysTimeFormat:Y,cultureTagPrimary:J,cultureTagUserDefault:X,cultureTagInstLang:Z,cultureTagUserCurrent:ee}))),t.numberFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({iformat:e,formatString:t,builtIn:r}))),t.sheetName=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,sheetName:t}))),t.blankValue={kind:"Blank"},t.errorValue=(0,n.typedInstanceCreator)()((e=>({kind:"Error",type:e}))),t.richValue=(0,n.typedInstanceCreator)()((e=>({kind:"Rich",fields:e}))),t.cellLocation=(0,n.typedInstanceCreator)()(((e,t)=>({row:e,column:t}))),t.rangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({row:e,column:t,lastRow:r,lastColumn:n}))),t.sheetRangeLocation=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}))),t.sheetCellLocation=(0,n.typedInstanceCreator)()(((e,t,r)=>({sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}))),t.cellData=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}))),t.rangeUpdate=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}))),t.rangeWrite=(0,n.typedInstanceCreator)()(((e,r,n,i)=>(0,t.rangeUpdate)(e,r,void 0,n,i))),t.arrayData=(0,n.typedInstanceCreator)()(((e,t)=>({isSpilled:e,formulaBarText:t}))),t.arrayUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({range:e,data:t,fromStateId:r}))),t.unusedCellsUpdate=(0,n.typedInstanceCreator)()(((e,t)=>({sheetId:e,usedRange:t}))),t.namedValueData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedValue",value:e}))),t.namedFormulaData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedFormula",formulaBarText:e}))),t.namedRangeData=(0,n.typedInstanceCreator)()((e=>({kind:"NamedRange",range:e}))),t.columnData=(0,n.typedInstanceCreator)()(((e,t)=>({column:e,name:t}))),t.namedTableData=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}))),t.namedFailureData=(0,n.typedInstanceCreator)()(((e,t)=>({kind:"NamedFailure",failureReason:e,objectKind:t}))),t.namedObject=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,data:t}))),t.namedObjectsUpdate=(0,n.typedInstanceCreator)()(((e,t,r)=>({scope:e,objects:t,fromStateId:r}))),t.rangeFormulaEdit=(e,t,r,n,i,a="Inferred")=>({range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:i,kind:a}),t.formatEditOperation=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,format:t,ribbon:r,changeDecimals:n}))),t.rangeFormatEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,operation:t,origin:r,viewport:n}))),t.arrayFormulaEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({range:e,formulaBarText:t,origin:r,viewport:n}))),t.rangePasteEdit=(0,n.typedInstanceCreator)()(((e,t,r,n)=>({kind:e,target:t,source:r,viewport:n}))),t.inferredFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({format:e,category:t,decimals:r}))),t.cellDataDelta=(0,n.typedInstanceCreator)()(((e,t,r,n,i)=>({formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:i}))),t.rangeDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.arrayDelta=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,data:t}))),t.rangeFailure=(0,n.typedInstanceCreator)()(((e,t)=>({range:e,reason:t}))),t.recalcResults=(0,n.typedInstanceCreator)()(((e,t,r,n,i,a)=>({stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:a}))),t.evalFormulaFormat=(0,n.typedInstanceCreator)()(((e,t,r)=>({kind:e,iformat:t,knownFormat:r}))),t.updateRequest=(0,n.typedInstanceCreator)()(((e,t,r)=>({rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}))),t.runExperiment=(0,n.typedInstanceCreator)()(((e,t)=>({name:e,param:t}))),t.recalcServiceConfig=(0,n.typedInstanceCreator)()(((e,t,r,n,i,a,o,s,u,l,c=(null==l?void 0:l/(l>=1?1:10)),d)=>({totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:a,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:u}))),t.workbookProps=(0,n.typedInstanceCreator)()(((e,t,r)=>({date1904:e,dateCompatibility:t,timezone:r}))),function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(a||(t.RecalcServiceCreateMode=a={}))},438:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecalcSideGrid=void 0,t.convertX10UpdatesToCalcUpdates=p,t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=h;const n=r(6533),i=r(6913),a=r(9610),o=r(6592),s=n.__importStar(r(7882)),u=r(3313),l=r(6824),c=r(9204),d=r(8453),m=r(721),g=r(4563);function p(e,t){return e.map((e=>{if(!(0,i.isDefined)(e.data))return{data:void 0,range:(0,u.sheetGridRangeToLocation)(e.range)};const r=(0,u.readOperToCellValue)(t,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:r??m.blankValue,iformat:e.data.iformat,failureReason:void 0===r?"unsupported Oper serialization":void 0},range:(0,u.sheetGridRangeToLocation)(e.range)}}))}function h(e,t){return e.map((e=>{const[r,...n]=e.range,a=[(0,u.sheetGridRangeToLocation)(r),...n.map((e=>(0,u.sheetGridRangeToLocation)(e)))];return{kind:e.kind,range:a,formulaBarText:e.formulaBarText,value:(0,i.isDefined)(e.value)?(0,u.readOperToCellValue)(t,e.value):void 0,origin:(0,i.isDefined)(e.origin)?(0,u.gridCellToCellLocation)(e.origin):void 0}}))}function f(e){const[t,r]=e,[n,i]=t;if(i.map(S),void 0===r)return e;for(const e of r)f(e);return e}function S(e){if(e.value.kind===i.ResultKind.Failure&&e.value.reason.kind===o.ReasonKind.Unavailable){const t=e.value.reason.objects;for(let e=0;e<t.length;e++){const r=t[e];r.kind===c.UnavailableKind.GridRange&&(t[e]={...r,unavailableCells:!0})}}return e}(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),t.RecalcSideGrid=class{async createIGridExportEndpoint(e){await s.Endpoint.createInside(e,(()=>this))}discardSnapshot(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)}async evalClonedModelOnSnapshot(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,o.unavailable)(["evalOnClonedModel"]));const s=p(t,a.config.mathpack),u=h(r,a.config.mathpack),l=this.calcGrid.evalOnClonedModelOnSnapshot(s,u,a,n);return this.calcGrid.resumeRecalc(),(0,i.success)(await l)}async evalFormulaOnSnapshot(e,t,r,n={kind:c.SpecialFormat.Origin}){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,o.unavailable)(["evalFormula"]));const s=this.calcGrid.evalFormulaOnSnapshotImpl(t,r,n,a);this.calcGrid.resumeRecalc();const u=S(await s);return(0,i.success)(u)}async evalFormulaTreeOnSnapshot(e,t,r,n={kind:c.SpecialFormat.Origin}){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,o.unavailable)(["evalFormula"]));const s=this.calcGrid.evalFormulaTreeOnSnapshotImpl(t,r,n,a);this.calcGrid.resumeRecalc();const u=f(await s);return(0,i.success)(u)}async getSheetNames(e){const{snapshot:t}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===t)return(0,i.failure)((0,o.unavailable)(["getSheetNames"]));const r={document:this.calcGrid.document,sheets:new Array},n=t.getSheetRangeIndexes((0,o.allSheetsRange)(this.calcGrid.document));if(!(0,i.isSuccess)(n))return n;for(const e of n.value.sheets){const n=t.getSheetName(this.calcGrid.document,e);if(!(0,i.isSuccess)(n))return n;r.sheets.push({sheetIndex:(0,o.sheetIndex)(this.calcGrid.document,e),sheetName:n.value})}return(0,i.success)(r)}async getCorrespondingSnapshotID(e){const t=await this.getOrCreateSnapshot(e);return void 0===t?-1:t.correspondingId}async getOrCreateSnapshot(e){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(e),this.calcGrid.resumeRecalc().catch((e=>{setTimeout((()=>{throw e}))}))),this.snapshotPromises[e]}getRangeFormats(e,t){return this.getRangeData(e,t,"formats")}getRangeValues(e,t){return this.getRangeData(e,t,"values")}getRangeFormulae(e,t){return this.getRangeData(e,t,"formulae")}async getRangeData(e,t,r){const{snapshot:n}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===n)return(0,i.failure)((0,o.unavailable)(["getRangeData/getOrCreateSnapshot"]));const s=n.allEditedAvailable(t);if(s.kind!==i.ResultKind.Success)return(0,i.failure)((0,o.unavailable)(["getRangeData/allEditedAvailable"]));let u=(0,d.createCellSetFromRange)(t.range);!0!==s.value&&(u=(0,a.exceptProduct)(u,s.value));const m=e=>{const r=[];return(0,d.forEachRangeInSet)(u,(n=>{const s=e((0,o.sheetGridRange)(t.sheet,n),(e=>{u=(0,a.exceptProduct)(u,(0,d.createCellSetFromRange)(e))}),((e,t)=>{r.push([[e.row,e.col],t])}));return s.kind===i.ResultKind.Success&&s.value}))?(0,i.success)(r):(0,i.failure)((0,o.unavailable)(["getRangeData/extractData"]))},p={formulae:()=>m(((e,t,r)=>n.forEachEditedFormula(e,((e,{lexicalKind:n,compiledFmla:i,fmla:a,origin:s})=>(n!==o.LexicalKind.Range&&(0,o.isGridCell)(e)?(0,l.isBlankGridFormula)(a,void 0!==i)||r(e,{kind:void 0!==i?g.FormulaKind.CellFormula:g.FormulaKind.Value,formulaBarText:a,origin:(0,o.isGridCellEqual)(s,e)?void 0:s}):t(e),!0))))),formats:()=>m(((e,t,r)=>n.forEachEditedFormat(e,((e,n)=>(n===c.SpecialFormat.Unavailable?t(e):(0,l.isBlankCellFormat)(n)||r(e,"number"==typeof n?n:n.formatString),!0))))),values:()=>m(((e,t,r)=>n.forEachRecalcValue(e,((e,n)=>(void 0!==n.failure?t(e):(0,l.isBlankGridValue)(n.oper,n.failure)||r(e,n.oper),!0)))))}[r]();if(p.kind!==i.ResultKind.Success)return p;const h=[];return(0,d.forEachRangeInSet)(u,(e=>(h.push(e),!0))),(0,i.success)({nonEmptyCells:p.value,availableRanges:h})}async getIntersectingTables(e,t){const{snapshot:r}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===r)return(0,i.failure)((0,o.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]));const n=r.allServerAvailable(t);if(n.kind!==i.ResultKind.Success)return(0,i.failure)((0,o.unavailable)(["getIntersectingTables/allServerAvailable"]));const s=r.getIntersectingTables(t);if(!(0,i.isSuccess)(s))return(0,i.failure)((0,o.unavailable)(["getIntersectingTables/getIntersectingTables"]));const u=[];for(const e of s.value){const t=r.getNamedObject(e,o.NameSource.Plain);if(t.kind!==i.ResultKind.Success)return t;if("NamedTable"!==t.value?.kind)continue;const n=[];t.value.columnIndexes.forEach(((e,t)=>(n.push({column:e,name:t}),!0))),u.push({name:e.name,dataRange:t.value.specialRefRanges[o.SpecialRefId.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:n})}const l=(0,d.createCellSetFromRange)(t.range),c=!0===n.value?l:(0,a.exceptProduct)(l,n.value),m=[];return(0,d.forEachRangeInSet)(c,(e=>(m.push(e),!0))),(0,i.success)({tables:u,availableRanges:m})}async getIformats(e,t,r,n){const{snapshot:a}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};if(void 0===a)return(0,i.failure)((0,o.unavailable)(["getIformats/getOrCreateSnapshot"]));const s=a.getIformats(t,r,n);return(0,i.isSuccess)(s)?(0,i.success)({availableFormats:s.value}):(0,i.failure)((0,o.unavailable)(["getIformats/getIntersectingTables"]))}async getHiddenRows(e,t,r,n){const{snapshot:i}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};return void 0===i?l.hiddennessFullyUnavailable:i.getHiddenRows(t,r,n)}async getHiddenCols(e,t,r,n){const{snapshot:i}=await this.getOrCreateSnapshot(e)??{snapshot:void 0};return void 0===i?l.hiddennessFullyUnavailable:i.getHiddenCols(t,r,n)}constructor(e){this.calcGrid=e,this.snapshotPromises=[]}}},4579:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeUnavailableCellsStats=function(e){const t=(0,n.makeStringMap)(),r=(0,n.makeStringMap)();for(const n of e){const e=n.range;if(n.reason.kind===o.LangReasonKind.Unavailable)for(const u of n.reason.objects)u.kind===s.UnavailableKind.GridRange&&((0,o.isSheetIndexEqual)(u.range.sheet,e.sheet)?t[u.range.sheet.index]=(0,a.unionProduct)(t[u.range.sheet.index]??i.empty,!0!==u.unavailableCells?u.unavailableCells:i.empty):r[u.range.sheet.index]=(0,a.unionProduct)(r[u.range.sheet.index]??i.empty,!0!==u.unavailableCells?u.unavailableCells:i.empty))}let l=0,c=0,d=0;const m=(0,n.makeStringMap)();for(const e in t){const r=t[e]??i.empty;m[e]=(0,a.unionProduct)(m[e]??i.empty,r),(0,u.forEachRangeInSet)(r,(e=>(l+=e.rows*e.cols,!0)))}for(const e in r){const t=r[e]??i.empty;m[e]=(0,a.unionProduct)(m[e]??i.empty,t),(0,u.forEachRangeInSet)(t,(e=>(c+=e.rows*e.cols,!0)))}for(const e in m){const t=m[e]??i.empty;(0,u.forEachRangeInSet)(t,(e=>(d+=e.rows*e.cols,!0)))}return{numOfUnavailableCellsInTheSameSheet:l,numOfUnavailableCellsInDifferentSheet:c,totalNumOfUnavailableCells:d}};const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(9204),u=r(8453)},4352:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VolatileMode=t.ResettableLazy=void 0,t.asyncLazy=function(e){return new s(e)},t.getTimeImpl=function(e,t,r,s=u.Estimation,c=l){switch(s){case u.PrecisionTest:return(0,n.failure)((0,i.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case u.Estimation:switch(r){case a.GetTimeKind.NonVolatile:return(0,n.failure)((0,i.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case a.GetTimeKind.ValueCell:case a.GetTimeKind.Volatile:}case u.GroundTruth:}const{mathpack:d,datepack:m}=e,g=c(),p=m.utcToLocal(e,(0,i.dateTime)(g.getUTCFullYear(),g.getUTCMonth()+1,g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCDay()+1,g.getUTCMilliseconds(),i.Rounding.Round1000ths),e.timezone);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==p);const{yr:h,rounding:f}=p;let{mon:S,dom:v,hour:y,min:F,sec:b,fracSec:C}=p;t<i.TimeGranularity.Instant&&(C=0,b=0,F=0,y=0),t<i.TimeGranularity.Day&&(v=1,S=1);const k=(0,i.dateTime)(h,S,v,y,F,b,1,C,f),E=m.toNum(e,k);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,i.isErrorOper)(E));const A=d.toNumber(E);if(s===u.GroundTruth)return(0,n.success)(E);const T=m.toNum(e,p);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,i.isErrorOper)(T));const R=d.toNumber(T);let N;switch(t){case i.TimeGranularity.Instant:N=R;break;case i.TimeGranularity.Day:N=A+1;break;case i.TimeGranularity.Year:{const t=(0,i.dateTime)(h+1,S,v,y,F,b,1,C,f),r=m.toNum(e,t);(0,n.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,i.isErrorOper)(r)),N=d.toNumber(r);break}}const I=10/1440;return R<A+I||R>N-I?(0,n.failure)((0,i.unavailable)([{kind:o.UnavailableKind.TimeGranularity,granularity:t}])):(0,n.success)(E)};const n=r(6913),i=r(6592),a=r(1159),o=r(9204);class s{getValue(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value}force(){void 0===this.value&&(this.value=this.valueCreationFunc())}reset(){this.value=void 0}constructor(e){this.valueCreationFunc=e,this.value=void 0}}var u;t.ResettableLazy=s,function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(u||(t.VolatileMode=u={}));const l=()=>new Date},9132:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachProduct=t.exceptProduct=t.compareProduct=t.union=t.empty=t.dense=t.VolatileMode=t.registerExperimentFactory=t.ExperimentKind=t.incrementFailure=t.optChecker=t.oneOfChecker=t.objectChecker=t.check=t.chPossiblyInfiniteNumber=t.chFiniteNumber=t.chBoolean=t.arrayChecker=t.blankStyleValue=t.forEachRangeInSet=t.forEachCellInSet=t.createCellSetFromRange=t.bspFactory=t.namedTable=t.namedFormula=t.sheetInFilterMode=t.sheetHiddenRows=t.sheetCellSet=t.createSheetCellSetFromRange=t.UnavailableKind=t.SpecialStyle=t.SpecialFormat=t.OutputMessageKind=t.ComputedCellKind=t.ComputeKind=t.blankCellFormat=t.CloningTarget=t.isFailureOutputMessage=t.voidCallback=t.PartialWorkbookDocumentCollection=t.mathpack=t.locale=t.knownFormatData=t.genFmt=t.englishLocaleData=t.createRange=t.blankStyle=t.PartialWorkbook=t.UnitExperiment=t.makeGridRangeTable=void 0,t.unionProduct=t.project=t.meetsProduct=t.intersectProduct=void 0;const n=r(6913);var i=n.bspSet.empty;t.empty=i;var a=n.bspSet.dense;t.dense=a;var o=n.bspSet.union;t.union=o;var s=n.productSet.unionProduct;t.unionProduct=s;var u=n.productSet.meetsProduct;t.meetsProduct=u;var l=n.productSet.exceptProduct;t.exceptProduct=l;var c=n.productSet.intersectProduct;t.intersectProduct=c;var d=n.productSet.compareProduct;t.compareProduct=d;var m=n.productSet.project;t.project=m;var g=n.productSet.forEachProduct;t.forEachProduct=g;var p=r(6592);Object.defineProperty(t,"makeGridRangeTable",{enumerable:!0,get:function(){return p.makeGridRangeTable}});var h=r(780);Object.defineProperty(t,"UnitExperiment",{enumerable:!0,get:function(){return h.UnitExperiment}});var f=r(3804);Object.defineProperty(t,"PartialWorkbook",{enumerable:!0,get:function(){return f.PartialWorkbook}});var S=r(9399);Object.defineProperty(t,"blankStyle",{enumerable:!0,get:function(){return S.blankStyle}}),Object.defineProperty(t,"createRange",{enumerable:!0,get:function(){return S.createRange}}),Object.defineProperty(t,"englishLocaleData",{enumerable:!0,get:function(){return S.englishLocaleData}}),Object.defineProperty(t,"genFmt",{enumerable:!0,get:function(){return S.genFmt}}),Object.defineProperty(t,"knownFormatData",{enumerable:!0,get:function(){return S.knownFormatData}}),Object.defineProperty(t,"locale",{enumerable:!0,get:function(){return S.locale}}),Object.defineProperty(t,"mathpack",{enumerable:!0,get:function(){return S.mathpack}});var v=r(5677);Object.defineProperty(t,"PartialWorkbookDocumentCollection",{enumerable:!0,get:function(){return v.PartialWorkbookDocumentCollection}}),Object.defineProperty(t,"voidCallback",{enumerable:!0,get:function(){return v.voidCallback}});var y=r(7796);Object.defineProperty(t,"isFailureOutputMessage",{enumerable:!0,get:function(){return y.isFailureOutputMessage}});var F=r(6824);Object.defineProperty(t,"CloningTarget",{enumerable:!0,get:function(){return F.CloningTarget}}),Object.defineProperty(t,"blankCellFormat",{enumerable:!0,get:function(){return F.blankCellFormat}});var b=r(9204);Object.defineProperty(t,"ComputeKind",{enumerable:!0,get:function(){return b.ComputeKind}}),Object.defineProperty(t,"ComputedCellKind",{enumerable:!0,get:function(){return b.ComputedCellKind}}),Object.defineProperty(t,"OutputMessageKind",{enumerable:!0,get:function(){return b.OutputMessageKind}}),Object.defineProperty(t,"SpecialFormat",{enumerable:!0,get:function(){return b.SpecialFormat}}),Object.defineProperty(t,"SpecialStyle",{enumerable:!0,get:function(){return b.SpecialStyle}}),Object.defineProperty(t,"UnavailableKind",{enumerable:!0,get:function(){return b.UnavailableKind}}),Object.defineProperty(t,"createSheetCellSetFromRange",{enumerable:!0,get:function(){return b.createSheetCellSetFromRange}}),Object.defineProperty(t,"sheetCellSet",{enumerable:!0,get:function(){return b.sheetCellSet}}),Object.defineProperty(t,"sheetHiddenRows",{enumerable:!0,get:function(){return b.sheetHiddenRows}}),Object.defineProperty(t,"sheetInFilterMode",{enumerable:!0,get:function(){return b.sheetInFilterMode}});var C=r(7214);Object.defineProperty(t,"namedFormula",{enumerable:!0,get:function(){return C.namedFormula}}),Object.defineProperty(t,"namedTable",{enumerable:!0,get:function(){return C.namedTable}});var k=r(8453);Object.defineProperty(t,"bspFactory",{enumerable:!0,get:function(){return k.bspFactory}}),Object.defineProperty(t,"createCellSetFromRange",{enumerable:!0,get:function(){return k.createCellSetFromRange}}),Object.defineProperty(t,"forEachCellInSet",{enumerable:!0,get:function(){return k.forEachCellInSet}}),Object.defineProperty(t,"forEachRangeInSet",{enumerable:!0,get:function(){return k.forEachRangeInSet}});var E=r(362);Object.defineProperty(t,"blankStyleValue",{enumerable:!0,get:function(){return E.blankStyleValue}});var A=r(8328);Object.defineProperty(t,"arrayChecker",{enumerable:!0,get:function(){return A.arrayChecker}}),Object.defineProperty(t,"chBoolean",{enumerable:!0,get:function(){return A.chBoolean}}),Object.defineProperty(t,"chFiniteNumber",{enumerable:!0,get:function(){return A.chFiniteNumber}}),Object.defineProperty(t,"chPossiblyInfiniteNumber",{enumerable:!0,get:function(){return A.chPossiblyInfiniteNumber}}),Object.defineProperty(t,"check",{enumerable:!0,get:function(){return A.check}}),Object.defineProperty(t,"objectChecker",{enumerable:!0,get:function(){return A.objectChecker}}),Object.defineProperty(t,"oneOfChecker",{enumerable:!0,get:function(){return A.oneOfChecker}}),Object.defineProperty(t,"optChecker",{enumerable:!0,get:function(){return A.optChecker}});var T=r(7755);Object.defineProperty(t,"incrementFailure",{enumerable:!0,get:function(){return T.incrementFailure}});var R=r(3340);Object.defineProperty(t,"ExperimentKind",{enumerable:!0,get:function(){return R.ExperimentKind}}),Object.defineProperty(t,"registerExperimentFactory",{enumerable:!0,get:function(){return R.registerExperimentFactory}});var N=r(4352);Object.defineProperty(t,"VolatileMode",{enumerable:!0,get:function(){return N.VolatileMode}})},8263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.columnData=t.namedTableData=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.internal=t.RecalcServiceDataTransformer=t.getTime=t.recalcServiceInsideInit=t.readOperToCellValue=t.cellValueToReadOper=t.localeInfoFromData=t.RecalcServiceCreateMode=t.createRecalcService=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.evalFormulaData=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;const n=r(6533);var i=r(721);Object.defineProperty(t,"worksheetFunctionName",{enumerable:!0,get:function(){return i.worksheetFunctionName}}),Object.defineProperty(t,"errorTypeName",{enumerable:!0,get:function(){return i.errorTypeName}}),Object.defineProperty(t,"localeData",{enumerable:!0,get:function(){return i.localeData}}),Object.defineProperty(t,"numberFormat",{enumerable:!0,get:function(){return i.numberFormat}}),Object.defineProperty(t,"sheetName",{enumerable:!0,get:function(){return i.sheetName}}),Object.defineProperty(t,"blankValue",{enumerable:!0,get:function(){return i.blankValue}}),Object.defineProperty(t,"errorValue",{enumerable:!0,get:function(){return i.errorValue}}),Object.defineProperty(t,"richValue",{enumerable:!0,get:function(){return i.richValue}}),Object.defineProperty(t,"getCellValueKind",{enumerable:!0,get:function(){return i.getCellValueKind}}),Object.defineProperty(t,"getCellFormatKind",{enumerable:!0,get:function(){return i.getCellFormatKind}}),Object.defineProperty(t,"cellLocation",{enumerable:!0,get:function(){return i.cellLocation}}),Object.defineProperty(t,"rangeLocation",{enumerable:!0,get:function(){return i.rangeLocation}}),Object.defineProperty(t,"sheetRangeLocation",{enumerable:!0,get:function(){return i.sheetRangeLocation}}),Object.defineProperty(t,"sheetCellLocation",{enumerable:!0,get:function(){return i.sheetCellLocation}}),Object.defineProperty(t,"cellData",{enumerable:!0,get:function(){return i.cellData}}),Object.defineProperty(t,"cellFormulaCellData",{enumerable:!0,get:function(){return i.cellFormulaCellData}}),Object.defineProperty(t,"arrayFormulaCellData",{enumerable:!0,get:function(){return i.arrayFormulaCellData}}),Object.defineProperty(t,"valueCellData",{enumerable:!0,get:function(){return i.valueCellData}}),Object.defineProperty(t,"rangeUpdate",{enumerable:!0,get:function(){return i.rangeUpdate}}),Object.defineProperty(t,"rangeWrite",{enumerable:!0,get:function(){return i.rangeWrite}}),Object.defineProperty(t,"rangePromote",{enumerable:!0,get:function(){return i.rangePromote}}),Object.defineProperty(t,"arrayData",{enumerable:!0,get:function(){return i.arrayData}}),Object.defineProperty(t,"arrayUpdate",{enumerable:!0,get:function(){return i.arrayUpdate}}),Object.defineProperty(t,"arrayWrite",{enumerable:!0,get:function(){return i.arrayWrite}}),Object.defineProperty(t,"arrayPromote",{enumerable:!0,get:function(){return i.arrayPromote}}),Object.defineProperty(t,"unusedCellsUpdate",{enumerable:!0,get:function(){return i.unusedCellsUpdate}}),Object.defineProperty(t,"namedValueData",{enumerable:!0,get:function(){return i.namedValueData}}),Object.defineProperty(t,"namedFormulaData",{enumerable:!0,get:function(){return i.namedFormulaData}}),Object.defineProperty(t,"namedRangeData",{enumerable:!0,get:function(){return i.namedRangeData}}),Object.defineProperty(t,"namedFailureData",{enumerable:!0,get:function(){return i.namedFailureData}}),Object.defineProperty(t,"namedObject",{enumerable:!0,get:function(){return i.namedObject}}),Object.defineProperty(t,"namedObjectsUpdate",{enumerable:!0,get:function(){return i.namedObjectsUpdate}}),Object.defineProperty(t,"namedObjectsWrite",{enumerable:!0,get:function(){return i.namedObjectsWrite}}),Object.defineProperty(t,"undefinedNamesWrite",{enumerable:!0,get:function(){return i.undefinedNamesWrite}}),Object.defineProperty(t,"namedObjectsPromote",{enumerable:!0,get:function(){return i.namedObjectsPromote}}),Object.defineProperty(t,"namedTableData",{enumerable:!0,get:function(){return i.namedTableData}}),Object.defineProperty(t,"columnData",{enumerable:!0,get:function(){return i.columnData}}),Object.defineProperty(t,"rangeFormulaEdit",{enumerable:!0,get:function(){return i.rangeFormulaEdit}}),Object.defineProperty(t,"cellFormulaRangeFormulaEdit",{enumerable:!0,get:function(){return i.cellFormulaRangeFormulaEdit}}),Object.defineProperty(t,"valueRangeFormulaEdit",{enumerable:!0,get:function(){return i.valueRangeFormulaEdit}}),Object.defineProperty(t,"inferredRangeFormulaEdit",{enumerable:!0,get:function(){return i.inferredRangeFormulaEdit}}),Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return i.RibbonFormat}}),Object.defineProperty(t,"formatEditOperation",{enumerable:!0,get:function(){return i.formatEditOperation}}),Object.defineProperty(t,"formatEditSetFormat",{enumerable:!0,get:function(){return i.formatEditSetFormat}}),Object.defineProperty(t,"formatEditRibbonFormat",{enumerable:!0,get:function(){return i.formatEditRibbonFormat}}),Object.defineProperty(t,"formatEditChangeDecimals",{enumerable:!0,get:function(){return i.formatEditChangeDecimals}}),Object.defineProperty(t,"rangeFormatEdit",{enumerable:!0,get:function(){return i.rangeFormatEdit}}),Object.defineProperty(t,"arrayFormulaEdit",{enumerable:!0,get:function(){return i.arrayFormulaEdit}}),Object.defineProperty(t,"rangePasteEdit",{enumerable:!0,get:function(){return i.rangePasteEdit}}),Object.defineProperty(t,"copyPasteRangePasteEdit",{enumerable:!0,get:function(){return i.copyPasteRangePasteEdit}}),Object.defineProperty(t,"inferredFormat",{enumerable:!0,get:function(){return i.inferredFormat}}),Object.defineProperty(t,"cellDataDelta",{enumerable:!0,get:function(){return i.cellDataDelta}}),Object.defineProperty(t,"rangeDelta",{enumerable:!0,get:function(){return i.rangeDelta}}),Object.defineProperty(t,"arrayDelta",{enumerable:!0,get:function(){return i.arrayDelta}}),Object.defineProperty(t,"rangeFailure",{enumerable:!0,get:function(){return i.rangeFailure}}),Object.defineProperty(t,"recalcResults",{enumerable:!0,get:function(){return i.recalcResults}}),Object.defineProperty(t,"evalFormulaData",{enumerable:!0,get:function(){return i.evalFormulaData}}),Object.defineProperty(t,"evalFormulaFormat",{enumerable:!0,get:function(){return i.evalFormulaFormat}}),Object.defineProperty(t,"evalFormulaFormatOrigin",{enumerable:!0,get:function(){return i.evalFormulaFormatOrigin}}),Object.defineProperty(t,"evalFormulaFormatIformat",{enumerable:!0,get:function(){return i.evalFormulaFormatIformat}}),Object.defineProperty(t,"evalFormulaFormatKnown",{enumerable:!0,get:function(){return i.evalFormulaFormatKnown}}),Object.defineProperty(t,"evalFormulaFormatInferred",{enumerable:!0,get:function(){return i.evalFormulaFormatInferred}}),Object.defineProperty(t,"evalFormulaFormatAggregate",{enumerable:!0,get:function(){return i.evalFormulaFormatAggregate}}),Object.defineProperty(t,"updateRequest",{enumerable:!0,get:function(){return i.updateRequest}}),Object.defineProperty(t,"runExperiment",{enumerable:!0,get:function(){return i.runExperiment}}),Object.defineProperty(t,"recalcServiceConfig",{enumerable:!0,get:function(){return i.recalcServiceConfig}}),Object.defineProperty(t,"workbookProps",{enumerable:!0,get:function(){return i.workbookProps}});var a=r(7450);Object.defineProperty(t,"createRecalcService",{enumerable:!0,get:function(){return a.createRecalcService}});var o=r(721);Object.defineProperty(t,"RecalcServiceCreateMode",{enumerable:!0,get:function(){return o.RecalcServiceCreateMode}});var s=r(3313);Object.defineProperty(t,"localeInfoFromData",{enumerable:!0,get:function(){return s.localeInfoFromData}});var u=r(3313);Object.defineProperty(t,"cellValueToReadOper",{enumerable:!0,get:function(){return u.cellValueToReadOper}}),Object.defineProperty(t,"readOperToCellValue",{enumerable:!0,get:function(){return u.readOperToCellValue}});var l=r(6766);Object.defineProperty(t,"recalcServiceInsideInit",{enumerable:!0,get:function(){return l.recalcServiceInsideInit}});var c=r(4352);Object.defineProperty(t,"getTime",{enumerable:!0,get:function(){return c.getTimeImpl}});var d=r(7755);Object.defineProperty(t,"RecalcServiceDataTransformer",{enumerable:!0,get:function(){return d.RecalcServiceDataTransformer}}),t.internal=n.__importStar(r(9132))},8698:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExcelOnlineCalcNewPackagesNames=function(){return l};const n=r(6913),i=r(6592),a=r(1159),o=r(1764),s=r(1475),u=r(391),l=`${n.PackageName}, ${i.PackageName},\n  ${u.PackageName}, ${a.PackageName}, ${s.PackageName}, ${o.PackageName}`},5779:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pair=t.ResultKind=t.arrayFill=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.messageFromError=t.assertIndex=t.assertPositiveInteger=t.assertPositiveLength=t.assertFalse=t.assertTrue=t.assertNatural=t.assertNever=t.Pledge=t.JSF32=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.now=t.makeStringMap=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.numEnumMap=t.numEnumArray=t.identity=t.fastAbs=t.fastMax=t.fastMin=void 0;var n=r(6913);Object.defineProperty(t,"fastMin",{enumerable:!0,get:function(){return n.fastMin}}),Object.defineProperty(t,"fastMax",{enumerable:!0,get:function(){return n.fastMax}}),Object.defineProperty(t,"fastAbs",{enumerable:!0,get:function(){return n.fastAbs}}),Object.defineProperty(t,"identity",{enumerable:!0,get:function(){return n.identity}}),Object.defineProperty(t,"numEnumArray",{enumerable:!0,get:function(){return n.numEnumArray}}),Object.defineProperty(t,"numEnumMap",{enumerable:!0,get:function(){return n.numEnumMap}}),Object.defineProperty(t,"safePush",{enumerable:!0,get:function(){return n.safePush}}),Object.defineProperty(t,"safeConcat",{enumerable:!0,get:function(){return n.safeConcat}}),Object.defineProperty(t,"isDefined",{enumerable:!0,get:function(){return n.isDefined}}),Object.defineProperty(t,"isNone",{enumerable:!0,get:function(){return n.isNone}}),Object.defineProperty(t,"makeStringMap",{enumerable:!0,get:function(){return n.makeStringMap}}),Object.defineProperty(t,"now",{enumerable:!0,get:function(){return n.now}}),Object.defineProperty(t,"staticAssertExtends",{enumerable:!0,get:function(){return n.staticAssertExtends}}),Object.defineProperty(t,"staticAssertSame",{enumerable:!0,get:function(){return n.staticAssertSame}}),Object.defineProperty(t,"staticAssertIs",{enumerable:!0,get:function(){return n.staticAssertIs}}),Object.defineProperty(t,"staticAssertIsOptional",{enumerable:!0,get:function(){return n.staticAssertIsOptional}}),Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return n.JSF32}}),Object.defineProperty(t,"Pledge",{enumerable:!0,get:function(){return n.Pledge}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return n.assertNever}}),Object.defineProperty(t,"assertNatural",{enumerable:!0,get:function(){return n.assertNatural}}),Object.defineProperty(t,"assertTrue",{enumerable:!0,get:function(){return n.assertTrue}}),Object.defineProperty(t,"assertFalse",{enumerable:!0,get:function(){return n.assertFalse}}),Object.defineProperty(t,"assertPositiveLength",{enumerable:!0,get:function(){return n.assertPositiveLength}}),Object.defineProperty(t,"assertPositiveInteger",{enumerable:!0,get:function(){return n.assertPositiveInteger}}),Object.defineProperty(t,"assertIndex",{enumerable:!0,get:function(){return n.assertIndex}}),Object.defineProperty(t,"messageFromError",{enumerable:!0,get:function(){return n.messageFromError}}),Object.defineProperty(t,"isInteger",{enumerable:!0,get:function(){return n.isInteger}}),Object.defineProperty(t,"stringStartsWith",{enumerable:!0,get:function(){return n.stringStartsWith}}),Object.defineProperty(t,"stringEndsWith",{enumerable:!0,get:function(){return n.stringEndsWith}}),Object.defineProperty(t,"arrayFill",{enumerable:!0,get:function(){return n.arrayFill}}),Object.defineProperty(t,"ResultKind",{enumerable:!0,get:function(){return n.ResultKind}}),Object.defineProperty(t,"pair",{enumerable:!0,get:function(){return n.pair}})},7433:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.calcConfig=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.Country=t.LCID=t.localeInfo=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=t.makeStringCompareCI=t.FeatureName=t.getCalcAbsUrl=t.isCalcInit=t.initCalc=void 0;var n=r(6913);Object.defineProperty(t,"initCalc",{enumerable:!0,get:function(){return n.initCalc}}),Object.defineProperty(t,"isCalcInit",{enumerable:!0,get:function(){return n.isCalcInit}}),Object.defineProperty(t,"getCalcAbsUrl",{enumerable:!0,get:function(){return n.getCalcAbsUrl}}),Object.defineProperty(t,"FeatureName",{enumerable:!0,get:function(){return n.FeatureName}}),Object.defineProperty(t,"makeStringCompareCI",{enumerable:!0,get:function(){return n.makeStringCompareCI}});var i=r(6592);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return i.ulsLogger}}),Object.defineProperty(t,"localeInfo",{enumerable:!0,get:function(){return i.localeInfo}}),Object.defineProperty(t,"LCID",{enumerable:!0,get:function(){return i.LCID}}),Object.defineProperty(t,"Country",{enumerable:!0,get:function(){return i.Country}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return i.PictureSpecial}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return i.PictureSingle}}),Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return i.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return i.PictureDbnum}}),Object.defineProperty(t,"calcConfig",{enumerable:!0,get:function(){return i.calcConfig}}),Object.defineProperty(t,"getEnglishLocaleInfo",{enumerable:!0,get:function(){return i.getEnglishLocaleInfo}}),Object.defineProperty(t,"englishWorksheetFuncIdToName",{enumerable:!0,get:function(){return i.englishWorksheetFuncIdToName}}),Object.defineProperty(t,"englishErrorTypeToName",{enumerable:!0,get:function(){return i.englishErrorTypeToName}}),Object.defineProperty(t,"englishOperatorIdToName",{enumerable:!0,get:function(){return i.englishOperatorIdToName}}),Object.defineProperty(t,"operatorIdToName",{enumerable:!0,get:function(){return i.operatorIdToName}}),Object.defineProperty(t,"createWorksheetFuncNameCallbacks",{enumerable:!0,get:function(){return i.createWorksheetFuncNameCallbacks}}),Object.defineProperty(t,"createIsThousandsPositionCallback",{enumerable:!0,get:function(){return i.createIsThousandsPositionCallback}})},224:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.dateTime=t.tzUTC=t.tzData=t.Rounding=t.TimeDivision=void 0;var n=r(6592);Object.defineProperty(t,"TimeDivision",{enumerable:!0,get:function(){return n.TimeDivision}}),Object.defineProperty(t,"Rounding",{enumerable:!0,get:function(){return n.Rounding}}),Object.defineProperty(t,"tzData",{enumerable:!0,get:function(){return n.tzData}}),Object.defineProperty(t,"tzUTC",{enumerable:!0,get:function(){return n.tzUTC}}),Object.defineProperty(t,"dateTime",{enumerable:!0,get:function(){return n.dateTime}}),Object.defineProperty(t,"TimeGranularity",{enumerable:!0,get:function(){return n.TimeGranularity}}),Object.defineProperty(t,"xlDatepack",{enumerable:!0,get:function(){return n.xlDatepack}})},5874:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contextNameNode=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaRootAnnotation=t.appHeadNameAnnotation=t.AnnotationKind=t.headNamePart=t.flattenNameParts=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.varNode=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=void 0;var n=r(6592);Object.defineProperty(t,"RefStyle",{enumerable:!0,get:function(){return n.RefStyle}}),Object.defineProperty(t,"SyntaxFeature",{enumerable:!0,get:function(){return n.SyntaxFeature}}),Object.defineProperty(t,"QualifierKind",{enumerable:!0,get:function(){return n.QualifierKind}}),Object.defineProperty(t,"CellRefKind",{enumerable:!0,get:function(){return n.CellRefKind}}),Object.defineProperty(t,"PosKind",{enumerable:!0,get:function(){return n.PosKind}}),Object.defineProperty(t,"CommentKind",{enumerable:!0,get:function(){return n.CommentKind}}),Object.defineProperty(t,"NodeKind",{enumerable:!0,get:function(){return n.NodeKind}}),Object.defineProperty(t,"NamePartKind",{enumerable:!0,get:function(){return n.NamePartKind}}),Object.defineProperty(t,"SpecialRefId",{enumerable:!0,get:function(){return n.SpecialRefId}}),Object.defineProperty(t,"StructRefKind",{enumerable:!0,get:function(){return n.StructRefKind}}),Object.defineProperty(t,"BadType",{enumerable:!0,get:function(){return n.BadType}}),Object.defineProperty(t,"errorQualifier",{enumerable:!0,get:function(){return n.errorQualifier}}),Object.defineProperty(t,"relativeQualifier",{enumerable:!0,get:function(){return n.relativeQualifier}}),Object.defineProperty(t,"documentQualifier",{enumerable:!0,get:function(){return n.documentQualifier}}),Object.defineProperty(t,"sheetQualifier",{enumerable:!0,get:function(){return n.sheetQualifier}}),Object.defineProperty(t,"identQualifier",{enumerable:!0,get:function(){return n.identQualifier}}),Object.defineProperty(t,"sheetRangeQualifier",{enumerable:!0,get:function(){return n.sheetRangeQualifier}}),Object.defineProperty(t,"badQualifier",{enumerable:!0,get:function(){return n.badQualifier}}),Object.defineProperty(t,"pos",{enumerable:!0,get:function(){return n.pos}}),Object.defineProperty(t,"cellRefError",{enumerable:!0,get:function(){return n.cellRefError}}),Object.defineProperty(t,"cellRefSingle",{enumerable:!0,get:function(){return n.cellRefSingle}}),Object.defineProperty(t,"cellRefRange",{enumerable:!0,get:function(){return n.cellRefRange}}),Object.defineProperty(t,"cellRefRow",{enumerable:!0,get:function(){return n.cellRefRow}}),Object.defineProperty(t,"cellRefCol",{enumerable:!0,get:function(){return n.cellRefCol}}),Object.defineProperty(t,"cellRefBad",{enumerable:!0,get:function(){return n.cellRefBad}}),Object.defineProperty(t,"formula",{enumerable:!0,get:function(){return n.formula}}),Object.defineProperty(t,"multiLineComment",{enumerable:!0,get:function(){return n.multiLineComment}}),Object.defineProperty(t,"singleLineComment",{enumerable:!0,get:function(){return n.singleLineComment}}),Object.defineProperty(t,"formulaSpan",{enumerable:!0,get:function(){return n.formulaSpan}}),Object.defineProperty(t,"literalNode",{enumerable:!0,get:function(){return n.literalNode}}),Object.defineProperty(t,"arrayNode",{enumerable:!0,get:function(){return n.arrayNode}}),Object.defineProperty(t,"appNode",{enumerable:!0,get:function(){return n.appNode}}),Object.defineProperty(t,"flattenLetArgs",{enumerable:!0,get:function(){return n.flattenLetArgs}}),Object.defineProperty(t,"indexedArg",{enumerable:!0,get:function(){return n.indexedArg}}),Object.defineProperty(t,"letVar",{enumerable:!0,get:function(){return n.letVar}}),Object.defineProperty(t,"letNode",{enumerable:!0,get:function(){return n.letNode}}),Object.defineProperty(t,"flattenLambdaArgs",{enumerable:!0,get:function(){return n.flattenLambdaArgs}}),Object.defineProperty(t,"paramName",{enumerable:!0,get:function(){return n.paramName}}),Object.defineProperty(t,"paramDefault",{enumerable:!0,get:function(){return n.paramDefault}}),Object.defineProperty(t,"paramNode",{enumerable:!0,get:function(){return n.paramNode}}),Object.defineProperty(t,"lambdaParam",{enumerable:!0,get:function(){return n.lambdaParam}}),Object.defineProperty(t,"lambdaNode",{enumerable:!0,get:function(){return n.lambdaNode}}),Object.defineProperty(t,"operatorNode",{enumerable:!0,get:function(){return n.operatorNode}}),Object.defineProperty(t,"wsfNode",{enumerable:!0,get:function(){return n.wsfNode}}),Object.defineProperty(t,"parenNode",{enumerable:!0,get:function(){return n.parenNode}}),Object.defineProperty(t,"nameNode",{enumerable:!0,get:function(){return n.nameNode}}),Object.defineProperty(t,"identNamePart",{enumerable:!0,get:function(){return n.identNamePart}}),Object.defineProperty(t,"cellRefNamePart",{enumerable:!0,get:function(){return n.cellRefNamePart}}),Object.defineProperty(t,"fieldRefNamePart",{enumerable:!0,get:function(){return n.fieldRefNamePart}}),Object.defineProperty(t,"contextNameNode",{enumerable:!0,get:function(){return n.contextNameNode}}),Object.defineProperty(t,"cellRefNode",{enumerable:!0,get:function(){return n.cellRefNode}}),Object.defineProperty(t,"fieldRefNode",{enumerable:!0,get:function(){return n.fieldRefNode}}),Object.defineProperty(t,"fieldRef",{enumerable:!0,get:function(){return n.fieldRef}}),Object.defineProperty(t,"structRefNode",{enumerable:!0,get:function(){return n.structRefNode}}),Object.defineProperty(t,"structRef",{enumerable:!0,get:function(){return n.structRef}}),Object.defineProperty(t,"specialRef",{enumerable:!0,get:function(){return n.specialRef}}),Object.defineProperty(t,"columnRef",{enumerable:!0,get:function(){return n.columnRef}}),Object.defineProperty(t,"rangeOpRef",{enumerable:!0,get:function(){return n.rangeOpRef}}),Object.defineProperty(t,"commaOpRef",{enumerable:!0,get:function(){return n.commaOpRef}}),Object.defineProperty(t,"thisRowOpRef",{enumerable:!0,get:function(){return n.thisRowOpRef}}),Object.defineProperty(t,"missingRef",{enumerable:!0,get:function(){return n.missingRef}}),Object.defineProperty(t,"badRef",{enumerable:!0,get:function(){return n.badRef}}),Object.defineProperty(t,"varNode",{enumerable:!0,get:function(){return n.varNode}}),Object.defineProperty(t,"identNode",{enumerable:!0,get:function(){return n.identNode}}),Object.defineProperty(t,"missingNode",{enumerable:!0,get:function(){return n.missingNode}}),Object.defineProperty(t,"badCharsNode",{enumerable:!0,get:function(){return n.badCharsNode}}),Object.defineProperty(t,"badSequenceNode",{enumerable:!0,get:function(){return n.badSequenceNode}}),Object.defineProperty(t,"flattenNameParts",{enumerable:!0,get:function(){return n.flattenNameParts}}),Object.defineProperty(t,"headNamePart",{enumerable:!0,get:function(){return n.headNamePart}}),Object.defineProperty(t,"AnnotationKind",{enumerable:!0,get:function(){return n.AnnotationKind}}),Object.defineProperty(t,"appHeadNameAnnotation",{enumerable:!0,get:function(){return n.appHeadNameAnnotation}}),Object.defineProperty(t,"formulaRootAnnotation",{enumerable:!0,get:function(){return n.formulaRootAnnotation}}),Object.defineProperty(t,"localNameUseAnnotation",{enumerable:!0,get:function(){return n.localNameUseAnnotation}}),Object.defineProperty(t,"localNameDeclAnnotation",{enumerable:!0,get:function(){return n.localNameDeclAnnotation}})},2333:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=void 0;var n=r(1475);Object.defineProperty(t,"getWorksheetFunc",{enumerable:!0,get:function(){return n.getWorksheetFunc}}),Object.defineProperty(t,"nextFuncs",{enumerable:!0,get:function(){return n.nextFuncs}})},896:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="67.11.8"},3693:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.nameScope=t.nameLoc=t.documentScope=t.originCell=t.sheetGridCube=t.sheetGridRange=t.sheetGridCell=t.sheetRangeIndexes=t.allSheetsRange=t.gridRange=t.gridCell=t.sheetRange=t.sheetIndex=t.structRefColumnLoc=t.documentLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.sheetCols=t.sheetRows=t.NameSource=t.LexicalKind=void 0;var n=r(6592);Object.defineProperty(t,"LexicalKind",{enumerable:!0,get:function(){return n.LexicalKind}}),Object.defineProperty(t,"NameSource",{enumerable:!0,get:function(){return n.NameSource}}),Object.defineProperty(t,"sheetRows",{enumerable:!0,get:function(){return n.sheetRows}}),Object.defineProperty(t,"sheetCols",{enumerable:!0,get:function(){return n.sheetCols}}),Object.defineProperty(t,"lexicalSourceCell",{enumerable:!0,get:function(){return n.lexicalSourceCell}}),Object.defineProperty(t,"lexicalSourceRange",{enumerable:!0,get:function(){return n.lexicalSourceRange}}),Object.defineProperty(t,"lexicalSourceGrid",{enumerable:!0,get:function(){return n.lexicalSourceGrid}}),Object.defineProperty(t,"lexicalSourceName",{enumerable:!0,get:function(){return n.lexicalSourceName}}),Object.defineProperty(t,"lexicalSourceWSF",{enumerable:!0,get:function(){return n.lexicalSourceWSF}}),Object.defineProperty(t,"lexicalSourceUDF",{enumerable:!0,get:function(){return n.lexicalSourceUDF}}),Object.defineProperty(t,"documentLoc",{enumerable:!0,get:function(){return n.documentLoc}}),Object.defineProperty(t,"structRefColumnLoc",{enumerable:!0,get:function(){return n.structRefColumnLoc}}),Object.defineProperty(t,"sheetIndex",{enumerable:!0,get:function(){return n.sheetIndex}}),Object.defineProperty(t,"sheetRange",{enumerable:!0,get:function(){return n.sheetRange}}),Object.defineProperty(t,"gridCell",{enumerable:!0,get:function(){return n.gridCell}}),Object.defineProperty(t,"gridRange",{enumerable:!0,get:function(){return n.gridRange}}),Object.defineProperty(t,"allSheetsRange",{enumerable:!0,get:function(){return n.allSheetsRange}}),Object.defineProperty(t,"sheetRangeIndexes",{enumerable:!0,get:function(){return n.sheetRangeIndexes}}),Object.defineProperty(t,"sheetGridCell",{enumerable:!0,get:function(){return n.sheetGridCell}}),Object.defineProperty(t,"sheetGridRange",{enumerable:!0,get:function(){return n.sheetGridRange}}),Object.defineProperty(t,"sheetGridCube",{enumerable:!0,get:function(){return n.sheetGridCube}}),Object.defineProperty(t,"originCell",{enumerable:!0,get:function(){return n.originCell}}),Object.defineProperty(t,"documentScope",{enumerable:!0,get:function(){return n.documentScope}}),Object.defineProperty(t,"nameLoc",{enumerable:!0,get:function(){return n.nameLoc}}),Object.defineProperty(t,"nameScope",{enumerable:!0,get:function(){return n.nameScope}}),Object.defineProperty(t,"userDefinedFuncLoc",{enumerable:!0,get:function(){return n.userDefinedFuncLoc}})},3622:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.xlMathpack=t.ieeeMathpack=t.numberComponents=void 0;var n=r(6592);Object.defineProperty(t,"numberComponents",{enumerable:!0,get:function(){return n.numberComponents}}),Object.defineProperty(t,"ieeeMathpack",{enumerable:!0,get:function(){return n.ieeeMathpack}}),Object.defineProperty(t,"xlMathpack",{enumerable:!0,get:function(){return n.xlMathpack}}),Object.defineProperty(t,"formatScientificLeft",{enumerable:!0,get:function(){return n.formatScientificLeft}})},5753:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.hashesValue=t.renderedValue=t.formattedValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.fractionOverflow=t.dateOverflow=t.aggregationError=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=t.KnownFormat=void 0,t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.createNumberFormatter=t.shouldInstallFormat=t.getRibbonFormat=t.RibbonFormat=void 0;var n=r(6592);Object.defineProperty(t,"KnownFormat",{enumerable:!0,get:function(){return n.KnownFormat}}),Object.defineProperty(t,"CurrencyFormat",{enumerable:!0,get:function(){return n.CurrencyFormat}}),Object.defineProperty(t,"DateOrder",{enumerable:!0,get:function(){return n.DateOrder}}),Object.defineProperty(t,"NumberShape",{enumerable:!0,get:function(){return n.NumberShape}}),Object.defineProperty(t,"Calendar",{enumerable:!0,get:function(){return n.Calendar}});var i=r(1159);Object.defineProperty(t,"FormatReasonKind",{enumerable:!0,get:function(){return i.FormatReasonKind}}),Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return i.ReasonKind}}),Object.defineProperty(t,"notValueString",{enumerable:!0,get:function(){return i.notValueString}}),Object.defineProperty(t,"notFormatString",{enumerable:!0,get:function(){return i.notFormatString}}),Object.defineProperty(t,"noFormatPart",{enumerable:!0,get:function(){return i.noFormatPart}}),Object.defineProperty(t,"tooWide",{enumerable:!0,get:function(){return i.tooWide}}),Object.defineProperty(t,"aggregationError",{enumerable:!0,get:function(){return i.aggregationError}}),Object.defineProperty(t,"dateOverflow",{enumerable:!0,get:function(){return i.dateOverflow}}),Object.defineProperty(t,"fractionOverflow",{enumerable:!0,get:function(){return i.fractionOverflow}}),Object.defineProperty(t,"previousFormatFailure",{enumerable:!0,get:function(){return i.previousFormatFailure}}),Object.defineProperty(t,"FormatLocKind",{enumerable:!0,get:function(){return i.FormatLocKind}}),Object.defineProperty(t,"formatLocKnownFormat",{enumerable:!0,get:function(){return i.formatLocKnownFormat}}),Object.defineProperty(t,"formatLocIFormat",{enumerable:!0,get:function(){return i.formatLocIFormat}}),Object.defineProperty(t,"FormatValueType",{enumerable:!0,get:function(){return i.FormatValueType}}),Object.defineProperty(t,"BidiDate",{enumerable:!0,get:function(){return i.BidiDate}}),Object.defineProperty(t,"CultureTag",{enumerable:!0,get:function(){return i.CultureTag}}),Object.defineProperty(t,"FormatCurrency",{enumerable:!0,get:function(){return i.FormatCurrency}}),Object.defineProperty(t,"NamedColor",{enumerable:!0,get:function(){return i.NamedColor}}),Object.defineProperty(t,"Alignment",{enumerable:!0,get:function(){return i.Alignment}}),Object.defineProperty(t,"GetTimeKind",{enumerable:!0,get:function(){return i.GetTimeKind}}),Object.defineProperty(t,"Clip",{enumerable:!0,get:function(){return i.Clip}}),Object.defineProperty(t,"FormattedUnitKind",{enumerable:!0,get:function(){return i.FormattedUnitKind}}),Object.defineProperty(t,"formattedUnitGeneral",{enumerable:!0,get:function(){return i.formattedUnitGeneral}}),Object.defineProperty(t,"formattedUnitString",{enumerable:!0,get:function(){return i.formattedUnitString}}),Object.defineProperty(t,"formattedUnitBlank",{enumerable:!0,get:function(){return i.formattedUnitBlank}}),Object.defineProperty(t,"formattedUnitFlexible",{enumerable:!0,get:function(){return i.formattedUnitFlexible}}),Object.defineProperty(t,"formattedValue",{enumerable:!0,get:function(){return i.formattedValue}}),Object.defineProperty(t,"renderedValue",{enumerable:!0,get:function(){return i.renderedValue}}),Object.defineProperty(t,"hashesValue",{enumerable:!0,get:function(){return i.hashesValue}}),Object.defineProperty(t,"isHashesValue",{enumerable:!0,get:function(){return i.isHashesValue}}),Object.defineProperty(t,"renderCallback",{enumerable:!0,get:function(){return i.renderCallback}}),Object.defineProperty(t,"memoizedRenderCallback",{enumerable:!0,get:function(){return i.memoizedRenderCallback}}),Object.defineProperty(t,"renderInfiniteWidth",{enumerable:!0,get:function(){return i.renderInfiniteWidth}}),Object.defineProperty(t,"renderedValueToString",{enumerable:!0,get:function(){return i.renderedValueToString}}),Object.defineProperty(t,"EditKind",{enumerable:!0,get:function(){return i.EditKind}}),Object.defineProperty(t,"formulaEdit",{enumerable:!0,get:function(){return i.formulaEdit}}),Object.defineProperty(t,"stringEdit",{enumerable:!0,get:function(){return i.stringEdit}}),Object.defineProperty(t,"numberEdit",{enumerable:!0,get:function(){return i.numberEdit}}),Object.defineProperty(t,"otherEdit",{enumerable:!0,get:function(){return i.otherEdit}}),Object.defineProperty(t,"NumberFormatSource",{enumerable:!0,get:function(){return i.NumberFormatSource}}),Object.defineProperty(t,"createFormatGlobals",{enumerable:!0,get:function(){return i.createFormatGlobals}}),Object.defineProperty(t,"evalFormatLocalsGrid",{enumerable:!0,get:function(){return i.evalFormatLocalsGrid}}),Object.defineProperty(t,"getKnownFormat",{enumerable:!0,get:function(){return i.getKnownFormat}}),Object.defineProperty(t,"isKnownFormatDefined",{enumerable:!0,get:function(){return i.isKnownFormatDefined}}),Object.defineProperty(t,"englishXLSXKnownFormat",{enumerable:!0,get:function(){return i.englishXLSXKnownFormat}}),Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return i.RibbonFormat}}),Object.defineProperty(t,"getRibbonFormat",{enumerable:!0,get:function(){return i.getRibbonFormat}}),Object.defineProperty(t,"shouldInstallFormat",{enumerable:!0,get:function(){return i.shouldInstallFormat}}),Object.defineProperty(t,"createNumberFormatter",{enumerable:!0,get:function(){return i.createNumberFormatter}}),Object.defineProperty(t,"getValueEditOperKind",{enumerable:!0,get:function(){return i.getValueEditOperKind}}),Object.defineProperty(t,"applyValueEdit",{enumerable:!0,get:function(){return i.applyValueEdit}}),Object.defineProperty(t,"toXLNumber",{enumerable:!0,get:function(){return i.toXLNumber}})},6013:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.createParser=t.notFormulaString=t.parseLocals=t.ReasonKind=t.createParseGlobals=void 0;var n=r(391);Object.defineProperty(t,"createParseGlobals",{enumerable:!0,get:function(){return n.createParseGlobals}}),Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return n.ReasonKind}}),Object.defineProperty(t,"parseLocals",{enumerable:!0,get:function(){return n.parseLocals}}),Object.defineProperty(t,"notFormulaString",{enumerable:!0,get:function(){return n.notFormulaString}}),Object.defineProperty(t,"createParser",{enumerable:!0,get:function(){return n.createParser}}),Object.defineProperty(t,"parseResultHelper",{enumerable:!0,get:function(){return n.parseResultHelper}})},3475:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=t.DerefOperKind=t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var n=r(6913);Object.defineProperty(t,"TransitionKind",{enumerable:!0,get:function(){return n.TransitionKind}}),Object.defineProperty(t,"nextTransition",{enumerable:!0,get:function(){return n.nextTransition}}),Object.defineProperty(t,"breakTransition",{enumerable:!0,get:function(){return n.breakTransition}}),Object.defineProperty(t,"callMachineTransition",{enumerable:!0,get:function(){return n.callMachineTransition}}),Object.defineProperty(t,"nextOnSuccessReceiver",{enumerable:!0,get:function(){return n.nextOnSuccessReceiver}}),Object.defineProperty(t,"MachineCycle",{enumerable:!0,get:function(){return n.MachineCycle}}),Object.defineProperty(t,"MachineRuntime",{enumerable:!0,get:function(){return n.MachineRuntime}}),Object.defineProperty(t,"AllMachine",{enumerable:!0,get:function(){return n.AllMachine}}),Object.defineProperty(t,"VoidMachine",{enumerable:!0,get:function(){return n.VoidMachine}});var i=r(1475);Object.defineProperty(t,"DerefOperKind",{enumerable:!0,get:function(){return i.DerefOperKind}}),Object.defineProperty(t,"singleReadOperType",{enumerable:!0,get:function(){return i.singleReadOperType}}),Object.defineProperty(t,"readOperType",{enumerable:!0,get:function(){return i.readOperType}}),Object.defineProperty(t,"MachineCallKind",{enumerable:!0,get:function(){return i.MachineCallKind}}),Object.defineProperty(t,"machineCall",{enumerable:!0,get:function(){return i.machineCall}}),Object.defineProperty(t,"isMachineCall",{enumerable:!0,get:function(){return i.isMachineCall}})},7752:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.createCompiler=t.RecordOper=t.LambdaOper=t.LimitKind=t.limitExceeded=t.createCompileGlobals=t.illFormedFormula=t.compileLocalsName=t.compileLocalsGrid=t.evalLocals=t.evalGlobals=t.previousNameFailure=t.previousFailure=t.breaked=t.paused=t.cellCycle=t.nameCycle=t.stopped=t.userDefinedFunc=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.Interrupt=t.CellKind=t.interval=t.ReasonKind=t.extension=void 0;const n=r(6533);t.extension=n.__importStar(r(3475));var i=r(1475);Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return i.ReasonKind}}),Object.defineProperty(t,"interval",{enumerable:!0,get:function(){return i.interval}}),Object.defineProperty(t,"CellKind",{enumerable:!0,get:function(){return i.CellKind}}),Object.defineProperty(t,"Interrupt",{enumerable:!0,get:function(){return i.Interrupt}}),Object.defineProperty(t,"StepAction",{enumerable:!0,get:function(){return i.StepAction}}),Object.defineProperty(t,"RuntimePositionKind",{enumerable:!0,get:function(){return i.RuntimePositionKind}}),Object.defineProperty(t,"runtimePositionLetVal",{enumerable:!0,get:function(){return i.runtimePositionLetVal}}),Object.defineProperty(t,"runtimePositionLambdaRoot",{enumerable:!0,get:function(){return i.runtimePositionLambdaRoot}}),Object.defineProperty(t,"runtimePositionLambdaParam",{enumerable:!0,get:function(){return i.runtimePositionLambdaParam}}),Object.defineProperty(t,"runtimePositionEtaLambdaBody",{enumerable:!0,get:function(){return i.runtimePositionEtaLambdaBody}}),Object.defineProperty(t,"runtimePositionFormulaRoot",{enumerable:!0,get:function(){return i.runtimePositionFormulaRoot}}),Object.defineProperty(t,"runtimePositionFirstOrderFunc",{enumerable:!0,get:function(){return i.runtimePositionFirstOrderFunc}}),Object.defineProperty(t,"finalValue",{enumerable:!0,get:function(){return i.finalValue}}),Object.defineProperty(t,"pendingValue",{enumerable:!0,get:function(){return i.pendingValue}}),Object.defineProperty(t,"cellWellFormedFormula",{enumerable:!0,get:function(){return i.cellWellFormedFormula}}),Object.defineProperty(t,"cellFormula",{enumerable:!0,get:function(){return i.cellFormula}}),Object.defineProperty(t,"userDefinedFunc",{enumerable:!0,get:function(){return i.userDefinedFunc}}),Object.defineProperty(t,"stopped",{enumerable:!0,get:function(){return i.stopped}}),Object.defineProperty(t,"nameCycle",{enumerable:!0,get:function(){return i.nameCycle}}),Object.defineProperty(t,"cellCycle",{enumerable:!0,get:function(){return i.cellCycle}}),Object.defineProperty(t,"paused",{enumerable:!0,get:function(){return i.paused}}),Object.defineProperty(t,"breaked",{enumerable:!0,get:function(){return i.breaked}}),Object.defineProperty(t,"previousFailure",{enumerable:!0,get:function(){return i.previousFailure}}),Object.defineProperty(t,"previousNameFailure",{enumerable:!0,get:function(){return i.previousNameFailure}}),Object.defineProperty(t,"evalGlobals",{enumerable:!0,get:function(){return i.evalGlobals}}),Object.defineProperty(t,"evalLocals",{enumerable:!0,get:function(){return i.evalLocals}}),Object.defineProperty(t,"compileLocalsGrid",{enumerable:!0,get:function(){return i.compileLocalsGrid}}),Object.defineProperty(t,"compileLocalsName",{enumerable:!0,get:function(){return i.compileLocalsName}}),Object.defineProperty(t,"illFormedFormula",{enumerable:!0,get:function(){return i.illFormedFormula}}),Object.defineProperty(t,"createCompileGlobals",{enumerable:!0,get:function(){return i.createCompileGlobals}}),Object.defineProperty(t,"limitExceeded",{enumerable:!0,get:function(){return i.limitExceeded}}),Object.defineProperty(t,"LimitKind",{enumerable:!0,get:function(){return i.LimitKind}}),Object.defineProperty(t,"LambdaOper",{enumerable:!0,get:function(){return i.LambdaOper}}),Object.defineProperty(t,"RecordOper",{enumerable:!0,get:function(){return i.RecordOper}}),Object.defineProperty(t,"createCompiler",{enumerable:!0,get:function(){return i.createCompiler}}),Object.defineProperty(t,"createEvaluator",{enumerable:!0,get:function(){return i.createEvaluator}})},5858:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncType=t.getOperatorType=t.unknownFunctionType=t.functionType=t.SpecialPrecs=t.WorksheetFuncId=t.OperatorId=t.FunctionFlags=t.SignatureType=void 0;var n=r(6592);Object.defineProperty(t,"SignatureType",{enumerable:!0,get:function(){return n.SignatureType}}),Object.defineProperty(t,"FunctionFlags",{enumerable:!0,get:function(){return n.FunctionFlags}}),Object.defineProperty(t,"OperatorId",{enumerable:!0,get:function(){return n.OperatorId}}),Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return n.WorksheetFuncId}}),Object.defineProperty(t,"SpecialPrecs",{enumerable:!0,get:function(){return n.SpecialPrecs}}),Object.defineProperty(t,"functionType",{enumerable:!0,get:function(){return n.functionType}}),Object.defineProperty(t,"unknownFunctionType",{enumerable:!0,get:function(){return n.unknownFunctionType}}),Object.defineProperty(t,"getOperatorType",{enumerable:!0,get:function(){return n.getOperatorType}}),Object.defineProperty(t,"getWorksheetFuncType",{enumerable:!0,get:function(){return n.getWorksheetFuncType}})},2199:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n=r(6592);Object.defineProperty(t,"FontUnderline",{enumerable:!0,get:function(){return n.FontUnderline}}),Object.defineProperty(t,"FontVerticalAlignment",{enumerable:!0,get:function(){return n.FontVerticalAlignment}}),Object.defineProperty(t,"FillKind",{enumerable:!0,get:function(){return n.FillKind}}),Object.defineProperty(t,"PatternType",{enumerable:!0,get:function(){return n.PatternType}}),Object.defineProperty(t,"BorderLineType",{enumerable:!0,get:function(){return n.BorderLineType}}),Object.defineProperty(t,"HorizontalAlignment",{enumerable:!0,get:function(){return n.HorizontalAlignment}}),Object.defineProperty(t,"VerticalAlignment",{enumerable:!0,get:function(){return n.VerticalAlignment}})},5848:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.isValidArgsLength=t.getArgType=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isWSFNode=t.isOperatorNode=t.isUnqualifiedNameNode=t.isWellFormed=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isSheetGridCell=t.isGridCell=t.isSheetGridRange=t.isSheetIndex=t.partialArray=t.javaScriptError=t.isSuccess=t.successUndefined=t.failure=t.success=t.ResultKind=void 0,t.identityVisitor=t.IdentityVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.resolveGridRef=t.createResolver=t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.InvalidStructRefReason=t.invalidStructRef=t.InvalidCellRefReason=t.invalidCellRef=t.InvalidQualifierReason=t.invalidQualifier=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.formatName=t.formatGridRange=t.formatQualifier=t.formatRangePos=t.formatCellPos=t.formatColRange=t.formatRowRange=t.formatCol=t.formatRow=t.resolvePosition=t.columnName=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.isReadOperEqual=void 0,t.isUnbracketedFieldName=t.sheetRangeToSheetIndex=t.shouldFieldRefBeBracketed=t.relabelFormula=t.createPrinter=t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=t.buildAnnotations=t.reducePledge=t.reduceBottomUp=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=void 0;var n=r(6913);Object.defineProperty(t,"ResultKind",{enumerable:!0,get:function(){return n.ResultKind}}),Object.defineProperty(t,"success",{enumerable:!0,get:function(){return n.success}}),Object.defineProperty(t,"failure",{enumerable:!0,get:function(){return n.failure}}),Object.defineProperty(t,"successUndefined",{enumerable:!0,get:function(){return n.successUndefined}}),Object.defineProperty(t,"isSuccess",{enumerable:!0,get:function(){return n.isSuccess}}),Object.defineProperty(t,"javaScriptError",{enumerable:!0,get:function(){return n.javaScriptError}}),Object.defineProperty(t,"partialArray",{enumerable:!0,get:function(){return n.partialArray}});var i=r(6592);Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return i.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return i.isSheetGridRange}}),Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return i.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return i.isSheetGridCell}}),Object.defineProperty(t,"forEachCellInRange",{enumerable:!0,get:function(){return i.forEachCellInRange}}),Object.defineProperty(t,"forEachTileInRange",{enumerable:!0,get:function(){return i.forEachTileInRange}}),Object.defineProperty(t,"gridRangeJoin",{enumerable:!0,get:function(){return i.gridRangeJoin}}),Object.defineProperty(t,"gridRangeJoinOpt",{enumerable:!0,get:function(){return i.gridRangeJoinOpt}}),Object.defineProperty(t,"gridRangesJoin",{enumerable:!0,get:function(){return i.gridRangesJoin}}),Object.defineProperty(t,"gridRangeIsect",{enumerable:!0,get:function(){return i.gridRangeIsect}}),Object.defineProperty(t,"gridRangeIsects",{enumerable:!0,get:function(){return i.gridRangeIsects}}),Object.defineProperty(t,"gridCellImplicitIsect",{enumerable:!0,get:function(){return i.gridCellImplicitIsect}}),Object.defineProperty(t,"gridRangeCompare",{enumerable:!0,get:function(){return i.gridRangeCompare}}),Object.defineProperty(t,"gridRangeExcept",{enumerable:!0,get:function(){return i.gridRangeExcept}}),Object.defineProperty(t,"gridRangeSize",{enumerable:!0,get:function(){return i.gridRangeSize}}),Object.defineProperty(t,"isDocumentLocEqual",{enumerable:!0,get:function(){return i.isDocumentLocEqual}}),Object.defineProperty(t,"isSheetIndexEqual",{enumerable:!0,get:function(){return i.isSheetIndexEqual}}),Object.defineProperty(t,"isNameScopeEqual",{enumerable:!0,get:function(){return i.isNameScopeEqual}}),Object.defineProperty(t,"isGridCellEqual",{enumerable:!0,get:function(){return i.isGridCellEqual}}),Object.defineProperty(t,"isGridRangeEqual",{enumerable:!0,get:function(){return i.isGridRangeEqual}}),Object.defineProperty(t,"isSheetGridCellEqual",{enumerable:!0,get:function(){return i.isSheetGridCellEqual}}),Object.defineProperty(t,"isSheetGridRangeEqual",{enumerable:!0,get:function(){return i.isSheetGridRangeEqual}}),Object.defineProperty(t,"isWellFormed",{enumerable:!0,get:function(){return i.isWellFormed}}),Object.defineProperty(t,"isUnqualifiedNameNode",{enumerable:!0,get:function(){return i.isUnqualifiedNameNode}}),Object.defineProperty(t,"isOperatorNode",{enumerable:!0,get:function(){return i.isOperatorNode}}),Object.defineProperty(t,"isWSFNode",{enumerable:!0,get:function(){return i.isWSFNode}}),Object.defineProperty(t,"gridRangeAnchor",{enumerable:!0,get:function(){return i.gridRangeAnchor}}),Object.defineProperty(t,"sheetGridRangeAnchor",{enumerable:!0,get:function(){return i.sheetGridRangeAnchor}}),Object.defineProperty(t,"gridCellRange",{enumerable:!0,get:function(){return i.gridCellRange}}),Object.defineProperty(t,"getArguments",{enumerable:!0,get:function(){return i.getArguments}}),Object.defineProperty(t,"getArgType",{enumerable:!0,get:function(){return i.getArgType}}),Object.defineProperty(t,"isValidArgsLength",{enumerable:!0,get:function(){return i.isValidArgsLength}}),Object.defineProperty(t,"isNumberOper",{enumerable:!0,get:function(){return i.isNumberOper}}),Object.defineProperty(t,"isStringOper",{enumerable:!0,get:function(){return i.isStringOper}}),Object.defineProperty(t,"isBooleanOper",{enumerable:!0,get:function(){return i.isBooleanOper}}),Object.defineProperty(t,"isErrorOper",{enumerable:!0,get:function(){return i.isErrorOper}}),Object.defineProperty(t,"isRangeOper",{enumerable:!0,get:function(){return i.isRangeOper}}),Object.defineProperty(t,"isArrayOper",{enumerable:!0,get:function(){return i.isArrayOper}}),Object.defineProperty(t,"isMissingOper",{enumerable:!0,get:function(){return i.isMissingOper}}),Object.defineProperty(t,"isBlankOper",{enumerable:!0,get:function(){return i.isBlankOper}}),Object.defineProperty(t,"isRichOper",{enumerable:!0,get:function(){return i.isRichOper}}),Object.defineProperty(t,"isPrimitiveOper",{enumerable:!0,get:function(){return i.isPrimitiveOper}}),Object.defineProperty(t,"isWriteOper",{enumerable:!0,get:function(){return i.isWriteOper}}),Object.defineProperty(t,"isReadOperEqual",{enumerable:!0,get:function(){return i.isReadOperEqual}}),Object.defineProperty(t,"ReasonKind",{enumerable:!0,get:function(){return i.ReasonKind}}),Object.defineProperty(t,"notImplemented",{enumerable:!0,get:function(){return i.notImplemented}}),Object.defineProperty(t,"unavailable",{enumerable:!0,get:function(){return i.unavailable}}),Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return i.internal}}),Object.defineProperty(t,"createFailureErrorClass",{enumerable:!0,get:function(){return i.createFailureErrorClass}}),Object.defineProperty(t,"columnName",{enumerable:!0,get:function(){return i.columnName}}),Object.defineProperty(t,"resolvePosition",{enumerable:!0,get:function(){return i.resolvePosition}}),Object.defineProperty(t,"formatRow",{enumerable:!0,get:function(){return i.formatRow}}),Object.defineProperty(t,"formatCol",{enumerable:!0,get:function(){return i.formatCol}}),Object.defineProperty(t,"formatRowRange",{enumerable:!0,get:function(){return i.formatRowRange}}),Object.defineProperty(t,"formatColRange",{enumerable:!0,get:function(){return i.formatColRange}}),Object.defineProperty(t,"formatCellPos",{enumerable:!0,get:function(){return i.formatCellPos}}),Object.defineProperty(t,"formatRangePos",{enumerable:!0,get:function(){return i.formatRangePos}}),Object.defineProperty(t,"formatQualifier",{enumerable:!0,get:function(){return i.formatQualifier}}),Object.defineProperty(t,"formatGridRange",{enumerable:!0,get:function(){return i.formatGridRange}}),Object.defineProperty(t,"formatName",{enumerable:!0,get:function(){return i.formatName}}),Object.defineProperty(t,"parseGridCellA1",{enumerable:!0,get:function(){return i.parseGridCellA1}}),Object.defineProperty(t,"parseGridRangeA1",{enumerable:!0,get:function(){return i.parseGridRangeA1}}),Object.defineProperty(t,"parseQualifier",{enumerable:!0,get:function(){return i.parseQualifier}}),Object.defineProperty(t,"wrapPosition",{enumerable:!0,get:function(){return i.wrapPosition}}),Object.defineProperty(t,"resolveLocalsGrid",{enumerable:!0,get:function(){return i.resolveLocalsGrid}}),Object.defineProperty(t,"ResolveReasonKind",{enumerable:!0,get:function(){return i.ResolveReasonKind}}),Object.defineProperty(t,"noOriginSheet",{enumerable:!0,get:function(){return i.noOriginSheet}}),Object.defineProperty(t,"invalidQualifier",{enumerable:!0,get:function(){return i.invalidQualifier}}),Object.defineProperty(t,"InvalidQualifierReason",{enumerable:!0,get:function(){return i.InvalidQualifierReason}}),Object.defineProperty(t,"invalidCellRef",{enumerable:!0,get:function(){return i.invalidCellRef}}),Object.defineProperty(t,"InvalidCellRefReason",{enumerable:!0,get:function(){return i.InvalidCellRefReason}}),Object.defineProperty(t,"invalidStructRef",{enumerable:!0,get:function(){return i.invalidStructRef}}),Object.defineProperty(t,"InvalidStructRefReason",{enumerable:!0,get:function(){return i.InvalidStructRefReason}}),Object.defineProperty(t,"emptyIntersection",{enumerable:!0,get:function(){return i.emptyIntersection}}),Object.defineProperty(t,"ResolvedKind",{enumerable:!0,get:function(){return i.ResolvedKind}}),Object.defineProperty(t,"resolvedName",{enumerable:!0,get:function(){return i.resolvedName}}),Object.defineProperty(t,"resolvedCellRef",{enumerable:!0,get:function(){return i.resolvedCellRef}}),Object.defineProperty(t,"resolvedUserDefinedFunc",{enumerable:!0,get:function(){return i.resolvedUserDefinedFunc}}),Object.defineProperty(t,"resolvedLocalName",{enumerable:!0,get:function(){return i.resolvedLocalName}}),Object.defineProperty(t,"resolvedWorksheetFunc",{enumerable:!0,get:function(){return i.resolvedWorksheetFunc}}),Object.defineProperty(t,"resolvedStructRef",{enumerable:!0,get:function(){return i.resolvedStructRef}}),Object.defineProperty(t,"resolvedNever",{enumerable:!0,get:function(){return i.resolvedNever}}),Object.defineProperty(t,"resolvedDottedName",{enumerable:!0,get:function(){return i.resolvedDottedName}}),Object.defineProperty(t,"createResolver",{enumerable:!0,get:function(){return i.createResolver}}),Object.defineProperty(t,"resolveGridRef",{enumerable:!0,get:function(){return i.resolveGridRef}}),Object.defineProperty(t,"visitFormulaNode",{enumerable:!0,get:function(){return i.visitFormulaNode}}),Object.defineProperty(t,"visitOperatorNode",{enumerable:!0,get:function(){return i.visitOperatorNode}}),Object.defineProperty(t,"visitWSFNode",{enumerable:!0,get:function(){return i.visitWSFNode}}),Object.defineProperty(t,"visitAppHeadNode",{enumerable:!0,get:function(){return i.visitAppHeadNode}}),Object.defineProperty(t,"visitQualifier",{enumerable:!0,get:function(){return i.visitQualifier}}),Object.defineProperty(t,"visitCellRef",{enumerable:!0,get:function(){return i.visitCellRef}}),Object.defineProperty(t,"IdentityVisitor",{enumerable:!0,get:function(){return i.IdentityVisitor}}),Object.defineProperty(t,"identityVisitor",{enumerable:!0,get:function(){return i.identityVisitor}}),Object.defineProperty(t,"ConstVisitor",{enumerable:!0,get:function(){return i.ConstVisitor}}),Object.defineProperty(t,"constVisitor",{enumerable:!0,get:function(){return i.constVisitor}}),Object.defineProperty(t,"voidVisitor",{enumerable:!0,get:function(){return i.voidVisitor}}),Object.defineProperty(t,"DelegatingVisitor",{enumerable:!0,get:function(){return i.DelegatingVisitor}}),Object.defineProperty(t,"BinaryVisitor",{enumerable:!0,get:function(){return i.BinaryVisitor}}),Object.defineProperty(t,"binaryVisitor",{enumerable:!0,get:function(){return i.binaryVisitor}}),Object.defineProperty(t,"ComposeVisitor",{enumerable:!0,get:function(){return i.ComposeVisitor}}),Object.defineProperty(t,"composeVisitor",{enumerable:!0,get:function(){return i.composeVisitor}}),Object.defineProperty(t,"reduceBottomUp",{enumerable:!0,get:function(){return i.reduceBottomUp}}),Object.defineProperty(t,"reducePledge",{enumerable:!0,get:function(){return i.reducePledge}}),Object.defineProperty(t,"buildAnnotations",{enumerable:!0,get:function(){return i.buildAnnotations}}),Object.defineProperty(t,"createSimplePrintGlobals",{enumerable:!0,get:function(){return i.createSimplePrintGlobals}}),Object.defineProperty(t,"printLocalsGrid",{enumerable:!0,get:function(){return i.printLocalsGrid}}),Object.defineProperty(t,"printLocalsName",{enumerable:!0,get:function(){return i.printLocalsName}}),Object.defineProperty(t,"createPrinter",{enumerable:!0,get:function(){return i.createPrinter}}),Object.defineProperty(t,"relabelFormula",{enumerable:!0,get:function(){return i.relabelFormula}}),Object.defineProperty(t,"shouldFieldRefBeBracketed",{enumerable:!0,get:function(){return i.shouldFieldRefBeBracketed}}),Object.defineProperty(t,"sheetRangeToSheetIndex",{enumerable:!0,get:function(){return i.sheetRangeToSheetIndex}});var a=r(391);Object.defineProperty(t,"isUnbracketedFieldName",{enumerable:!0,get:function(){return a.isUnbracketedFieldName}})},9691:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceBottomUp=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.booleanOper=t.stringOper=t.precedents=t.ErrorType=t.falseOper=t.trueOper=t.OperKind=t.PrecsBound=t.SpecialPrecs=void 0;var n=r(6592);Object.defineProperty(t,"SpecialPrecs",{enumerable:!0,get:function(){return n.SpecialPrecs}}),Object.defineProperty(t,"PrecsBound",{enumerable:!0,get:function(){return n.PrecsBound}}),Object.defineProperty(t,"OperKind",{enumerable:!0,get:function(){return n.OperKind}}),Object.defineProperty(t,"trueOper",{enumerable:!0,get:function(){return n.trueOper}}),Object.defineProperty(t,"falseOper",{enumerable:!0,get:function(){return n.falseOper}}),Object.defineProperty(t,"ErrorType",{enumerable:!0,get:function(){return n.ErrorType}}),Object.defineProperty(t,"precedents",{enumerable:!0,get:function(){return n.precedents}}),Object.defineProperty(t,"stringOper",{enumerable:!0,get:function(){return n.stringOper}}),Object.defineProperty(t,"booleanOper",{enumerable:!0,get:function(){return n.booleanOper}}),Object.defineProperty(t,"errorOper",{enumerable:!0,get:function(){return n.errorOper}}),Object.defineProperty(t,"nullErrorOper",{enumerable:!0,get:function(){return n.nullErrorOper}}),Object.defineProperty(t,"div0ErrorOper",{enumerable:!0,get:function(){return n.div0ErrorOper}}),Object.defineProperty(t,"valueErrorOper",{enumerable:!0,get:function(){return n.valueErrorOper}}),Object.defineProperty(t,"refErrorOper",{enumerable:!0,get:function(){return n.refErrorOper}}),Object.defineProperty(t,"nameErrorOper",{enumerable:!0,get:function(){return n.nameErrorOper}}),Object.defineProperty(t,"numErrorOper",{enumerable:!0,get:function(){return n.numErrorOper}}),Object.defineProperty(t,"naErrorOper",{enumerable:!0,get:function(){return n.naErrorOper}}),Object.defineProperty(t,"gettingDataErrorOper",{enumerable:!0,get:function(){return n.gettingDataErrorOper}}),Object.defineProperty(t,"spillErrorOper",{enumerable:!0,get:function(){return n.spillErrorOper}}),Object.defineProperty(t,"connectErrorOper",{enumerable:!0,get:function(){return n.connectErrorOper}}),Object.defineProperty(t,"blockedErrorOper",{enumerable:!0,get:function(){return n.blockedErrorOper}}),Object.defineProperty(t,"unknownErrorOper",{enumerable:!0,get:function(){return n.unknownErrorOper}}),Object.defineProperty(t,"fieldErrorOper",{enumerable:!0,get:function(){return n.fieldErrorOper}}),Object.defineProperty(t,"calcErrorOper",{enumerable:!0,get:function(){return n.calcErrorOper}}),Object.defineProperty(t,"busyErrorOper",{enumerable:!0,get:function(){return n.busyErrorOper}}),Object.defineProperty(t,"externalErrorOper",{enumerable:!0,get:function(){return n.externalErrorOper}}),Object.defineProperty(t,"arrayOper",{enumerable:!0,get:function(){return n.arrayOper}}),Object.defineProperty(t,"rangeSeqOper",{enumerable:!0,get:function(){return n.rangeSeqOper}}),Object.defineProperty(t,"range3DOper",{enumerable:!0,get:function(){return n.range3DOper}}),Object.defineProperty(t,"missingOper",{enumerable:!0,get:function(){return n.missingOper}}),Object.defineProperty(t,"blankOper",{enumerable:!0,get:function(){return n.blankOper}}),Object.defineProperty(t,"reduceBottomUp",{enumerable:!0,get:function(){return n.reduceBottomUp}})},4414:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argumentAssistancePluginDependenciesResolved=t.ArgumentAssistancePlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(246),l=r(9268),c=r(1663),d=r(2261),m=r(4352),g=r(9084),p=r(2937),h=r(8795),f=r(6307),S=r(8708),v=r(8402),y=r(9615),F=r(4563),b=S.PluginRegistry.create(s.PluginFactoryName.ArgumentAssistancePlugin,s.PluginGroup.Excel);let C=(()=>{let e,t,r,s=[b.x10Plugin()],p=[],h=[];return t=class{*run(e){this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map;const t=yield{kind:f.ComputationRequestKind.GetActiveCell};if(t.kind!==f.ComputationRequestKind.GetActiveCell)return this.logFailure("failed to get active cell"),null;this.addTimeStamp("GetActiveCell");let r=yield{kind:f.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(this.addTimeStamp("ParseCellContentSync"),!(void 0!==r&&r.kind===f.ComputationRequestKind.ParseActiveCell&&(0,i.isSuccess)(r.result)||(r=yield{kind:f.ComputationRequestKind.ParseEdit,cell:t.activeCell,formulaBarText:e.content},this.addTimeStamp("ParseCellContentAsync"),r.kind===f.ComputationRequestKind.ParseEdit&&(0,i.isSuccess)(r.result))))return null;if(r.result.value.kind!==o.EditKind.Formula)return null;const{formula:n}=r.result.value,s=new c.ArgumentAssistanceVisitor(n,e.caretPosition,this.newNamedObjectsEnabled);if((0,a.reduceBottomUp)(s,n),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===s.assistedFunctionHead)return this.logTimeStamp(),null;const g=yield{kind:f.ComputationRequestKind.GetConfig};this.addTimeStamp("GetConfig");const p=g.kind===f.ComputationRequestKind.GetConfig?g.config.localeInfo.listSeparator:",",h=s.assistedFunctionHead;if(h.kind===a.NodeKind.Name){if(!this.newNamedObjectsEnabled&&!this.supportUDF)return null;const t=yield{kind:f.ComputationRequestKind.GetDefinedNamesInfo};if(t.kind!==f.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const r=t.definedNamesInfo.find((e=>e.name===h.whole));if(null==r?.reference){if(this.supportUDF){const t=yield{kind:f.ComputationRequestKind.GetFunctionInfo,functionName:h.whole};if(t.kind===f.ComputationRequestKind.GetFunctionInfo&&t.functionInfo.IsDynamicUdf)return new m.ResettableLazy((()=>(0,l.createFunctionRenderingInfoForUDF)(t.functionInfo,n,s.assistedFunctionArgs,e.caretPosition,p))).getValue()}return null}if(!this.newNamedObjectsEnabled)return null;const a=yield{kind:f.ComputationRequestKind.ParseActiveCell,formulaText:r.reference};if(a.kind!==f.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(a.result)||a.result.value.kind!==o.EditKind.Formula)return null;const{formula:u}=a.result.value;if(!u.isWellFormed||"Lambda"!==u.node.kind||!u.node.isClosed)return null;const c=[];for(const e of u.node.params){const{name:t,isBracketed:r}=e.name.arg.name;if("Ident"!==t.kind)return this.logFailure(`unexpected parameter in lambda function: ${t.kind}`),null;const n=r?`[${t.whole}]`:t.whole;c.push(n)}const d=(0,l.getActiveParamIndex)(n,s.assistedFunctionArgs,e.caretPosition);return{kind:"Minimal",functionName:h.whole,listSeparator:p,parameters:{params:c,activeParam:d}}}const S=yield{kind:f.ComputationRequestKind.GetFunctionInfo,functionName:h.whole};if(this.addTimeStamp("GetFunctionInfo"),S.kind!==f.ComputationRequestKind.GetFunctionInfo)return this.logFailure(`failed to get function info for ${h.whole}`),null;const v=S.functionInfo;if((0,u.isChangeGateEnabled)("OfficeVSO:9920153_excludePythonArgAssistance")){if(v.FunctionIndexInServer===a.WorksheetFuncId.PY)return null}else if((0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.PythonInfra",!1)&&v.FunctionIndexInServer===a.WorksheetFuncId.PY){const e=yield{kind:f.ComputationRequestKind.GetPythonLicense};if(e.kind!==f.ComputationRequestKind.GetPythonLicense)return this.logFailure("failed to get python license"),null;if(this.argumentAssitanceFilterOutPythonEnabled&&("Success"!==e.license.kind||"Success"===e.license.kind&&!e.license.value.isEnabled))return null}const y=new m.ResettableLazy((()=>(0,l.createFunctionRenderingInfo)(S.functionInfo,n,s.assistedFunctionArgs,e.caretPosition,h.id,p))),b=d.functionExamples.getValue()[h.id];if(this.addTimeStamp("GetExampleString"),void 0===b)return this.logFailure(`no example found for function: ${h.whole}, id: ${h.id}`),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),y.getValue();const C=yield{kind:f.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:b,kind:F.FormulaKind.CellFormula},useEnglishLocaleInfo:!0};if(this.addTimeStamp("ParseExample"),C.kind!==f.ComputationRequestKind.ParseCellFormula||!(0,i.isSuccess)(C.result)){this.logFailure(`failed to parse example for function: ${h.whole}`);const e=y.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),e}if(g.kind===f.ComputationRequestKind.GetConfig&&g.config.localeInfo.lcid===a.LCID.USA){const t=(0,l.createFunctionRenderingInfo)(S.functionInfo,n,s.assistedFunctionArgs,e.caretPosition,h.id,p,b,C.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),t}const k=yield{kind:f.ComputationRequestKind.PrintFormula,formula:C.result.value,origin:t.activeCell};if(this.addTimeStamp("localize example string"),k.kind!==f.ComputationRequestKind.PrintFormula||!(0,i.isSuccess)(k.result)){this.logFailure(`failed to pretty print localized example for function: ${h.whole}`);const e=y.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),e}const E=yield{kind:f.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:k.result.value,kind:F.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(this.addTimeStamp("parse localized example string"),E.kind!==f.ComputationRequestKind.ParseCellFormula||!(0,i.isSuccess)(E.result)){this.logFailure(`failed to parse localized example for function: ${h.whole}`);const e=y.getValue();return this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),e}const A=(0,l.createFunctionRenderingInfo)(S.functionInfo,n,s.assistedFunctionArgs,e.caretPosition,h.id,p,k.result.value,E.result.value);return this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),A}logFailure(e){a.ulsLogger.ULS.traceTag(545388683,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`ArgumentAssistancePlugin encountered a failure with msg ${e}`)}addTimeStampAndLog(e){this.addTimeStamp(e),this.logTimeStamp()}logTimeStamp(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);const e={};this.timeStamps.forEach(((t,r)=>{e[r]=t})),a.ulsLogger.ULS.traceTag(540377222,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`${JSON.stringify(e)}`)}addTimeStamp(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()}constructor(){this.timer=(n.__runInitializers(this,h),v.defaultTimerInterface),this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.newNamedObjectsEnabled=(0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,u.isChangeGateEnabled)("OfficeVSO:9646883_NameManager-FG-Removal"),this.supportUDF=(0,u.isChangeGateEnabled)("OfficeVSO:9307294_LetUDFSupportArgumentAssistance"),this.argumentAssitanceFilterOutPythonEnabled=(0,u.isChangeGateEnabled)("OfficeVSO:9668654_autocompleteToplevelPython")}},n.__setFunctionName(t,"ArgumentAssistancePlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[b.uiMessageHandler({kind:g.RequestKind.argumentAssistance})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},s,{kind:"class",name:t.name,metadata:i},null,p),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=b.injectPluginFactory(),n.__runInitializers(t,p),t})();t.ArgumentAssistancePlugin=C,(0,p.registerPluginFactory)(C.factory),t.argumentAssistancePluginDependenciesResolved=(0,y.trackableAsyncLazy)((async()=>{let e;e=(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?await h.dynamicPluginLoaderCreated.getValue():await h.workerThreadSpread.getValue(),await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(s.PluginFactoryName.ArgumentAssistancePlugin),await h.schedulerWithRecalcServiceAttached.getValue()}),"argumentAssistancePluginDependenciesResolved")},9268:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFunctionRenderingInfo=function(e,t,r,l,d,m,p,h){const f=i(t,r,l),S=e.Params.split("!");return{kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:S.map(((t,r)=>function(e,t,r,i,l,d,m,p){const h=(0,n.getWorksheetFuncType)(l),f=""!==t?t.split(d+" ").filter((e=>"..."!==e)):[],S=u(f,h,i),v=function(e,t){return void 0===e||void 0===t?null:t.node.args.map((r=>{const n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(m,p),y=s(e.ParamsHelp,f,h,r),F=c(S,y);return{signatureParams:g(S,o(i,f.length,h)),descriptions:y,descriptionParams:g(F,a(i,F.length,h)),exampleParams:null!==v?g(v,a(i,v.length,h,!0)):null,exampleDescription:""}}(e,t,r,f,d,m,p,h))),activeSignature:0,listSeparator:m,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},t.createFunctionRenderingInfoForUDF=function(e,t,r,n,l){const d=i(t,r,n),m=e.Params.split("!");return{kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:m.map(((t,r)=>function(e,t,r,n,i){const l="...",d=""!==t?t.split(i).filter((e=>e!==l)):[],m=e.Params.endsWith(l)?e.Params.split(i).length-2:e.Params.split(i).length,p=e.Params.endsWith(l)?1:0,h={minArgs:0,maxArgs:0,headTypes:new Array(m).fill(0),restTypes:new Array(p).fill(0),tailTypes:[],returnType:0,staticPrecs:0,flags:0},f=u(d,h,n),S=s(e.ParamsHelp,d,h,r),v=c(f,S);return{signatureParams:g(f,o(n,d.length,h)),descriptions:S,descriptionParams:g(v,a(n,v.length,h)),exampleParams:null,exampleDescription:""}}(e,t,r,d,l))),activeSignature:0,listSeparator:l,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},t.getActiveParamIndex=i,t.getParamIndexToHighlight=a,t.getParamNumberSuffix=l,t.getBaseParamName=m;const n=r(6592);function i(e,t,r){let n=0;for(let i=0;i<t.length;i++){const a=e.spans[t[i].label];if(a&&a.start-a.pre.length<=r&&r<=a.end+a.post.length){n=i;break}}return n}function a(e,t,r,n=!1,i=!1){const a=t-1,o=r.restTypes.length,s=r.headTypes.length;if(e<s+o)return e;if(e>=s&&0===o)return-1;const u=(e-s)%o;return n?e<=a-r.tailTypes.length?e:a-r.tailTypes.length-(o-1)+u:s+(i&&0===u&&r.tailTypes.length>0?o:u)}function o(e,t,r){let n=a(e,t,r);return d(e,r)&&(n+=1),n}function s(e,t,r,n){let i=e?e.split("!"):[];if(i=0===n?i.slice(0,t.length):i.slice(-1*t.length),r.restTypes.length>0){for(let e=r.headTypes.length;e<i.length;e+=1){const r=m(t[e]),n=`${r}1,${r}2,... `;i[e]=n+i[e]}1===r.restTypes.length&&i.push(i[r.headTypes.length])}return i}function u(e,t,r){const n=e.slice(),i=t.headTypes.length,a=t.restTypes.length;if(a>0){let e=l(r,i,a);for(let t=i;t<n.length;t+=a){for(let r=0;r<a;r+=1){const i=m(n[t+r]),o=e>1&&r%a==0?"[":"",s=e>1&&r%a==a-1?"]":"";n[t+r]=`${o}${i}${e}${s}`}e+=1}n.push("..."),d(r,t)&&n.splice(i,0,"...")}return n}function l(e,t,r){return 1+Math.max(Math.floor((e-t)/r),0)}function c(e,t){return e.filter((e=>"..."!==e)).slice(0,t.length).map((e=>function(e){return e.startsWith("[")&&!e.endsWith("]")?e+"]":!e.startsWith("[")&&e.endsWith("]")?"["+e:e}(e)))}function d(e,t){return t.restTypes.length>0&&e>=t.headTypes.length+t.restTypes.length}function m(e){return e.match(/[^0-9\[\]]+/)}function g(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}},1663:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentAssistanceVisitor=void 0;const n=r(6592),i=r(246);class a extends n.IdentityVisitor{appNode(e,t,r,a){const o=(0,i.isChangeGateEnabled)("OfficeVSO:9307294_LetUDFSupportArgumentAssistance");return(e.kind===n.NodeKind.WSF||(this.newNamedObjectsEnabled||o)&&e.kind===n.NodeKind.Name)&&this.updateAssistedFunction(e,t),super.appNode(e,t,r,a)}letNode(e,t,r,n,i,a){const o=super.letNode(e,t,r,n,i,a);return this.updateAssistedFunction(e,o.args),o}lambdaNode(e,t,r,n,i,a){const o=super.lambdaNode(e,t,r,n,i,a);return this.updateAssistedFunction(e,o.args),o}updateAssistedFunction(e,t){const r=this.parsedFormulaTree.spans[t[0].label],n=this.parsedFormulaTree.spans[t[t.length-1].label],i=r.start-r.pre.length,a=n.end-n.post.length;this.caretPosition<=a&&this.caretPosition>=i&&(void 0===this.assistedFunctionHead||i>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=i)}constructor(e,t,r){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.newNamedObjectsEnabled=r,this.assistedFunctionScopeStart=0}}t.ArgumentAssistanceVisitor=a},2261:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionExamples=void 0;const n=r(6592),i=r(4352);t.functionExamples=new i.ResettableLazy((()=>({[n.WorksheetFuncId.ABS]:"=ABS(2)",[n.WorksheetFuncId.CUBEMEMBERPROPERTY]:`=CUBEMEMBERPROPERTY("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fiscal)}].[2014]",$A$3)`,[n.WorksheetFuncId.CUBERANKEDMEMBER]:`=CUBERANKEDMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",$D$4,1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TopMonth)}")`,[n.WorksheetFuncId.BINOM_DIST_RANGE]:"=BINOM.DIST.RANGE(60,0.75,48)",[n.WorksheetFuncId.NETWORKDAYS_INTL]:"=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",[n.WorksheetFuncId.AVERAGE_WEIGHTED]:"=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",[n.WorksheetFuncId.GAMMALN_PRECISE]:"=GAMMALN.PRECISE(4)",[n.WorksheetFuncId.CONFIDENCE_NORM]:"=CONFIDENCE.NORM(0.05,2.5,50)",[n.WorksheetFuncId.CEILING_PRECISE]:"=CEILING.PRECISE(4.3)",[n.WorksheetFuncId.FORECAST_LINEAR]:"=FORECAST.LINEAR(30,A2:A6,B2:B6)",[n.WorksheetFuncId.PERCENTRANK_EXC]:"=PERCENTRANK.EXC(A2:A11,2)",[n.WorksheetFuncId.PERCENTRANK_INC]:"=PERCENTRANK.INC(A2:A11,2)",[n.WorksheetFuncId.PERCENTILE_EXC]:"=PERCENTILE.EXC(B2:B10,0.25)",[n.WorksheetFuncId.PERCENTILE_INC]:"=PERCENTILE.INC(A2:A5,0.3)",[n.WorksheetFuncId.CUBEKPIMEMBER]:`=CUBEKPIMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MySalesKPI)}",1)`,[n.WorksheetFuncId.CHISQ_DIST_RT]:"=CHISQ.DIST.RT(18.307,10)",[n.WorksheetFuncId.FLOOR_PRECISE]:"=FLOOR.PRECISE(-3.2,-1)",[n.WorksheetFuncId.NEGBINOM_DIST]:"=NEGBINOM.DIST(10,5,0.25,TRUE)",[n.WorksheetFuncId.GETPIVOTDATA]:`=GETPIVOTDATA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", $A$3, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.South)}")`,[n.WorksheetFuncId.CUBESETCOUNT]:"=CUBESETCOUNT(A3)",[n.WorksheetFuncId.ERFC_PRECISE]:"=ERFC.PRECISE(1)",[n.WorksheetFuncId.CHISQ_INV_RT]:"=CHISQ.INV.RT(0.3, 2)",[n.WorksheetFuncId.CONFIDENCE_T]:"=CONFIDENCE.T(0.05,1,50)",[n.WorksheetFuncId.CEILING_MATH]:"=CEILING.MATH(24.3,5)",[n.WorksheetFuncId.HYPGEOM_DIST]:"=HYPGEOM.DIST(1,4,8,20,TRUE)",[n.WorksheetFuncId.LOGNORM_DIST]:"=LOGNORM.DIST(4,3.5,1.2,TRUE)",[n.WorksheetFuncId.NEGBINOMDIST]:"=NEGBINOMDIST(10,5,0.25)",[n.WorksheetFuncId.PERMUTATIONA]:"=PERMUTATIONA(3,2)",[n.WorksheetFuncId.POISSON_DIST]:"=POISSON.DIST(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL_DIST]:"=WEIBULL.DIST(105,20,100,TRUE)",[n.WorksheetFuncId.COVARIANCE_P]:"=COVARIANCE.P(A2:A6, B2:B6)",[n.WorksheetFuncId.COVARIANCE_S]:"=COVARIANCE.S(A3:A5,B3:B5)",[n.WorksheetFuncId.QUARTILE_EXC]:"=QUARTILE.EXC(A2:A12,1)",[n.WorksheetFuncId.QUARTILE_INC]:"=QUARTILE.INC(A2:A9,1)",[n.WorksheetFuncId.ECMA_CEILING]:"=ECMA.CEILING(1.5, 0.1)",[n.WorksheetFuncId.WORKDAY_INTL]:"=WORKDAY.INTL(DATE(2012,1,1),30,1)",[n.WorksheetFuncId.STOCKHISTORY]:'=STOCKHISTORY("MSFT", "2024-01-01", "2024-01-10")',[n.WorksheetFuncId.ERF_PRECISE]:"=ERF.PRECISE(0.745)",[n.WorksheetFuncId.NUMBERVALUE]:'=NUMBERVALUE("0.035")',[n.WorksheetFuncId.HYPGEOMDIST]:"=HYPGEOMDIST(1,4,8,20)",[n.WorksheetFuncId.LOGNORMDIST]:"=LOGNORMDIST(4,3.5,1.2)",[n.WorksheetFuncId.LOGNORM_INV]:"=LOGNORM.INV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.NORM_S_DIST]:"=NORM.S.DIST(1.33, TRUE)",[n.WorksheetFuncId.STANDARDIZE]:"=STANDARDIZE(42,40,1.5)",[n.WorksheetFuncId.FORMULATEXT]:"=FORMULATEXT(A2)",[n.WorksheetFuncId.PERCENTRANK]:"=PERCENTRANK(A2:A11,2)",[n.WorksheetFuncId.CONCATENATE]:`=CONCATENATE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}", " ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.ISO_CEILING]:"=ISO.CEILING(4.3)",[n.WorksheetFuncId.VALUETOTEXT]:`=VALUETOTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SomeText)}")`,[n.WorksheetFuncId.ARRAYTOTEXT]:"=ARRAYTOTEXT(B1:B3)",[n.WorksheetFuncId.AVERAGEIFS]:'=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',[n.WorksheetFuncId.COUNTBLANK]:"=COUNTBLANK(A2:B5)",[n.WorksheetFuncId.ERROR_TYPE]:"=ERROR.TYPE(#NULL!)",[n.WorksheetFuncId.CUBEMEMBER]:`=CUBEMEMBER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}",(B4, C6, D5),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesFor2004)}")`,[n.WorksheetFuncId.ISOWEEKNUM]:"=ISOWEEKNUM(40977)",[n.WorksheetFuncId.SUBSTITUTE]:`=SUBSTITUTE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesData)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cost)}")`,[n.WorksheetFuncId.SUMPRODUCT]:"=SUMPRODUCT(C2:C5,D2:D5)",[n.WorksheetFuncId.WEBSERVICE]:`=WEBSERVICE(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WebServiceLink)})`,[n.WorksheetFuncId.BINOM_DIST]:"=BINOM.DIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.CHISQ_DIST]:"=CHISQ.DIST(0.5,1,TRUE)",[n.WorksheetFuncId.CONFIDENCE]:"=CONFIDENCE(0.05,2.5,50)",[n.WorksheetFuncId.EXPON_DIST]:"=EXPON.DIST(0.2,10,TRUE)",[n.WorksheetFuncId.FLOOR_MATH]:"=FLOOR.MATH(24.3,5)",[n.WorksheetFuncId.GAMMA_DIST]:"=GAMMA.DIST(4.79, 1.234, 7, TRUE)",[n.WorksheetFuncId.NORM_S_INV]:"=NORM.S.INV(0.908789)",[n.WorksheetFuncId.CHISQ_TEST]:"=CHISQ.TEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PERCENTILE]:"=PERCENTILE(E2:E5,0.3)",[n.WorksheetFuncId.FIELDVALUE]:`=FIELDVALUE(A2, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.AVERAGEIF]:'=AVERAGEIF(B2:B5,"<23000")',[n.WorksheetFuncId.BITLSHIFT]:"=BITLSHIFT(4,2)",[n.WorksheetFuncId.BITRSHIFT]:"=BITRSHIFT(13,2)",[n.WorksheetFuncId.DATEVALUE]:'=DATEVALUE("1/1/2008")',[n.WorksheetFuncId.FILTERXML]:'=FILTERXML(B3,"//rc/@title")',[n.WorksheetFuncId.CUBEVALUE]:`=CUBEVALUE(Sales,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time)}].[2004]","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProduct)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Beverages)}]")`,[n.WorksheetFuncId.ENCODEURL]:`=ENCODEURL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EncodeURLExmapleLink)}")`,[n.WorksheetFuncId.HYPERLINK]:`=HYPERLINK("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HyperlinkExampleLink)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ClickForReport)}")`,[n.WorksheetFuncId.ISLOGICAL]:"=ISLOGICAL(TRUE)",[n.WorksheetFuncId.ISNONTEXT]:"=ISNONTEXT(A2)",[n.WorksheetFuncId.ISFORMULA]:"=ISFORMULA(A2)",[n.WorksheetFuncId.PDURATION]:"=PDURATION(2.5%,2000,2200)",[n.WorksheetFuncId.TIMEVALUE]:'=TIMEVALUE("22-Aug-2011 6:35 AM")',[n.WorksheetFuncId.TRANSPOSE]:"=TRANSPOSE(A2:F9)",[n.WorksheetFuncId.FREQUENCY]:"=FREQUENCY(A2:A20, B2:B5)",[n.WorksheetFuncId.BETA_DIST]:"=BETA.DIST(2,8,10,TRUE,1,3)",[n.WorksheetFuncId.BINOMDIST]:"=BINOMDIST(6,10,0.5,FALSE)",[n.WorksheetFuncId.BINOM_INV]:"=BINOM.INV(6,0.5,0.75)",[n.WorksheetFuncId.CHISQ_INV]:"=CHISQ.INV(0.3, 2)",[n.WorksheetFuncId.CRITBINOM]:"=CRITBINOM(6,0.5,0.75)",[n.WorksheetFuncId.EXPONDIST]:"=EXPONDIST(0.2,10,TRUE)",[n.WorksheetFuncId.F_DIST_RT]:"=F.DIST.RT(15.2069,6,4)",[n.WorksheetFuncId.FISHERINV]:"=FISHERINV(0.972955)",[n.WorksheetFuncId.GAMMADIST]:"=GAMMADIST(10.00001131,9,2,FALSE)",[n.WorksheetFuncId.GAMMA_INV]:"=GAMMA.INV(0.068094,9,2)",[n.WorksheetFuncId.NORM_DIST]:"=NORM.DIST(1, 0, 1, TRUE)",[n.WorksheetFuncId.T_DIST_2T]:"=T.DIST.2T(1.959999998,60)",[n.WorksheetFuncId.T_DIST_RT]:"=T.DIST.RT(1.959999998,60)",[n.WorksheetFuncId.INTERCEPT]:"=INTERCEPT(A2:A6, B2:B6)",[n.WorksheetFuncId.MODE_MULT]:"=MODE.MULT(A2:A13)",[n.WorksheetFuncId.MODE_SNGL]:"=MODE.SNGL(A2:A7)",[n.WorksheetFuncId.AGGREGATE]:"=AGGREGATE(12, 6, A1:A11, B1:B11)",[n.WorksheetFuncId.RANDARRAY]:"=RANDARRAY(5,3,1,100)",[n.WorksheetFuncId.COUNTIFS]:'=COUNTIFS(A2:A7,"<6",A2:A7,">1")',[n.WorksheetFuncId.DAVERAGE]:`=DAVERAGE(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:B2)`,[n.WorksheetFuncId.BAHTTEXT]:"=BAHTTEXT(1234)",[n.WorksheetFuncId.DPRODUCT]:`=DPRODUCT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:F3)`,[n.WorksheetFuncId.INDIRECT]:"=INDIRECT(A2)",[n.WorksheetFuncId.ISNUMBER]:"=ISNUMBER(A2)",[n.WorksheetFuncId.MINVERSE]:"=MINVERSE(A1:D4)",[n.WorksheetFuncId.RANK_AVG]:"=RANK.AVG(94,B2:B8)",[n.WorksheetFuncId.SUBTOTAL]:"=SUBTOTAL(9,A2:A5)",[n.WorksheetFuncId.BETADIST]:"=BETADIST(2,8,10,1,3)",[n.WorksheetFuncId.BETA_INV]:"=BETA.INV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.F_INV_RT]:"=F.INV.RT(0.01,6,4)",[n.WorksheetFuncId.GAMMAINV]:"=GAMMAINV(0.65, 4, 2)",[n.WorksheetFuncId.NORMDIST]:"=NORMDIST(42,40,1.5,TRUE)",[n.WorksheetFuncId.NORM_INV]:"=NORM.INV(0.908789,40,1.5)",[n.WorksheetFuncId.NORMSINV]:"=NORMSINV(0.9088)",[n.WorksheetFuncId.SUMX2MY2]:"=SUMX2MY2(A3:A9,B3:B9)",[n.WorksheetFuncId.SUMX2PY2]:"=SUMX2PY2(A3:A9,B3:B9)",[n.WorksheetFuncId.FORECAST]:"=FORECAST(30,A2:A6,B2:B6)",[n.WorksheetFuncId.QUARTILE]:"=QUARTILE(A2:A9,1)",[n.WorksheetFuncId.TRIMMEAN]:"=TRIMMEAN(A2:A12,0.2)",[n.WorksheetFuncId.T_INV_2T]:"=T.INV.2T(0.546449,60)",[n.WorksheetFuncId.AVERAGEA]:"=AVERAGEA(A2:A6)",[n.WorksheetFuncId.TEXTJOIN]:'=TEXTJOIN(",", TRUE, A2:A8)',[n.WorksheetFuncId.SEQUENCE]:"=SEQUENCE(4,5)",[n.WorksheetFuncId.ADDRESS]:`=ADDRESS(2,3,1,FALSE,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Book1)}]${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sheet1)}")`,[n.WorksheetFuncId.AVERAGE]:"=AVERAGE(A2:A6)",[n.WorksheetFuncId.COLUMNS]:"=COLUMNS(C1:E4)",[n.WorksheetFuncId.COUNTIF]:'=COUNTIF(B2:B5,">55")',[n.WorksheetFuncId.DAYS360]:'=DAYS360("30-Jan-2011","1-Feb-2011")',[n.WorksheetFuncId.DCOUNTA]:`=DCOUNTA(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F2)`,[n.WorksheetFuncId.DECIMAL]:'=DECIMAL("FF",16)',[n.WorksheetFuncId.DEGREES]:"=DEGREES(PI())",[n.WorksheetFuncId.DSTDEVP]:`=DSTDEVP(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.CUBESET]:`=CUBESET("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales)}","[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Product)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProducts)}].${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Children)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Products)}",1,"[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures)}].[${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesAmount)}]")`,[n.WorksheetFuncId.HLOOKUP]:`=HLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Axles)}", A1:C4, 2, TRUE)`,[n.WorksheetFuncId.IFERROR]:`=IFERROR(55/0, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ErrorInCalculation)}")`,[n.WorksheetFuncId.ISBLANK]:"=ISBLANK(A2)",[n.WorksheetFuncId.ISERROR]:"=ISERROR(#REF!)",[n.WorksheetFuncId.XLOOKUP]:`=XLOOKUP("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}",A2:A9,C2:C9,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NotFound)}",0,1)`,[n.WorksheetFuncId.MDETERM]:"=MDETERM(A2:D5)",[n.WorksheetFuncId.PRODUCT]:"=PRODUCT(A2:A4)",[n.WorksheetFuncId.RADIANS]:"=RADIANS(270)",[n.WorksheetFuncId.RANK_EQ]:"=RANK.EQ(7,A2:A6,1)",[n.WorksheetFuncId.REPLACE]:'=REPLACE(2009,3,2,"10")',[n.WorksheetFuncId.STDEV_S]:"=STDEV.S(A2:A11)",[n.WorksheetFuncId.STDEV_P]:"=STDEV.P(A3:A12)",[n.WorksheetFuncId.UNICODE]:'=UNICODE("B")',[n.WorksheetFuncId.UNICHAR]:"=UNICHAR(66)",[n.WorksheetFuncId.VLOOKUP]:"=VLOOKUP(103, A2:B26, 2, FALSE)",[n.WorksheetFuncId.WEEKDAY]:"=WEEKDAY(39492)",[n.WorksheetFuncId.GAMMALN]:"=GAMMALN(4)",[n.WorksheetFuncId.BETAINV]:"=BETAINV(0.685470581,8,10,1,3)",[n.WorksheetFuncId.CHIDIST]:"=CHIDIST(18.307,10)",[n.WorksheetFuncId.COMBINA]:"=COMBINA(4,3)",[n.WorksheetFuncId.CEILING]:"=CEILING(2.5, 1)",[n.WorksheetFuncId.NORMINV]:"=NORMINV(0.908789,40,1.5)",[n.WorksheetFuncId.POISSON]:"=POISSON(1, 2, TRUE)",[n.WorksheetFuncId.WEIBULL]:"=WEIBULL(105,20,100,TRUE)",[n.WorksheetFuncId.SUMXMY2]:"=SUMXMY2(A3:A9,B3:B9)",[n.WorksheetFuncId.CHITEST]:"=CHITEST(A2:B4,A6:B8)",[n.WorksheetFuncId.PEARSON]:"=PEARSON(A3:A7,B3:B7)",[n.WorksheetFuncId.GEOMEAN]:"=GEOMEAN(A2:A8)",[n.WorksheetFuncId.HARMEAN]:"=HARMEAN(A2:A8)",[n.WorksheetFuncId.STDEVPA]:"=STDEVPA(A3:A12)",[n.WorksheetFuncId.DATEDIF]:'=DATEDIF("1/1/2001","1/1/2003","Y")',[n.WorksheetFuncId.ARABIC]:'=ARABIC("LVII")',[n.WorksheetFuncId.CHOOSE]:`=CHOOSE(3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wide)}",115,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.World)}",8)`,[n.WorksheetFuncId.COLUMN]:"=COLUMN(C9)",[n.WorksheetFuncId.COUNTA]:"=COUNTA(B2:B6)",[n.WorksheetFuncId.DCOUNT]:`=DCOUNT(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Age)}", A1:F2)`,[n.WorksheetFuncId.DOLLAR]:"=DOLLAR(1.2351, 4)",[n.WorksheetFuncId.DSTDEV]:`=DSTDEV(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.GROWTH]:"=GROWTH(B2:B10, A2:A10, A11:A13)",[n.WorksheetFuncId.IMCOSH]:'=IMCOSH("4+3i")',[n.WorksheetFuncId.IMCSCH]:'=IMCSCH("4+3i")',[n.WorksheetFuncId.IMSECH]:'=IMSECH("4+3i")',[n.WorksheetFuncId.IMSINH]:'=IMSINH("4+3i")',[n.WorksheetFuncId.ISTEXT]:`=ISTEXT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region1)}")`,[n.WorksheetFuncId.LINEST]:"=LINEST(B2:B10, A2:A10, FALSE, TRUE)",[n.WorksheetFuncId.LOGEST]:"=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",[n.WorksheetFuncId.LOOKUP]:"=LOOKUP(4.19, A2:A6, B2:B6)",[n.WorksheetFuncId.XMATCH]:"=XMATCH(F2,C3:C9,1)",[n.WorksheetFuncId.MEDIAN]:"=MEDIAN(A2:A6)",[n.WorksheetFuncId.MINUTE]:"=MINUTE(0.53125)",[n.WorksheetFuncId.OFFSET]:"=OFFSET(D3,3,-2,1,1)",[n.WorksheetFuncId.PROPER]:`=PROPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisIsATITLE)}")`,[n.WorksheetFuncId.SEARCH]:`=SEARCH("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.E)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Statements)}",6)`,[n.WorksheetFuncId.SECOND]:"=SECOND(0.700208333333333)",[n.WorksheetFuncId.SHEETS]:`=SHEETS(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.My3DRef)})`,[n.WorksheetFuncId.STDEVP]:"=STDEVP(A3:A12)",[n.WorksheetFuncId.SUMIFS]:`=SUMIFS(A2:A9, B2:B9, "<>${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bananas)}", C2:C9, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom)}")`,[n.WorksheetFuncId.AVEDEV]:"=AVEDEV(A2:A8)",[n.WorksheetFuncId.CHIINV]:"=CHIINV(0.3, 2)",[n.WorksheetFuncId.COMBIN]:"=COMBIN(8,2)",[n.WorksheetFuncId.F_DIST]:"=F.DIST(15.2069,6,4,TRUE)",[n.WorksheetFuncId.FISHER]:"=FISHER(0.75)",[n.WorksheetFuncId.LOGINV]:"=LOGINV(0.039084, 3.5, 1.2)",[n.WorksheetFuncId.PERMUT]:"=PERMUT(100,3)",[n.WorksheetFuncId.T_DIST]:"=T.DIST(60,1,TRUE)",[n.WorksheetFuncId.CORREL]:"=CORREL(A2:A6, B2:B6)",[n.WorksheetFuncId.F_TEST]:"=F.TEST(A2:A6,B2:B6)",[n.WorksheetFuncId.T_TEST]:"=T.TEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.SKEW_P]:"=SKEW.P(A2:A11)",[n.WorksheetFuncId.Z_TEST]:"=Z.TEST(A2:A11,4)",[n.WorksheetFuncId.STDEVA]:"=STDEVA(A3:A12)",[n.WorksheetFuncId.MAXIFS]:`=MAXIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.MINIFS]:`=MINIFS(A2:A7,B2:B7,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",D2:D7,">100")`,[n.WorksheetFuncId.CONCAT]:`=CONCAT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas)}"," ", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser)}")`,[n.WorksheetFuncId.SWITCH]:`=SWITCH(WEEKDAY("10/10/2016"),1,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)}",2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}",3,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoMatch)}")`,[n.WorksheetFuncId.FILTER]:`=FILTER(A5:D20,(C5:C20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Apple)}")*(A5:A20="${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.East)}"),"")`,[n.WorksheetFuncId.UNIQUE]:"=UNIQUE(A2:A12)",[n.WorksheetFuncId.SORTBY]:"=SORTBY(D2:D9,E2:E9,1)",[n.WorksheetFuncId.BITAND]:"=BITAND(1,5)",[n.WorksheetFuncId.BITXOR]:"=BITXOR(5,3)",[n.WorksheetFuncId.ACOSH]:"=ACOSH(10)",[n.WorksheetFuncId.ACOTH]:"=ACOTH(6)",[n.WorksheetFuncId.ATANH]:"=ATANH(-0.1)",[n.WorksheetFuncId.ATAN2]:"=ATAN2(4,0)",[n.WorksheetFuncId.CLEAN]:"=CLEAN(A2)",[n.WorksheetFuncId.COUNT]:"=COUNT(A2:A7)",[n.WorksheetFuncId.DVARP]:`=DVARP(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.EXACT]:`=EXACT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Goodbye)}")`,[n.WorksheetFuncId.FALSE]:"=FALSE()",[n.WorksheetFuncId.FIXED]:"=FIXED(-1234.567, -1, TRUE)",[n.WorksheetFuncId.IMCOT]:'=IMCOT("4+3i")',[n.WorksheetFuncId.IMCSC]:'=IMCSC("4+3i")',[n.WorksheetFuncId.IMSEC]:'=IMSEC("4+3i")',[n.WorksheetFuncId.IMTAN]:'=IMTAN("4+3i")',[n.WorksheetFuncId.INDEX]:"=INDEX(A2:B3,2,1)",[n.WorksheetFuncId.ISERR]:"=ISERR(#N/A)",[n.WorksheetFuncId.ISREF]:"=ISREF(A2)",[n.WorksheetFuncId.LOWER]:`=LOWER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EECummings)}")`,[n.WorksheetFuncId.MATCH]:"=MATCH(39,B2:B5,1)",[n.WorksheetFuncId.MMULT]:"=MMULT(A1:B3, C1:F2)",[n.WorksheetFuncId.MONTH]:"=MONTH(40648)",[n.WorksheetFuncId.RIGHT]:`=RIGHT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",5)`,[n.WorksheetFuncId.ROUND]:"=ROUND(2.149, 1)",[n.WorksheetFuncId.SHEET]:`=SHEET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Table1)})`,[n.WorksheetFuncId.STDEV]:"=STDEV(A3:A12)",[n.WorksheetFuncId.SUMIF]:'=SUMIF(A2:A5,">160000")',[n.WorksheetFuncId.TODAY]:"=TODAY()",[n.WorksheetFuncId.TREND]:"=TREND(B2:B10, A2:A10, A11:A13, TRUE)",[n.WorksheetFuncId.TRUNC]:"=TRUNC(8.9)",[n.WorksheetFuncId.UPPER]:`=UPPER("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KelliXu)}")`,[n.WorksheetFuncId.VALUE]:"=VALUE(1000)",[n.WorksheetFuncId.VAR_S]:"=VAR.S(A2:A11)",[n.WorksheetFuncId.VAR_P]:"=VAR.P(A2:A11)",[n.WorksheetFuncId.GAMMA]:"=GAMMA(-3.75)",[n.WorksheetFuncId.GAUSS]:"=GAUSS(2)",[n.WorksheetFuncId.FDIST]:"=FDIST(15.20686486,6,4)",[n.WorksheetFuncId.F_INV]:"=F.INV(0.01,6,4)",[n.WorksheetFuncId.FLOOR]:"=FLOOR(23.25, 0.1)",[n.WorksheetFuncId.TDIST]:"=TDIST(60, 1, 1)",[n.WorksheetFuncId.COVAR]:"=COVAR(A2:A6, B2:B6)",[n.WorksheetFuncId.FTEST]:"=FTEST(A2:A6,B2:B6)",[n.WorksheetFuncId.STEYX]:"=STEYX(A3:A9,B3:B9)",[n.WorksheetFuncId.SLOPE]:"=SLOPE(A3:A9,B3:B9)",[n.WorksheetFuncId.TTEST]:"=TTEST(A2:A10,B2:B10,2,1)",[n.WorksheetFuncId.DEVSQ]:"=DEVSQ(A2:A8)",[n.WorksheetFuncId.SUMSQ]:"=SUMSQ(3, 4)",[n.WorksheetFuncId.ZTEST]:"=ZTEST(A2:A11,6)",[n.WorksheetFuncId.LARGE]:"=LARGE(A2:B6,7)",[n.WorksheetFuncId.SMALL]:"=SMALL(A2:A10,4)",[n.WorksheetFuncId.MUNIT]:"=MUNIT(2)",[n.WorksheetFuncId.T_INV]:"=T.INV(0.75,2)",[n.WorksheetFuncId.ROMAN]:"=ROMAN(499,0)",[n.WorksheetFuncId.POWER]:"=POWER(5,2)",[n.WorksheetFuncId.ISPMT]:"=ISPMT(10%, 2, 5, 1000)",[n.WorksheetFuncId.VARPA]:"=VARPA(1, 2)",[n.WorksheetFuncId.AREAS]:"=AREAS(B2:D4)",[n.WorksheetFuncId.ASINH]:"=ASINH(10)",[n.WorksheetFuncId.BITOR]:"=BITOR(23,10)",[n.WorksheetFuncId.ACOS]:"=ACOS(-0.5)",[n.WorksheetFuncId.ACOT]:"=ACOT(2)",[n.WorksheetFuncId.ATAN]:"=ATAN(1)",[n.WorksheetFuncId.CELL]:`=CELL("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Address)}", C2)`,[n.WorksheetFuncId.CHAR]:"=CHAR(65)",[n.WorksheetFuncId.COSH]:"=COSH(EXP(1))",[n.WorksheetFuncId.COTH]:"=COTH(2)",[n.WorksheetFuncId.CSCH]:"=CSCH(2)",[n.WorksheetFuncId.DATE]:"=DATE(2008,1,2)",[n.WorksheetFuncId.DAYS]:'=DAYS("3/15/2011","2/1/2011")',[n.WorksheetFuncId.DGET]:`=DGET(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.DMAX]:`=DMAX(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DMIN]:`=DMIN(A5:E11, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DSUM]:`=DSUM(A4:E10,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit)}", A1:F3)`,[n.WorksheetFuncId.DVAR]:`=DVAR(A4:E10, "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield)}", A1:A3)`,[n.WorksheetFuncId.FACT]:"=FACT(5)",[n.WorksheetFuncId.FIND]:`=FIND("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.M)}",A2)`,[n.WorksheetFuncId.HOUR]:"=HOUR(0.75)",[n.WorksheetFuncId.IFNA]:`=IFNA("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoNAError)}", "${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Error)}")`,[n.WorksheetFuncId.IPMT]:"=IPMT(10%, 3, 3, 8000)",[n.WorksheetFuncId.ISNA]:"=ISNA(#REF!)",[n.WorksheetFuncId.LEFT]:`=LEFT("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice)}",4)`,[n.WorksheetFuncId.MIRR]:"=MIRR(A2:A7, 0.1, 0.12)",[n.WorksheetFuncId.NPER]:"=NPER(0.12/12, -100, -1000, 10000, 1)",[n.WorksheetFuncId.PPMT]:"=PPMT(0.08, 10, 10, 200000)",[n.WorksheetFuncId.RAND]:"=RAND()",[n.WorksheetFuncId.RANK]:"=RANK(3.5,A2:A6,1)",[n.WorksheetFuncId.RATE]:"=RATE(4*12, -200, 8000)",[n.WorksheetFuncId.REPT]:'=REPT("*-", 3)',[n.WorksheetFuncId.ROWS]:"=ROWS(C1:E4)",[n.WorksheetFuncId.SECH]:"=SECH(0)",[n.WorksheetFuncId.SIGN]:"=SIGN(10)",[n.WorksheetFuncId.SINH]:"=SINH(2)",[n.WorksheetFuncId.SQRT]:"=SQRT(16)",[n.WorksheetFuncId.TANH]:"=TANH(0.5)",[n.WorksheetFuncId.TEXT]:'=TEXT(1234.567,"$#,##0.00")',[n.WorksheetFuncId.TIME]:"=TIME(16,48,10)",[n.WorksheetFuncId.TRIM]:`=TRIM("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuarterEarnings)}")`,[n.WorksheetFuncId.TRUE]:"=TRUE()",[n.WorksheetFuncId.TYPE]:`=TYPE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Smith)}")`,[n.WorksheetFuncId.VARP]:"=VARP(A2:A11)",[n.WorksheetFuncId.YEAR]:"=YEAR(39634)",[n.WorksheetFuncId.INFO]:`=INFO("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numfile)}")`,[n.WorksheetFuncId.EVEN]:"=EVEN(1.5)",[n.WorksheetFuncId.FINV]:"=FINV(0.42, 2, 3)",[n.WorksheetFuncId.PROB]:"=PROB(A3:A6,B3:B6,2)",[n.WorksheetFuncId.KURT]:"=KURT(A2:A11)",[n.WorksheetFuncId.SKEW]:"=SKEW(A2:A11)",[n.WorksheetFuncId.MODE]:"=MODE(A2:A7)",[n.WorksheetFuncId.MINA]:"=MINA(A2:A6)",[n.WorksheetFuncId.MAXA]:"=MAXA(A2:A6)",[n.WorksheetFuncId.VARA]:"=VARA(1, 2)",[n.WorksheetFuncId.SORT]:"=SORT(A2:A17)",[n.WorksheetFuncId.ASIN]:"=ASIN(-0.5)",[n.WorksheetFuncId.BASE]:"=BASE(7,2)",[n.WorksheetFuncId.CODE]:`=CODE("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CodeA)}")`,[n.WorksheetFuncId.AND]:"=AND(A2>1,A2<100)",[n.WorksheetFuncId.COS]:"=COS(1.047)",[n.WorksheetFuncId.COT]:"=COT(30)",[n.WorksheetFuncId.CSC]:"=CSC(15)",[n.WorksheetFuncId.DAY]:"=DAY(40648)",[n.WorksheetFuncId.DDB]:"=DDB(2400,300,10*365,1)",[n.WorksheetFuncId.RTD]:`=RTD(mycomaddin.progid,,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ServerName)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price)}")`,[n.WorksheetFuncId.EXP]:"=EXP(1)",[n.WorksheetFuncId.INT]:"=INT(8.9)",[n.WorksheetFuncId.IRR]:"=IRR(A2:A4,-10%)",[n.WorksheetFuncId.LEN]:`=LEN("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Excel)}")`,[n.WorksheetFuncId.LOG]:"=LOG(10)",[n.WorksheetFuncId.MAX]:"=MAX(A2:A6)",[n.WorksheetFuncId.MID]:`=MID("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FluidFlow)}",1,5)`,[n.WorksheetFuncId.MIN]:"=MIN(A2:A6)",[n.WorksheetFuncId.MOD]:"=MOD(3, 2)",[n.WorksheetFuncId.NOT]:"=NOT(A2>100)",[n.WorksheetFuncId.NPV]:"=NPV(0.1, -10000, 3000, 4200, 6800)",[n.WorksheetFuncId.PMT]:"=PMT(0.08/12,10,10000)",[n.WorksheetFuncId.ROW]:"=ROW(C10)",[n.WorksheetFuncId.RRI]:"=RRI(96,10000,11000)",[n.WorksheetFuncId.SEC]:"=SEC(30)",[n.WorksheetFuncId.SIN]:"=SIN(PI())",[n.WorksheetFuncId.SLN]:"=SLN(30000, 7500, 10)",[n.WorksheetFuncId.SUM]:"=SUM(A1:A3)",[n.WorksheetFuncId.SYD]:"=SYD(30000,7500,10,1)",[n.WorksheetFuncId.TAN]:"=TAN(0.785)",[n.WorksheetFuncId.VAR]:"=VAR(A2:A11)",[n.WorksheetFuncId.VDB]:"=VDB(2400, 300, 10*365, 0, 1)",[n.WorksheetFuncId.XOR]:"=XOR(3>0,2<9)",[n.WorksheetFuncId.ODD]:"=ODD(1.5)",[n.WorksheetFuncId.PHI]:"=PHI(0.75)",[n.WorksheetFuncId.RSQ]:"=RSQ(A3:A9, B3:B9)",[n.WorksheetFuncId.IFS]:`=IFS(A2>89,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsA)}",A2>79,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB)}",A2>69,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsC)}",A2>59,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsD)}",TRUE,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsF)}")`,[n.WorksheetFuncId.DB]:"=DB(1000000,100000,6,1,7)",[n.WorksheetFuncId.FV]:"=FV(0.06/12, 10, -200, -500, 1)",[n.WorksheetFuncId.IF]:`=IF(C2>B2,"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OverBudget)}","${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WithinBudget)}")`,[n.WorksheetFuncId.LN]:"=LN(86)",[n.WorksheetFuncId.NA]:"=NA()",[n.WorksheetFuncId.OR]:"=OR(A2>1,A2<100)",[n.WorksheetFuncId.PV]:"=PV(0.08/12, 12*20, 500, , 0)",[n.WorksheetFuncId.N]:`=N(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Even)})`,[n.WorksheetFuncId.T]:`=T("${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello)}")`,[n.WorksheetFuncId.ACCRINT]:"=ACCRINT(39508,39691,39569,0.1,1000,2,0)",[n.WorksheetFuncId.ACCRINTM]:"=ACCRINTM(39539,39614,0.1,1000,3)",[n.WorksheetFuncId.AMORDEGRC]:"=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.AMORLINC]:"=AMORLINC(2400,39679,39813,300,1,0.15,1)",[n.WorksheetFuncId.BESSELI]:"=BESSELI(1.5,1)",[n.WorksheetFuncId.BESSELJ]:"=BESSELJ(1.9,2)",[n.WorksheetFuncId.BESSELK]:"=BESSELK(1.5,1)",[n.WorksheetFuncId.BESSELY]:"=BESSELY(2.5,1)",[n.WorksheetFuncId.BIN2DEC]:"=BIN2DEC(1100100)",[n.WorksheetFuncId.BIN2HEX]:"=BIN2HEX(11111011, 4)",[n.WorksheetFuncId.BIN2OCT]:"=BIN2OCT(1001, 3)",[n.WorksheetFuncId.COMPLEX]:'=COMPLEX(3,4,"j")',[n.WorksheetFuncId.CONVERT]:'=CONVERT(1,"lbm","kg")',[n.WorksheetFuncId.COUPDAYBS]:'=COUPDAYBS("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPDAYS]:'=COUPDAYS("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPDAYSNC]:'=COUPDAYSNC("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPNCD]:'=COUPNCD("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.COUPNUM]:'=COUPNUM("25-Jan-2011","15-Nov-2012",2,1)',[n.WorksheetFuncId.COUPPCD]:'=COUPPCD("25-Jan-2011","15-Nov-2011",2,1)',[n.WorksheetFuncId.CUMIPMT]:"=CUMIPMT(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.CUMPRINC]:"=CUMPRINC(A2/12,A3*12,A4,13,24,0)",[n.WorksheetFuncId.DEC2BIN]:"=DEC2BIN(9, 4)",[n.WorksheetFuncId.DEC2HEX]:"=DEC2HEX(100,4)",[n.WorksheetFuncId.DEC2OCT]:"=DEC2OCT(58,3)",[n.WorksheetFuncId.DELTA]:"=DELTA(5,4)",[n.WorksheetFuncId.DISC]:'=DISC("7/1/2018","1/1/2048",97.975,100,1)',[n.WorksheetFuncId.DOLLARDE]:"=DOLLARDE(1.02,16)",[n.WorksheetFuncId.DOLLARFR]:"=DOLLARFR(1.125,16)",[n.WorksheetFuncId.DURATION]:'=DURATION("7/1/2018","1/1/2048",8%,9%,2,1)',[n.WorksheetFuncId.EDATE]:'=EDATE("15-Jan-2011",1)',[n.WorksheetFuncId.EFFECT]:"=EFFECT(0.0525,4)",[n.WorksheetFuncId.EOMONTH]:'=EOMONTH("1-Jan-2011",1)',[n.WorksheetFuncId.ERF]:"=ERF(0.745)",[n.WorksheetFuncId.ERFC]:"=ERFC(1)",[n.WorksheetFuncId.FACTDOUBLE]:"=FACTDOUBLE(6)",[n.WorksheetFuncId.FORECAST_ETS]:"=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:"=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:"=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",[n.WorksheetFuncId.FORECAST_ETS_STAT]:"=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",[n.WorksheetFuncId.FVSCHEDULE]:"=FVSCHEDULE(1,{0.09,0.11,0.1})",[n.WorksheetFuncId.GCD]:"=GCD(24,36)",[n.WorksheetFuncId.GESTEP]:"=GESTEP(5,4)",[n.WorksheetFuncId.HEX2BIN]:"=HEX2BIN(F,8)",[n.WorksheetFuncId.HEX2DEC]:"=HEX2DEC(FFFFFFFF5B)",[n.WorksheetFuncId.HEX2OCT]:"=HEX2OCT(F, 3)",[n.WorksheetFuncId.IMABS]:'=IMABS("5+12i")',[n.WorksheetFuncId.IMAGE]:'=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',[n.WorksheetFuncId.IMAGINARY]:'=IMAGINARY("3+4i")',[n.WorksheetFuncId.IMARGUMENT]:'=IMARGUMENT("3+4i")',[n.WorksheetFuncId.IMCONJUGATE]:'=IMCONJUGATE("3+4i")',[n.WorksheetFuncId.IMCOS]:'=IMCOS("1+i")',[n.WorksheetFuncId.IMDIV]:'=IMDIV("-238+240i","10+24i")',[n.WorksheetFuncId.IMEXP]:'=IMEXP("1+i")',[n.WorksheetFuncId.IMLN]:'=IMLN("3+4i")',[n.WorksheetFuncId.IMLOG10]:'=IMLOG10("3+4i")',[n.WorksheetFuncId.IMLOG2]:'=IMLOG2("3+4i")',[n.WorksheetFuncId.IMPOWER]:'=IMPOWER("2+3i", 3)',[n.WorksheetFuncId.IMPRODUCT]:'=IMPRODUCT("3+4i","5-3i")',[n.WorksheetFuncId.IMREAL]:'=IMREAL("6-9i")',[n.WorksheetFuncId.IMSIN]:'=IMSIN("4+3i")',[n.WorksheetFuncId.IMSQRT]:'=IMSQRT("1+i")',[n.WorksheetFuncId.IMSUB]:'=IMSUB("13+4i","5+3i")',[n.WorksheetFuncId.IMSUM]:'=IMSUM("3+4i","5-3i")',[n.WorksheetFuncId.INTRATE]:'=INTRATE("2/15/2008","5/15/2008",1000000,1014420,2)',[n.WorksheetFuncId.ISEVEN]:"=ISEVEN(2.5)",[n.WorksheetFuncId.ISODD]:"=ISODD(2.5)",[n.WorksheetFuncId.LAMBDA]:"=LAMBDA(a, b, SQRT((a^2+b^2)))",[n.WorksheetFuncId.LET]:`=LET(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)}, SUM(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)}, COUNT(A1:A10), ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)} / ${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count)})`,[n.WorksheetFuncId.LCM]:"=LCM(5,2)",[n.WorksheetFuncId.LOG10]:"=LOG10(86)",[n.WorksheetFuncId.MDURATION]:'=MDURATION("1/1/2008","1/1/2016",8%,9%,2,1)',[n.WorksheetFuncId.MROUND]:"=MROUND(10,3)",[n.WorksheetFuncId.MULTINOMIAL]:"=MULTINOMIAL(2,3,4)",[n.WorksheetFuncId.NETWORKDAYS]:'=NETWORKDAYS("10/1/2012","3/1/2013")',[n.WorksheetFuncId.NOMINAL]:"=NOMINAL(0.053543, 4)",[n.WorksheetFuncId.NOW]:"=NOW()",[n.WorksheetFuncId.OCT2BIN]:"=OCT2BIN(3,3)",[n.WorksheetFuncId.OCT2DEC]:"=OCT2DEC(54)",[n.WorksheetFuncId.OCT2HEX]:"=OCT2HEX(100,4)",[n.WorksheetFuncId.ODDFPRICE]:'=ODDFPRICE("11/11/2008","3/1/2021","10/15/2008","3/1/2009",7.85%,6.25%,100,2,1)',[n.WorksheetFuncId.ODDFYIELD]:'=ODDFYIELD("11/11/2008","3/1/2021","10/15/2008","3/1/2009",5.75%,84.5,100,2,0)',[n.WorksheetFuncId.ODDLPRICE]:'=ODDLPRICE("2/7/2008","6/15/2008","10/15/2007",3.75%,4.05%,100,2,0)',[n.WorksheetFuncId.ODDLYIELD]:'=ODDLYIELD("4/20/2008","6/15/2008","12/24/2007",3.75%,99.875,100,2,0)',[n.WorksheetFuncId.PI]:"=PI()",[n.WorksheetFuncId.PRICE]:'=PRICE("2/15/2008","11/15/2017",5.75%,6.5%,100,2,0)',[n.WorksheetFuncId.PRICEDISC]:'=PRICEDISC("2/16/2008","3/1/2008",5.25%,100,2)',[n.WorksheetFuncId.PRICEMAT]:'=PRICEMAT("2/15/2008","4/13/2008","11/11/2007",6.1%,6.1%,0)',[n.WorksheetFuncId.QUOTIENT]:"=QUOTIENT(5,2)",[n.WorksheetFuncId.RANDBETWEEN]:"=RANDBETWEEN(1,100)",[n.WorksheetFuncId.RECEIVED]:'=RECEIVED("2/15/2008","5/15/2008",1000000,5.75%,2)',[n.WorksheetFuncId.RECURSE]:"=RECURSE()",[n.WorksheetFuncId.ROUNDDOWN]:"=ROUNDDOWN(3.14159,3)",[n.WorksheetFuncId.ROUNDUP]:"=ROUNDUP(3.14159,3)",[n.WorksheetFuncId.SERIESSUM]:"=SERIESSUM(0.785398163,0,2,A4:A7)",[n.WorksheetFuncId.SQRTPI]:"=SQRTPI(1)",[n.WorksheetFuncId.TBILLEQ]:'=TBILLEQ("3/31/2008","6/1/2008",9.14%)',[n.WorksheetFuncId.TBILLPRICE]:'=TBILLPRICE("3/31/2008","6/1/2008",9%)',[n.WorksheetFuncId.TBILLYIELD]:'=TBILLYIELD("3/31/2008","6/1/2008",98.45%)',[n.WorksheetFuncId.TINV]:"=TINV(0.05464,60)",[n.WorksheetFuncId.WEEKNUM]:'=WEEKNUM("3/9/2012",2)',[n.WorksheetFuncId.WORKDAY]:'=WORKDAY("10/1/2008",151)',[n.WorksheetFuncId.XIRR]:"=XIRR(A3:A7, B3:B7, 0.1)",[n.WorksheetFuncId.XNPV]:"=XNPV(0.09, A2:A6, B2:B6)",[n.WorksheetFuncId.YEARFRAC]:'=YEARFRAC("1/1/2012","7/30/2012")',[n.WorksheetFuncId.YIELD]:'=YIELD("2/15/2008","11/15/2016",5.75%,95.04287,100,2,0)',[n.WorksheetFuncId.YIELDDISC]:'=YIELDDISC("2/16/2008","3/1/2008",99.795,100,2)',[n.WorksheetFuncId.YIELDMAT]:'=YIELDMAT("3/15/2008","11/3/2008","11/8/2007",6.25%,100.0123,0)',[n.WorksheetFuncId.TEXTSPLIT]:'=TEXTSPLIT("1,2,3;4,5,6",",",";")',[n.WorksheetFuncId.TEXTBEFORE]:'=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.TEXTAFTER]:'=TEXTAFTER("Red riding hood\'s, red hood", "hood")',[n.WorksheetFuncId.VSTACK]:"=VSTACK({1,2},{3,4},5)",[n.WorksheetFuncId.HSTACK]:"=HSTACK({1;2},{3;4},5)",[n.WorksheetFuncId.MAP]:"=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",[n.WorksheetFuncId.WRAPROWS]:"=WRAPROWS(A2:G2,3)",[n.WorksheetFuncId.SCAN]:"=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",[n.WorksheetFuncId.MAKEARRAY]:"=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",[n.WorksheetFuncId.REDUCE]:"=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",[n.WorksheetFuncId.NORMSDIST]:"=NORMDIST(A2,A3,A4,TRUE)",[n.WorksheetFuncId.CHOOSEROWS]:"=CHOOSEROWS(A2:B7,1,3,5,1)",[n.WorksheetFuncId.CHOOSECOLS]:"=CHOOSECOLS(A2:E7,1,3,5,1)",[n.WorksheetFuncId.DROP]:"=DROP(A2:C4,2)",[n.WorksheetFuncId.WRAPCOLS]:"=WRAPCOLS(A2:F2,3)",[n.WorksheetFuncId.TOCOL]:"=TOCOL(A2:D4)",[n.WorksheetFuncId.TAKE]:"=TAKE(A2:C4,2)",[n.WorksheetFuncId.TOROW]:"=TOROW(A2:D4)",[n.WorksheetFuncId.BYCOL]:`=BYCOL(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.BYROW]:`=BYROW(A1:C2, LAMBDA(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)}, MAX(${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array)})))`,[n.WorksheetFuncId.EXPAND]:"=EXPAND(A2:B3,3,3)",[n.WorksheetFuncId.DBCS]:'=DBCS("EXCEL")',[n.WorksheetFuncId.ASC]:'=ASC("EXCEL")',[n.WorksheetFuncId.LENB]:'=LENB("EXCEL")',[n.WorksheetFuncId.FURIGANA]:"=PHONETIC(C4)",[n.WorksheetFuncId.ISOMITTED]:`=LAMBDA(x,y, IF(ISOMITTED(y),"${FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingSecondArgument)}",x+y))(1,)`,[n.WorksheetFuncId.MIDB]:"=MIDB(A2,7,20)",[n.WorksheetFuncId.RIGHTB]:"=RIGHTB(A2,7)"})))},8921:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationDefinitionsMap=t.RegisterAnnotation=t.alFeatureNamePrefix=void 0;const n=r(6913),i=r(1592),a=r(5528),o=r(7160),s=r(6246);t.alFeatureNamePrefix="x10";const u={[s.ALAnnotationKind.FormulaByExample]:{annotationType:o.FormulaByExampleAnnotation,isModelRequired:!1},[s.ALAnnotationKind.CalculatedColumnSuggestion]:{annotationType:a.CalculatedColumnSuggestion,isModelRequired:!0},[s.ALAnnotationKind.FormulaByExamplePreview]:{annotationType:o.FormulaByExamplePreviewAnnotation,isModelRequired:!1},[s.ALAnnotationKind.FormulaCompletionFormulaAnnotation]:{annotationType:i.FormulaCompletionFormulaAnnotation,isModelRequired:!0},[s.ALAnnotationKind.FormulaCompletionBlockedAnnotation]:{annotationType:i.FormulaCompletionBlockedAnnotation,isModelRequired:!0}};t.RegisterAnnotation={[s.ALAnnotationKind.FormulaByExample]:!0,[s.ALAnnotationKind.CalculatedColumnSuggestion]:!0,[s.ALAnnotationKind.FormulaByExamplePreview]:!0,[s.ALAnnotationKind.FormulaCompletionFormulaAnnotation]:!0,[s.ALAnnotationKind.FormulaCompletionBlockedAnnotation]:!0},t.AnnotationDefinitionsMap=(0,n.mapFromArrayOfPairs)((0,n.strEnumArray)(s.ALAnnotationKind).map((e=>[e,{annotationName:u[e].annotationType.getTypeName(),featureName:`${t.alFeatureNamePrefix}_${e}`,isModelRequired:u[e].isModelRequired}])))},7154:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AugLoopService=void 0;const n=r(6913),i=r(1633),a=r(8921),o=r(4352),s=r(6246);t.AugLoopService=class{async registerALAnnotation(e){const t=this.registerAnnotationCallbacks[e].getValue();return"Failure"===(await t).kind&&this.registerAnnotationCallbacks[e].reset(),t}async sendSignal(e,t){try{const r=await this.augLoopInterop.sendSignal(e,`${a.alFeatureNamePrefix}_${i.PluginFactoryName[t]}`);return(0,n.isDefined)(r)?(0,n.success)(r):(0,n.failure)(r)}catch(e){return(0,n.failure)(e)}}constructor(e){this.augLoopInterop=e,this.registerAnnotationCallbacks=(0,n.mapFromArrayOfPairs)((0,n.strEnumArray)(s.ALAnnotationKind).map((e=>[e,new o.ResettableLazy((async()=>{try{const t=a.AnnotationDefinitionsMap[e],r=await this.augLoopInterop.registerOnAnnotation(s.ALAnnotationKind[e],t.annotationName,t.featureName,t.isModelRequired);return(0,n.success)(r)}catch(e){return(0,n.failure)(e)}}))])))}}},514:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.speedUnitTypeEnums=t.informationUnitTypeEnums=t.areaUnitTypeEnums=t.volumeUnitTypeEnums=t.temperatureUnitTypeEnums=t.magnetismUnitTypeEnums=t.powerUnitTypeEnums=t.energyUnitTypeEnums=t.forceUnitTypeEnums=t.pressureUnitTypeEnums=t.timeUnitTypeEnums=t.distanceUnitTypeEnums=t.massUnitTypeEnums=void 0,t.getConvertEnum=function(e,t,r,n){const a=i.getValue().map((e=>e.getValue())),o=[].concat(...a);if(2===e)return o;if(3===e){const e=function(e,t,r){const n=e.spans[r[1].label].start,a=e.spans[r[1].label].end,o=t.substring(n,a).replace(/^"|"$/g,"")??"";if(""===o)return[];for(const e of i.getValue())if(e.getValue().find((e=>e.value===o)))return e.getValue();return[]}(t,r,n);return e.length>0?e:o}return[]};const n=r(4352);t.massUnitTypeEnums=new n.ResettableLazy((()=>[{value:"g",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gram)},{value:"sg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Slug)},{value:"lbm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundM)},{value:"u",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atomic)},{value:"ozm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ozm)},{value:"grain",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Grain)},{value:"cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeight)},{value:"uk_cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeightUk)},{value:"stone",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Stone)},{value:"ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ton)},{value:"uk_ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TonUk)}])),t.distanceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"m",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Meter)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMile)},{value:"Nmi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMile)},{value:"in",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Inch)},{value:"ft",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ft)},{value:"yd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yd)},{value:"ang",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Angs)},{value:"Pica",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pica)},{value:"ell",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ell)},{value:"ly",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYr)},{value:"parsec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Parsec)},{value:"survey_mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MileUs)}])),t.timeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"yr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yr)},{value:"day",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Day)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hour)},{value:"mn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Minute)},{value:"sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sec)}])),t.pressureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"Pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pascal)},{value:"atm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atmos)},{value:"mmHg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Merc)},{value:"psi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Psi)},{value:"Torr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Torr)}])),t.forceUnitTypeEnums=new n.ResettableLazy((()=>[{value:"N",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Newton)},{value:"dyn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Dyne)},{value:"lbf",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundF)},{value:"pond",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pond)}])),t.energyUnitTypeEnums=new n.ResettableLazy((()=>[{value:"J",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Joule)},{value:"e",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Erg)},{value:"cal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ItCal)},{value:"eV",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volt)},{value:"HPh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePwHr)},{value:"Wh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WattHr)},{value:"flb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FtPound)},{value:"BTU",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Btu)},{value:"c",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThermCal)}])),t.powerUnitTypeEnums=new n.ResettableLazy((()=>[{value:"HP",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePw)},{value:"W",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Watt)},{value:"PS",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorseStr)}])),t.magnetismUnitTypeEnums=new n.ResettableLazy((()=>[{value:"T",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tessla)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gauss)}])),t.temperatureUnitTypeEnums=new n.ResettableLazy((()=>[{value:"C",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cels)},{value:"F",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fahr)},{value:"K",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Kelv)},{value:"Rank",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Rankine)},{value:"Reau",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Reaumur)}])),t.volumeUnitTypeEnums=new n.ResettableLazy((()=>[{value:"tsp",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tsp)},{value:"tbs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tbs)},{value:"oz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Oz)},{value:"cup",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cup)},{value:"qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUs)},{value:"gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gal)},{value:"l",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Liter)},{value:"uk_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUk)},{value:"us_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUs)},{value:"ang^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow3)},{value:"barrel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Barrel)},{value:"bushel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bushel)},{value:"ft^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow3)},{value:"GRT",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegTon)},{value:"in^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow3)},{value:"ly^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow3)},{value:"mi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow3)},{value:"MTON",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeasTon)},{value:"Nmi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow3)},{value:"Pica^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow3)},{value:"tspm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MdnTsp)},{value:"uk_gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GalUk)},{value:"yd^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow3)},{value:"uk_qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUk)}])),t.areaUnitTypeEnums=new n.ResettableLazy((()=>[{value:"uk_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUk)},{value:"us_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUs)},{value:"ang^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow2)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Are)},{value:"ft^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow2)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hectare)},{value:"in^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow2)},{value:"ly^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow2)},{value:"m^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeterPow2)},{value:"Morgen",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Morgen)},{value:"mi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow2)},{value:"Nmi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow2)},{value:"Pica^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow2)},{value:"yd^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow2)}])),t.informationUnitTypeEnums=new n.ResettableLazy((()=>[{value:"bit",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bit)},{value:"byte",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Byte)}])),t.speedUnitTypeEnums=new n.ResettableLazy((()=>[{value:"admkn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AdmKnot)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Knot)},{value:"m/hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashHr)},{value:"m/sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashSec)},{value:"mph",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MPH)}]));const i=new n.ResettableLazy((()=>[t.massUnitTypeEnums,t.distanceUnitTypeEnums,t.timeUnitTypeEnums,t.pressureUnitTypeEnums,t.forceUnitTypeEnums,t.energyUnitTypeEnums,t.powerUnitTypeEnums,t.magnetismUnitTypeEnums,t.temperatureUnitTypeEnums,t.volumeUnitTypeEnums,t.areaUnitTypeEnums,t.informationUnitTypeEnums,t.speedUnitTypeEnums]))},3592:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteEnumPluginDependenciesResolved=t.AutocompleteEnumPlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(514),l=r(1235),c=r(7900),d=r(9084),m=r(2937),g=r(8795),p=r(6307),h=r(8708),f=r(9615),S=r(9731),v=h.PluginRegistry.create(s.PluginFactoryName.AutocompleteEnumPlugin,s.PluginGroup.Excel);let y=(()=>{let e,t,r,m=[v.x10Plugin()],g=[],h=[];return t=class{isUserDefinedEnumFeatureEnabled(){return(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteUserDefinedEnum")}*run(e){const t=yield{kind:p.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==p.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value;let n;if(this.isUserDefinedEnumFeatureEnabled()){const e=yield{kind:p.ComputationRequestKind.GetFunctionsInfo};if(e.kind!==p.ComputationRequestKind.GetFunctionsInfo)return this.logFailure("failed to get functions info"),null;n=e.functionsInfo.filter((e=>e.IsDynamicUdf&&e.CustomEnums.length>0))}const s=new c.AutoCompleteEnumVisitor(r,e.caretPosition,n);if((0,a.reduceBottomUp)(s,r),void 0===s.stringStartPosition||void 0===s.stringEndPosition||void 0===s.functionHead&&void 0===s.customFunctionName||void 0===s.argIndex||void 0===s.functionArgs||s.isInsideArrayNode)return null;const d=s.argIndex+1,{stringStartPosition:m,stringEndPosition:g,functionHead:h,customFunctionName:f}=s,S=e.caretPosition===g?e.content.substring(m,g).toUpperCase():"";let v,y=!1;if(this.isUserDefinedEnumFeatureEnabled()&&void 0!==f&&void 0!==n){const e=n.find((e=>e.NameDataStrings===f));if(!e)return this.logFailure("can't get custom function info by function name"),null;const{udfEnumInfo:t,isStringTypeEnum:r}=this.getUdfParamEnumInfoByArg(d,e);y=r,v=t,void 0!==v&&a.ulsLogger.ULS.traceTag(505759755,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Autocompleted with custom enum")}else if(void 0!==h)if(h.id===a.WorksheetFuncId.CONVERT)v=(0,u.getConvertEnum)(d,r,e.content,s.functionArgs);else{const e=l.functionEnums.getValue();v=this.getEnumInfoByArg(d,e,h.id)}if((0,i.isNone)(v))return null;const F=yield{kind:p.ComputationRequestKind.GetConfig};if(F.kind!==p.ComputationRequestKind.GetConfig)return this.logFailure("failed to get config"),null;const b=F.config.localeInfo,C=this.getLocalizedEnumInfo(v,b);if(0===C.length)return this.logFailure("failed to get enum info for values/descriptions"),null;const{prefixedEnumInfo:k,notPrefixedEnumInfo:E}=this.getFilteredEnumInfo(S,C,h?.id),A=this.shouldAddDoubleQuotes(h?.id)||y;return{items:[...this.generateCompletionItems(k,m,g,!0,A),...this.generateCompletionItems(E,m,g,!1,A)]}}generateCompletionItems(e,t,r,n,i){return e.map((e=>{const a=i?`"${e.value}"`:e.value;return{label:a,kind:s.CompletionItemKind.Enum,type:s.SuggestionKind.Simple,detail:e.description,textEdit:{newText:a,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))}getFilteredEnumInfo(e,t,r){let n=[],i=[];const a=e.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(r)&&e.endsWith('"')&&e.startsWith('"'))n=t.filter((e=>e.value.toUpperCase()===a));else{const e=(0,S.filterSuggestionsAccordingToPrefix)(a,t,(e=>e.value));n=e.prefixedSuggestions,i=e.notPrefixedSuggestions}return 0===n.length&&0===i.length&&i.push(...t),{prefixedEnumInfo:n,notPrefixedEnumInfo:i}}getEnumInfoByArg(e,t,r){const n=t[r];if(!(0,i.isNone)(n))return n[e]}getUdfParamEnumInfoByArg(e,t){const r=e=>!(null==e||!Array.isArray(e))&&e.every((e=>"object"==typeof e&&null!==e&&"value"in e&&"string"==typeof e.value));if(""===t.CustomEnums)return this.logFailure("CustomEnums is empty"),{udfEnumInfo:void 0,isStringTypeEnum:!1};let n=!1,i=0;try{const a=JSON.parse(t.CustomEnums);for(const t of Object.keys(a)){"isLastParamRepeating"===t&&(n=a[t]);const o=Number(t);if(!isNaN(o)){if(e===o){const e=a[t];return{udfEnumInfo:e,isStringTypeEnum:r(e)}}i=Math.max(i,o)}}if(n&&e>i){const e=a[i];return{udfEnumInfo:e,isStringTypeEnum:r(e)}}}catch(e){this.logFailure("Failed to parse custom enums: "+e)}return{udfEnumInfo:void 0,isStringTypeEnum:!1}}getLocalizedEnumInfo(e,t){const r=e.map((e=>({value:"function"==typeof e.value?e.value(t):e.value,description:"function"==typeof e.description?e.description(t):e.description}))),n=r.length,i=r.filter((e=>{const{value:t,description:r}=e;return void 0!==t&&void 0!==r&&""!==t&&"undefined"!==t}));return e.length!==n&&this.logFailure("failed to get enum info for some values"),i}shouldAddDoubleQuotes(e){return e===a.WorksheetFuncId.COMPLEX||e===a.WorksheetFuncId.INFO||e===a.WorksheetFuncId.CONVERT||e===a.WorksheetFuncId.CELL||e===a.WorksheetFuncId.TRANSLATE}logFailure(e){a.ulsLogger.ULS.traceTag(508350686,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteEnumPlugin encountered a failure with msg ${e}`)}constructor(){n.__runInitializers(this,h)}},n.__setFunctionName(t,"AutocompleteEnumPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[v.uiMessageHandler({kind:d.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},m,{kind:"class",name:t.name,metadata:i},null,g),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=v.injectPluginFactory(),n.__runInitializers(t,g),t})();t.AutocompleteEnumPlugin=y,(0,m.registerPluginFactory)(y.factory),t.autocompleteEnumPluginDependenciesResolved=(0,f.trackableAsyncLazy)((async()=>{const e=await g.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(s.PluginFactoryName.AutocompleteEnumPlugin),await g.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteEnumPluginDependenciesResolved")},7900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoCompleteEnumVisitor=void 0;const n=r(6913),i=r(6592),a=r(3486);class o extends a.CaretInsideArrayNodeIdentityVisitor{isUserDefinedEnumFeatureEnabled(){return(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteUserDefinedEnum")}appNode(e,t,r,n){return this.isUserDefinedEnumFeatureEnabled()&&e.kind===i.NodeKind.Name&&this.dynamicUdfFunctionNameSet.has(e.whole)&&(this.customFunctionName=e.whole),void 0===this.customFunctionName&&e.kind!==i.NodeKind.WSF||this.updateAssistedFunctionAndArgIndex(e,t),super.appNode(e,t,r,n)}updateAssistedFunctionAndArgIndex(e,t){for(let r=0;r<t.length;r++){const n=this.parsedFormulaTree.spans[t[r].label];if(n&&n.start-n.pre.length<=this.caretPosition&&this.caretPosition<=n.end+n.post.length&&void 0===this.functionHead){e.kind===i.NodeKind.WSF&&(this.functionHead=e),this.argIndex=r,this.functionArgs=t,this.stringStartPosition=n.start,this.stringEndPosition=n.end;break}}}constructor(e,t,r){super(e,t),this.dynamicUdfFunctionNameSet=new Set(r?.map((e=>e.NameDataStrings)))}}t.AutoCompleteEnumVisitor=o},1235:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionEnums=void 0;const n=r(6592),i=r(4352);t.functionEnums=new i.ResettableLazy((()=>({[n.WorksheetFuncId.ERROR_TYPE]:{1:[{value:e=>e.errorNames[n.ErrorType.NULL]??"",description:n.ErrorType.NULL.toString()},{value:e=>e.errorNames[n.ErrorType.DIV0]??"",description:n.ErrorType.DIV0.toString()},{value:e=>e.errorNames[n.ErrorType.VALUE]??"",description:n.ErrorType.VALUE.toString()},{value:e=>e.errorNames[n.ErrorType.REF]??"",description:n.ErrorType.REF.toString()},{value:e=>e.errorNames[n.ErrorType.NAME]??"",description:n.ErrorType.NAME.toString()},{value:e=>e.errorNames[n.ErrorType.NUM]??"",description:n.ErrorType.NUM.toString()},{value:e=>e.errorNames[n.ErrorType.NA]??"",description:n.ErrorType.NA.toString()}]},[n.WorksheetFuncId.SUBTOTAL]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"101",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"102",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"103",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"104",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"105",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"106",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"107",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"108",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"109",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"110",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"111",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}]},[n.WorksheetFuncId.AGGREGATE]:{1:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)},{value:"8",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)},{value:"9",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)},{value:"10",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VAR)},{value:"11",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.VARP)},{value:"12",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"13",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MODE_SNGL)},{value:"14",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.LARGE)},{value:"15",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SMALL)},{value:"16",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_INC)},{value:"17",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_INC)},{value:"18",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_EXC)},{value:"19",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_EXC)}],2:[{value:"0",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"1",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"2",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"3",description:e=>FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNothing)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRows)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValues)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValues)}]},[n.WorksheetFuncId.CUBESET]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.None)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaAscending)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaDescending)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalAscending)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalDescending)}]},[n.WorksheetFuncId.VLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.HLOOKUP]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},[n.WorksheetFuncId.XLOOKUP]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.RANK]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_AVG]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.RANK_EQ]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},[n.WorksheetFuncId.MATCH]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LessThan)},{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GreaterThan)}]},[n.WorksheetFuncId.XMATCH]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},[n.WorksheetFuncId.FINDN]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}],7:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheFirstCharacterPositionOfTheString)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheLastCharacterPositionOfTheString)}]},[n.WorksheetFuncId.TEXTBEFORE]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTAFTER]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},[n.WorksheetFuncId.TEXTSPLIT]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}]},[n.WorksheetFuncId.ACCRINT]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ACCRINTM]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ADDRESS]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)}],3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Absolute)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AbsoluteRowRelativeColumn)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RelativeRowAbsoluteColumn)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Relative)}]},[n.WorksheetFuncId.AMORDEGRC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.AMORLINC]:{7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.BETA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.BINOMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.BINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.CHISQ_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.COMPLEX]:{3:[{value:"i",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ISuffixDescriptionForComplexNumber)},{value:"j",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.JSuffixDescriptionForComplexNumber)}]},[n.WorksheetFuncId.COUPDAYBS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYS]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPDAYSNC]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPNUM]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.COUPPCD]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.CUMIPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.CUMPRINC]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.DAYS360]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASDMethod)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EuropeanMethod)}]},[n.WorksheetFuncId.DISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.DURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.EXPONDIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.EXPON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.F_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.FIXED]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PreventCommas)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotPreventCommas)}]},[n.WorksheetFuncId.FV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.GAMMADIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.GAMMA_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.HYPGEOM_DIST]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.INDIRECT]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)}]},[n.WorksheetFuncId.INTRATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.IPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.LINEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGEST]:{3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},[n.WorksheetFuncId.LOGNORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.MDURATION]:{5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.NEGBINOM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_S_DIST]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.NORMDIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NORM_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.NPER]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.ODDFPRICE]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDFYIELD]:{8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLPRICE]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.ODDLYIELD]:{7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PMT]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.POISSON]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.POISSON_DIST]:{3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},[n.WorksheetFuncId.PPMT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.PRICE]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.PRICEMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.QUARTILE]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_INC]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},[n.WorksheetFuncId.QUARTILE_EXC]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)}]},[n.WorksheetFuncId.RATE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.RECEIVED]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.REGEXEXTRACT]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode0)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode1)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexExtractMode2)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.REGEXREPLACE]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.REGEXTEST]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegexCaseInsensitiveMatch)}]},[n.WorksheetFuncId.ROMAN]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Classic)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Simplified)}]},[n.WorksheetFuncId.STOCKHISTORY]:{4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Daily)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Weekly)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monthly)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoHeader)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Showheader)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ShowInstrumentIdentifierAndHeader)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],10:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],11:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}]},[n.WorksheetFuncId.TRANSLATE]:{2:[{value:"af",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAF)},{value:"sq",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSQ)},{value:"am",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAM)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAR)},{value:"hy",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHY)},{value:"as",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAS)},{value:"az",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAZ)},{value:"bn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBN)},{value:"ba",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBA)},{value:"eu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEU)},{value:"bho",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBHO)},{value:"brx",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBRX)},{value:"bs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBOSNIAN)},{value:"bg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBG)},{value:"yue",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUE)},{value:"ca",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCA)},{value:"hne",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHNE)},{value:"lzh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLZH)},{value:"zh-chs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHS)},{value:"zh-cht",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHT)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHR)},{value:"cs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCS)},{value:"da",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDA)},{value:"prs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePRS)},{value:"dv",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDV)},{value:"doi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDOI)},{value:"nl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNL)},{value:"en",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEN)},{value:"et",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameET)},{value:"fo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFO)},{value:"fj",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFJ)},{value:"fil",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFIL)},{value:"fi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFI)},{value:"fr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR)},{value:"fr-ca",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR_CA)},{value:"gl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGL)},{value:"lug",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLUG)},{value:"ka",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKA)},{value:"de",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDE)},{value:"el",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEL)},{value:"gu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGU)},{value:"ht",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHT)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHA)},{value:"he",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHE)},{value:"hi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHI)},{value:"mww",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMWW)},{value:"hu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHU)},{value:"is",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIS)},{value:"ig",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIG)},{value:"id",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameID)},{value:"ikt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIKT)},{value:"iu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU)},{value:"iu-latn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU_LATN)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGA)},{value:"it",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIT)},{value:"ja",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameJA)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKN)},{value:"ks",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKS)},{value:"kk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKK)},{value:"km",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKM)},{value:"rw",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRW)},{value:"tlh-Latn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTLHLATN)},{value:"tlh-Piqd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTLHPIQD)},{value:"gom",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGOM)},{value:"ko",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKO)},{value:"ku",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKU)},{value:"kmr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKMR)},{value:"ky",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKY)},{value:"lo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLO)},{value:"lv",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLV)},{value:"ln",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLN)},{value:"lt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLT)},{value:"dsb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDSB)},{value:"mk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMK)},{value:"mai",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMAI)},{value:"mg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMG)},{value:"ms",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMS)},{value:"ml",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameML)},{value:"mt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMT)},{value:"mni",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMNI)},{value:"mr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMR)},{value:"mn-cyrl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_CYRL)},{value:"mn-mong",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_MONG)},{value:"my",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMY)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMI)},{value:"ne",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNE)},{value:"nb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNB)},{value:"nya",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNYA)},{value:"or",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOR)},{value:"ps",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePS)},{value:"fa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFA)},{value:"pl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePL)},{value:"pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT)},{value:"pt-pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT_PT)},{value:"pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePA)},{value:"otq",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOTQ)},{value:"ro",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRO)},{value:"run",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRUN)},{value:"ru",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRU)},{value:"sm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSM)},{value:"sr-cyrl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_CYRL)},{value:"sr-latn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_LATN)},{value:"st",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameST)},{value:"nso",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNSO)},{value:"tn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTN)},{value:"sn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSN)},{value:"sd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSD)},{value:"si",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSI)},{value:"sk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSK)},{value:"sl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSL)},{value:"so",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSO)},{value:"es",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameES)},{value:"sw",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSW)},{value:"sv",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSV)},{value:"ty",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTY)},{value:"ta",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTA)},{value:"tt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTT)},{value:"te",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTE)},{value:"th",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTH)},{value:"bo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBO)},{value:"ti",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTI)},{value:"to",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTO)},{value:"tr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTR)},{value:"tk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTK)},{value:"uk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUK)},{value:"hsb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHSB)},{value:"ur",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUR)},{value:"ug",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUG)},{value:"uz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUZ)},{value:"vi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameVI)},{value:"cy",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCY)},{value:"xh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameXH)},{value:"yo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYO)},{value:"yua",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUA)},{value:"zu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZU)}],3:[{value:"af",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAF)},{value:"sq",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSQ)},{value:"am",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAM)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAR)},{value:"hy",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHY)},{value:"as",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAS)},{value:"az",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameAZ)},{value:"bn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBN)},{value:"ba",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBA)},{value:"eu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEU)},{value:"bho",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBHO)},{value:"brx",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBRX)},{value:"bs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBOSNIAN)},{value:"bg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBG)},{value:"yue",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUE)},{value:"ca",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCA)},{value:"hne",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHNE)},{value:"lzh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLZH)},{value:"zh-chs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHS)},{value:"zh-cht",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZH_CHT)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHR)},{value:"cs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCS)},{value:"da",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDA)},{value:"prs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePRS)},{value:"dv",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDV)},{value:"doi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDOI)},{value:"nl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNL)},{value:"en",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEN)},{value:"et",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameET)},{value:"fo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFO)},{value:"fj",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFJ)},{value:"fil",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFIL)},{value:"fi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFI)},{value:"fr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR)},{value:"fr-ca",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFR_CA)},{value:"gl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGL)},{value:"lug",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLUG)},{value:"ka",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKA)},{value:"de",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDE)},{value:"el",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameEL)},{value:"gu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGU)},{value:"ht",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHT)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHA)},{value:"he",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHE)},{value:"hi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHI)},{value:"mww",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMWW)},{value:"hu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHU)},{value:"is",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIS)},{value:"ig",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIG)},{value:"id",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameID)},{value:"ikt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIKT)},{value:"iu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU)},{value:"iu-latn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIU_LATN)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGA)},{value:"it",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameIT)},{value:"ja",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameJA)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKN)},{value:"ks",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKS)},{value:"kk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKK)},{value:"km",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKM)},{value:"rw",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRW)},{value:"tlh-Latn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTLHLATN)},{value:"tlh-Piqd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTLHPIQD)},{value:"gom",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameGOM)},{value:"ko",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKO)},{value:"ku",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKU)},{value:"kmr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKMR)},{value:"ky",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameKY)},{value:"lo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLO)},{value:"lv",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLV)},{value:"ln",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLN)},{value:"lt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameLT)},{value:"dsb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameDSB)},{value:"mk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMK)},{value:"mai",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMAI)},{value:"mg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMG)},{value:"ms",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMS)},{value:"ml",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameML)},{value:"mt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMT)},{value:"mni",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMNI)},{value:"mr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMR)},{value:"mn-cyrl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_CYRL)},{value:"mn-mong",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMN_MONG)},{value:"my",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMY)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameMI)},{value:"ne",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNE)},{value:"nb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNB)},{value:"nya",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNYA)},{value:"or",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOR)},{value:"ps",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePS)},{value:"fa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameFA)},{value:"pl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePL)},{value:"pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT)},{value:"pt-pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePT_PT)},{value:"pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNamePA)},{value:"otq",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameOTQ)},{value:"ro",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRO)},{value:"run",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRUN)},{value:"ru",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameRU)},{value:"sm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSM)},{value:"sr-cyrl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_CYRL)},{value:"sr-latn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSR_LATN)},{value:"st",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameST)},{value:"nso",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameNSO)},{value:"tn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTN)},{value:"sn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSN)},{value:"sd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSD)},{value:"si",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSI)},{value:"sk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSK)},{value:"sl",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSL)},{value:"so",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSO)},{value:"es",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameES)},{value:"sw",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSW)},{value:"sv",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameSV)},{value:"ty",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTY)},{value:"ta",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTA)},{value:"tt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTT)},{value:"te",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTE)},{value:"th",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTH)},{value:"bo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameBO)},{value:"ti",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTI)},{value:"to",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTO)},{value:"tr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTR)},{value:"tk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameTK)},{value:"uk",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUK)},{value:"hsb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameHSB)},{value:"ur",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUR)},{value:"ug",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUG)},{value:"uz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameUZ)},{value:"vi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameVI)},{value:"cy",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameCY)},{value:"xh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameXH)},{value:"yo",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYO)},{value:"yua",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameYUA)},{value:"zu",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LanguageNameZU)}]},[n.WorksheetFuncId.TREND]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.TTEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.T_TEST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},[n.WorksheetFuncId.VDB]:{7:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SwitchToStraightLineDepreciation)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotSwitchToStraightLineDepreciation)}]},[n.WorksheetFuncId.WEEKDAY]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers0Mondaythrough6Sunday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Tuesdaythrough7Monday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Wednesdaythrough7Tuesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Thursdaythrough7Wednesday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Fridaythrough7Thursday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Saturdaythrough7Friday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)}]},[n.WorksheetFuncId.WEIBULL]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEIBULL_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.YEARFRAC]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELD]:{6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDDISC]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.YIELDMAT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},[n.WorksheetFuncId.GROWTH]:{4:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},[n.WorksheetFuncId.PV]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},[n.WorksheetFuncId.TDIST]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}]},[n.WorksheetFuncId.T_DIST]:{4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},[n.WorksheetFuncId.WEEKNUM]:{2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wednesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Thursday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Friday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Saturday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"21",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}]},[n.WorksheetFuncId.NETWORKDAYS_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.WORKDAY_INTL]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},[n.WorksheetFuncId.FORECAST_ETS]:{5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_CONFINT]:{6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],7:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],4:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.FORECAST_ETS_STAT]:{4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaParameterOfETSalgorithm)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BetaParameterOfETSalgorithm)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GammaParameterOfETSalgorithm)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MASEMetric)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMAPEMetric)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MAEMetric)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RMSEMetric)},{value:"8",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.StepSizeDetected)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)},{value:"2",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)},{value:"3",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)},{value:"4",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MAX)},{value:"5",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)},{value:"6",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.MIN)},{value:"7",description:e=>e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}]},[n.WorksheetFuncId.TEXTJOIN]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}]},[n.WorksheetFuncId.SORT]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}],4:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByColumn)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByRow)}]},[n.WorksheetFuncId.UNIQUE]:{2:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueColumns)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueRows)}],3:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnitemsthatAppearExactlyOnce)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnEveryDistinctItem)}]},[n.WorksheetFuncId.SORTBY]:{3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}]},[n.WorksheetFuncId.RANDARRAY]:{5:[{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Integer)},{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Decimal)}]},[n.WorksheetFuncId.VALUETOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.ARRAYTOTEXT]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},[n.WorksheetFuncId.TOCOL]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.TOROW]:{2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:e=>e.falseName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:e=>e.trueName,description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},[n.WorksheetFuncId.IMAGE]:{3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FitCell)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FillCell)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OriginalSize)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CustomSize)}]}})))},3486:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteBaseVisitor=t.CaretInsideArrayNodeIdentityVisitor=void 0;const n=r(6592),i=r(246);class a extends n.IdentityVisitor{arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(n)&&(this.isInsideArrayNode=!0),n}caretInNode(e){if(void 0===e)return!1;const t=this.parsedFormulaTree.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end}constructor(e,t){super(),this.parsedFormulaTree=e,this.caretPosition=t,this.isInsideArrayNode=!1,this.autoCompleteFixForArrayNodesEnabled=(0,i.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled")}}t.CaretInsideArrayNodeIdentityVisitor=a,t.AutocompleteBaseVisitor=class extends a{nameNode(e,t,r){return e.kind!==n.NamePartKind.IdentNamePart&&e.kind!==n.NamePartKind.FieldRefNamePart||this.updateAutocompleteString(r,e.asWhole),super.nameNode(e,t,r)}appNode(e,t,r,i){return e.kind===n.NodeKind.WSF&&this.updateAutocompleteString(i,e.whole),super.appNode(e,t,r,i)}cellRefNode(e,t,r){const i=this.parsedFormulaTree.spans[r];if(e.kind===n.CellRefKind.Single&&i){const e=this.formulaString.substring(i.start,i.end);this.updateAutocompleteString(r,e)}return super.cellRefNode(e,t,r)}updateAutocompleteString(e,t){const r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)}constructor(e,t,r){super(e,t),this.formulaString=r}}},7068:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteCopilotPluginDependenciesResolved=t.AutocompleteCopilotPlugin=void 0;const n=r(6533),i=r(1633),a=r(9084),o=r(2937),s=r(8795),u=r(8708),l=r(9615),c=u.PluginRegistry.create(i.PluginFactoryName.AutocompleteCopilotPlugin,i.PluginGroup.Excel);let d=(()=>{let e,t,r,o=[c.x10Plugin()],s=[],u=[];return t=class{*run(e){const t={label:"Copilot",kind:i.CompletionItemKind.Copilot,type:i.SuggestionKind.Simple,detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CopilotFormulaGenerationAutoCompleteItem),isPrefixed:!0};return"="===e.content?{items:[t]}:{items:[]}}constructor(){n.__runInitializers(this,u)}},n.__setFunctionName(t,"AutocompleteCopilotPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[c.uiMessageHandler({kind:a.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,u),n.__esDecorate(null,e={value:t},o,{kind:"class",name:t.name,metadata:i},null,s),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=c.injectPluginFactory(),n.__runInitializers(t,s),t})();t.AutocompleteCopilotPlugin=d,(0,o.registerPluginFactory)(d.factory),t.autocompleteCopilotPluginDependenciesResolved=(0,l.trackableAsyncLazy)((async()=>{const e=await s.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(i.PluginFactoryName.AutocompleteCopilotPlugin),await s.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteCopilotPluginDependenciesResolved")},8388:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteFunctionPluginDependenciesResolved=t.AutocompleteFunctionPlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(246),l=r(3486),c=r(9731),d=r(4846),m=r(9084),g=r(2937),p=r(8795),h=r(6307),f=r(8708),S=r(9615),v=f.PluginRegistry.create(s.PluginFactoryName.AutocompleteFunctionPlugin,s.PluginGroup.Excel);let y=(()=>{let e,t,r,g=[v.x10Plugin()],p=[],f=[];return t=class{*run(e){const t=yield{kind:h.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==h.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new l.AutocompleteBaseVisitor(r,e.caretPosition,e.content);if((0,a.reduceBottomUp)(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition||n.isInsideArrayNode)return null;const s=n.autocompleteString.toUpperCase(),u=n.stringStartPosition,m=n.stringEndPosition,g=yield{kind:h.ComputationRequestKind.GetFunctionsInfo};if(g.kind!==h.ComputationRequestKind.GetFunctionsInfo)return this.logFailure("failed to get functions info"),null;let p=g.functionsInfo;const f=p.some((e=>e.FunctionIndexInServer===a.WorksheetFuncId.PY));let S=f;if(f){const e=yield{kind:h.ComputationRequestKind.GetPythonLicense};if(e.kind!==h.ComputationRequestKind.GetPythonLicense)return this.logFailure("failed to get python license"),null;"Success"===e.license.kind&&e.license.value.isEnabled&&(S=!1)}(this.autoCompleteFilterOutPythonEnabled&&f&&r.node.kind!==a.NodeKind.Name||S)&&(p=p.filter((e=>e.FunctionIndexInServer!==a.WorksheetFuncId.PY)));const{prefixedSuggestions:v,notPrefixedSuggestions:y}=(0,c.filterSuggestionsAccordingToPrefix)(s,p,(e=>e.NameDataStrings)),F=d.functionShortDescriptions.getValue();null!==F&&null!==F.descriptionMap||this.logFailure("failed to get short descriptions, will show function info help description");const b=(0,c.getCompletedFunctionSuffix)(e.content,m);return{items:[...this.generateCompletionItems(v,F,u,m,!0,b),...this.generateCompletionItems(y,F,u,m,!1,b)]}}generateCompletionItems(e,t,r,n,o,l){const c=[],d=e.map((e=>{const a=e.FunctionIndexInServer.toString();let d=(0,i.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?t.descriptionMap?.[a]:t.descriptionMap?.get(a);return(0,i.isNone)(d)&&(c.push(e.FunctionIndexInServer),d=e.Help),{label:e.NameDataStrings,kind:s.CompletionItemKind.Function,type:s.SuggestionKind.Simple,detail:d,textEdit:{newText:e.NameDataStrings+l,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:o,shouldRequestAutocompleteOnCommit:!(0,u.isChangeGateEnabled)("OfficeVSO:9905905_FixForFormulaAutoCompleteLoop")||""!==l}}));return c.length>0&&a.ulsLogger.ULS.traceTag(508871621,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`AutocompleteFunctionPlugin missing short descriptions for func IDs: ${JSON.stringify(c)}`),d}logFailure(e){a.ulsLogger.ULS.traceTag(539083013,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteFunctionPlugin encountered a failure with msg ${e}`)}constructor(){this.autoCompleteFilterOutPythonEnabled=(n.__runInitializers(this,f),(0,u.isChangeGateEnabled)("OfficeVSO:9668654_autocompleteToplevelPython"))}},n.__setFunctionName(t,"AutocompleteFunctionPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[v.uiMessageHandler({kind:m.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,f),n.__esDecorate(null,e={value:t},g,{kind:"class",name:t.name,metadata:i},null,p),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=v.injectPluginFactory(),n.__runInitializers(t,p),t})();t.AutocompleteFunctionPlugin=y,(0,g.registerPluginFactory)(y.factory),t.autocompleteFunctionPluginDependenciesResolved=(0,S.trackableAsyncLazy)((async()=>{const e=await p.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(s.PluginFactoryName.AutocompleteFunctionPlugin),await p.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteFunctionPluginDependenciesResolved")},9731:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStructRefCompletionItemRank=t.endOf=t.verifyTextAndRange=void 0,t.filterSuggestionsAccordingToPrefix=function(e,t,r,i=!1){const a=[],o=[],s=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:o}:(t.forEach((e=>{const t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(!t.startsWith(s)||i&&t===s)if(i){const r=t.split(" ");(0,n.isDefined)(r.find((e=>e.startsWith(s))))&&o.push(e)}else s.length>2&&t.includes(s)&&o.push(e);else a.push(e)})),{prefixedSuggestions:a,notPrefixedSuggestions:o})},t.getCompletedFunctionSuffix=function(e,t){return"("===e?.charAt(t)?"":"("};const n=r(6913),i=r(5033),a=r(1633);t.verifyTextAndRange=(e,t,r,n,i)=>{expect(e?.label).toEqual(t),expect(e?.textEdit?.newText).toEqual(i??t),expect(e?.textEdit?.range?.start?.character).toEqual(r),expect(e?.textEdit?.range?.end?.character).toEqual(n)},t.endOf=e=>e.length,t.getStructRefCompletionItemRank=e=>{const t=e.kind===a.CompletionItemKind.TableHeader?1:e.label?.startsWith("#")?0:e.label?.startsWith("@")?2:void 0;return(0,n.isNone)(t)?(n.ulsLogger.ULS.traceTag(526411872,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ${JSON.stringify(e)}`),0):t}},9809:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteLetPluginDependenciesResolved=t.AutocompleteLetPlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(9731),l=r(670),c=r(9084),d=r(2937),m=r(8795),g=r(6307),p=r(8708),h=r(9615),f=p.PluginRegistry.create(s.PluginFactoryName.AutocompleteLetPlugin,s.PluginGroup.Excel);let S=(()=>{let e,t,r,d=[f.x10Plugin()],m=[],p=[];return t=class{*run(e){const t=yield{kind:g.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==g.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value,n=e.caretPosition,s=new l.AutocompleteLetVisitor(e.content,r,n);(0,a.reduceBottomUp)(s,r);const c=s.references.reverse(),d=Array.from(new Set(c)),m=s.caretNodeText;if(void 0===m||s.isInsideArrayNode)return null;const p=n,h=p-m.length,{prefixedSuggestions:f,notPrefixedSuggestions:S}=(0,u.filterSuggestionsAccordingToPrefix)(m,d);return{items:[...this.stringsToCompletionItems(f,h,p,!0),...this.stringsToCompletionItems(S,h,p,!1)]}}stringsToCompletionItems(e,t,r,n){return e.map((e=>({label:e,kind:s.CompletionItemKind.LetVariable,type:s.SuggestionKind.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n})))}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"AutocompleteLetPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[f.uiMessageHandler({kind:c.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,p),n.__esDecorate(null,e={value:t},d,{kind:"class",name:t.name,metadata:i},null,m),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=f.injectPluginFactory(),n.__runInitializers(t,m),t})();t.AutocompleteLetPlugin=S,(0,d.registerPluginFactory)(S.factory),t.autocompleteLetPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await m.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.AutocompleteLetPlugin),await m.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteLetPluginDependenciesResolved")},670:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteLetVisitor=void 0;const n=r(6913),i=r(6592),a=r(3486);class o extends a.CaretInsideArrayNodeIdentityVisitor{letNode(e,t,r,n,a,o){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let r=0;r<t.length;r+=1){const{binder:n}=t[r];if(this.caretInNode(n.arg)){this.pushNames(e.id===i.WorksheetFuncId.LET?t.slice(0,r):t);break}}return super.letNode(e,t,r,n,a,o)}lambdaNode(e,t,r,n,i,a){if(this.caretInNode(r?.arg))this.pushNames(t);else for(let e=0;e<t.length;e+=1){const{name:r}=t[e];if(void 0!==r.arg.def&&this.caretInNode(r.arg.def.rhs)){this.pushNames(t.slice(0,e));break}}return super.lambdaNode(e,t,r,n,i,a)}pushNames(e){(0,n.safePush)(this.references,e.map((({name:e})=>e.arg.wholeName)).filter(n.isDefined).reverse())}constructor(e,t){super(e,t),this.references=[]}}t.AutocompleteLetVisitor=class extends o{nameNode(e,t,r){return this.updateCaretNodeText(r,e.asWhole),super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r];if(e.kind===i.CellRefKind.Single&&n){const e=this.formulaString.substring(n.start,n.end);this.updateCaretNodeText(r,e)}return super.cellRefNode(e,t,r)}updateCaretNodeText(e,t){const r=this.parsedFormulaTree.spans[e]?.end;void 0!==r&&this.caretPosition===r&&t.length>0&&(this.caretNodeText=t)}constructor(e,t,r){super(t,r),this.formulaString=e}}},6067:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteNamedObjectsPluginDependenciesResolved=t.AutocompleteNamedObjectsPlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(246),l=r(3486),c=r(9731),d=r(9084),m=r(2937),g=r(8795),p=r(6307),h=r(8708),f=r(9615),S=h.PluginRegistry.create(s.PluginFactoryName.AutocompleteNamedObjectsPlugin,s.PluginGroup.Excel);let v=(()=>{let e,t,r,m=[S.x10Plugin()],g=[],h=[];return t=class{*run(e){const t=yield{kind:p.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==p.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:p.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==p.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const u=n.definedNamesInfo,d=new l.AutocompleteBaseVisitor(r,e.caretPosition,e.content);(0,a.reduceBottomUp)(d,r);const{autocompleteString:m,stringStartPosition:g,stringEndPosition:h,isInsideArrayNode:f}=d;if(!(0,i.isDefined)(m)||!(0,i.isDefined)(h)||!(0,i.isDefined)(g)||f)return null;const{prefixedSuggestions:S,notPrefixedSuggestions:v}=(0,c.filterSuggestionsAccordingToPrefix)(m,u,(e=>e.name));if(this.newNamedObjectsEnabled){const t=[...S.map((e=>({...e,isPrefixed:!0}))),...v.map((e=>({...e,isPrefixed:!1})))];for(const e of t){if((0,i.isNone)(e.reference)||e.type!==s.DefinedNameInfoType.Other)continue;const t=yield{kind:p.ComputationRequestKind.ParseActiveCell,formulaText:e.reference};if(t.kind!==p.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result)||t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value;r.isWellFormed&&"Lambda"===r.node.kind&&r.node.isClosed&&(e.type=s.DefinedNameInfoType.Lambda)}const r=(0,c.getCompletedFunctionSuffix)(e.content,h);return{items:this.namesToCompletionItems(t,g,h,r)}}return{items:[...this.namesToCompletionItemsOld(S,g,h,!0),...this.namesToCompletionItemsOld(v,g,h,!1)]}}namesToCompletionItemsOld(e,t,r,n){return e.filter((e=>e.type!==s.DefinedNameInfoType.Invalid)).map((e=>({label:e.name,kind:e.type===s.DefinedNameInfoType.NamedRange?s.CompletionItemKind.NamedRange:s.CompletionItemKind.Table,type:s.SuggestionKind.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n})))}namesToCompletionItems(e,t,r,n){return e.filter((e=>e.type!==s.DefinedNameInfoType.Invalid)).map((e=>{const i=function(e){switch(e.type){case s.DefinedNameInfoType.NamedRange:return s.CompletionItemKind.NamedRange;case s.DefinedNameInfoType.Table:return s.CompletionItemKind.Table;case s.DefinedNameInfoType.Lambda:return s.CompletionItemKind.Lambda;default:return s.CompletionItemKind.NamedOther}}(e);let a=e.name;return i===s.CompletionItemKind.Lambda&&(a+=n),{label:e.name,kind:i,type:s.SuggestionKind.Simple,textEdit:{newText:a,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:e.isPrefixed}}))}logFailure(e){a.ulsLogger.ULS.traceTag(528562134,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteNamedObjectPlugin encountered a failure with msg ${e}`)}constructor(){this.newNamedObjectsEnabled=(n.__runInitializers(this,h),(0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,u.isChangeGateEnabled)("OfficeVSO:9646883_NameManager-FG-Removal"))}},n.__setFunctionName(t,"AutocompleteNamedObjectsPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:d.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},m,{kind:"class",name:t.name,metadata:i},null,g),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,g),t})();t.AutocompleteNamedObjectsPlugin=v,(0,m.registerPluginFactory)(v.factory),t.autocompleteNamedObjectsPluginDependenciesResolved=(0,f.trackableAsyncLazy)((async()=>{const e=await g.autoCompletePluginsThread.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.AutocompleteNamedObjectsPlugin),await g.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteNamedObjectsPluginDependenciesResolved")},5591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteRichValuePluginDependenciesResolved=t.AutocompleteRichValuePlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(391),u=r(1633),l=r(9731),c=r(9928),d=r(9084),m=r(2937),g=r(8795),p=r(6307),h=r(8708),f=r(9615),S=h.PluginRegistry.create(u.PluginFactoryName.AutocompleteRichValuePlugin,u.PluginGroup.Excel);let v=(()=>{let e,t,r,m=[S.x10Plugin()],g=[],h=[];var f=t=class{*run(e){if((0,i.isNone)(e.content)||(0,i.isNone)(e.caretPosition))return y("missing request arguments"),null;const t=yield{kind:p.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==p.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value,n=yield{kind:p.ComputationRequestKind.GetDefinedNamesInfo};if(n.kind!==p.ComputationRequestKind.GetDefinedNamesInfo)return y("failed to get named objects info"),null;const s=yield{kind:p.ComputationRequestKind.GetActiveCell};if(s.kind!==p.ComputationRequestKind.GetActiveCell)return y("failed to get active cell"),null;const d=s.activeCell,m=new c.AutocompleteRichValueVisitor(r,e.caretPosition,e.content,n.definedNamesInfo,d.range);if((0,a.reduceBottomUp)(m,r),m.isInsideArrayNode)return null;let g,h;if((0,i.isDefined)(m.cellRef))g=m.cellRef,h=d.sheet.index;else if((0,i.isDefined)(m.namedRangeNode)){const e={originGridCell:(0,i.success)(d.range),originSheet:(0,i.success)(d.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:p.ComputationRequestKind.ResolveReferences,nodes:[m.namedRangeNode],locals:e};if(t.kind===p.ComputationRequestKind.ResolveReferences){const e=t.resolverResults[0];if(e.kind===a.ResolvedKind.ResolvedStructRef&&(0,i.isSuccess)(e.resolution)&&void 0!==e.resolution.value){const t=e.resolution.value.range;g={firstRow:t.row,firstColumn:t.col,lastRow:t.row+t.rows-1,lastColumn:t.col+t.cols-1},h=e.resolution.value.sheet.index}}}if(!(0,i.isDefined)(g))return null;const f=m.dotNotationPath;if((0,i.isNone)(f))return y("failed to parse cellRef"),null;let S="";if((0,i.isDefined)(m.sheetName))S=m.sheetName;else{const e=yield{kind:p.ComputationRequestKind.GetSheetNames};if(e.kind!==p.ComputationRequestKind.GetSheetNames)return y("failed to get sheet names"),null;if(!(0,a.isDocumentLocEqual)(d.sheet.document,e.document))return y("sheet names document is different than that of active cell"),null;if(!(0,i.isDefined)(h))return y("sheet index is undefined"),null;S=e.sheets[e.idToIndex[h]].sheetName}const v={...g,sheetName:S,namedObjectName:""},F=yield{kind:p.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:v,dotNotationPath:f,singleColumn:!1,findRange:!1};if(F.kind!==p.ComputationRequestKind.GetRichValueFieldListContext)return y("failed to get field list context data"),null;if((0,i.isNone)(F.result)||0===F.result.length)return null;F.result.length>1&&y("fieldListContextRequest results length greater than 1");const{prefixedSuggestions:b,notPrefixedSuggestions:C}=(0,l.filterSuggestionsAccordingToPrefix)(m.richValueItemPrefix,F.result[0].FieldInfoDataList,(e=>e.Name),!0),k=yield{kind:p.ComputationRequestKind.GetConfig};let E=[...this.resultsToCompletionItems(b,!0,m.dotNotationIndex,m.fieldRefChainEndIndex??e.caretPosition,k,!!m.namedRangeNode),...this.resultsToCompletionItems(C,!1,m.dotNotationIndex,m.fieldRefChainEndIndex??e.caretPosition,k,!!m.namedRangeNode)];var A,T;return m.shouldAddEmptySuggestion&&(E=[(A=m.dotNotationIndex,T=m.fieldRefChainEndIndex??e.caretPosition,{label:"",kind:u.CompletionItemKind.RichEntityEmptyCellRef,type:u.SuggestionKind.Simple,detail:"",textEdit:{newText:"",range:{start:{line:0,character:A},end:{line:0,character:T}}},isPrefixed:!0}),...E]),{items:E}}static getTextToCommit(e,t,r){let n=e.Name;if(n=n.replace("'","''"),n=n.replace("[","'["),n=n.replace("]","']"),e.RefersToDotFunction)return`.${n}`;if(r)return`.[${n}]`;const i=t.kind===p.ComputationRequestKind.GetConfig?t.config.localeInfo:void 0;return i&&!(0,s.isUnbracketedFieldName)(i,n)?`.[${n}]`:`.${n}`}resultsToCompletionItems(e,t,r,n,i,a){return e.map((e=>({label:e.Name,kind:u.CompletionItemKind.RichEntity,type:u.SuggestionKind.Simple,detail:"",textEdit:{newText:f.getTextToCommit(e,i,a),range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:t})))}constructor(){n.__runInitializers(this,h)}};return n.__setFunctionName(t,"AutocompleteRichValuePlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:d.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},m,{kind:"class",name:t.name,metadata:i},null,g),f=t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,g),f=t})();function y(e){i.ulsLogger.ULS.traceTag(529056660,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteRichValuePlugin encountered a failure with msg ${e}`)}t.AutocompleteRichValuePlugin=v,(0,m.registerPluginFactory)(v.factory),t.autocompleteRichValuePluginDependenciesResolved=(0,f.trackableAsyncLazy)((async()=>{const e=await g.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(u.PluginFactoryName.AutocompleteRichValuePlugin),await g.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteRichValuePluginDependenciesResolved")},9928:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteRichValueVisitor=void 0;const n=r(6913),i=r(6592),a=r(1633),o=r(3486),s=r(6398);class u extends o.CaretInsideArrayNodeIdentityVisitor{nameNode(e,t,r){const a=this.parsedFormulaTree.spans[r]?.end;if(a===this.caretPosition&&e.kind===i.NamePartKind.IdentNamePart&&this.trySetDefinedName(e)&&(this.dotNotationIndex=a,this.childFieldRefLabel=r),e.kind===i.NamePartKind.FieldRefNamePart){const r=this.parsedFormulaTree.spans[e.lhs.label]?.end;if((0,n.isDefined)(r)&&(this.caretPosition===a||this.isCaretAfterDotBeforeStartOfFieldRef(r,e.rhs)&&e.lhs.kind!==i.NamePartKind.FieldRefNamePart)){let n=!1;e.lhs.kind===i.NamePartKind.CellRefNamePart?(this.setCellRef(e.lhs.ref,t),n=!0):e.lhs.kind===i.NamePartKind.IdentNamePart&&this.trySetDefinedName(e.lhs)&&(n=!0),n&&(this.dotNotationIndex=r,e.rhs.field.kind===i.NodeKind.Ident&&(this.caretPosition===a?this.richValueItemPrefix=e.rhs.field.whole:this.fieldRefChainEndIndex=a))}}return super.nameNode(e,t,r)}cellRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r]?.end;return void 0!==n&&this.caretPosition===n&&(this.setCellRef(e,t),this.dotNotationIndex=n,this.childFieldRefLabel=r,this.shouldAddEmptySuggestion=!0),super.cellRefNode(e,t,r)}fieldRefNode(e,t,r){const n=this.parsedFormulaTree.spans[r]?.end,i=this.parsedFormulaTree.spans[e.label]?.end;return void 0===n||void 0===i||(this.isCaretAtEndOfFieldRefNode(n,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=i,this.richValueItemPrefix=l(t)):this.isCaretAfterDotBeforeStartOfFieldRef(i,t)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,r),this.dotNotationIndex=i,this.fieldRefChainEndIndex=n):e.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=n,this.childFieldRefLabel=r)),super.fieldRefNode(e,t,r)}structRefNode(e,t,r){const o=super.structRefNode(e,t,r),s=this.parsedFormulaTree.spans[r]?.end;return this.caretPosition===s&&(0,n.isDefined)(e)&&t.isClosed&&o.kind===i.NodeKind.StructRef&&this.definedNames.some((t=>t.type===a.DefinedNameInfoType.Table&&(0,n.isDefined)(t.name)&&t.name.toLowerCase()===e.whole.toLowerCase()))&&(this.setNamedNodeRef(o),this.dotNotationIndex=s),o}initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(e,t){let r=e;for(;r.kind===i.NodeKind.FieldRef;)this.dotNotationPath="["+l(r.rhs)+"]."+this.dotNotationPath,r=r.lhs;r.kind===i.NodeKind.CellRef&&this.setCellRef(r.ref,r.qualifier),r.kind===i.NodeKind.StructRef&&this.setNamedNodeRef(r),r.kind===i.NodeKind.Name&&this.trySetDefinedName(r.parts),this.childFieldRefLabel=t}getRefString(e){const t=this.parsedFormulaTree.spans[e]?.start,r=this.parsedFormulaTree.spans[e]?.end;return(0,n.isDefined)(t)&&(0,n.isDefined)(r)&&t>=0&&r<this.formulaText.length?this.formulaText.substring(t,r):""}setCellRef(e,t){e.kind!==i.CellRefKind.Single&&e.kind!==i.CellRefKind.Range||(this.cellRef=(0,s.getRangeFromCellRef)(e,this.activeCell,c)),(0,n.isDefined)(t)&&(this.sheetName=(0,s.getSheetNameFromQualifier)(t,c)),this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}setNamedNodeRef(e){this.namedRangeNode=e,this.trySetDotNotationPathOrigin((()=>this.getRefString(e.label)))}isCaretAfterDotBeforeStartOfFieldRef(e,t){if(!(0,n.isDefined)(t))return!1;const r=this.parsedFormulaTree.spans[t.field.label]?.start;return void 0!==r&&this.caretPosition>e&&(this.caretPosition<r||!t.isBracketed&&this.caretPosition===r)}isCaretAtEndOfFieldRefNode(e,t){if(this.caretPosition===e)return!0;const r=this.parsedFormulaTree.spans[t.field.label]?.end;return!(!(0,n.isDefined)(r)||this.caretPosition!==r)}trySetDefinedName(e){if(e.canDenoteNamedObject){const t=this.definedNames.find((t=>t.name?.toLowerCase()===e.asWhole.toLowerCase()));if((0,n.isDefined)(t))return this.setDefinedName(t),!0}return!1}setDefinedName(e){const t=e.namedRange;if(!(0,n.isDefined)(t))return;const r=e.sheetName??t.sheetName;(0,n.isDefined)(r)&&(this.sheetName=r),this.cellRef={firstRow:t.top-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1},this.trySetDotNotationPathOrigin((()=>e.name))}trySetDotNotationPathOrigin(e){if(this.dotNotationPath.length>0){const t=e();(0,n.isDefined)(t)?this.dotNotationPath=t+"."+this.dotNotationPath:c("tryUpdateDotNotationPath with undefined name")}}constructor(e,t,r,n,i){super(e,t),this.formulaText=r,this.definedNames=n,this.activeCell=i,this.dotNotationPath="",this.richValueItemPrefix="",this.dotNotationIndex=0,this.shouldAddEmptySuggestion=!1}}function l(e){return e.field.kind!==i.NodeKind.Ident?"":e.field.whole}function c(e){i.ulsLogger.ULS.traceTag(523257827,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`AutocompleteRichValueVisitor failed with msg: ${e}`)}t.AutocompleteRichValueVisitor=u},4017:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteTableHeadersPluginDependenciesResolved=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(246),l=r(9731),c=r(2159),d=r(2566),m=r(4352),g=r(9084),p=r(2937),h=r(8795),f=r(6307),S=r(8708),v=r(9615),y=S.PluginRegistry.create(s.PluginFactoryName.AutocompleteTableHeadersPlugin,s.PluginGroup.Excel);let F=(()=>{let e,t,r,m=[y.x10Plugin()],p=[],h=[];return t=class{*run(e){const{content:t,caretPosition:r}=e;if((0,i.isNone)(t)||(0,i.isNone)(r))return null;const n=yield{kind:f.ComputationRequestKind.ParseActiveCell,formulaText:t};if(n.kind!==f.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(n.result))return null;if(n.result.value.kind!==o.EditKind.Formula)return null;const{formula:u}=n.result.value,l=yield{kind:f.ComputationRequestKind.GetDefinedNamesInfo};if(l.kind!==f.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),null;const m=l.definedNamesInfo.filter((e=>e.type===s.DefinedNameInfoType.Table)).map((e=>e.name)).filter(i.isDefined);if(0===m.length)return null;let g;g=this.fixAutocompleteTableHeadersBugEnabled?new c.AutocompleteTableHeadersVisitor(u,r,m):new d.AutocompleteTableHeadersVisitorOld(u,r,m),(0,a.reduceBottomUp)(g,u);let{tableName:p}=g;const{containingNode:h,isInsideArrayNode:S,isNodeClosed:v}=g;if((0,i.isNone)(h)||S)return null;if((0,i.isNone)(p)){const e=yield{kind:f.ComputationRequestKind.GetActiveCell};if(e.kind!==f.ComputationRequestKind.GetActiveCell)return this.logFailure("Couldn't get active cell"),null;const t=yield{kind:f.ComputationRequestKind.GetContainingTable,cell:e.activeCell};if(t.kind!==f.ComputationRequestKind.GetContainingTable||!(0,i.isSuccess)(t.result))return this.logFailure(`GetContainingTable request failed. result kind = ${JSON.stringify(t)}`),null;if(p=t.result.value?.name,(0,i.isNone)(p))return null}let{start:y,end:F}=h;const b=t.charAt(F-1);if("]"!==b&&")"!==b||F--,"["===t.charAt(y)&&y++,!(r===F||this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,y,r)))return null;const C=yield{kind:f.ComputationRequestKind.GetAvailableTableHeaders,tableName:p};let k;if(C.kind!==f.ComputationRequestKind.GetAvailableTableHeaders||!(0,i.isSuccess)(C.result)||(0,i.isNone)(C.result.value)||C.result.value.isPartial){a.ulsLogger.ULS.traceTag(509682331,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server");const e=yield{kind:f.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:p};if(e.kind!==f.ComputationRequestKind.GetFullTableHeadersFromServer||!(0,i.isDefined)(e.result))return this.logFailure("Failed to get header names from server"),null;k=e.result}else k=C.result.value.cols;if(!(0,i.isDefined)(k)||0===k.length)return null;let E="";this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,y,r)?F=v?F:y:E=t.substring(y,F);const A=yield{kind:f.ComputationRequestKind.GetConfig};return A.kind!==f.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),null):{items:this.getCompletionItems(k,E,y,F,g.isWithinThisRowOp,A.config.localeInfo.specialRefNames)}}caretIsInTheBeginning(e,t,r){return 0===e.substring(t,r).trim().length}generateCompletionItems(e,t,r,n,a,o){const u=[];return e.forEach((e=>{const l="string"==typeof e,c=l?e:e.name,d=l?void 0:e.description;u.push({label:c,kind:a,type:s.SuggestionKind.Simple,textEdit:{newText:(0,i.isDefined)(o)?o(c):c,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:d,isPrefixed:n})})),u}generateHeadersCompletionItems(e,t,r,n,i=!1){const{prefixedSuggestions:a,notPrefixedSuggestions:o}=(0,l.filterSuggestionsAccordingToPrefix)(e,t),u=this.getHeaderTextEditCallback(i);return[...this.generateCompletionItems(a,r,n,!0,s.CompletionItemKind.TableHeader,u),...this.generateCompletionItems(o,r,n,!1,s.CompletionItemKind.TableHeader,u)]}generateSpecialCaseCompletionItems(e,t,r,n){const i=[a.SpecialRefId.All,a.SpecialRefId.Data,a.SpecialRefId.Headers,a.SpecialRefId.Totals].map((e=>({name:n[e]??"",description:b.getValue()[e]}))),{prefixedSuggestions:o,notPrefixedSuggestions:u}=(0,l.filterSuggestionsAccordingToPrefix)(r,i,(e=>e.name));return[...this.generateCompletionItems(o,e,t,!0,s.CompletionItemKind.TableSpecialStructRef),...this.generateCompletionItems(u,e,t,!1,s.CompletionItemKind.TableSpecialStructRef)]}generateThisRowOpCompletionItem(e,t,r){return{label:`@ - ${r}`,kind:s.CompletionItemKind.TableSpecialStructRef,type:s.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),shouldRequestAutocompleteOnCommit:!0}}logFailure(e){a.ulsLogger.ULS.traceTag(526508764,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`AutocompleteTableHeadersPlugin encountered a failure with msg ${e}`)}constructor(){this.fixAutocompleteTableHeadersBugEnabled=(n.__runInitializers(this,h),(0,u.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug")),this.getCompletionItems=(e,t,r,n,i,o)=>{const s="@"===t.charAt(0);if(s||i){const i=s?r+1:r,a=s?t.substring(1):t;return this.generateHeadersCompletionItems(a,e,i,n,!0)}const u=[];if(""===t){const e=o[a.SpecialRefId.ThisRow]?.substring(1);this.fixAutocompleteTableHeadersBugEnabled?u.push(this.generateThisRowOpCompletionItem(r,r,e)):u.push(this.generateThisRowOpCompletionItem(r,n,e))}return u.push(...this.generateSpecialCaseCompletionItems(r,n,t,o)),u.push(...this.generateHeadersCompletionItems(t,e,r,n)),u},this.getHeaderTextEditCallback=e=>t=>{const r=C(t);return e&&this.hasSpecialChars(r)?`[${r}]`:r},this.hasSpecialChars=e=>{try{return new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u").test(e)}catch(e){return this.logFailure(`hasSpecialChars method, error: ${e}.`),!0}}}},n.__setFunctionName(t,"AutocompleteTableHeadersPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[y.uiMessageHandler({kind:g.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},m,{kind:"class",name:t.name,metadata:i},null,p),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=y.injectPluginFactory(),n.__runInitializers(t,p),t})();(0,p.registerPluginFactory)(F.factory),t.autocompleteTableHeadersPluginDependenciesResolved=(0,v.trackableAsyncLazy)((async()=>{const e=await h.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.AutocompleteTableHeadersPlugin),await h.schedulerWithRecalcServiceAttached.getValue()}),"autocompleteTableHeadersPluginDependenciesResolved");const b=new m.ResettableLazy((()=>({[a.SpecialRefId.All]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefAllDescription),[a.SpecialRefId.Data]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefDataDescription),[a.SpecialRefId.Headers]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefHeadersDescription),[a.SpecialRefId.Totals]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefTotalsDescription),[a.SpecialRefId.ThisRow]:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription)}))),C=e=>e.replace(/\[|\]|\'|\@|\#/g,"'$&")},2159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitor=void 0;const n=r(6913),i=r(6592),a=r(3486);class o extends a.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){if(this.isCaretInNode(t)){e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)}));const r=this.parsedFormulaTree.spans[t.label];this.isNodeClosed=this.isStructRefClosed=t.isClosed,this.containingNode=r,void 0!==t.innerRef&&this.findContainingNode(t.innerRef)}return super.structRefNode(e,t,r)}getIsNodeClosed(e){return e.isBracketed?e.isClosed:this.isStructRefClosed}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}isCaretInBeginningOfNode(e){return(0,n.isDefined)(e)&&this.caretPosition===e.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isStructRefClosed=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:case i.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.getIsNodeClosed(e));break;case i.StructRefKind.ThisRowOpRef:const r=e.ref;if(this.isCaretInBeginningOfNode(t))break;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t,this.isNodeClosed=this.isStructRefClosed);break;case i.StructRefKind.CommaOpRef:if(this.isCaretInBeginningOfNode(t))break;e.refs.map(this.findContainingNode);break;case i.StructRefKind.RangeOpRef:if(this.isCaretInBeginningOfNode(t))break;const a=e;this.findContainingNode(a.lhs),this.findContainingNode(a.rhs);break;case i.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,n.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitor=o},2566:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitorOld=void 0;const n=r(6913),i=r(6592),a=r(3486);class o extends a.CaretInsideArrayNodeIdentityVisitor{structRefNode(e,t,r){return this.isCaretInNode(t)&&(e&&this.tableNames.forEach((t=>{t.toLocaleLowerCase()===e.whole.toLocaleLowerCase()&&(this.tableName=t)})),void 0===t.innerRef?this.containingNode=this.parsedFormulaTree.spans[t.label]:this.findContainingNode(t.innerRef)),super.structRefNode(e,t,r)}isCaretInNode(e){const t=this.parsedFormulaTree.spans[e.label];return(0,n.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start}constructor(e,t,r){super(e,t),this.tableNames=r,this.isWithinThisRowOp=!1,this.isNodeClosed=!1,this.findContainingNode=e=>{const t=this.parsedFormulaTree.spans[e.label];if(this.isCaretInNode(e))switch(e.kind){case i.StructRefKind.SpecialRef:case i.StructRefKind.ColumnRef:case i.StructRefKind.BadRef:this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case i.StructRefKind.ThisRowOpRef:const r=e.ref;this.isWithinThisRowOp=!0,(0,n.isDefined)(r)?this.findContainingNode(r):this.isTighterThanCurrent(t)&&(this.containingNode=t);break;case i.StructRefKind.CommaOpRef:e.refs.map(this.findContainingNode);break;case i.StructRefKind.RangeOpRef:const a=e;this.findContainingNode(a.lhs),this.findContainingNode(a.rhs);break;case i.StructRefKind.MissingRef:this.containingNode=void 0}},this.isTighterThanCurrent=e=>(0,n.isDefined)(e)&&((0,n.isNone)(this.containingNode)||e.end<this.containingNode.end||e.start>this.containingNode.start)}}t.AutocompleteTableHeadersVisitorOld=o},4803:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaAuthoringCopilotIPEPluginDependenciesResolved=t.formulaAuthoringCopilotIPEPlugin=void 0;const n=r(6533),i=r(6913),a=r(1633),o=r(6700),s=r(9084),u=r(2937),l=r(8795),c=r(8708),d=r(9615),m=["="],g=c.PluginRegistry.create(a.PluginFactoryName.FormulaAuthoringCopilotIPEPlugin,a.PluginGroup.Excel);let p=(()=>{let e,t,r,u=[g.x10Plugin()],l=[],c=[];return t=class{*run(e){return(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringCopilotIPE")?h(e.content)?h(e.cellOriginalValue)?{shouldShowIPE:!1,mode:a.FormulaCopilotIPEMode.Modify,placeholderText:f(a.FormulaCopilotIPEMode.Modify)}:{shouldShowIPE:!0,mode:a.FormulaCopilotIPEMode.Create,placeholderText:f(a.FormulaCopilotIPEMode.Create)}:{shouldShowIPE:!1}:"="===e.content?{shouldShowIPE:!0}:{shouldShowIPE:!1}}constructor(){n.__runInitializers(this,c)}},n.__setFunctionName(t,"formulaAuthoringCopilotIPEPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[g.uiMessageHandler({kind:s.RequestKind.formulaCopilotIPE,modifiers:{executionType:o.ExecutionType.Sync}}),g.uiMessageHandler({kind:s.RequestKind.formulaCopilotIPE})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,c),n.__esDecorate(null,e={value:t},u,{kind:"class",name:t.name,metadata:i},null,l),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=g.injectPluginFactory(),n.__runInitializers(t,l),t})();function h(e){return m.some((t=>e.startsWith(t)))}function f(e){switch(e){case a.FormulaCopilotIPEMode.Create:return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CopilotIPEFormulaCreationPlaceholder);case a.FormulaCopilotIPEMode.Modify:return"";default:(0,i.assertNever)(`unexpected formula mode ${e}`,e)}}t.formulaAuthoringCopilotIPEPlugin=p,(0,u.registerPluginFactory)(p.factory),t.formulaAuthoringCopilotIPEPluginDependenciesResolved=(0,d.trackableAsyncLazy)((async()=>{const e=await l.autoCompletePluginsThread.getValue();await e.loadPluginScript("formula-authoring-strings",!0),await e.createAndAttachPlugin(a.PluginFactoryName.FormulaAuthoringCopilotIPEPlugin),await l.schedulerWithRecalcServiceAttached.getValue()}),"formulaAuthoringCopilotIPEPluginDependenciesResolved")},4846:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionShortDescriptions=void 0;const n=r(6913),i=r(6592),a=r(5033),o=r(4352);t.functionShortDescriptions=new o.ResettableLazy((()=>{try{const e=new Map,t={};for(const r of Object.keys(i.WorksheetFuncId)){const n=Number(r);if(!isNaN(Number(n))){const r=FormulaAuthoringStrings[i.WorksheetFuncId[n]+"ShortDescription"];e.set(n.toString(),r),t[n.toString()]=r}}return(0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?{descriptionMap:t}:{descriptionMap:e}}catch(e){return n.ulsLogger.ULS.traceTag(538792415,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`failed to get functionShortDescriptionsMap with exception ${e}`),{}}}))},4330:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventCallbacksManagerService=t.isALAnnotationEventKind=t.ALAnnotationKinds=t.ExternallyHandledEventKinds=t.ExternallyTriggeredEventKinds=t.ALAnnotationKind=t.EventKind=void 0,t.makeEventEmitter=function(e){return(0,i.mapFromArrayOfDependantPairs)(t.ExternallyTriggeredEventKinds.map((t=>[t,r=>e.triggerEvent(t,r)])))},t.makeALAnnotationNotifier=function(e){const t=t=>r=>(0,n.isNone)(r)?Promise.resolve():Promise.resolve(e.triggerEvent(t,r));return{FormulaByExample:t(o.FormulaByExample),CalculatedColumnSuggestion:t(o.CalculatedColumnSuggestion),FormulaByExamplePreview:t(o.FormulaByExamplePreview),FormulaCompletionFormulaAnnotation:t(o.FormulaCompletionFormulaAnnotation),FormulaCompletionBlockedAnnotation:t(o.FormulaCompletionBlockedAnnotation)}};const n=r(6913),i=r(3713);var a,o;!function(e){e.InternalTestEvent="InternalTestEvent",e.TestEvent="TestEvent",e.FBECacheUpdateEvent="FBECacheUpdateEvent",e.FBESendSignal="FBESendSignal",e.FBEOutcomeUpdate="FBEOutcomeUpdate",e.FBECacheUpdateEventDeprecated="FBECacheUpdateEventDeprecated",e.FormulaTranspilerInitEvent="FormulaTranspilerInitEvent",e.DescriptionCalculateColumns="DescriptionCalculateColumns",e.ExternalLinksMetaDataInitEvent="ExternalLinksMetaDataInitEvent",e.FormulaCompletionBlockedSuggestion="FormulaCompletionBlockedSuggestion",e.FormulaCompletionFormulaAnnotationArrived="FormulaCompletionFormulaAnnotationArrived"}(a||(t.EventKind=a={})),function(e){e.FormulaByExample="FormulaByExample",e.CalculatedColumnSuggestion="CalculatedColumnSuggestion",e.FormulaByExamplePreview="FormulaByExamplePreview",e.FormulaCompletionFormulaAnnotation="FormulaCompletionFormulaAnnotation",e.FormulaCompletionBlockedAnnotation="FormulaCompletionBlockedAnnotation"}(o||(t.ALAnnotationKind=o={})),t.ExternallyTriggeredEventKinds=[a.TestEvent,a.FBEOutcomeUpdate,a.FormulaTranspilerInitEvent,a.ExternalLinksMetaDataInitEvent],t.ExternallyHandledEventKinds=[a.TestEvent,a.DescriptionCalculateColumns,a.FormulaCompletionBlockedSuggestion],t.ALAnnotationKinds=(0,n.strEnumArray)(o),t.isALAnnotationEventKind=e=>t.ALAnnotationKinds.findIndex((t=>e===t))>=0,(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),(0,n.staticAssertSame)(),t.EventCallbacksManagerService=class{make(e){return t=>this.registry[e].forEach((e=>e(t)))}constructor(e){this.registry=(0,i.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((e=>[e,[]]))),this.registerEventCallback=(e,t)=>this.registry[e].push(t),this.TestEvent=this.make("TestEvent"),this.DescriptionCalculateColumns=this.make("DescriptionCalculateColumns"),this.FormulaCompletionBlockedSuggestion=this.make("FormulaCompletionBlockedSuggestion"),e(this)}}},6246:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALAnnotationKind=t.EventKind=void 0;var n=r(4330);Object.defineProperty(t,"EventKind",{enumerable:!0,get:function(){return n.EventKind}}),Object.defineProperty(t,"ALAnnotationKind",{enumerable:!0,get:function(){return n.ALAnnotationKind}})},9084:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPluginResponseWindows=t.RequestKind=void 0;var n=r(2363);Object.defineProperty(t,"RequestKind",{enumerable:!0,get:function(){return n.RequestKind}}),Object.defineProperty(t,"defaultPluginResponseWindows",{enumerable:!0,get:function(){return n.defaultPluginResponseWindows}})},2363:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestKindCellContentNamesMap=t.defaultPluginResponseWindows=t.RequestKind=void 0,t.makeRequester=function(e){const t=t=>(...[r,a,o])=>(0,n.isNone)(r)?Promise.resolve(null):Promise.resolve(e.doRequest(t,r,a,o??i.DefaultComputationGroup));return{argumentAssistance:t(a.argumentAssistance),chatGPTQuery:t(a.chatGPTQuery),columnFormulaSuggestion:t(a.columnFormulaSuggestion),formulaCopilotIPE:t(a.formulaCopilotIPE),formulaHighlighting:t(a.formulaHighlighting),formulaRepair:t(a.formulaRepair),functionSuggestion:t(a.functionSuggestion),formulaCompletion:t(a.formulaCompletion),gotoCtrlClick:t(a.gotoCtrlClick),inCellSuggestion:t(a.inCellSuggestion),runAuthoringExperiment:t(a.runAuthoringExperiment),runExperiment:t(a.runExperiment),runPerCharacterExperiment:t(a.runPerCharacterExperiment),runTest:t(a.runTest),valuePreview:t(a.valuePreview),getTranspiledFormulas:t(a.getTranspiledFormulas),getAnonymizedFormulas:t(a.getAnonymizedFormulas),inCellControlsAutodetection:t(a.inCellControlsAutodetection),getLocale:t(a.getLocale)}},t.makeSyncRequester=function(e){return{runTest:(t,r,o)=>(0,n.isNone)(t)?null:e.doSyncRequest(a.runTest,t,r,o??i.DefaultComputationGroup),formulaHighlighting:(t,r,o)=>(0,n.isNone)(t)?null:e.doSyncRequest(a.formulaHighlighting,t,r,o??i.DefaultComputationGroup),columnFormulaSuggestion:(t,r,o)=>(0,n.isNone)(t)?null:e.doSyncRequest(a.columnFormulaSuggestion,t,r,o??i.DefaultComputationGroup),formulaCopilotIPE:(t,r,o)=>(0,n.isNone)(t)?null:e.doSyncRequest(a.formulaCopilotIPE,t,r,o??i.DefaultComputationGroup)}};const n=r(6913),i=r(6307);var a;!function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.formulaCopilotIPE="formulaCopilotIPE",e.formulaCompletion="formulaCompletion",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.columnFormulaSuggestion="columnFormulaSuggestion",e.getTranspiledFormulas="getTranspiledFormulas",e.getAnonymizedFormulas="getAnonymizedFormulas",e.inCellControlsAutodetection="inCellControlsAutodetection",e.getLocale="getLocale"}(a||(t.RequestKind=a={})),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.defaultPluginResponseWindows={[a.functionSuggestion]:{startDelta:5,stopDelta:2e3},[a.inCellSuggestion]:{startDelta:5,stopDelta:2e3},[a.formulaHighlighting]:{startDelta:5,stopDelta:2e3},[a.argumentAssistance]:{startDelta:5,stopDelta:2e3},[a.formulaCopilotIPE]:{startDelta:5,stopDelta:2e3},[a.formulaCompletion]:{startDelta:(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.FormulaCompletionStartDelta"),stopDelta:6e3},[a.valuePreview]:{startDelta:5,stopDelta:2e3},[a.gotoCtrlClick]:{startDelta:5,stopDelta:2e3},[a.formulaRepair]:{startDelta:5,stopDelta:2e3},[a.runExperiment]:{startDelta:0,stopDelta:15e3},[a.runAuthoringExperiment]:{startDelta:0,stopDelta:15e3},[a.runPerCharacterExperiment]:{startDelta:5,stopDelta:2e3},[a.runTest]:{startDelta:0,stopDelta:15e3},[a.chatGPTQuery]:{startDelta:0,stopDelta:15e3},[a.columnFormulaSuggestion]:{startDelta:0,stopDelta:2e4},[a.getTranspiledFormulas]:{startDelta:0,stopDelta:5e3},[a.getAnonymizedFormulas]:{startDelta:0,stopDelta:5e3},[a.inCellControlsAutodetection]:{startDelta:0,stopDelta:2e3},[a.getLocale]:{startDelta:0,stopDelta:2e3}},n.staticAssertSame,t.requestKindCellContentNamesMap={[a.functionSuggestion]:"content",[a.inCellSuggestion]:"content",[a.formulaCopilotIPE]:"content",[a.formulaHighlighting]:"content",[a.argumentAssistance]:"content",[a.valuePreview]:"text",[a.runAuthoringExperiment]:"content",[a.runPerCharacterExperiment]:"content",[a.formulaRepair]:"formula",[a.gotoCtrlClick]:"text",[a.formulaCompletion]:"content",[a.columnFormulaSuggestion]:void 0,[a.runExperiment]:void 0,[a.runTest]:void 0,[a.chatGPTQuery]:void 0,[a.getTranspiledFormulas]:void 0,[a.getAnonymizedFormulas]:void 0,[a.inCellControlsAutodetection]:void 0,[a.getLocale]:void 0}},3747:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationKinds=t.ComputationType=void 0;const n=r(6913),i=r(4330),a=r(2363);var o;!function(e){e.UIMessage="UIMessage",e.Event="Event"}(o||(t.ComputationType=o={})),t.ComputationKinds={[o.UIMessage]:a.RequestKind,[o.Event]:{...i.EventKind,...i.ALAnnotationKind}},(0,n.staticAssertSame)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)()},326:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computationRegistry=t.registerComputation=t.deletePluginRegistration=t.wrapRegistration=void 0,t.getShouldRunComputationPredicate=d,t.isFormulaRequest=m,t.getFormulaContent=g;const n=r(6913),i=r(6592),a=r(3747),o=r(2363),s=r(3713),u=r(4691);class l{push(e,t){this.registeredComputations.get(t)?i.ulsLogger.ULS.traceTag(507330770,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`Computation '${JSON.stringify(t.computationIdentifier)}' already registered`):(this.byFactoryName.get(e).push(t),this.registeredComputations.set(t,!0))}getRegistrationsByPluginIdentifier(e){return this.byFactoryName.get(e)}getRegistrationByComputationIdentifier(e){return this.getRegistrationsByPluginIdentifier(e).find((t=>t.computationIdentifier.computationName===e.computationName))}deleteRegistrationsByPluginIdentifier(e){let t=0;for(const r of this.byFactoryName.get(e))this.registeredComputations.delete(r),t++;return this.byFactoryName.delete(e),t}constructor(){this.registeredComputations=new s.DefaultMap({getKey:e=>`${e.computationIdentifier.factoryName}.${e.computationIdentifier.pluginName}.${e.computationIdentifier.computationName}.${e.computationIdentifier.executionType}`,getDefault:()=>!1}),this.byFactoryName=new s.DefaultMap({getKey:e=>`${e.factoryName}.${e.pluginName}`,getDefault:()=>[]})}}const c=(0,s.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(a.ComputationType).map((e=>[e,new l])));function d(e,t){return function(r,n){for(const t of p)if(!t({registration:e,input:r,pluginGroup:n}))return!1;return void 0===t||t.bind(this)(r)}}function m(e){return void 0!==o.requestKindCellContentNamesMap[e]}function g(e){const t=o.requestKindCellContentNamesMap[e[0]];(0,s.staticTypeHint)(t);const r=e[1][t];return(0,s.staticTypeHint)(r),r}t.wrapRegistration=(e,t,r,n,i,a,o,s)=>{const u=d({type:e,kind:t,pluginGroup:n,modifiers:a},s);return{type:e,kind:t,execution:r,pluginGroup:n,computationIdentifier:i,modifiers:a,registrationMethod:(n,a)=>([s,l])=>{if(!u.bind(a)(s.computationInput,l))return void n.addResult({type:e,computationKind:t,computationIdentifier:i,computationGroup:s.computationGroup,correlationId:s.correlationId},{kind:"Skipped"});const c=o.bind(a);n.startComputation(e,t,r,i,c(s.computationInput),s)}}},t.deletePluginRegistration=e=>{let t=0;for(const r of(0,n.strEnumArray)(a.ComputationType))t+=c[r].deleteRegistrationsByPluginIdentifier(e);t>0&&u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.PluginAttachmentFailure,failureLevel:i.TraceLevel.Warning,path:"deletePluginRegistration",description:"Deleted plugin registration",data:e}})},t.registerComputation=(e,r,n,i,a,o,s,u)=>{const l=(0,t.wrapRegistration)(e,r,n,i,a,o,s,u);c[e].push(a,l)},t.computationRegistry=c;const p=[({registration:e,pluginGroup:t})=>void 0===t||t===e.pluginGroup,({registration:e,input:t})=>{if(e.type!==a.ComputationType.UIMessage||e.modifiers.runOnNonFormula)return!0;if((0,s.staticTypeHint)(e.kind),!m(e.kind))return!0;const r=[e.kind,t];(0,s.staticTypeHint)(r);const n=g(r);return-1!==["=","+","-"].indexOf(n[0])}]},6700:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionType=void 0,function(e){e.Atomic="Atomic",e.NoOp="NoOp",e.Sync="Sync",e.Async="Async",e.Internal="Internal"}(r||(t.ExecutionType=r={}))},4776:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelperSingleton=void 0;const n=r(6913),i=r(5157);t.FormulaAuthoringHelperSingleton=(0,n.singleton)((()=>new i.FormulaAuthoringHelper))},5157:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelper=void 0;const n=r(6913),i=r(6592),a=r(246),o=r(6286),s=r(9268),u=r(6471);t.FormulaAuthoringHelper=class{getMinimalParamArray(e,t){if((0,n.isNone)(t))return;const{minArgs:r,restTypes:i}=(0,o.getWorksheetFuncTypeWrapper)(t);let s;s=(0,a.isChangeGateEnabled)("OfficeVSO:9292450_FixWrongParamForCFInArgumentsDialog")?i.length>0&&!t.IsDynamicUdf?Math.max(r,2):e?.length??0:i.length>0?Math.max(r,2):e?.length??0;const u=[];for(let r=0;r<s;r+=1){const i=this.getFunctionParamByIndex(e,t,r);(0,n.isDefined)(i)&&u.push(i)}return u}getFunctionParamByIndex(e,t,r){if((0,n.isNone)(t))return;const i=t.ParamsHelp.split("!");let u="",l=!1,c="";if((0,a.isChangeGateEnabled)("OfficeVSO:9292450_FixWrongParamForCFInArgumentsDialog")&&t.IsDynamicUdf){if(r<=e.length-1&&(l=/^\[.*\]$/.test(e[r]),u=l?e[r].slice(1,-1):e[r],c=i[r]),r>=e.length-1)if(t.Params.endsWith("..."))u=`${(0,s.getBaseParamName)(e[e.length-1])}${r-e.length+2}`,l=!0,c=i[i.length-1];else if(r!==e.length-1)return void this.logError("Trying to get param by index that is out of bounds")}else{const n=(0,o.getWorksheetFuncTypeWrapper)(t),a=n.headTypes.length,d=(0,s.getParamIndexToHighlight)(r,e.length,n,!1,!0);if(-1===d)return void this.logError("Trying to get param by index that is out of bounds");if(d>=e.length)return void this.logError("Trying to add param for a signature that doesn't have rest params.");u=r<a?e[d].match(/[^\[\]]+/).toString():`${(0,s.getBaseParamName)(e[d])}${(0,s.getParamNumberSuffix)(r,a,n.restTypes.length)}`,l=r>=n.minArgs,c=i[(0,s.getParamIndexToHighlight)(r,t.ParamsHelp.split("!").length,n)]}return{name:u,isOptional:l,description:c,type:"TO DO"}}getFormulaAnonymizer(e){const t=new u.ConsistentAnonymizer;return{anonymize:(r,i)=>{try{return a=r,(0,n.isDefined)(a)&&"string"==typeof a?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}(e)?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"row"in e&&"col"in e&&1===e.rows&&1===e.cols}(i)?t.anonymize(r,e,i):(this.logError("getFormulaAnonymizer: Origin"),null):(this.logError("getFormulaAnonymizer: Config"),null):(this.logError("getFormulaAnonymizer: Formula"),null)}catch(e){return this.logError(`getFormulaAnonymizer: ${e}`),null}var a}}}logError(e){i.ulsLogger.ULS.traceTag(512331973,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,`FormulaAuthoringHelper error: ${e}`)}constructor(){this.hasRepeatingParams=e=>(0,n.isNone)(e)?(this.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,o.getWorksheetFuncTypeWrapper)(e).restTypes.length>0}}},6286:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncTypeWrapper=function(e){return i(e)?a[e.FunctionIndexInServer][e.signatureIndex]:(0,n.getWorksheetFuncType)(e.FunctionIndexInServer)};const n=r(6592),i=e=>{if(void 0===e)return!1;const{FunctionIndexInServer:t,signatureIndex:r}=e;return!(0!==r&&1!==r||t!==n.WorksheetFuncId.AGGREGATE&&t!==n.WorksheetFuncId.INDEX&&t!==n.WorksheetFuncId.LOOKUP)},a={[n.WorksheetFuncId.AGGREGATE]:[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],[n.WorksheetFuncId.INDEX]:[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],[n.WorksheetFuncId.LOOKUP]:[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}]}},6471:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=void 0;const n=r(6913),i=r(6592),a=r(391);var o=a.stopUsingThis.tokenizeFormula,s=a.stopUsingThis.singleLineCommentToken,u=a.stopUsingThis.multiLineCommentToken,l=a.stopUsingThis.TokenKind,c=a.stopUsingThis.identToken,d=a.stopUsingThis.literalToken,m=a.stopUsingThis.cellRefA1Token,g=a.stopUsingThis.TokenOperKind,p=a.stopUsingThis.cellRefR1C1Token,h=a.stopUsingThis.unexpectedToken,f=a.stopUsingThis.DelimId;class S{get(e,t,r){if(e===l.Literal){if(void 0===r)throw new Error("Expected subkind");return this.literalStore.get(r)?.get(t)}return this.nonLiteralStore.get(e)?.get(t)}set(e,t,r,n){if(e===l.Literal){if(void 0===n)throw new Error("Expected subkind");const e=this.literalStore.get(n)??new Map;e.set(t,r),this.literalStore.set(n,e)}else{const n=this.nonLiteralStore.get(e)??new Map;n.set(t,r),this.nonLiteralStore.set(e,n)}}constructor(){this.nonLiteralStore=new Map,this.literalStore=new Map}}t.ConsistentAnonymizer=class{getAnonymization(e,t,r,n){const i=this.store.get(e,r,t);if(void 0!==i)return i;const a=n(this.counter);return this.counter+=1,this.store.set(e,r,a,t),a}anonymizeIdent(e,t,r,n){const i=t??e.start,a=r?.localeInfo.getWorksheetFuncId(e.chars);if(void 0!==a&&function(e){return void 0!==e&&e.kind===l.Left&&e.value===f.Paren}(n))return c(i,e.chars);const o=this.getAnonymization(e.kind,void 0,e.chars,(e=>`ident${e}`));return c(i,o)}anonymizeA1CellRef(e,t){if(e.refStyle!==i.RefStyle.A1)throw new Error("Expected RefStyle.A1");const r=t??e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`A${e}`));return m(r,n,void 0,void 0)}anonymizeR1C1CellRef(e,t){if(e.refStyle!==i.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");const r=t??e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(e=>`R${e}C${e}`));return p(r,n,void 0,void 0)}anonymizeCellRef(e,t){return e.refStyle===i.RefStyle.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)}anonymizeLiteral(e,t){const r=t??e.start;let a;switch(e.oper.kind){case i.OperKind.Number:a=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`${e}`));break;case i.OperKind.String:a=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`"s${e}"`));break;case g.BadNumber:a=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>`1e${e}000`));break;case g.BadError:a=this.getAnonymization(e.kind,e.oper.kind,e.chars,(e=>{const t=["a"],r="a".charCodeAt(0);let n=e;for(;n>0;){const i=e%10,a=String.fromCharCode(r+i);t.push(a),n=Math.floor(n/10)}return`#${t.join("")}`}));break;case i.OperKind.Boolean:case i.OperKind.Error:a=e.chars;break;default:(0,n.assertNever)("error",e.oper)}const o=e.oper,s=e.hasRight;return d(r,a,o,s)}anonymizeToken(e,t,r,i){switch(e.kind){case l.Ident:return this.anonymizeIdent(e,t,r,i);case l.CellRef:return this.anonymizeCellRef(e,t);case l.Literal:return this.anonymizeLiteral(e,t);case l.Unexpected:return function(e,t){const r=t??e.start;return"\t"===e.chars||";"===e.chars?h(r,e.chars):h(r,"\t")}(e,t);case l.SingleLineComment:return s(t,"redacted");case l.MultiLineComment:return u(t,"redacted",e.isClosed);case l.End:case l.Left:case l.Right:case l.Sep:case l.Operator:case l.Spaces:case l.SpecialRef:case l.Escape:return{...e,start:t};default:return(0,n.assertNever)("ConsistentAnonymizer.anonymizeToken",e)}}anonymize(e,t,r){const n=o(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),i=[];let a=0;for(let e=0;e<n.length;e+=1){const r=n[e],o=e+1<n.length?n[e+1]:void 0,s=this.anonymizeToken(r,a,t,o);a+=s.chars.length,i.push(s)}return i.map((e=>e.chars)).join("")}constructor(){this.store=new S,this.counter=1}}},5722:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaCollectionPluginDependenciesResolved=t.FormulaCollectionPlugin=void 0,t.deserializeSplitCollectedFormulaLog=function(e){let t=e,r=t.indexOf(",");const n=Number(t.slice(0,r));t=t.slice(r+1),r=t.indexOf(",");return{correlationId:n,logPartId:Number(t.slice(0,r)),partialMessage:t.slice(r+1)}},t.combineSplitCollectedFormulaLogs=function(e){const t=e.sort((e=>e.logPartId)).map((e=>e.partialMessage)).join("");return JSON.parse(t)};const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(391),u=r(5033),l=r(1633),c=r(6471),d=r(9084),m=r(2937),g=r(8795),p=r(6307),h=r(8708),f=r(9615);function S(e){a.ulsLogger.ULS.traceTag(537962337,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,e)}const v=h.PluginRegistry.create(l.PluginFactoryName.FormulaCollectionPlugin,l.PluginGroup.Excel);let y=(()=>{let e,t,r,m=[v.x10Plugin()],g=[],h=[];var f=t=class{getEditEntry(e,t){const r={content:e,cell:t};if(void 0===this.lastEdit||!(0,a.isSheetGridCellEqual)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r}anonymizeSheetId(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);const t=(0,u.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t}*run(e){const t=yield{kind:p.ComputationRequestKind.GetActiveCell};if(t.kind!==p.ComputationRequestKind.GetActiveCell)return S(k.GetActiveCell),null;const r=t.activeCell;if(null==e.content)return S(k.EmptyContent),null;if(!e.content.trimLeft().startsWith("="))return null;const n=this.getEditEntry(e.content,r);if(void 0===n)return null;const u=yield{kind:p.ComputationRequestKind.GetConfig};if(u.kind!==p.ComputationRequestKind.GetConfig)return S(k.GetConfig),null;const l=u.config,c=(0,s.createAnalyzeGlobals)(l),d=(0,a.lexicalSourceCell)(n.cell),m=(0,s.analyzeLocalsGrid)(d.kind,d.range),g=(0,s.createAnalyzer)(c),h=this.consistentAnonymizer.anonymize(n.content,l,r.range),v=yield{kind:p.ComputationRequestKind.ParseEdit,cell:n.cell,formulaBarText:h};if(v.kind!==p.ComputationRequestKind.ParseEdit||!(0,i.isSuccess)(v.result))return S(k.ParseEdit),null;if(v.result.value.kind!==o.EditKind.Formula)return null;const y=v.result.value.formula,F=y.isWellFormed;let E;if(!F){const e=g.checkFormulaWithDiagnostics(m,y);if((0,i.isSuccess)(e)){const t=e?.value[1];void 0!==t&&(E=function(e,t){const r={},n={};return Object.keys(e).forEach((i=>{const a=Number(i),o=e[a];void 0!==o&&(r[i]=o);const s=t.spans[a];void 0!==s&&(n[i]=s)})),{spanDiagnostics:r,spans:n}}(t,y))}}const A=yield{kind:p.ComputationRequestKind.GetCorrelationId};if("GetCorrelationId"!==A.kind)return null;const T=A.correlationId;return function(e){const t=function(e){let t=JSON.stringify(e),r=0;const n=[];for(;t.length>0;){const[i,a]=C(t,r,e.i);t=a,r+=1,n.push(i)}return n}(e);for(const e of t){const t=b(e);a.ulsLogger.ULS.dnmTraceTag(537962336,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}({v:f.formulaCollectionVersion,f:h,ok:F,d:E,c:{s:this.anonymizeSheetId(n.cell.sheet.index),c:n.cell.range.col,r:n.cell.range.row},i:T}),null}constructor(){this.lastEdit=n.__runInitializers(this,h),this.lastEdit=void 0,this.consistentAnonymizer=new c.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}};return n.__setFunctionName(t,"FormulaCollectionPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[v.uiMessageHandler({kind:d.RequestKind.functionSuggestion})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,h),n.__esDecorate(null,e={value:t},m,{kind:"class",name:t.name,metadata:i},null,g),f=t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=v.injectPluginFactory(),t.factoryName=l.PluginFactoryName.FormulaCollectionPlugin,t.formulaCollectionVersion=1,n.__runInitializers(t,g),f=t})();t.FormulaCollectionPlugin=y;const F=2300;function b(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function C(e,t,r){const n=r.toString().length+t.toString().length+2,i=F-n;return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,i)},e.slice(i)]}var k;!function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(k||(k={})),(0,m.registerPluginFactory)(y.factory),t.formulaCollectionPluginDependenciesResolved=(0,f.trackableAsyncLazy)((async()=>{const e=await g.workerThreadSpread.getValue();await e.createAndAttachPlugin(l.PluginFactoryName.FormulaCollectionPlugin),await g.schedulerWithRecalcServiceAttached.getValue()}),"formulaCollectionPluginDependenciesResolved")},5706:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coloredReferencesPluginDependenciesResolved=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(5499),l=r(6700),c=r(9084),d=r(2937),m=r(8795),g=r(6307),p=r(8708),h=r(9615),f=r(8429),S=p.PluginRegistry.create(s.PluginFactoryName.ColoredReferencesPlugin,s.PluginGroup.Excel);let v=(()=>{let e,t,r,d=[S.x10Plugin()],m=[],p=[];return t=class{*run(e){const t=e.content,r=yield{kind:g.ComputationRequestKind.ParseActiveCell,formulaText:t};if(r.kind!==g.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(r.result))return null;if(r.result.value.kind!==o.EditKind.Formula)return null;const n=yield{kind:g.ComputationRequestKind.GetActiveCell};if(n.kind!==g.ComputationRequestKind.GetActiveCell)return y("failed to get active cell"),null;let l;const c=yield{kind:g.ComputationRequestKind.GetSheetNames};let d;c.kind===g.ComputationRequestKind.GetSheetNames?l=c:y("failed to get sheet names");const m=yield{kind:g.ComputationRequestKind.GetDefinedNamesInfo};m.kind===g.ComputationRequestKind.GetDefinedNamesInfo?d=m.definedNamesInfo:y("failed to get defined names");const p=n.activeCell,{formula:h}=r.result.value,S=new u.ColoredReferencesVisitor(p,h,t,l,d);(0,a.reduceBottomUp)(S,h);let v=S.formulaHighlights;if(0!==S.structRefNodes.length){const e={originGridCell:(0,i.success)(p.range),originSheet:(0,i.success)(p.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},t=yield{kind:g.ComputationRequestKind.ResolveReferences,nodes:S.structRefNodes,locals:e};t.kind===g.ComputationRequestKind.ResolveReferences?v=v.concat(function(e,t,r){const n=[];return r.forEach((r=>{const o=e.spans[r.node.label];if(!o)return void y("failed to resolve StructRef, formulaSpan null");if(!(0,i.isSuccess)(r.resolution))return void y(`failed to resolve StructRef, reason: ${r.resolution?.reason.kind}`);if(void 0===r.resolution.value)return void y("failed to resolve StructRef, resolution value undefined");const u=r.resolution.value,l=(0,a.sheetRangeToSheetIndex)(u.sheet);if(!(0,i.isDefined)(l)||!(0,a.isSheetIndexEqual)(l,t.sheet))return;const c=(0,f.gridRangeToRange)(u.range),d={kind:s.HighlightKind.StructRef,span:o,rangeInfo:{range:c}};n.push(d)})),n}(h,p,t.resolverResults)):y("failed to resolve node references")}return{formulaHighlights:v}}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"ColoredReferencesPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[S.uiMessageHandler({kind:c.RequestKind.formulaHighlighting,modifiers:{executionType:l.ExecutionType.Sync}})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,p),n.__esDecorate(null,e={value:t},d,{kind:"class",name:t.name,metadata:i},null,m),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=S.injectPluginFactory(),n.__runInitializers(t,m),t})();function y(e){a.ulsLogger.ULS.traceTag(525133647,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`ColoredReferencesPlugin encountered a failure with msg ${e}`)}(0,d.registerPluginFactory)(v.factory),t.coloredReferencesPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await m.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.ColoredReferencesPlugin),await m.schedulerWithRecalcServiceAttached.getValue()}),"coloredReferencesPluginDependenciesResolved")},5499:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColoredReferencesVisitor=void 0;const n=r(6913),i=r(6592),a=r(1633),o=r(8723),s=r(6398),u=r(8429);class l extends i.IdentityVisitor{structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.structRefNodes.push(n),n}nameNode(e,t,r){const o=super.nameNode(e,t,r);if(!this.isRefInActiveSheet(t))return o;if(o.parts.kind===i.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(o.parts.lhs),o;if(!(0,n.isDefined)(this.namedObjectsMap))return o;const s=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());return void 0!==s&&s.type!==a.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(r,s),o}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(!(0,s.isValidCellRef)(e)||!this.isRefInActiveSheet(t))return n;const o=this.parsedFormulaTree.spans[r];if(o){const t=this.createRangeInfoFromCellRef(e),r=this.formulaSpanToHighlightingSpan(o,i.NodeKind.CellRef);this.formulaHighlights.push(c(a.HighlightKind.CellRef,r,t))}return n}get namedObjectsMap(){return(0,n.isDefined)(this._namedObjectsMap)||(0,n.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,s.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap}createAndAppendNamedRefHighlight(e,t){const r=this.parsedFormulaTree.spans[e];if(!(0,n.isDefined)(r)||!(0,n.isDefined)(this.sheetNames))return;const u=t.sheetName;if(!(0,n.isDefined)(u))return void d(`createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ${t.type}`);const l=(0,s.getSheetIndexFromSheetName)(u,this.sheetNames);if(!(0,n.isDefined)(l))return void d(`createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ${t.type}`);if(!(0,i.isSheetIndexEqual)(l,this.activeCell.sheet))return;const m=(0,o.getRangeFromDefinedName)(t);void 0!==m&&this.formulaHighlights.push(c(a.HighlightKind.NamedRange,r,{range:m}))}createAndAppendFieldRefHighlight(e){switch(e.kind){case i.NamePartKind.CellRefNamePart:this.createAndAppendCellRefPartHighlight(e);break;case i.NamePartKind.IdentNamePart:{if(!(0,n.isDefined)(this.namedObjectsMap))return;const t=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());void 0!==t&&t.type!==a.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(e.label,t);break}case i.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(e.lhs)}}createAndAppendCellRefPartHighlight(e){const t=this.parsedFormulaTree.spans[e.label];if(!(0,n.isDefined)(t))return;const r=this.createRangeInfoFromCellRef(e.ref),o=this.formulaSpanToHighlightingSpan(t,i.NodeKind.CellRef),s=c(a.HighlightKind.CellRef,o,r);this.formulaHighlights.push(s)}formulaSpanToHighlightingSpan(e,t){const r={...e};var n,a;return t===i.NodeKind.CellRef&&(n=e,(a=this.formulaString).length>n.end&&a.charAt(n.end)===i.operatorStrings[i.OperatorId.Pound]&&(r.end+=1)),r}createRangeInfoFromCellRef(e){return{range:(0,s.getRangeFromCellRef)(e,this.activeCell.range,d),positionKindInfo:(0,u.getPositionKindInfoFromCellRef)(e)}}isRefInActiveSheet(e){if(!(0,n.isDefined)(e))return!0;if(!(0,n.isDefined)(this.sheetNames))return!1;const t=(0,s.getSheetIndexFromQualifier)(e,this.sheetNames,this.failureCallback);return(0,n.isDefined)(t)?(0,i.isSheetIndexEqual)(t,this.activeCell.sheet):(this.failureCallback?.("CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)}constructor(e,t,r,n,i,a){super(),this.activeCell=e,this.parsedFormulaTree=t,this.formulaString=r,this.sheetNames=n,this.definedNameInfoList=i,this.failureCallback=a,this.structRefNodes=[],this.formulaHighlights=[],this.activeCellSheetName=void 0,this._namedObjectsMap=void 0}}function c(e,t,r){return{kind:e,span:t,rangeInfo:r}}function d(e){i.ulsLogger.ULS.traceTag(520935561,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`ColoredReferencesVisitor encountered a failure with msg ${e}`)}t.ColoredReferencesVisitor=l},7146:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenthesesCouplingPluginDependenciesResolved=t.ParenthesesCouplingPlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(4171),l=r(6700),c=r(9084),d=r(2937),m=r(8795),g=r(6307),p=r(8708),h=r(9615),f=p.PluginRegistry.create(s.PluginFactoryName.ParenthesesCouplingPlugin,s.PluginGroup.Excel);let S=(()=>{let e,t,r,d=[f.x10Plugin()],m=[],p=[];return t=class{*run(e){if(null!=e.selectionLength&&e.selectionLength>0)return null;const t=yield{kind:g.ComputationRequestKind.ParseActiveCell,formulaText:e.content};if(t.kind!==g.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;const{formula:r}=t.result.value,n=new u.ParenthesesCouplingVisitor(r,e.caretPosition);return(0,a.reduceBottomUp)(n,r),(0,i.isDefined)(n.parenthesesSpan)?this.getParenthesesHighlights(n.parenthesesSpan):{formulaHighlights:void 0}}getParenthesesHighlights(e){const t=e.start,r=e.end,n={kind:s.HighlightKind.Parentheses,span:{start:t,end:t+1}};return{formulaHighlights:[{kind:s.HighlightKind.Parentheses,span:{start:r,end:r+1}},n]}}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"ParenthesesCouplingPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[f.uiMessageHandler({kind:c.RequestKind.formulaHighlighting,modifiers:{executionType:l.ExecutionType.Sync}}),f.uiMessageHandler({kind:c.RequestKind.formulaHighlighting,modifiers:{executionType:l.ExecutionType.Async}})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,p),n.__esDecorate(null,e={value:t},d,{kind:"class",name:t.name,metadata:i},null,m),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=f.injectPluginFactory(),n.__runInitializers(t,m),t})();t.ParenthesesCouplingPlugin=S,(0,d.registerPluginFactory)(S.factory),t.parenthesesCouplingPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await m.dynamicPluginLoaderCreated.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.ParenthesesCouplingPlugin),await m.schedulerWithRecalcServiceAttached.getValue()}),"parenthesesCouplingPluginDependenciesResolved")},4171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParenthesesCouplingVisitor=void 0;const n=r(6592);class i extends n.IdentityVisitor{appNode(e,t,r,i){return e.kind!==n.NodeKind.Operator&&this.matchFormula(e,r,i),super.appNode(e,t,r,i)}parenNode(e,t,r){const n=this.formula.spans[r];return t&&n&&this.matchParentheses(n.start,n.end-1),super.parenNode(e,t,r)}letNode(e,t,r,n,i,a){return this.matchFormula(e,i,a),super.letNode(e,t,r,n,i,a)}lambdaNode(e,t,r,n,i,a){return this.matchFormula(e,i,a),super.lambdaNode(e,t,r,n,i,a)}matchFormula(e,t,r){const n=this.formula.spans[r],i=this.formula.spans[e.label];t&&n&&i&&this.matchParentheses(i.end,n.end-1)}matchParentheses(e,t){e===this.caretPosition&&(this.checkRight=!0),t===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(e,t,this.caretPosition+1)||this.shouldUpdateLocation(e,t,this.caretPosition)?(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(e,t,this.caretPosition-1)&&(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!0)}shouldUpdateLocation(e,t,r){return e<r&&r<=t&&(void 0===this.parenthesesSpan||this.areParenthesesLeftOfCaret&&e<=this.parenthesesSpan.start||e>this.parenthesesSpan.start)}constructor(e,t){super(),this.formula=e,this.caretPosition=t,this.parenthesesSpan=void 0,this.checkLeft=!1,this.checkRight=!1,this.areParenthesesLeftOfCaret=!1}}t.ParenthesesCouplingVisitor=i},8429:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gridRangeToRange=function(e){const t=e.row,r=e.col;return{firstRow:t,firstColumn:r,lastRow:t+e.rows-1,lastColumn:r+e.cols-1}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0},t.getPositionKindInfoFromCellRef=function(e){switch(e.kind){case n.CellRefKind.Col:return function(e){return{firstRow:i.PositionKind.Relative,firstColumn:a[e.col1.kind],secondRow:i.PositionKind.Relative,secondColumn:a[e.col2.kind]}}(e);case n.CellRefKind.Row:return function(e){return{firstRow:a[e.row1.kind],firstColumn:i.PositionKind.Relative,secondRow:a[e.row2.kind],secondColumn:i.PositionKind.Relative}}(e);case n.CellRefKind.Single:return function(e){let t,r;return{firstRow:t=a[e.row.kind],firstColumn:r=a[e.col.kind],secondRow:t,secondColumn:r}}(e);case n.CellRefKind.Range:return function(e){return{firstRow:a[e.ref1.row.kind],firstColumn:a[e.ref1.col.kind],secondRow:a[e.ref2.row.kind],secondColumn:a[e.ref2.col.kind]}}(e)}};const n=r(6592),i=r(1633),a={Abs:i.PositionKind.Absolute,Rel:i.PositionKind.Relative}},1210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gotoCtrlClickPluginDependenciesResolved=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(1633),u=r(8475),l=r(9084),c=r(2937),d=r(8795),m=r(6307),g=r(8723),p=r(8708),h=r(9615),f=p.PluginRegistry.create(s.PluginFactoryName.GotoCtrlClickPlugin,s.PluginGroup.Excel);let S=(()=>{let e,t,r,c=[f.x10Plugin()],d=[],p=[];return t=class{*run({text:e,index:t}){const r=e;if(t<0||t>=r.length)return v("caret out of formula scope"),{kind:s.GotoCtrlClickResultKind.NoReferenceFound};const n=yield{kind:m.ComputationRequestKind.ParseActiveCell,formulaText:r};if(n.kind!==m.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(n.result))return v("failed to parse active cell"),{kind:s.GotoCtrlClickResultKind.Failure};if(n.result.value.kind!==o.EditKind.Formula)return v("Not a formula cell"),{kind:s.GotoCtrlClickResultKind.NotAFormula};const l=yield{kind:m.ComputationRequestKind.GetActiveCell};if(l.kind!==m.ComputationRequestKind.GetActiveCell)return v("failed to get active cell"),null;let c;const d=yield{kind:m.ComputationRequestKind.GetDefinedNamesInfo};d.kind===m.ComputationRequestKind.GetDefinedNamesInfo?c=d.definedNamesInfo:v("failed to get defined names");const p=l.activeCell,{formula:h}=n.result.value,f=new u.GotoCtrlClickVisitor(h,p.range,c,t);if((0,a.reduceBottomUp)(f,h),!f.referenceFound)return{kind:s.GotoCtrlClickResultKind.NoReferenceFound};let S=f.sheetRange;if((0,i.isDefined)(f.structRefNodeToResolve)){let e;const t=yield{kind:m.ComputationRequestKind.GetSheetNames};if(t.kind!==m.ComputationRequestKind.GetSheetNames)return v("failed to get sheet names"),{kind:s.GotoCtrlClickResultKind.RangeResolutionFailure,span:f.span};e=t;const r=yield{kind:m.ComputationRequestKind.ResolveReferences,nodes:[f.structRefNodeToResolve],locals:{originGridCell:(0,i.success)(p.range),originSheet:(0,i.success)(p.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}};r.kind===m.ComputationRequestKind.ResolveReferences?S=(0,g.getSheetRangeFromResolvedRef)(e,r.resolverResults[0],v):v("failed to resolve node references")}return(0,i.isDefined)(S)?{kind:s.GotoCtrlClickResultKind.ReferenceFound,sheetRange:S,span:f.span}:{kind:s.GotoCtrlClickResultKind.RangeResolutionFailure,span:f.span}}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"GotoCtrlClickPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[f.uiMessageHandler({kind:l.RequestKind.gotoCtrlClick})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,p),n.__esDecorate(null,e={value:t},c,{kind:"class",name:t.name,metadata:i},null,d),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=f.injectPluginFactory(),n.__runInitializers(t,d),t})();function v(e){a.ulsLogger.ULS.traceTag(508687389,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,`GotoCtrlClickPlugin encountered a failure with msg ${e}`)}(0,c.registerPluginFactory)(S.factory),t.gotoCtrlClickPluginDependenciesResolved=(0,h.trackableAsyncLazy)((async()=>{const e=await d.workerThreadSpread.getValue();await e.createAndAttachPlugin(s.PluginFactoryName.GotoCtrlClickPlugin),await d.schedulerWithRecalcServiceAttached.getValue()}),"gotoCtrlClickPluginDependenciesResolved")},8475:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GotoCtrlClickVisitor=void 0;const n=r(6913),i=r(6592),a=r(1633),o=r(8723),s=r(6398);class u extends i.IdentityVisitor{get namedObjectsMap(){return(0,n.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:(0,n.isDefined)(this.definedNameInfoList)?(this._namedObjectsMap=(0,s.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap):void l("namedObjectsMap: was called but definedNameInfoList is undefined")}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);if(this.referenceFound)return n;const i=this.parsedFormulaTree.spans[r];return(0,s.caretInSpanScope)(this.caretPosition,i)&&(this.referenceFound=!0,this.span=i,this.structRefNodeToResolve=n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);if(this.referenceFound)return n;const i=this.parsedFormulaTree.spans[r];return(0,s.caretInSpanScope)(this.caretPosition,i)&&(this.referenceFound=!0,this.span=i,this.sheetRange=(0,o.sheetRangeFromCellRef)(e,t,this.activeCell,l)),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);if(this.referenceFound)return n;const u=this.parsedFormulaTree.spans[r];if(!(0,s.caretInSpanScope)(this.caretPosition,u))return n;if(n.parts.kind===i.NamePartKind.FieldRefNamePart)this.tryFindFieldRefGotoReference(n.parts,t);else{const r=this.namedObjectsMap?.get(e.asWhole.toLocaleLowerCase());void 0!==r&&r.type!==a.DefinedNameInfoType.Invalid&&(this.referenceFound=!0,this.span=u,this.sheetRange=(0,o.getSheetRangeFromDefinedNameInfo)(r,t))}return n}tryFindFieldRefGotoReference(e,t){const r=(0,s.findFieldRefSourceLhs)(e);switch(r.kind){case i.NamePartKind.CellRefNamePart:{const e=this.parsedFormulaTree.spans[r.label];return void((0,s.caretInSpanScope)(this.caretPosition,e)&&(this.referenceFound=!0,this.span=e,this.sheetRange=(0,o.sheetRangeFromCellRef)(r.ref,void 0,this.activeCell,l)))}case i.NamePartKind.IdentNamePart:{const e=this.parsedFormulaTree.spans[r.label];if((0,n.isDefined)(this.namedObjectsMap)&&(0,s.caretInSpanScope)(this.caretPosition,e)){this.referenceFound=!0,this.span=e;const i=(0,s.getNamePartIfExists)(r,this.namedObjectsMap);if(!(0,n.isDefined)(i))return;this.sheetRange=(0,o.getSheetRangeFromDefinedNameInfo)(i,t)}return}default:l("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.activeCell=t,this.definedNameInfoList=r,this.caretPosition=n,this.structRefNodeToResolve=void 0,this.span=void 0,this.sheetRange=void 0,this.referenceFound=!1,this._namedObjectsMap=void 0}}function l(e){i.ulsLogger.ULS.traceTag(508687388,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`GotoCtrlClickVisitor encountered a failure with msg ${e}`)}t.GotoCtrlClickVisitor=u},3688:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationFinalizer=void 0;const n=r(6913),i=r(6592),a=r(8824),o=r(6307),s=r(1529),u=r(4691);t.ComputationFinalizer=class{subscribe(e){if(!this.isClosed)return this.subject.subscribe(e);u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"PluginFinalizer.subscribe",description:"subscription for a closed finalizer was requested"}})}finalize(e,t){const r=this.extractComputationInfo(e);t===o.ExecutionStopReason.Unknown&&u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalize was invoked with an unknown stop reason",data:r}}),this.isClosed?u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalizer was invoked more than once",data:{stopReason:t,...r}}}):(this.isClosed=!0,this.finalizeComputationGeneratorExecution(e,t),this.subject.next({computationInfo:r,stopReason:t}))}finalizeComputationGeneratorExecution(e,t){switch(t){case o.ExecutionStopReason.Unknown:case o.ExecutionStopReason.Frame.Timeout:case o.ExecutionStopReason.Frame.Superseded:case o.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:let r=!1;try{e.generator.throw(new s.X10ExceptionComputationTermination(t))}catch(n){r=!0,n instanceof s.X10ExceptionComputationTermination&&n.stopReason&&n?.stopReason!==t&&i.ulsLogger.ULS.traceTag(508903693,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,u.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:e.info}))}finally{r||u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"ComputationFinalizer.finalizeComputationGeneratorExecution",description:"computation terminated by x10 with exception but did not threw the exception back",data:e.info}})}break;case o.ExecutionStopReason.Computation.Done:case o.ExecutionStopReason.Computation.Skipped:case o.ExecutionStopReason.Computation.Exception:break;default:(0,n.assertNever)("Unknown stopReason",t)}}extractComputationInfo(e){const t=e.info;t.totalRuntime=e.info.computationTime;for(const r in e.info.requestTimes)t.totalRuntime+=e.info.requestTimes[r]?.requestDuration??0;return t}constructor(...e){this.subject=new a.Subject,this.isClosed=!1;for(const t of e)this.subscribe(t)}}},8723:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeFromDefinedName=u,t.getSheetRangeFromDefinedNameInfo=function(e,t){const r=u(e);if(!(0,n.isDefined)(r))return;const i=(0,n.isDefined)(e.sheetName)?e.sheetName:t?(0,o.getSheetNameFromQualifier)(t):"";return{...r,sheetName:i,namedObjectName:(0,n.isDefined)(e.name)?e.name:""}},t.sheetRangeFromCellRef=function(e,t,r,i){const a=(0,o.getRangeFromCellRef)(e,r,i);if((0,n.isDefined)(a))return{...a,sheetName:t?(0,o.getSheetNameFromQualifier)(t):"",namedObjectName:""}},t.getSheetRangeFromResolvedRef=function(e,t,r){if(!(0,n.isSuccess)(t.resolution))return void r?.(`failed to resolve StructRef, reason: ${t.resolution.reason}`);if(void 0===t.resolution.value)return void r?.("failed to resolve StructRef, resolution value undefined");const i=t.resolution.value,a=(0,o.sheetIndexToSheetName)(i.sheet,e)??"";return{...(0,s.gridRangeToRange)(i.range),sheetName:a,namedObjectName:t.node.lhs?t.node.lhs.whole:""}},t.toSharedSheetRange=function(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}},t.rangeToGridRange=function(e){const t=e.firstRow,r=e.firstColumn;return(0,i.gridRange)(t,r,e.lastRow-t+1,e.lastColumn-r+1)},t.getSheetGridCellFromRangeObject=function(e,t){return(0,i.sheetGridCell)(t,{row:e.firstRow,col:e.firstColumn,rows:1,cols:1})},t.rangesIntersects=l,t.gridRangesIntersects=c,t.uniteIntersectingGridRanges=function(e,t){return c(e,t)?(0,i.gridRange)((0,n.fastMin)(e.row,t.row),(0,n.fastMin)(e.col,t.col),(0,n.fastMax)(e.row+e.rows,t.row+t.rows)-(0,n.fastMin)(e.row,t.row),(0,n.fastMax)(e.col+e.cols,t.col+t.cols)-(0,n.fastMin)(e.col,t.col)):null},t.uniteIntersectingRangeObjects=function(e,t){return l(e,t)?{firstRow:(0,n.fastMin)(e.firstRow,t.firstRow),firstColumn:(0,n.fastMin)(e.firstColumn,t.firstColumn),lastRow:(0,n.fastMax)(e.lastRow,t.lastRow),lastColumn:(0,n.fastMax)(e.lastColumn,t.lastColumn)}:null},t.areSheetGridCellsSame=function(e,t){return e.sheet.index===t.sheet.index&&e.range.row===t.range.row&&e.range.col===t.range.col};const n=r(6913),i=r(6592),a=r(1633),o=r(6398),s=r(8429);function u(e){const t=e.namedRange;if(null==t||e.type===a.DefinedNameInfoType.Invalid)return;const r=e.type===a.DefinedNameInfoType.Table?1:0;return t.bottom&&t.top&&t.right&&t.left?{firstRow:t.top+r-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1}:void 0}function l(e,t){return(0,n.fastMin)(e.lastColumn,t.lastColumn)>=(0,n.fastMax)(e.firstColumn,t.firstColumn)&&(0,n.fastMin)(e.lastRow,t.lastRow)>=(0,n.fastMax)(e.firstRow,t.firstRow)}function c(e,t){return(0,n.fastMin)(e.col+e.cols-1,t.col+t.cols-1)>=(0,n.fastMax)(e.col,t.col)&&(0,n.fastMin)(e.row+e.rows-1,t.row+t.rows-1)>=(0,n.fastMax)(e.row,t.row)}},8824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TaskInternal=t.Ref=t.InitializingSubject=t.Subject=void 0;const n=r(5033),i=r(4691);class a{next(e){for(const[t,r]of this.subscribers)r(e)}subscribe(e){return this.subscribers.push([++this.currentSubscription,e]),this.currentSubscription}unsubscribe(e){this.subscribers=this.subscribers.filter((([t,r])=>t!==e))}constructor(){this.subscribers=[],this.currentSubscription=0}}t.Subject=a,t.InitializingSubject=class extends a{subscribe(e){const t=super.subscribe(e);return this.initializeSubscriber().map(e),t}constructor(e){super(),this.initializeSubscriber=e}},t.Ref=class{constructor(e){this.value=e}},t.X10TaskInternal=class{static createToken(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"}resolve(e){return e!==this.token&&i.x10Logger.log({kind:"failure",payload:{failureKind:i.X10FailureKind.AssertionFailure,failureLevel:n.TraceLevel.Warning,path:"X10TaskInternal.resolve",description:"Task is resolving with an invalid token"}}),this.maybeThenable}constructor(e,t){this.maybeThenable=e,this.token=t}}},6398:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidCellRef=function(e){return e.kind!==i.CellRefKind.Bad&&e.kind!==i.CellRefKind.Error},t.getSheetIndexFromSheetName=s,t.getSheetIndexFromQualifier=function(e,t,r){return s(u(e,r),t)},t.getSheetNameFromQualifier=u,t.getRangeFromCellRef=function(e,t,r){switch(e.kind){case i.CellRefKind.Single:{const r=l(e.row,t.row),n=l(e.col,t.col);return{firstRow:r,firstColumn:n,lastRow:r,lastColumn:n}}case i.CellRefKind.Range:return{firstRow:l(e.ref1.row,t.row),firstColumn:l(e.ref1.col,t.col),lastRow:l(e.ref2.row,t.row),lastColumn:l(e.ref2.col,t.col)};case i.CellRefKind.Col:return{firstRow:0,firstColumn:l(e.col1,t.col),lastRow:o.MaxRow,lastColumn:l(e.col2,t.col)};case i.CellRefKind.Row:return{firstRow:l(e.row1,t.row),firstColumn:0,lastRow:l(e.row2,t.row),lastColumn:o.MaxColumn};default:(0,n.isDefined)(r)&&r(`getRangeFromCellRef unexpected CellRefKind: ${e.kind}`)}},t.createNameToDefinedNameInfoMapping=function(e){const t=new Map;return e.forEach((e=>{(0,n.isDefined)(e.name)&&t.set(e.name.toLocaleLowerCase(),e)})),t},t.getNamePartIfExists=function(e,t){const r=t.get(e.asWhole.toLocaleLowerCase());if(void 0!==r&&r.type!==a.DefinedNameInfoType.Invalid)return r},t.getAbsolutePosition=l,t.sheetIndexToSheetName=function(e,t){const r=t.sheets.findIndex((t=>(0,i.isSheetIndexEqual)(t.sheetIndex,e)));if(-1!==r)return t.sheets[r].sheetName},t.caretInSpanScope=function(e,t){return(0,n.isDefined)(t)&&e.valueOf()>=t.start&&e.valueOf()<t.end},t.findFieldRefSourceLhs=function e(t){switch(t.kind){case i.NamePartKind.CellRefNamePart:case i.NamePartKind.IdentNamePart:return t;case i.NamePartKind.FieldRefNamePart:return e(t.lhs)}};const n=r(6913),i=r(6592),a=r(1633);class o{}function s(e,t){const r=t.nameToIndex.getValue(e);if((0,n.isDefined)(r))return t.sheets[r].sheetIndex}function u(e,t){return e.kind===i.QualifierKind.Sheet?e.sheet:e.kind===i.QualifierKind.Ident?e.name:((0,n.isDefined)(t)&&t(`getSheetNameFromQualifier unexpected qualifier kind: ${e.kind}`),"")}function l(e,t){return e.index+(e.kind===i.PosKind.Rel?t:0)}o.MaxRow=1048575,o.MaxColumn=16383},8708:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;var n=r(9486);Object.defineProperty(t,"PluginRegistry",{enumerable:!0,get:function(){return n.PluginRegistry}})},9486:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;const n=r(6913),i=r(3747),a=r(326),o=r(6700);class s{static creator(){return(e,t)=>new s(e,t)}static get create(){return s.creator()}x10Plugin(e){return(t,r)=>{const o=String(r.name),s={factoryName:this.factoryName,pluginName:o,pluginGroup:this.pluginGroup,create:r=>new t(...e?e(r):[])};(0,n.assertTrue)(`Registry object cannot be used on '${s.pluginName}' class. 'x10Plugin' decorator must be called only once on plugin class`,void 0===this.factory),this.factory=s,(0,a.deletePluginRegistration)({factoryName:this.factoryName,pluginName:o});for(const e of this.registeredUIHandlers)(0,a.registerComputation)(i.ComputationType.UIMessage,e.kind,e.executionType,this.pluginGroup,{factoryName:this.factoryName,pluginName:o,computationName:e.name,executionType:e.executionType},e.modifiers,e.computationGenerator,e.predicate);for(const e of this.registeredEventHandlers)(0,a.registerComputation)(i.ComputationType.Event,e.kind,e.executionType,this.pluginGroup,{factoryName:this.factoryName,pluginName:o,computationName:e.name,executionType:e.executionType},e.modifiers,e.computationGenerator,e.predicate)}}uiMessageHandler(e){return(t,r)=>{this.registeredUIHandlers.push({type:i.ComputationType.UIMessage,kind:e.kind,name:String(r.name),executionType:e.modifiers?.executionType??o.ExecutionType.Async,modifiers:e.modifiers??{},computationGenerator:t,predicate:e.predicate})}}eventHandler(e){return(t,r)=>{this.registeredEventHandlers.push({type:i.ComputationType.Event,kind:e.kind,name:String(r.name),executionType:e.modifiers?.executionType??o.ExecutionType.Async,modifiers:e.modifiers??{},computationGenerator:t,predicate:e.predicate})}}injectPluginFactory(){return(0,n.assertTrue)("Plugin factory not initialized. `x10Plugin` decorator must be called on plugin class",void 0!==this.factory),this.factory}constructor(e,t){this.factoryName=e,this.pluginGroup=t,this.factory=void 0,this.registeredUIHandlers=[],this.registeredEventHandlers=[]}}t.PluginRegistry=s},405:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TableIntelligenceService=void 0;const n=r(6913),i=r(6592),a=r(4691);t.X10TableIntelligenceService=class{async getRecognizedRangeTablesInfo(...e){try{const t=await this.tableIntelligenceProvider.getRecognizedRangeTablesInfo(...e);return(0,n.isDefined)(t)?(0,n.success)(t.filter(n.isDefined)):(0,n.failure)(void 0)}catch(e){return"getRecognizedRangeTablesInfo",t=`failed to get recognized range tables info: ${e}`,a.x10Logger.log({kind:"failure",payload:{failureKind:a.X10FailureKind.TableIntelligenceFailure,failureLevel:i.TraceLevel.Warning,path:"X10TableIntelligenceService.getRecognizedRangeTablesInfo",description:t}}),(0,n.failure)(e)}var t}constructor(e){this.tableIntelligenceProvider=e}}},4563:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyRangeFormat=t.emptyRangeFormula=t.emptyRangeValue=t.FormulaKind=void 0,t.wrapIntoResumeRecalc=function(e,t){return{evalClonedModelOnSnapshot:(r,...n)=>{const i=e.evalClonedModelOnSnapshot(r,...n);return t(r),i},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:(r,...n)=>{const i=e.getRangeFormats(r,...n);return t(r),i},getRangeValues:(r,...n)=>{const i=e.getRangeValues(r,...n);return t(r),i},getRangeFormulae:(r,...n)=>{const i=e.getRangeFormulae(r,...n);return t(r),i},getSheetNames:(r,...n)=>{const i=e.getSheetNames(r,...n);return t(r),i},getIntersectingTables:(r,...n)=>{const i=e.getIntersectingTables(r,...n);return t(r),i},getIformats:(r,...n)=>{const i=e.getIformats(r,...n);return t(r),i},getHiddenRows:(r,...n)=>{const i=e.getHiddenRows(r,...n);return t(r),i},getHiddenCols:(r,...n)=>{const i=e.getHiddenCols(r,...n);return t(r),i},evalFormulaOnSnapshot:(r,...n)=>{const i=e.evalFormulaOnSnapshot(r,...n);return t(r),i},evalFormulaTreeOnSnapshot:(r,...n)=>{const i=e.evalFormulaTreeOnSnapshot(r,...n);return t(r),i},getCorrespondingSnapshotID:t=>e.getCorrespondingSnapshotID(t)}};const n=r(6913),i=r(6592);var a;!function(e){e.Value="Value",e.CellFormula="CellFormula"}(a||(t.FormulaKind=a={})),t.emptyRangeValue=i.blankOper,t.emptyRangeFormula={kind:a.Value,formulaBarText:"",origin:(0,i.gridCell)(0,0)},(0,n.staticAssertExtends)(),t.emptyRangeFormat=0},6410:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0,function(e){e.doNothing="doNothing",e.setActiveCell="setActiveCell",e.setActiveCellFormat="setActiveCellFormat",e.setFunctionsInfo="setFunctionsInfo",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.writeRange="writeRange",e.writeRanges="writeRanges",e.setNumberFormats="setNumberFormats"}(r||(t.NotificationKind=r={}))},8049:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timeline=void 0,t.indexToLSPPosition=s,t.spanToLSPRange=function(e,t,r){return{start:s(e,t),end:s(e,r)}},t.spanCompare=function(e,t){let r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0};const n=r(6913),i=r(5033),a=r(7882),o=r(8402);function s(e,t){let r=0,i=0;for(;i<t;){const a=e.indexOf("\n",i),o=e.indexOf("\r",i),s=a<0?o:o<0?a:(0,n.fastMin)(a,o);if(s<0||s>=t)break;r+=1,i=s+1+(s===o&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-i}}t.Timeline=class{stamp(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())}log(e){if(this.enabled){this.stamp(e);const t={};let r=this.timer.now(),a=0;this.timestamps.forEach(((e,n)=>{r=Math.min(r,e),a=Math.max(a,e),t[n]=e})),a-r>this.logThreshold&&n.ulsLogger.ULS.traceTag(506009360,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Timeline[${this.name}]: ${JSON.stringify({...t,...this.workerInfo})}`),this.timestamps.clear()}}constructor(e,t,r=!0){this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=o.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,a.isWorkerThread)(),workerName:(0,a.workerName)()},n.ulsLogger.ULS.traceTag(506009361,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`Timeline[${this.name}]: Initializing, ${JSON.stringify(this.workerInfo)}`)}}},7229:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logSafeFailure=void 0;const n=r(6913);t.logSafeFailure={failure:e=>({...(0,n.failure)(e),logSafe:!0}),isSafe:e=>!0===e.logSafe,censored:e=>!0===e.logSafe?e:(0,n.failure)(void 0)}},6646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuePreviewPluginDependenciesResolved=t.ValuePreviewPlugin=void 0;const n=r(6533),i=r(6913),a=r(6592),o=r(1159),s=r(5033),u=r(1633),l=r(9702),c=r(9767),d=r(9204),m=r(9084),g=r(2937),p=r(8795),h=r(6307),f=r(8708),S=r(9615),v=r(4563),y=f.PluginRegistry.create(u.PluginFactoryName.ValuePreviewPlugin,u.PluginGroup.Excel);let F=(()=>{let e,t,r,u=[y.x10Plugin()],g=[],p=[];return t=class{*run({text:e,index:t,length:r,activeCell:n}){if((0,i.isNone)(e)||(0,i.isNone)(t)||(0,i.isNone)(r))return b("missing request arguments"),null;if(t<0||t+r>e.length)return b(`invalid selection, ${e.length}, ${t}, ${r}`),null;const u=yield{kind:h.ComputationRequestKind.GetActiveCell};if(u.kind!==h.ComputationRequestKind.GetActiveCell)return{kind:"Failure",index:t,length:r,reason:"GetActiveCell failed"};let m,g=u.activeCell;if((0,i.isNone)(n)||(0,i.isNone)(n.sheetName)||function(e,t){const r=[];return e.sheet.index!==t.sheetName&&r.push("sheet"),e.range.col!==t.firstColumn&&r.push("col"),e.range.row!==t.firstRow&&r.push("row"),r.length>0&&i.ulsLogger.ULS.traceTag(507777486,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,`ValuePreviewPlugin.areCellsEqual - active cell diff: ${r.join(",")}`),0===r.length}(g,n)){const t=yield{kind:h.ComputationRequestKind.ParseActiveCell,formulaText:e};if(t.kind!==h.ComputationRequestKind.ParseActiveCell||!(0,i.isSuccess)(t.result))return null;if(t.result.value.kind!==o.EditKind.Formula)return null;m=t.result.value.formula}else{const t=(0,a.unsafeGridRange)(n.firstRow,n.firstColumn,1,1);g=(0,a.sheetGridCell)((0,a.sheetIndex)(g.sheet.document,n.sheetName),t);const r=yield{kind:h.ComputationRequestKind.ParseCellFormula,cell:g,formula:{formulaBarText:e,kind:v.FormulaKind.CellFormula},useEnglishLocaleInfo:!1};if(r.kind!==h.ComputationRequestKind.ParseCellFormula||!(0,i.isSuccess)(r.result))return null;m=r.result.value}const p=function(e,t,r,n){let o;o=0===t?{start:1,end:r>0?r:e.length}:{start:t,end:t+r};const s=new c.ValuePreviewVisitor(n,o.start,o.end,e);let u;if((0,a.reduceBottomUp)(s,n),u=0===r?{start:0===t?t:s.subFormulaStart,end:s.subFormulaEnd}:{start:t,end:t+r},-1===u.start||u.end===u.start||s.isBadSelection||r>0&&!function(e,t){const r=0===t.start||Object.keys(e.spans).some((r=>e.spans[Number(r)]?.start===t.start)),n=Object.keys(e.spans).some((r=>e.spans[Number(r)]?.end===t.end));return r&&n}(n,u))return(0,i.failure)("invalid selection");const l=e.substring(u.start,u.end);return(0,i.success)({subFormula:l,subFormulaSpan:u,isVolatile:s.isVolatile,hasCrossWorkbookRef:s.hasCrossWorkbookRef,letDefinitions:s.letDefinitions})}(e,t,r,m);if("Success"!==p.kind)return null;let{subFormula:f}=p.value;const{subFormulaSpan:S,isVolatile:y,letDefinitions:F,hasCrossWorkbookRef:C}=p.value,k={index:S.start,length:S.end-S.start},E=yield{kind:h.ComputationRequestKind.GetConfig};if(E.kind!==h.ComputationRequestKind.GetConfig)return{kind:"Failure",...k,reason:"GetConfig failed"};(0,i.isDefined)(F)&&(f=F+E.config.localeInfo.listSeparator+f+")");const A=(f.startsWith("=")?"":"=")+f;if("="===A)return{kind:"Failure",...k,reason:"Empty formula"};if(C)return{kind:"Failure",evaluatedFormula:A,...k,reason:"Cross workbook reference"};const T=yield{kind:h.ComputationRequestKind.GetActiveCellFormat};if(T.kind!==h.ComputationRequestKind.GetActiveCellFormat)return b("GetActiveCellFormat failed"),{kind:"Unavailable",evaluatedFormula:A,...k,isVolatile:y,reason:"GetActiveCellFormat failed"};if(!(0,i.isSuccess)(T.result)||(0,i.isNone)(T.result.value))return b("Empty cell format"),{kind:"Unavailable",evaluatedFormula:A,...k,isVolatile:y,reason:"Empty cell format"};const R={kind:d.SpecialFormat.Edit,renderBlanksAsZeros:!0,isWholeFormula:A===e},N=yield{kind:h.ComputationRequestKind.EvalFormula,formula:A,origin:{sheet:g.sheet,range:{col:g.range.col,row:g.range.row,rows:1,cols:1}},format:R};if(N.kind!==h.ComputationRequestKind.EvalFormula)return{kind:"Failure",evaluatedFormula:A,...k,reason:"EvalFormula failed"};const I=new l.ValuePreviewResultExtractor(E.config).fromEvalFormulaOutput(N.result);switch(I.kind){case"Success":return{...I,evaluatedFormula:A,...k,isVolatile:y};case"Unavailable":return{kind:I.kind,evaluatedFormula:A,...k,isVolatile:y,reason:I.reason};case"Failure":return{kind:I.kind,evaluatedFormula:A,...k,reason:I.reason}}}constructor(){n.__runInitializers(this,p)}},n.__setFunctionName(t,"ValuePreviewPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[y.uiMessageHandler({kind:m.RequestKind.valuePreview})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,p),n.__esDecorate(null,e={value:t},u,{kind:"class",name:t.name,metadata:i},null,g),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=y.injectPluginFactory(),n.__runInitializers(t,g),t})();function b(e){i.ulsLogger.ULS.traceTag(521692767,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,`ValuePreviewPlugin encountered a failure with msg ${e}`)}t.ValuePreviewPlugin=F,(0,g.registerPluginFactory)(F.factory),t.valuePreviewPluginDependenciesResolved=(0,S.trackableAsyncLazy)((async()=>{const e=await p.workerThreadSpread.getValue();await e.createAndAttachPlugin(u.PluginFactoryName.ValuePreviewPlugin),await p.schedulerWithRecalcServiceAttached.getValue()}),"valuePreviewPluginDependenciesResolved")},9702:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewResultExtractor=void 0;const n=r(6913),i=r(6592),a=r(1159),o=r(1475);t.ValuePreviewResultExtractor=class{fromEvalFormulaOutput({value:e,formatted:t}){switch(e.kind){case n.ResultKind.Success:return this.resultFromSuccess(e.value,t);case n.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}}resultFromSuccess(e,t){let r;switch(e.kind){case i.OperKind.String:case i.OperKind.Array:case i.OperKind.Blank:case i.OperKind.Number:r=this.resultFromFormatted(t);break;case i.OperKind.Boolean:r=this.resultFromBoolean(e);break;case i.OperKind.Error:r=this.resultFromError(e,t);break;default:return{kind:"Failure",reason:`Unsupported operKind: ${e.kind}`}}if("Success"!==r.kind)return r;const n=this.getUnformattedValue(e,r);return{...r,unformattedValue:n,operKind:e.kind}}resultFromFormatted(e){if((0,n.isNone)(e))return{kind:"Failure",reason:"No formatted value"};switch(e.kind){case n.ResultKind.Success:if((0,a.isHashesValue)(e.value)){const r=e.value.units;return t=`Evaluate HashesValue: ${r.kind}`,n.ulsLogger.ULS.traceTag(520680450,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,`ValuePreviewResultExtractor encountered a failure with msg ${t}`),{kind:"Failure",reason:`HashesValue: ${r.kind}`}}return this.resultFromFormattedValue(e.value);case n.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}var t}resultFromFormattedValue(e){const t=this.formatter.renderValue(e,a.renderInfiniteWidth);return t.kind===n.ResultKind.Failure?{kind:"Failure",reason:"renderValue fail"}:(0,a.isHashesValue)(t.value)?{kind:"Failure",reason:`Render HashesValue: ${t.value.units.kind}`}:{kind:"Success",value:(0,a.renderedValueToString)(t.value),color:e.color}}resultFromFailureReason(e){const t=function(e){switch(e.kind){case o.ReasonKind.Unavailable:return`Unavailable - [${e.objects.map((e=>"kind"in e?e.kind:"")).join(",")}]`;case o.ReasonKind.NotImplemented:return`NotImplemented - [${e.features.join(",")}]`;case o.ReasonKind.PreviousFailure:return"PreviousFailure";default:return`${e.kind}`}}(e);switch(e.kind){case o.ReasonKind.Unavailable:case o.ReasonKind.NotImplemented:case o.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:`FailureReason: ${t}`};default:return{kind:"Failure",reason:`Unsupported FailureReason: ${t}`}}}resultFromError(e,t){switch(e.type){case i.ErrorType.NAME:case i.ErrorType.VALUE:case i.ErrorType.FIELD:return{kind:"Unavailable",reason:`Unsupported error: ${e.type}`}}return this.resultFromFormatted(t)}getUnformattedValue(e,t){let r=t.value;return e.kind===i.OperKind.String&&(t.value=`"${t.value}"`,r=e.value),e.kind===i.OperKind.Number&&(r=this.mathpack.toNumber(e).toString()),e.kind===i.OperKind.Blank&&(r=this.mathpack.toNumber(this.mathpack.zero).toString()),r}resultFromBoolean(e){const t=e.value?this.localeInfo.trueName:this.localeInfo.falseName;return{kind:"Success",value:t,unformattedValue:t,operKind:i.OperKind.Boolean}}constructor(e){this.mathpack=e.mathpack,this.localeInfo=e.localeInfo,this.formatter=(0,a.createNumberFormatter)({config:e})}}},9767:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewVisitor=void 0;const n=r(6913),i=r(6592),a=r(5033);class o extends i.IdentityVisitor{appNode(e,t,r,n){const i=super.appNode(e,t,r,n);return this.tryUpdateAppNodeAsSubFormula(e,i),i}literalNode(e,t,r){const n=super.literalNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}missingNode(e,t){const r=super.missingNode(e,t);return this.tryUpdateNodeAsSubFormula(r),r}arrayNode(e,t,r){const n=super.arrayNode(e,t,r);return this.tryUpdateNodeAsSubFormula(n),n}cellRefNode(e,t,r){const n=super.cellRefNode(e,t,r);return this.validateSelection(r,"whole"),this.tryAddCrossWorkbookRef(t,r),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}fieldRefNode(e,t,r){const n=super.fieldRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n),n}structRefNode(e,t,r){const n=super.structRefNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}nameNode(e,t,r){const n=super.nameNode(e,t,r);return this.validateSelection(r,"prefix"),this.tryUpdateNodeAsSubFormula(n)&&(this.isRefNode=!0),n}badSequenceNode(e,t,r){const n=super.badSequenceNode(e,t,r);return t.some((e=>e.label===this.nodeLabel))&&(this.updateNodeAsSubFormula(n),this.isBadSelection=!0),n}parenNode(e,t,r){const n=super.parenNode(e,t,r);return t&&this.tryUpdateNodeAsSubFormula(n),n}letNode(e,t,r,n,i,a){const o=super.letNode(e,t,r,n,i,a),s=this.parsedFormulaTree.spans[a];return this.isMatchingArg(s,!0)&&this.updateLetNodeAsSubFormula(o),o}wsfNode(e,t,r){const n=super.wsfNode(e,t,r);return this.validateSelection(r,"none"),n}operatorNode(e,t){const r=super.operatorNode(e,t);return this.validateSelection(t,"none"),r}tryUpdateNodeAsSubFormula(e){return!!this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[e.label])&&(this.updateNodeAsSubFormula(e),!0)}tryUpdateAppNodeAsSubFormula(e,t){if(e.kind!==i.NodeKind.WSF&&e.kind!==i.NodeKind.Operator)return void n.ulsLogger.ULS.traceTag(509347166,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,`ValuePreviewVisitor - visitor encountered higher order function, kind: ${e.kind}`);const r=this.parsedFormulaTree.spans[e.label],o=this.parsedFormulaTree.spans[t.label];this.tryAddVolatileFunction(e,t),this.isMatchingAppNode(r,o,e.kind,t.isClosed)&&this.updateNodeAsSubFormula(t)}updateLetNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.head.label],r=this.parsedFormulaTree.spans[e.label];if(this.isMatchingAppNode(t,r,i.NodeKind.WSF,e.isClosed))this.updateNodeAsSubFormula(e);else for(let t=0;t<e.args.length;t++){const i=e.args[t],a=this.parsedFormulaTree.spans[i.label];if(!(0,n.isDefined)(a))return;if(this.isMatchingArg(a,!0)){if(1===t)return;const o=t%2==0,s=e.args.length-2,u=o?Math.min(s,t+1):t-2,l=this.parsedFormulaTree.spans[e.args[u].label];if(!(0,n.isDefined)(l))return;const c=this.formula.substring(r.start,l.end);this.letDefinitions=c,this.isVolatile=this.checkIntersectionWithVolatileFunction(r),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(r),this.isMinimalMatchingSpan(a)&&(this.subFormulaStart=a.start,this.subFormulaEnd=a.end,this.nodeLabel=i.label)}}}updateNodeAsSubFormula(e){const t=this.parsedFormulaTree.spans[e.label];this.subFormulaStart=t.start,this.subFormulaEnd=t.end,this.nodeLabel=e.label,this.isVolatile=this.checkIntersectionWithVolatileFunction(t),this.hasCrossWorkbookRef=this.checkIntersectionWithCrossWorkbookRef(t)}isMinimalMatchingSpan(e){return-1===this.nodeLabel&&this.isMatchingArg(e)}isMatchingArg(e,t=!1){return!!(0,n.isDefined)(e)&&(this.selectionStart===this.selectionEnd?this.selectionStart>=e.start&&this.selectionEnd<e.end:t?this.selectionStart>=e.start&&this.selectionEnd<=e.end:this.selectionStart===e.start&&this.selectionEnd===e.end)}isMatchingAppNode(e,t,r,a){if(!(0,n.isDefined)(e)||!(0,n.isDefined)(t)||!a)return!1;if(this.selectionStart===this.selectionEnd)switch(r){case i.NodeKind.WSF:return this.selectionStart===e.end||this.selectionStart===t.end-1||this.selectionStart>=e.start&&this.selectionStart<e.end;case i.NodeKind.Operator:return this.selectionStart>=e.start-e.pre.length&&this.selectionStart<e.end+e.post.length}else if(e.start<=this.selectionStart&&this.selectionEnd<=e.end)return this.isBadSelection=!0,!1;return this.selectionStart===t.start&&this.selectionEnd===t.end}tryAddVolatileFunction(e,t){if(e.kind!==i.NodeKind.WSF)return;if(!t.isClosed)return;const r=this.parsedFormulaTree.spans[t.label];(0,n.isNone)(r)||(0,i.isVolatileFunc)(e.id)&&this.volatileFunctions.push({start:r.start,end:r.end})}checkIntersectionWithVolatileFunction(e){return this.volatileFunctions.some((t=>e.start<=t.start&&e.end>=t.end))}tryAddCrossWorkbookRef(e,t){if(!e||e.kind!==i.QualifierKind.Sheet&&e.kind!==i.QualifierKind.SheetRange&&e.kind!==i.QualifierKind.Document)return;if((0,n.isNone)(e.document))return;const r=this.parsedFormulaTree.spans[t];(0,n.isNone)(r)||this.crossWorkbookRefs.push({start:r.start,end:r.end})}checkIntersectionWithCrossWorkbookRef(e){return this.crossWorkbookRefs.some((t=>e.start<=t.start&&e.end>=t.end))}validateSelection(e,t){if(this.selectionStart===this.selectionEnd)return;const r=this.parsedFormulaTree.spans[e];if((0,n.isDefined)(r)&&!(this.selectionStart<r.start||this.selectionEnd>r.end))switch(t){case"prefix":return void(this.selectionStart!==r.start&&(this.isBadSelection=!0));case"suffix":return void(this.selectionEnd!==r.end&&(this.isBadSelection=!0));case"whole":return void(this.selectionStart===r.start&&this.selectionEnd===r.end||(this.isBadSelection=!0));case"none":return void(this.isBadSelection=!0)}}constructor(e,t,r,n){super(),this.parsedFormulaTree=e,this.selectionStart=t,this.selectionEnd=r,this.formula=n,this.subFormulaStart=-1,this.subFormulaEnd=-1,this.isBadSelection=!1,this.isRefNode=!1,this.isVolatile=!1,this.hasCrossWorkbookRef=!1,this.letDefinitions=void 0,this.volatileFunctions=[],this.crossWorkbookRefs=[],this.nodeLabel=-1}}t.ValuePreviewVisitor=o},6723:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chatGPTPluginAttach=t.parserPerformanceMeasurementsAttach=t.autocompleteBinaryModelExperimentPluginAttach=t.autocompleteRangeSuggestionPluginAttach=t.autocompleteWrapperPluginAttach=t.autocompletePluginDependenciesResolved=void 0;const n=r(1633),i=r(8795),a=r(9615),o=(0,a.trackableAsyncLazy)((async()=>{const e=await i.workerThreadSpread.getValue();return await e.loadPluginScript("excelOnlineAutocomplete",!1),e}),"threadWithExcelOnlineAutocompleteScriptLoaded");t.autocompletePluginDependenciesResolved=(0,a.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompletePlugin),await i.schedulerWithRecalcServiceAttached.getValue()}),"autocompletePluginDependenciesResolved"),t.autocompleteWrapperPluginAttach=(0,a.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteWrapperPlugin)}),"autocompleteWrapperPluginAttach"),t.autocompleteRangeSuggestionPluginAttach=(0,a.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteRangeSuggestionPlugin)}),"autocompleteRangeSuggestionPluginAttach"),t.autocompleteBinaryModelExperimentPluginAttach=(0,a.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)}),"autocompleteBinaryModelExperimentPluginAttach"),t.parserPerformanceMeasurementsAttach=(0,a.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.ParserPerformanceMeasurements)}),"parserPerformanceMeasurementsAttach"),t.chatGPTPluginAttach=(0,a.trackableAsyncLazy)((async()=>{const e=await o.getValue();await e.createAndAttachPlugin(n.PluginFactoryName.ChatGPTPlugin)}),"chatGPTPluginAttach")},6040:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheGrid=void 0;const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(4380),u=r(8723),l=r(3313),c=r(9399),d=r(9204),m=r(8453),g=r(438);function p(e){switch(e.kind){case"number":return o.xlMathpack.fromNumber(e.value);case"string":return(0,o.stringOper)(e.stringValue);case"bool":return(0,o.booleanOper)(e.boolValue);case"error":return(0,o.errorOper)(e.errorKind??o.ErrorType.UNKNOWN);case"rich":return{kind:o.OperKind.Rich,getFallback:()=>(0,o.errorOper)(o.ErrorType.FIELD),getField(){}};case"blank":return o.blankOper}}t.CacheGrid=class{get readonlyDataModel(){return this.calcGrid.dataModel.getDocs()}writeRange(e,t){const r=this.sheetRangeToSheetGridRange(t.range);if(void 0===r)return;const{hiddenRowSet:n,hiddenColSet:s}=this.populateHiddenCells(t,r,e),u=(0,d.sheetCellSet)(r.sheet,(0,a.createFromProduct)({row:n,col:s}));this.calcGrid.dataModel.writeCellContents(e,u,"",!1,(0,o.gridCell)(r.range.row,r.range.col),o.blankOper,void 0,void 0);const{visibleRows:l,visibleCols:c}=function(e,t,r){const{row:n,col:a,rows:o,cols:s}=e.range,u=(0,i.except)(m.bspFactory.row([n,n+o]),t),l=(0,i.except)(m.bspFactory.col([a,a+s]),r),c=[];(0,m.forEachRow)(u,(([e,t])=>{for(let r=e;r<t;r++)c.push(r);return!0}));const d=[];return(0,m.forEachCol)(l,(([e,t])=>{for(let r=e;r<t;r++)d.push(r);return!0})),{visibleRows:c,visibleCols:d}}(r,n,s);for(let n=0;n<t.values.length;n++){const i=t.values[n],a=l[n];for(let s=0;s<i.length;s++){const u=i[s],l=c[s],g=(0,o.gridCell)(a,l);this.calcGrid.dataModel.writeCellContents(e,(0,d.sheetCellSet)(r.sheet,(0,m.createCellSetFromRange)(g)),t.formulae[n][s].formulaText,t.formulae[n][s].isFormula,g,p(u),t.iformats[n][s],void 0)}}}get sheets(){return this.readonlyDataModel.getSingleReadonlyDocument()?.getReadonlySheets()}get nameManager(){return this.readonlyDataModel.getSingleReadonlyDocument()?.getReadonlyNameManager()}get config(){return this.readonlyDataModel.config}consumePartialWorkbookMessages(){for(;!this.calcGrid.dataModel.step().queueEmpty;);}populateHiddenCells(e,t,r){const n=e.hiddenRows.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,i.union)(e,m.bspFactory.row([t,r]))),i.empty),a=e.hiddenCols.reduce(((e,{startInclusive:t,endExclusive:r})=>(0,i.union)(e,m.bspFactory.col([t,r]))),i.empty),o=(0,l.sheetGridRangeToHiddenRows)(t,n),s=(0,l.sheetGridRangeToHiddenCols)(t,a);return this.calcGrid.dataModel.writeHiddenRows(r,o),this.calcGrid.dataModel.writeHiddenCols(r,s),{hiddenRowSet:n,hiddenColSet:a}}sheetRangeToSheetGridRange(e){const t=this.calcGrid.dataModel.getDocs().getSheetIndex(this.calcGrid.document,e.sheetName);if(t.kind!==n.ResultKind.Failure&&(0,n.isDefined)(t.value))return(0,o.sheetGridRange)((0,o.sheetIndex)(this.calcGrid.document,t.value),(0,u.rangeToGridRange)(e))}constructor(){this.calcGrid=(0,s.makeCalcGrid)(n.defaultSetTimeoutInterface),this.recalcSideGrid=new g.RecalcSideGrid(this.calcGrid),this.schedulerFeatures=[],this.setSchedulerFeatures=e=>{this.schedulerFeatures=e},this.setA1ReferenceStyle=(...e)=>{this.calcGrid.setA1ReferenceStyle(...e),this.consumePartialWorkbookMessages()},this.setLocale=(...e)=>{this.calcGrid.setLocale(...e),this.consumePartialWorkbookMessages()},this.setWorkbookProps=(...e)=>{this.calcGrid.setWorkbookProps(...e),this.consumePartialWorkbookMessages()},this.updateSheetNames=(...e)=>{this.calcGrid.updateSheetNames(...e),this.consumePartialWorkbookMessages()},this.updateNamedObjects=(...e)=>{this.calcGrid.updateNamedObjects(...e),this.consumePartialWorkbookMessages()},this.setNumberFormats=(...e)=>{this.calcGrid.setNumberFormats(...e),this.consumePartialWorkbookMessages()},this.getStateAsNotifications=()=>[],this.getDocumentLoc=(...e)=>this.readonlyDataModel.getDocumentLoc(...e),this.getSheetIndex=(...e)=>this.readonlyDataModel.getSheetIndex(...e),this.getSheetName=(...e)=>this.readonlyDataModel.getSheetName(...e),this.getNameLoc=(...e)=>this.readonlyDataModel.getNameLoc(...e),this.getUserDefinedFuncLoc=(...e)=>this.readonlyDataModel.getUserDefinedFuncLoc(...e),this.getSheetRangeIndexes=(...e)=>this.readonlyDataModel.getSheetRangeIndexes(...e),this.getContainingTable=(...e)=>this.readonlyDataModel.getContainingTable(...e),this.getStructRefSpecialRef=(...e)=>this.readonlyDataModel.getStructRefSpecialRef(...e),this.getStructRefColumn=(...e)=>this.readonlyDataModel.getStructRefColumn(...e),this.getRangeValues=(...e)=>this.recalcSideGrid.getRangeValues(...e),this.getRangeFormulae=(...e)=>this.recalcSideGrid.getRangeFormulae(...e),this.getRangeFormats=(...e)=>this.recalcSideGrid.getRangeFormats(...e),this.getSheetNames=(...e)=>this.recalcSideGrid.getSheetNames(...e),this.getIntersectingTables=(...e)=>this.recalcSideGrid.getIntersectingTables(...e),this.getIformats=(...e)=>this.recalcSideGrid.getIformats(...e),this.getHiddenRows=(...e)=>this.recalcSideGrid.getHiddenRows(...e),this.getHiddenCols=(...e)=>this.recalcSideGrid.getHiddenCols(...e),this.discardSnapshot=async(...e)=>this.recalcSideGrid.discardSnapshot(...e),this.evalClonedModelOnSnapshot=(...e)=>this.recalcSideGrid.evalClonedModelOnSnapshot(...e),this.evalFormulaOnSnapshot=(...e)=>this.recalcSideGrid.evalFormulaOnSnapshot(...e),this.evalFormulaTreeOnSnapshot=(...e)=>this.recalcSideGrid.evalFormulaTreeOnSnapshot(...e),this.getCorrespondingSnapshotID=(...e)=>this.recalcSideGrid.getCorrespondingSnapshotID(...e),this.calcGrid.dataModel.setNumberFormats(this.calcGrid.document,c.knownFormatData,!1,-1/0)}}},542:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTPlugin=void 0;const n=r(6533),i=r(6913),a=r(1633),o=r(9084),s=r(2937),u=r(6307),l=r(8708).PluginRegistry.create(a.PluginFactoryName.ChatGPTPlugin,a.PluginGroup.Excel);let c=(()=>{let e,t,r,a=[l.x10Plugin()],s=[],c=[];return t=class{*run(e){const t=e.query;if(!(0,i.isDefined)(t))return null;const r=yield{kind:u.ComputationRequestKind.CreateChatGPTSession,options:e.context};if(r.kind!==u.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");const n=yield{kind:u.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:t};if(n.kind!==u.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");const a=yield{kind:u.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:"Explain your answer"};if(a.kind!==u.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return{result:n.result,details:a.result}}constructor(){n.__runInitializers(this,c)}},n.__setFunctionName(t,"ChatGPTPlugin"),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;r=[l.uiMessageHandler({kind:o.RequestKind.chatGPTQuery})],n.__esDecorate(t,null,r,{kind:"method",name:"run",static:!1,private:!1,access:{has:e=>"run"in e,get:e=>e.run},metadata:i},null,c),n.__esDecorate(null,e={value:t},a,{kind:"class",name:t.name,metadata:i},null,s),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t.factory=l.injectPluginFactory(),n.__runInitializers(t,s),t})();t.ChatGPTPlugin=c,(0,s.registerPluginFactory)(c.factory)},6322:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTService=void 0;const n=r(6913);t.ChatGPTService=class{async createSession(e){const t=await this.provider.openChat(e);return(0,n.isDefined)(t)?(this.set.add(t),(0,n.success)(t)):(0,n.failure)(void 0)}async closeSession(e){if(!this.set.has(e))return(0,n.failure)(void 0);try{return this.provider.close(e),this.set.delete(e),(0,n.success)(void 0)}catch{return(0,n.failure)(void 0)}}async request(e,t){if(!this.set.has(e))return(0,n.failure)(void 0);try{const r=await this.provider.send(e,t);return(0,n.success)(r)}catch{return(0,n.failure)(void 0)}}constructor(e){this.provider=e,this.set=new Set}}},6132:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conflictResolver=void 0;const n=r(6913),i=r(5033),a=r(1633),o=r(9731),s=r(326),u=r(8049);t.conflictResolver={runTest:c,runExperiment:c,runAuthoringExperiment:c,runPerCharacterExperiment:c,argumentAssistance:d,valuePreview:d,gotoCtrlClick:d,formulaRepair:d,chatGPTQuery:d,columnFormulaSuggestion:d,formulaCopilotIPE:d,getTranspiledFormulas:d,getAnonymizedFormulas:d,inCellControlsAutodetection:d,getLocale:d,formulaCompletion:d,inCellSuggestion(e){for(const[{factoryName:t},r]of e)if(t===a.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,n.isDefined)(r))return r;return null},formulaHighlighting(e){if(e.length>0){let t=[];for(const[r,i]of e){const e=i.formulaHighlights?.filter(n.isDefined);void 0!==e&&(t=t.concat(e))}const r=(e,t)=>(0,n.isDefined)(e.span)&&(0,n.isDefined)(t.span)?(0,u.spanCompare)(e.span,t.span):(0,n.isDefined)(e)?1:(0,n.isDefined)(t)?-1:0;return t.sort(r),{formulaHighlights:t}}return null},functionSuggestion(e,t){if(t===a.PluginGroup.Python)return function(e){return d(e)}(e);let r;const s={Simple:[],Smart:[],Enum:[]};return e.forEach((([e,t])=>{t.items.filter(n.isDefined).filter((e=>(0,n.isDefined)(e.textEdit)||(0,n.isDefined)(e.label))).forEach((e=>{return s[(t=e,t.kind===a.CompletionItemKind.Enum?"Enum":t.type===a.SuggestionKind.Smart?"Smart":"Simple")].push(e);var t})),(0,n.isDefined)(t.data)&&(n.ulsLogger.ULS.assertTag(506804355,i.LogCategory.msoulscat_ES_EWAJS,!(0,n.isDefined)(r),"Multiple smart suggestions data received"),r=t.data)})),{items:s.Enum.length>0?[...s.Enum]:[...s.Smart,...s.Simple.sort((function(e,t){if((0,n.isDefined)(e.label)&&(0,n.isDefined)(t.label)){if((0,n.isDefined)(e.isPrefixed)&&(0,n.isDefined)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(l.includes(e.kind)&&l.includes(t.kind)){const r=(0,o.getStructRefCompletionItemRank)(e),n=(0,o.getStructRefCompletionItemRank)(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return(0,n.isDefined)(e.label)?1:(0,n.isDefined)(t.label)?-1:0}))],data:r}}};const l=[a.CompletionItemKind.TableHeader,a.CompletionItemKind.TableSpecialStructRef];function c(e){const t=[];for(const[r,{results:i}]of e)(0,n.isDefined)(i)&&t.push(...i.filter(n.isDefined));return{results:t}}function d(e){if(0===e.length)return null;const[t,r]=e[0];if(1===e.length)return r;const n=s.computationRegistry.UIMessage.getRegistrationByComputationIdentifier(t)?.kind;throw new Error(`Conflict resolver: ${n}: ${e.length} results received, while only one active plugin is currently supported`)}(0,n.staticAssertExtends)()},3175:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customConflictResolverFactories=t.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;const n=r(6913),i=r(1633),a=r(9084),o=r(2202);class s{consumeResult(e){switch(e.kind){case a.RequestKind.functionSuggestion:(0,n.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case a.RequestKind.argumentAssistance:(0,n.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case a.RequestKind.inCellSuggestion:(0,n.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=e.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;case a.RequestKind.formulaCopilotIPE:(0,n.isTypedChangeGateEnabled)("OfficeVSO:9848728_refactorFormulaCopilotIPERequest")&&((0,n.assertTrue)("formulaCopilotIPESet should be false when receiving formulaCopilotIPE request",!this.formulaCopilotIPESet),this.formulaCopilotIPEResult=e.result,this.formulaCopilotIPESet=!0,this.resolvePromiseIfPossible());break;default:(0,n.assertNever)(`unknown result: ${e}`,e)}}static create(){return new s}resolvePromiseIfPossible(){if(this.formulaCopilotIPESet&&this.functionSuggestionSet)return(0,n.isDefined)(this.functionSuggestionResult)&&(0,n.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0?(this.functionSuggestionResult.items[length-1]?.type===i.SuggestionKind.Smart&&((0,n.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||null==this.argumentAssistanceResult),(0,n.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||null==this.inCellSuggestionResult?.completionItem)),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null,formulaCopilotIPE:this.formulaCopilotIPEResult})):this.argumentAssistanceSet&&this.inCellSuggestionSet?this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult,formulaCopilotIPE:this.formulaCopilotIPEResult}):void 0}constructor(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.formulaCopilotIPEResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.formulaCopilotIPESet=!(0,n.isTypedChangeGateEnabled)("OfficeVSO:9848728_refactorFormulaCopilotIPERequest"),this.promise=new n.ResolvablePromise}}t.FunctionSuggestionAndArgumentAssistanceConflictResolver=s,(0,n.staticAssertExtends)(),t.customConflictResolverFactories={[o.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]:s},(0,n.staticAssertExtends)()},2202:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customConflictResolverPluginKinds=t.CustomConflictResolverStrategy=void 0,t.makeBatchRequester=function(e){return{functionSuggestionAndArgumentAssistance(t,r,i){if((0,n.isNone)(t))return Promise.resolve(null);const{functionSuggestion:s,argumentAssistance:u,inCellSuggestion:l,formulaCopilotIPE:c}=t;return(0,n.isNone)(s)||(0,n.isNone)(u)||(0,n.isNone)(l)||(0,n.isNone)(c)?Promise.resolve(null):e.doBatchRequest({strategy:o.FunctionSuggestionAndArgumentAssistance,functionSuggestion:s,argumentAssistance:u,inCellSuggestion:l,formulaCopilotIPE:c},r,i??a.DefaultComputationGroup)}}};const n=r(6913),i=r(9084),a=r(6307);var o;!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(o||(t.CustomConflictResolverStrategy=o={})),t.customConflictResolverPluginKinds={[o.FunctionSuggestionAndArgumentAssistance]:[i.RequestKind.functionSuggestion,i.RequestKind.argumentAssistance,i.RequestKind.inCellSuggestion,i.RequestKind.formulaCopilotIPE]},(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)()},8127:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderInsideInit=t.timelineQueueProcessorFactory=t.createPrefetchingCacheFactory=t.DynamicPluginLoader=t.DynamicPluginLoaderBase=void 0;const n=r(6533),i=r(6913),a=r(5033),o=n.__importStar(r(7882)),s=r(3713),u=r(6834),l=r(2041),c=r(2937),d=r(3385),m=r(8402),g=r(4691),p=r(4352);class h{loadPluginScriptTrace(e,t){i.ulsLogger.ULS.traceTag(553734797,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,g.x10Logger.formatLogMessage("loadPluginScript",{description:`${e} loaded, time to load ${t}`}))}async createAndAttachPlugin(e,t){const r=(0,c.getPluginFactory)(e);this.scheduler.createAndAttachPlugin(r,t)}constructor(e,t){if(!(t instanceof u.FormulaBarScheduler))throw new TypeError(`DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ${JSON.stringify(t)}`);this.scheduler=t,g.x10Logger.threadId=e}}t.DynamicPluginLoaderBase=h;class f extends h{async loadPluginScript(e,t){if((0,i.isNone)(e)||(0,i.isNone)(t))return;const r=m.defaultTimerInterface,n=r.now();await this.loader.loadScript(e);const a=r.now()-n;this.loadPluginScriptTrace(e,a)}isThreadingSupported(){return o.isThreadingSupported()&&void 0!==(0,i.getCalcAbsUrl)()}async createPluginThread(e){const t=`DynamicPluginLoaderThread-${f.lastThreadNum+=1}-${e}`,r=`${t}-IGrid`;await i.initCalcCalled;const n=await o.createWorker({createMode:"Thread",id:t},o.paramInsideDef({scriptUrl:(0,i.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(()=>({...(0,s.bindMethods)(this.scheduler,[...u.parentMethodsCall,...u.parentMethodsPost]),resolveScript:this.resolveScript})));try{let e=()=>{};n.onClose=()=>{e(),i.ulsLogger.ULS.traceTag(553734798,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,g.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))};const t=await(0,i.initCalcThread)(n);e=()=>t.close(),this.scheduler.doNotifyStatelessSubject.subscribe((e=>n.post.processNotification(e))),this.scheduler.requestWithCorrelationIdSubject.subscribe((e=>n.post.requestWithCorrelationId(...e))),this.scheduler.doNotifyStatefulSubject.subscribe((e=>n.post.processNotification(e)));const o={createIGridImportEndpoint:e=>n.call.createIGridImportEndpoint.transfer([e.port],e),onGridExporterClosed:n.post.onGridExporterClosed};return this.gridManager.onGridImporterCreated(o,r),new S(n)}catch(e){throw n.close(),e}}constructor(e,t,r,n){super("Main",r),this.threadEntryPoint=e,this.gridManager=t,this.loader=n;const i=n.getConfig();this.resolveScript=i.resolveScript}}t.DynamicPluginLoader=f,f.lastThreadNum=0;class S{loadPluginScript(e,t){return this.outside.call.loadPluginScript(e,t)}createAndAttachPlugin(e,t){return this.outside.call.createAndAttachPlugin(e,t)}recalcServiceAttached(){return this.outside.call.recalcServiceAttached()}close(){this.outside.close()}constructor(e){this.outside=e}}t.createPrefetchingCacheFactory=e=>(...t)=>{const r=e.getGrid();if(void 0!==r)return d.PrefetchingCache.create(r,...t)},t.timelineQueueProcessorFactory=e=>t=>new m.TimelineQueueProcessor(((e,t)=>e.kind-t.kind),t,void 0,e),t.dynamicPluginLoaderInsideInit=(e,t)=>async({config:r,connection:n},{pluginResponseWindows:i})=>o.Endpoint.createInside(n,(a=>{const o={...(0,s.bindLazyMethods)(new p.ResettableLazy((()=>a.call)),u.parentMethodsCall),...(0,s.bindLazyMethods)(new p.ResettableLazy((()=>a.post)),u.parentMethodsPost)},c=void 0,d=new l.GridProvider((()=>m.registerAsyncGrid())),m=new u.FormulaBarScheduler(e(c),t(d),i,d.getGridDataSink(),d.getSyncDataModel(),c,o);return new v(String(n.options.id),d,m,r,a)}));class v extends h{async loadPluginScript(e,t){if((0,i.isNone)(e)||(0,i.isNone)(t))return;if(!0===this.loadedScripts[e])return;const r=m.defaultTimerInterface,n=r.now();o.importScriptsWithRetry([await this.inside.call.resolveScript({identifier:e,isLocalized:t})],i.maxRetriesForLoadingScript);const a=r.now()-n;this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,a)}recalcServiceAttached(){return this.scheduler.recalcServiceAttached()}constructor(e,t,r,n,a){super(e,r),this.gridImporter=t,this.twConfig=n,this.inside=a,this.loadedScripts=(0,i.makeStringMap)(),this.initCalcThreadInside=async(e,t,r)=>{await(0,i.initCalcInThread)(e,t,r,this.twConfig)},this.createIGridImportEndpoint=this.gridImporter.createIGridImportEndpoint.bind(this.gridImporter),this.onGridExporterClosed=this.gridImporter.onGridExporterClosed.bind(this.gridImporter),this.processNotification=this.scheduler.processNotification.bind(this.scheduler),this.requestWithCorrelationId=this.scheduler.requestWithCorrelationId.bind(this.scheduler)}}},8570:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentQueueProcessorFactory=t.ExperimentQueueProcessor=void 0;const n=r(6913),i=r(6307);class a{enqueue(e,t,r){(0,n.isDefined)(r)&&e.kind===i.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(e)}step(){const e=this.queue.pop();(0,n.isDefined)(e)&&this.consumeMessage(e)}get done(){return 0===this.queue.getCount()}constructor(e){this.consumeMessage=e,this.queue=new n.PriorityQueue((()=>0))}}t.ExperimentQueueProcessor=a,t.experimentQueueProcessorFactory=e=>new a(e),(0,n.staticAssertExtends)()},3713:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMap=t.bindMethodsNullCheck=t.bindMethodsUnbox=void 0,t.staticTypeHint=function(e){},t.functionMapFromDUFunction=function(e,t){const r={};for(const n of t)r[n]=(...t)=>e(n,...t);return r},t.bindMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e[n](...t);r[n]=t}return r},t.lazy=function(e){return new i.ResettableLazy(e)},t.bindLazyMethods=function(e,t){const r={};for(const n of t){const t=(...t)=>e.getValue()[n](...t);r[n]=t}return r},t.asReadonly=function(e){return e},t.mapFromArrayOfDependantPairs=s,t.functionMapToGenericFunction1stArg=function(e){return(t,r,...n)=>e[t].call(e,r,...n)};const n=r(6913),i=r(4352);n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertExtends,n.staticAssertExtends,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame,n.staticAssertSame;class a{unbox(e){return(...t)=>e(t)}nullcheck(e){return(...t)=>{for(const e of t)if((0,n.isNone)(e))return null;return e(...t)}}}function o(e){const t=new a,r=t[e].bind(t);return function(e,t){const n={};for(const i of t){const t=e[i].bind(e);n[i]=r(t)}return n}}t.bindMethodsUnbox=o("unbox"),t.bindMethodsNullCheck=o("nullcheck");{const e={methodF:e=>e+1,methodG:([e])=>e+1},r=(0,t.bindMethodsUnbox)(e,["methodG"]);n.staticAssertSame,(0,t.bindMethodsNullCheck)(e,["methodG"]),n.staticAssertSame,(0,t.bindMethodsNullCheck)(r,["methodG"]),n.staticAssertSame}function s(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}s([["a",1],["b",2]]),n.staticAssertSame,t.DefaultMap=class{get(e){const t=this.operations.getKey(e),r=this.map.get(t);if(void 0!==r)return r;const n=this.operations.getDefault();return this.map.set(t,n),n}set(e,t){this.map.set(this.operations.getKey(e),t)}delete(e){this.map.delete(this.operations.getKey(e))}constructor(e){this.operations=e,this.map=new Map}}},6834:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaBarScheduler=t.parentMethodsPost=t.parentMethodsCall=void 0,t.shouldRunComputation=W;const n=r(6913),i=r(6592),a=r(1633),o=r(6537),s=r(7154),u=r(4846),l=r(6322),c=r(3747),d=r(326),m=r(4330),g=r(6700),p=r(2363),h=r(6132),f=r(3175),S=r(2202),v=r(3713),y=r(4366),F=r(6307),b=r(3688),C=r(8824),k=r(1479),E=r(2547),A=r(7736),T=r(405),R=r(8402),N=r(6410),I=r(7229),P=r(4691),O=r(4352),M=r(8698);class D{create(){return this.current+=1}constructor(){this.current=0}}const w=(0,v.mapFromArrayOfDependantPairs)((0,n.numEnumArray)(a.PluginFactoryName).map((e=>[e,a.PluginFactoryName[e]])));t.parentMethodsCall=["serviceCall","createChatGPTSession","closeChatGPTSession","sendChatGPTQuery","sendAugLoopSignal","registerALAnnotation","getRecognizedTablesInfo","getCoPilotLicense","getPythonLicense","logAshaErrorEvent"],t.parentMethodsCall,t.parentMethodsPost=["addResult","addToComputationCount","triggerEventImmediate"],(0,n.staticAssertSame)();const _={kind:E.InternalSchedulerResponseKind.FirstStep},L={[N.NotificationKind.setActiveCell]:!0,[N.NotificationKind.setActiveCellFormat]:!0,[N.NotificationKind.doNothing]:!0},x=(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension");class K{async serviceCall(e,t,r){if(void 0!==this.parent)return this.parent.serviceCall(e,t,r);const n=await this.services[e];(0,v.staticTypeHint)(n),(0,v.staticTypeHint)(t);const i=n[t];return(0,v.staticTypeHint)(i),i.bind(n)(...r)}registerProvider(e,t){P.x10Logger.log({kind:"provider",payload:{id:e,state:"Provided"}});const r=this.services[e];(0,v.staticTypeHint)(r);const n=r.resolve(t);return P.x10Logger.log({kind:"provider",payload:{id:e,state:"Registered"}}),n}async getCoPilotLicense(){return this.parent?this.parent.getCoPilotLicense():this.services.CopilotLicense.getCurrentValue()?.getLicense()}async getPythonLicense(){return this.parent?this.parent.getPythonLicense():this.services.PythonLicense.getCurrentValue()?.getLicense()}setFunctionInfo(e){if((0,n.isNone)(e))return void n.ulsLogger.ULS.traceTag(512274762,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));const t={};for(const r of e)(0,n.isDefined)(r)&&(t[r.NameDataStrings]=r);this.state={...this.state,functionsInfoMap:t},n.ulsLogger.ULS.traceTag(512274761,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))}setDefinedNamesInfo(e){if((0,n.isNone)(e))return void n.ulsLogger.ULS.traceTag(512274760,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));const t={};for(const r of e)(0,n.isDefined)(r)&&(0,n.isDefined)(r.name)&&(t[r.name.toUpperCase()]=r);this.state={...this.state,definedNamesInfoMap:t},n.ulsLogger.ULS.traceTag(512274759,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))}onWorkbookClosing(){P.x10Logger.flush()}getPluginResponseWindows(){return this.pluginResultWindows}setPluginResponseWindow(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}}consumeMessage(e){switch(e.kind){case F.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(e.computation,e.payload);break;case F.SchedulerTimelineQueueMessageKind.NoOpRequest:case F.SchedulerTimelineQueueMessageKind.SyncRequest:case F.SchedulerTimelineQueueMessageKind.AsyncRequest:case F.SchedulerTimelineQueueMessageKind.InternalRequest:const t=this.timer.now();this.processRequest(e.computation,e.request,{onFulfilled:t=>{if(t.kind===n.ResultKind.Success)return this.enqueueMessage({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:E.InternalSchedulerResponseKind.NormalResponse,response:t.value}}),t.value;const r=I.logSafeFailure.censored(t);return this.enqueueMessage({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:E.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:r}}),r},onRejected:()=>{const t=(0,n.failure)(void 0);return this.enqueueMessage({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:E.InternalSchedulerResponseKind.RequestFailure,request:e.request.kind,failure:t}}),t}}),e.computation.info.schedulerTime+=this.timer.now()-t;break;case F.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(e.correlationId,e.computationGroup,e.type,e.computationKind,F.ExecutionStopReason.Frame.Timeout);break;case F.SchedulerTimelineQueueMessageKind.Timeout:e.callback();break;default:(0,n.assertNever)(`unknown message: ${e}`,e)}}enqueueMessage(e,t){const r=K.abstractStepCosts[e.kind];this.processor.enqueue(e,r,t)}stepComputation(e,t){const r=this.responseStates[e.info.type][e.info.computationKind].computationFrame(e.info.computationGroup);if(e.info.correlationId===r?.correlationId)try{const r=this.timer.now(),n=B(e.generator,t);if(e.info.computationTime+=this.timer.now()-r,!0!==n.done){const t=n.value,r=(0,E.createTimelineQueueMessage)(t,e);this.enqueueMessage(r)}else this.addResultAndFinalizeComputationFrame(e,{kind:"Successful",message:n.value},F.ExecutionStopReason.Computation.Done)}catch(t){this.addResultAndFinalizeComputationFrame(e,{kind:"Exception"},F.ExecutionStopReason.Computation.Exception),P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.PluginFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.stepComputation",description:`plugin threw exception: ${t} during computation`,data:e.info}})}else e.finalizer.finalize(e,e.stopReasonRef.value)}addResultAndFinalizeComputationFrame(e,t,r){return e.finalizer.finalize(e,r),this.addResult(e.info,t)}addResult(e,t,r){const a=this.responseStates[e.type][e.computationKind].computationFrame(e.computationGroup);if(this.parent||r?.forEach((e=>P.x10Logger.log(...e))),void 0===a||a.correlationId>e.correlationId)return;if(a.correlationId<e.correlationId&&P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.AssertionFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.addResult",description:`main scheduler corelationID (${a.correlationId}) is less than the child one (${e.correlationId})`}}),this.parent){const n=[...r??[],...P.x10Logger.flushBufferedMessages()];this.parent.addResult(e,t,n)}switch(t.kind){case"Successful":a.successfulResults.results.push([e.computationIdentifier,t.message]);break;case"Exception":a.numFailures+=1;break;case"Skipped":a.numSkippedComputations+=1;break;default:(0,n.assertNever)("unknown result",t)}const o=function(e){switch(!0){case e.numFailures+e.numSkippedComputations+e.successfulResults.results.length!==e.numOfComputations:return;case e.numFailures===e.numOfComputations:return F.ExecutionStopReason.Computation.Exception;case e.numSkippedComputations===e.numOfComputations:return F.ExecutionStopReason.Computation.Skipped;default:return F.ExecutionStopReason.Computation.Done}}(a);void 0!==o&&this.stopComputationFrame(a.correlationId,e.computationGroup,e.type,e.computationKind,o)}processRequest(e,t,{onFulfilled:r,onRejected:a}){const o=this.responseStates[e.info.type][e.info.computationKind],s=o.computationFrame(e.info.computationGroup);if(e.info.correlationId!==s?.correlationId)return e.finalizer.finalize(e,e.stopReasonRef.value),a(I.logSafeFailure.failure("Computation timed out"));const u=this.timer.now(),l=(0,k.processRequest)(k.requestProcessorMap,t,e,o.computationFrame(e.info.computationGroup)?.cache,o.computationFrame(e.info.computationGroup)?.config);return(0,n.bindMaybeThenable)(l,(a=>(this.addProcessingTime(e,t.kind,u),a.kind!==n.ResultKind.Success&&P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.RequestProcessorFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.processRequest",description:"request returned a scheduler-side failure",data:{...e.info,failedRequest:t.kind,failedReason:I.logSafeFailure.censored(a)}}}),r(a))),(r=>(this.addProcessingTime(e,t.kind,u),P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.RequestProcessorFailure,failureLevel:i.TraceLevel.Error,path:"FormulaBarScheduler.processRequest",description:"request processor threw",data:{...e.info,failedRequest:t.kind,error:(0,n.messageFromError)(r)}}}),a(r))))}addProcessingTime(e,t,r){const n=this.timer.now(),i=e.info.requestTimes[t];return i?(i.requestDuration=i.requestDuration+n-r,i.numberOfRequests+=1,i.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,numberOfRequests:1,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n}stopComputationFrame(e,t,r,n,i){const a=this.responseStates[r][n];e===a.computationFrame(t)?.correlationId&&a.stop(t,i,this.timer.now())}getFunctionsShortDescriptions(){return u.functionShortDescriptions.getValue()}getSchedulerFeatures(){return(0,v.asReadonly)(this.syncDataModel.schedulerFeatures)}isSchedulerFeatureEnabled(e){return-1!==this.getSchedulerFeatures().indexOf(e)}doNotify(...e){n.ulsLogger.ULS.traceTag(512274758,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:`received notification of kind:\n       ${e[0]}\n      `})),this.enqueueNotification(e),e[0]!==N.NotificationKind.setSchedulerFeatures&&e[0]!==N.NotificationKind.notifyWorkbookClosing||this.processNotifications()}enqueueNotification(e){const t=this.notificationQueue.length-1,r=this.notificationQueue[t];if(void 0===r)this.notificationQueue.push(e),n.ulsLogger.ULS.traceTag(512274757,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`queue empty, notification of kind:\n         ${e[0]} pushed to queue\n        `}));else{const[a]=r,[o]=e;a===o&&!0===L[a]?(this.notificationQueue[t]=e,n.ulsLogger.ULS.traceTag(512274756,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`notification of kind:\n           ${e[0]} overrode previous notification\n          `}))):(this.notificationQueue.push(e),n.ulsLogger.ULS.traceTag(512274755,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:`couldn't coalesce, notification of kind:\n           ${e[0]} pushed to queue\n          `})))}}processNotifications(){for(const e of this.notificationQueue)n.ulsLogger.ULS.traceTag(512274754,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:`processing notification of kind:\n         ${e[0]}\n        `})),this.processNotification(e);this.notificationQueue.length=0}processNotification(e){const[t,r]=e;switch(this.notificationProcessorMap[t](...r),t){case N.NotificationKind.setA1ReferenceStyle:case N.NotificationKind.setLocale:case N.NotificationKind.setWorkbookProps:case N.NotificationKind.updateSheetNames:case N.NotificationKind.updateNamedObjects:case N.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(e);break;default:this.doNotifyStatelessSubject.next(e)}}requestWithCorrelationId(...[e,t,r,i,a,o,s]){const u=this.timer.now(),l=this.responseStates[e][t];l.closeFrame(s,F.ExecutionStopReason.Frame.Superseded,u);const c=this.createPrefetchingCache(this.syncDataModel,a),d=this.computationResultWindows[e][t],m=l.createFrame(a,s,g.ExecutionType.Async,i,c,this.syncDataModel.config,u,d);0===this.responseStates[e][t].numComputations?(P.x10Logger.log({kind:"requestSkipped",payload:{computationKind:t,computationGroup:s}}),m.resolve({kind:"Done",payload:{kind:t,results:[]}})):P.x10Logger.log({kind:"beginRequest",payload:{correlationId:a,computationKind:t,computationGroup:s}});const p=l.computationFrame(s);return(0,n.assertTrue)("`frame` should be always defined at this point",void 0!==p),this.computationSubjects[e][r][t].next([p,o]),d.stopDelta<1/0&&this.enqueueMessage({kind:F.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:a,computationGroup:s,type:e,computationKind:t},u+d.stopDelta+x),this.requestWithCorrelationIdSubject.next([e,t,r,i,a,o,s]),m}syncRequestWithCorrelationId(e,t,r,i,a,o,s){const u=this.timer.now(),l=this.responseStates[e][t];l.closeFrame(s,F.ExecutionStopReason.Frame.Superseded,u);const c=this.createPrefetchingCache(this.syncDataModel,a),d=this.computationResultWindows[e][t],m=l.createFrame(a,s,g.ExecutionType.Sync,i,c,this.syncDataModel.config,u,d);P.x10Logger.log({kind:"beginRequest",payload:{correlationId:a,computationKind:t,computationGroup:s}});const p=l.computationFrame(s);(0,n.assertTrue)("`frame` should be always defined at this point",void 0!==p),this.computationSubjects[e][r][t].next([p,o]);const h=u+d.stopDelta+x,[f,S]=this.runToCompletion(c,this.syncDataModel.config,h);return l.closeFrame(s,f,this.timer.now()),m.resolve({kind:"Done",payload:{kind:t,results:[]}}),{kind:t,results:S}}runToCompletion(e,t,r){const a=[];let o=this.timer.now();for(let s=this.syncMessageQueue.pop();void 0!==s;s=this.syncMessageQueue.pop(),o=this.timer.now()){if(o>=r){s.computation.finalizer.finalize(s.computation,F.ExecutionStopReason.Frame.Timeout);break}let u;switch(s.kind){case F.SchedulerTimelineQueueMessageKind.StepComputation:{const{computation:e,payload:t}=s;try{const r=B(e.generator,t);if(e.info.computationTime+=this.timer.now()-o,!0!==r.done){const t=r.value,n=(0,E.createSyncTimelineQueueMessage)(t,e);this.syncMessageQueue.enqueue(n)}else this.addResult(e.info,{kind:"Successful",message:r.value}),e.finalizer.finalize(e,F.ExecutionStopReason.Computation.Done),a.push([e.info.computationIdentifier,r.value])}catch{n.ulsLogger.ULS.traceTag(538581056,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,P.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:e.info})),e.finalizer.finalize(e,F.ExecutionStopReason.Computation.Exception)}}break;case F.SchedulerTimelineQueueMessageKind.NoOpRequest:case F.SchedulerTimelineQueueMessageKind.SyncRequest:const r=(0,k.processSyncRequest)(k.requestProcessorMap,s.request,s.computation,e,t);u=this.addProcessingTime(s.computation,s.request.kind,o),s.computation.info.schedulerTime+=u-o,r.kind===n.ResultKind.Success?this.syncMessageQueue.enqueue({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:s.computation,payload:{kind:E.InternalSchedulerResponseKind.NormalResponse,response:r.value}}):(P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.RequestProcessorFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.runToCompletion",description:"request returned a scheduler-side failure",data:{...s.computation.info,failedRequest:s.request.kind}}}),this.syncMessageQueue.enqueue({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:s.computation,payload:{kind:E.InternalSchedulerResponseKind.RequestFailure,request:s.request.kind,failure:I.logSafeFailure.censored(r)}}));break;default:(0,n.assertNever)(`unknown message: ${s}`,s)}}return this.syncMessageQueue.clear(),[!(0,n.isDefined)(r)||o<r?F.ExecutionStopReason.Computation.Done:F.ExecutionStopReason.Frame.Timeout,a]}triggerEventImmediate(e,t){if(this.parent)return this.parent.triggerEventImmediate(e,t);this.triggerEvent(e,t)}triggerEvent(e,t){return this.processNotifications(),this.doRequestUntyped(c.ComputationType.Event,e,t,void 0,this.eventComputationGroupFactory.create().toString()).then((()=>{}))}doRequest(e,t,r,n){return this.shouldRunRequest(c.ComputationType.UIMessage,e,t,r,g.ExecutionType.Async)?(this.processNotifications(),this.doRequestUntyped(c.ComputationType.UIMessage,e,t,r,n)):this.wrapResults(c.ComputationType.UIMessage,this.skippedRequest(e,n),r)}skippedRequest(e,t){P.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}});const r=new n.ResolvablePromise;return r.resolve({kind:"Done",payload:{kind:e,results:[]}}),r}async wrapResults(e,t,r){const n=await this.resolveConflicts(e,t,r);return"Superseded"===n.kind?n:{...n,payload:n.payload.result}}async doRequestUntyped(e,t,r,n,i){const o=this.requestWithCorrelationId(e,t,g.ExecutionType.Async,r,this.idFactory.create(),n,i);return this.wrapResults(e,o,n??a.PluginGroup.Excel)}doSyncRequest(e,t,r,n){return this.shouldRunRequest(c.ComputationType.UIMessage,e,t,r,g.ExecutionType.Sync)?(this.processNotifications(),this.doSyncRequestUntyped(c.ComputationType.UIMessage,e,t,r,n)):this.wrapSyncResponse(c.ComputationType.UIMessage,this.skippedSyncRequest(e,n),r)}skippedSyncRequest(e,t){return P.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}}),{kind:e,results:[]}}wrapSyncResponse(e,t,r){return this.syncResolveConflicts(e,t,r).result}doSyncRequestUntyped(e,t,r,n,i){let a;if(0===this.responseStates[e][t].numSyncComputations)a=this.skippedSyncRequest(t,i);else{const o=this.idFactory.create();a=this.syncRequestWithCorrelationId(e,t,g.ExecutionType.Sync,r,o,n,i)}return this.wrapSyncResponse(e,a,n)}async resolveConflicts(e,t,r){const n=await t;return"Superseded"===n.kind?n:{kind:"Done",payload:this.syncResolveConflicts(e,n.payload,r)}}syncResolveConflicts(e,t,r){const i=t.results.filter((([,e])=>(0,n.isDefined)(e)));return{kind:t.kind,result:this.conflictResolvers[e][t.kind](i,r)}}async doBatchRequest(e,t,r){const a=this.idFactory.create(),o=S.customConflictResolverPluginKinds[e.strategy],s=f.customConflictResolverFactories[e.strategy].create(),u=o.map((()=>!0)),l=new n.ResolvablePromise;for(let n=0;n<o.length;n+=1){const d=o[n],m=e[d];let p;this.shouldRunRequest(c.ComputationType.UIMessage,d,m,t,g.ExecutionType.Async)?(this.processNotifications(),p=this.requestWithCorrelationId(c.ComputationType.UIMessage,d,g.ExecutionType.Async,m,a,t,r??F.DefaultComputationGroup)):p=this.skippedRequest(d,r??F.DefaultComputationGroup),this.resolveConflicts(c.ComputationType.UIMessage,p,t).then((e=>{if(u[n]=!1,"Superseded"===e.kind)l.resolve({kind:"Superseded"});else{const t=e.payload;s.consumeResult(t)}}),(()=>{P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.CustomConflictResolverFailure,failureLevel:i.TraceLevel.Error,path:"FormulaBarScheduler.doBatchRequest",description:`Custom conflict resolver "${e.strategy}" got an exception for plugin kind "${d}". Skipping kind`}}),u[n]=!1,s.consumeResult({kind:d,result:null})}))}const d=(0,n.bindMaybeThenable)(s.promise,(e=>({kind:"Done",payload:e}))),m=await Promise.race([l,d]);for(let e=0;e<o.length;e+=1){const t=o[e];u[e]&&(this.doNotify(N.NotificationKind.conflictResolverEarlyTermination,[a,r??F.DefaultComputationGroup,t]),this.processNotifications())}return m}async updatePrefetchingCache(e){const t=this.createPrefetchingCache(this.syncDataModel,this.idFactory.create()),r=await(e.cache?.getCorrespondingSnapshotID()),n=await(t?.getCorrespondingSnapshotID());return n!==r?(e.cache=t,n):r}notifier(){return this.notifierObject}eventEmitter(){return this.eventEmitterObject}alAnnotationNotifier(){return this.alAnnotationNotifierObject}requester(){return this.requesterObject}syncRequester(){return this.syncRequesterObject}batchRequester(){return this.batchRequesterObject}setServerDataProvider(e){(0,n.isNone)(e)||(this.state={...this.state,serverDataProvider:e})}setActiveCellImpl(e){if((0,n.isNone)(e.docName)||(0,n.isNone)(e.sheetIndex))return void P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.NotificationProcessorFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.setActiveCellImpl",description:"early exit, some of the arguments is None"}});const t=(0,i.documentLoc)(void 0,""),r=(0,i.unsafeGridRange)(e.rowIndex,e.colIndex,1,1),a=(0,i.sheetGridCell)((0,i.sheetIndex)(t,e.sheetIndex),r),o=G(e);this.state={...this.state,activeCell:a,activeCellFormat:o},n.ulsLogger.ULS.traceTag(512274752,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("setActiveCellImpl",{description:`updated activeCell to col: ${a.range.col}, row: ${a.range.row}`}))}setActiveCellFormatImpl(e){const t=G(e);this.state={...this.state,activeCellFormat:t}}getConfig(){return this.syncDataModel.config}startComputation(e,t,r,i,a,o){switch(r){case g.ExecutionType.Internal:case g.ExecutionType.Async:this.enqueueMessage({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:{...this.generateNewComputationInfo(e,t,i,o),generator:a},payload:_},o.startTime+o.timeWindow.startDelta);break;case g.ExecutionType.Sync:this.syncMessageQueue.enqueue({kind:F.SchedulerTimelineQueueMessageKind.StepComputation,computation:{...this.generateNewComputationInfo(e,t,i,o),generator:a},payload:_});break;default:(0,n.assertNever)(`${r}`,r)}}generateNewComputationInfo(e,t,r,n){return{info:{correlationId:n.correlationId,computationGroup:n.computationGroup,type:e,computationKind:t,computationIdentifier:r,pluginFactoryNameString:w[r.factoryName],computationTime:0,schedulerTime:0,requestTimes:{}},cache:n.cache,finalizer:new b.ComputationFinalizer(...this.computationFinalizerHandlers),stopReasonRef:n.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}}getPluginComputations(e){return[...d.computationRegistry.UIMessage.getRegistrationsByPluginIdentifier(e),...d.computationRegistry.Event.getRegistrationsByPluginIdentifier(e)]}createAndAttachPlugin(e,t){this.parent&&this.warmupParse.force();const r=e.create(t);for(const t of this.getPluginComputations(e))switch(t.type){case c.ComputationType.UIMessage:this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;case c.ComputationType.Event:(0,m.isALAnnotationEventKind)(t.kind)&&this.registerALAnnotation(t.kind).catch((e=>{P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.ALFailure,failureLevel:i.TraceLevel.Error,path:"FormulaBarScheduler.createAndAttachPlugin",description:`Failed to register on ${t.kind} AL annotation: ${e}`}})})),this.computationSubjects[t.type][t.execution][t.kind].subscribe(t.registrationMethod(this,r)),this.addToComputationCount(t);break;default:(0,n.assertNever)(`${t}`,t)}return n.ulsLogger.ULS.traceTag(545378970,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,`x10arch.FormulaBarScheduler.createAndAttachPlugin: ${a.PluginFactoryName[e.factoryName]} was attached.`),r}addToComputationCount(e){switch(this.parent&&this.parent.addToComputationCount({type:e.type,kind:e.kind,execution:e.execution,computationIdentifier:e.computationIdentifier}),e.execution){case g.ExecutionType.Async:this.responseStates[e.type][e.kind].attachComputation(e.computationIdentifier);break;case g.ExecutionType.Sync:this.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier)}}attachEventCallbacksManager(e){for(const t of m.ExternallyHandledEventKinds)(0,n.isDefined)(e[t])&&this.computationSubjects[c.ComputationType.Event][g.ExecutionType.Async][t].subscribe((([r,n])=>{try{e[t](r.computationInput)}catch(e){P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.EventCallbacksManagerFailure,failureLevel:i.TraceLevel.Error,path:"FormulaBarScheduler.attachEventCallbacksManager",description:`Failed to call eventCallbacksManager.${t}: ${e}`}})}}))}async registerEventCallback(e,t){this.registerProvider("EventCallbackManager",this.attachEventCallbacksManager.bind(this)).registerEventCallback(e,t)}catchEvent(e){return new Promise(((t,r)=>{const i=this.computationSubjects[c.ComputationType.Event][g.ExecutionType.Async][e.eventKind].subscribe((([r,a])=>{(0,n.isDefined)(e.predicate)&&!e.predicate(r.computationInput)||(this.computationSubjects[c.ComputationType.Event][g.ExecutionType.Async][e.eventKind].unsubscribe(i),t((0,n.success)(r.computationInput)))}));this.enqueueMessage({kind:F.SchedulerTimelineQueueMessageKind.Timeout,type:c.ComputationType.Event,callback:()=>{this.computationSubjects[c.ComputationType.Event][g.ExecutionType.Async][e.eventKind].unsubscribe(i),t((0,n.failure)("Timeout"))}},this.timer.now()+e.timeout)}))}async registerALAnnotation(e){if(void 0!==this.parent)return this.parent.registerALAnnotation(e);let t;try{t=await this.services.AugmentationLoop.toPromise()}catch(e){return P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.ALFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.registerALAnnotation",description:`Error getting AugLoopService: ${e}`}}),(0,n.failure)(e)}return t.registerALAnnotation(e)}async getRecognizedTablesInfo(...e){if((0,n.isDefined)(this.parent))return this.parent.getRecognizedTablesInfo(...e);const t=this.services.TableIntelligence.getCurrentValue();return(0,n.isDefined)(t)?t.getRecognizedRangeTablesInfo(...e):(P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.TableIntelligenceFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.getRecognizedTablesInfo",description:"tableIntelligenceService is not attached yet"}}),(0,n.failure)(void 0))}async sendAugLoopSignal(e,t){if(void 0===this.parent){let r;try{r=await this.services.AugmentationLoop.toPromise()}catch(e){return P.x10Logger.log({kind:"failure",payload:{failureKind:P.X10FailureKind.ALFailure,failureLevel:i.TraceLevel.Warning,path:"FormulaBarScheduler.sendAugLoopSignal",description:`Error getting AugLoopService: ${e}`}}),(0,n.failure)(e)}return r.sendSignal(e,t)}return this.parent.sendAugLoopSignal(e,t)}augloopCloseCallback(){n.ulsLogger.ULS.traceTag(508629987,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")}async createChatGPTSession(e){return void 0===this.parent?(await this.services.ChatGPT.toPromise()).createSession(e):this.parent.createChatGPTSession(e)}async closeChatGPTSession(e){return void 0===this.parent?(await this.services.ChatGPT.toPromise()).closeSession(e):this.parent.closeChatGPTSession(e)}async sendChatGPTQuery(e,t){if(void 0===this.parent){const r=await this.services.ChatGPT.toPromise(),i=await r.request(e,t);return i.kind!==n.ResultKind.Success||(0,n.isDefined)(i.value)?((0,v.staticTypeHint)(i),i):(0,n.failure)(void 0)}return this.parent.sendChatGPTQuery(e,t)}async logAshaErrorEvent(...e){return void 0===this.parent?((0,o.logStandardizedAshaErrorEvent)(...e),(0,n.success)(void 0)):this.parent.logAshaErrorEvent(...e)}shouldRunRequest(e,t,r,n,i){const a=this.responseStates[e][t],o=i===g.ExecutionType.Async?a.attachedComputations:a.attachedSyncComputations;for(const i of o)if(e!==c.ComputationType.UIMessage||W(e,t,i,n,r))return!0;return!1}constructor(e,t,r={...p.defaultPluginResponseWindows},a,o,u=R.defaultTimerInterface,d){this.createPrefetchingCache=t,this.pluginResultWindows=r,this.gridDataSink=a,this.syncDataModel=o,this.timer=u,this.parent=d,this.responseStates=(0,v.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(c.ComputationType).map((e=>[e,(0,v.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(c.ComputationKinds[e]).map((t=>[t,new F.ResponseState(e,t)])))]))),this.uiMessages=(0,v.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(c.ComputationKinds[c.ComputationType.UIMessage]).map((e=>[e,new C.Subject]))),this.syncUIMessages=(0,v.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(c.ComputationKinds[c.ComputationType.UIMessage]).map((e=>[e,new C.Subject]))),this.eventHandlers=(0,v.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(c.ComputationKinds[c.ComputationType.Event]).map((e=>[e,new C.Subject]))),this.conflictResolvers={[c.ComputationType.UIMessage]:h.conflictResolver,[c.ComputationType.Event]:(0,n.mapFromArrayOfPairs)((0,n.strEnumArray)(c.ComputationKinds[c.ComputationType.Event]).map((e=>[e,()=>{}])))},this.computationSubjects={[c.ComputationType.UIMessage]:{[g.ExecutionType.Internal]:this.uiMessages,[g.ExecutionType.Async]:this.uiMessages,[g.ExecutionType.Sync]:this.syncUIMessages},[c.ComputationType.Event]:{[g.ExecutionType.Internal]:this.eventHandlers,[g.ExecutionType.Async]:this.eventHandlers}},this.syncMessageQueue=new n.PriorityQueue((()=>0)),this.doNotifyStatelessSubject=new C.Subject,this.doNotifyStatefulSubject=new C.InitializingSubject((()=>this.syncDataModel.getStateAsNotifications())),this.requestWithCorrelationIdSubject=new C.Subject,this.idFactory=new D,this.eventComputationGroupFactory=new D,this.state={scheduler:this},this.notificationProcessorMap={[N.NotificationKind.setActiveCell]:this.setActiveCellImpl.bind(this),[N.NotificationKind.setActiveCellFormat]:this.setActiveCellFormatImpl.bind(this),[N.NotificationKind.setA1ReferenceStyle]:this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),[N.NotificationKind.setLocale]:this.syncDataModel.setLocale.bind(this.syncDataModel),[N.NotificationKind.setWorkbookProps]:this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),[N.NotificationKind.updateSheetNames]:this.syncDataModel.updateSheetNames.bind(this.syncDataModel),[N.NotificationKind.updateNamedObjects]:this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),[N.NotificationKind.doNothing]:()=>{},[N.NotificationKind.writeRange]:(...e)=>this.gridDataSink?.writeRange(...e),[N.NotificationKind.writeRanges]:(e,t)=>t.map((t=>this.gridDataSink?.writeRange(e,t))),[N.NotificationKind.setNumberFormats]:(...e)=>this.gridDataSink?.setNumberFormats(...e),[N.NotificationKind.setFunctionsInfo]:this.setFunctionInfo.bind(this),[N.NotificationKind.conflictResolverEarlyTermination]:(e,t,r)=>this.stopComputationFrame(e,t,c.ComputationType.UIMessage,r,F.ExecutionStopReason.Frame.ConflictResolverEarlyTermination),[N.NotificationKind.setDefinedNamesInfo]:this.setDefinedNamesInfo.bind(this),[N.NotificationKind.notifyWorkbookClosing]:this.onWorkbookClosing.bind(this),[N.NotificationKind.setSchedulerFeatures]:this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel)},this.notifierObject=(0,y.makeNotifier)(this),this.eventEmitterObject=(0,m.makeEventEmitter)(this),this.alAnnotationNotifierObject=(0,m.makeALAnnotationNotifier)(this),this.requesterObject=(0,p.makeRequester)(this),this.syncRequesterObject=(0,p.makeSyncRequester)(this),this.batchRequesterObject=(0,S.makeBatchRequester)(this),this.notificationQueue=[],this.eventResultWindows=(0,n.mapFromArrayOfPairs)((0,n.strEnumArray)(c.ComputationKinds[c.ComputationType.Event]).map((e=>[e,{startDelta:0,stopDelta:1/0}]))),this.computationResultWindows={[c.ComputationType.UIMessage]:this.pluginResultWindows,[c.ComputationType.Event]:this.eventResultWindows},this.services={Recalc:A.SchedulerService.fromFunction({providerId:"Recalc",subscriberLimit:1e3},A.providerProxy),EventCallbackManager:A.SchedulerService.fromClass({providerId:"EventCallbackManager",subscriberLimit:1e3},m.EventCallbacksManagerService),AugmentationLoop:A.SchedulerService.fromClass({providerId:"AugmentationLoop",subscriberLimit:1e3},s.AugLoopService),ChatGPT:A.SchedulerService.fromClass({providerId:"ChatGPT",subscriberLimit:1e3},l.ChatGPTService),TableIntelligence:A.SchedulerService.fromClass({providerId:"TableIntelligence",subscriberLimit:1e3},T.X10TableIntelligenceService),CopilotLicense:A.SchedulerService.fromFunction({providerId:"CopilotLicense",subscriberLimit:1e3},A.providerProxy),PythonLicense:A.SchedulerService.fromFunction({providerId:"PythonLicense",subscriberLimit:1e3},A.providerProxy)},this.recalcServiceAttached=async()=>this.services.Recalc.toPromise(),this.registerAsyncGrid=()=>this.registerProvider("Recalc",void 0),this.computationFinalizerHandlers=[U],this.warmupParse=(0,O.asyncLazy)((async()=>{const e=this.createPrefetchingCache(this.syncDataModel,-1);if(e){const t=(0,i.documentLoc)(void 0,""),r=(0,i.sheetGridCell)((0,i.sheetIndex)(t,0),(0,i.gridCell)(1,1));e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})}})),n.ulsLogger.ULS.traceTag(537796811,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,P.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:`${(0,M.getExcelOnlineCalcNewPackagesNames)()}`})),this.processor=e(this.consumeMessage.bind(this))}}function B(e,t){switch(t.kind){case E.InternalSchedulerResponseKind.FirstStep:return e.next();case E.InternalSchedulerResponseKind.NormalResponse:return e.next(t.response);case E.InternalSchedulerResponseKind.RequestFailure:return e.throw({kind:t.failure.kind,request:t.request,reason:t.failure.reason});default:(0,n.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}function W(e,t,r,n,i){const a=d.computationRegistry[e].getRegistrationByComputationIdentifier(r)??{type:e,kind:t,modifiers:{},pluginGroup:n};return(0,d.getShouldRunComputationPredicate)(a)(i,n)}function U(e){P.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:`${e.computationInfo.pluginFactoryNameString}.${e.computationInfo.computationIdentifier.computationName}`,stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===F.ExecutionStopReason.Computation.Done&&P.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:e.computationInfo.pluginFactoryNameString,logInfo:e.computationInfo}})}function G(e){let t=null;return(0,n.isNone)(e.formatString)||(0,n.isNone)(e.builtIn)||(t={formatString:e.formatString,builtIn:e.builtIn}),t}t.FormulaBarScheduler=K,K.abstractStepCosts={[F.SchedulerTimelineQueueMessageKind.NoOpRequest]:.01,[F.SchedulerTimelineQueueMessageKind.AsyncRequest]:.1,[F.SchedulerTimelineQueueMessageKind.InternalRequest]:.1,[F.SchedulerTimelineQueueMessageKind.SyncRequest]:.5,[F.SchedulerTimelineQueueMessageKind.StepComputation]:1,[F.SchedulerTimelineQueueMessageKind.StopComputationFrame]:.01,[F.SchedulerTimelineQueueMessageKind.Timeout]:.01}},4380:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCalcGrid=function(e){return new i.RecalcServiceImpl(a,a,a,a,(0,n.asyncLoopFactory)(e))};const n=r(6913),i=r(6766),a=()=>{}},2041:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridImportManager=t.GridProvider=void 0;const n=r(6533),i=r(6913),a=r(5033),o=n.__importStar(r(7882)),s=r(6866),u=r(4691);function l(e,t,r){const{port1:n,port2:o}=new MessageChannel;Promise.all([e.createIGridImportEndpoint({port:o,options:r}),t.createIGridExportEndpoint({port:n,options:r},(()=>e.onGridExporterClosed()))]).catch((t=>{u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.GridFailure,failureLevel:a.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:(0,i.messageFromError)(t)}});try{e.onGridExporterClosed()}catch(t){u.x10Logger.log({kind:"failure",payload:{failureKind:u.X10FailureKind.GridFailure,failureLevel:a.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:`${u.X10FailureKind.GridFailure}: importer threw ${(0,i.messageFromError)(t)}`}})}}))}t.GridProvider=class{getGrid(){return this.gridService?.call}async createIGridImportEndpoint(e){this.onGridExporterClosed();const t=await o.Endpoint.createOutside(e,(e=>{this.gridService={call:void 0,close:()=>e.close("Force")}}));t.hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call))}onGridExporterClosed(){if(!this.gridService)return;const e=this.gridService;this.gridService=void 0,e.close()}constructor(e){this.onGridReady=e,this.gridService=void 0,this.syncDataModel=new s.SyncDataModel,this.getGridDataSink=()=>{},this.getSyncDataModel=()=>this.syncDataModel}},t.GridImportManager=class{onGridExporterCreated(e){this.exporter=e;for(const{importer:t,id:r}of this.importers)l(t,e,{id:r,createTimeout:this.timeout})}onGridImporterCreated(e,t){this.importers.push({importer:e,id:t}),this.exporter&&l(e,this.exporter,{id:t,createTimeout:this.timeout})}constructor(e){this.timeout=e,this.exporter=void 0,this.importers=[]}}},6061:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIEEE754Double=function({lowDword:e,highDword:t}){return n[o]=e,n[s]=t,i[0]};const r=new ArrayBuffer(8),n=new Uint32Array(r),i=new Float64Array(r),a=1===new Uint8Array(new Uint16Array([1]).buffer)[0],[o,s]=a?[0,1]:[1,0]},9273:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NaiveLocalSheetGrid=void 0;const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(4563),u=r(8453);class l{static buildSparseMatrix(e,t){const r=[];for(const[[n,i,a=1,o=1],...s]of e){const e=s.length;for(let u=i,l=0;u<i+o;u+=1)for(let i=n;i<n+a;i+=1,l=(l+1)%e)void 0===r[i]&&(r[i]=[]),r[i][u]=t(s[l],i,u)}return r}static forEachInSparseMatrix(e,t,r=(()=>!1)){let n=!0;return e.forEach(((e,i)=>{n&&e.forEach(((e,a)=>{n&&!r(e)&&(t((0,o.gridCell)(i,a),e)||(n=!1))}))})),n}static unionRanges(e){return e.map(u.createCellSetFromRange).reduce(a.unionProduct,i.empty)}getCellValue(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?(0,n.success)(this.values[e][t]):(0,n.success)(s.emptyRangeValue):(0,n.failure)((0,o.unavailable)(["getCellValue"]))}getCellFormat(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?(0,n.success)(this.formats[e][t]):(0,n.success)(s.emptyRangeFormat):(0,n.failure)((0,o.unavailable)(["getCellFormat"]))}getCellFormula(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?(0,n.success)(this.formulae[e][t]):(0,n.success)(s.emptyRangeFormula):(0,n.failure)((0,o.unavailable)(["getCellFormula"]))}foreachNonBlankCellValue(e){return void 0===this.values||l.forEachInSparseMatrix(this.values,e,(e=>e.kind===o.OperKind.Blank))}foreachNonBlankCellFormula(e){return void 0===this.formulae||l.forEachInSparseMatrix(this.formulae,e,(e=>e.kind===s.emptyRangeFormula.kind&&e.formulaBarText===s.emptyRangeFormula.formulaBarText))}isAvailable(e,t,r){let i;switch(r){case"value":i=this.valueAvailabilitySet;break;case"formula":i=this.formulaAvailabilitySet;break;case"format":i=this.formatAvailabilitySet;break;default:(0,n.assertNever)("isAvailable",r)}return void 0!==i&&((0,a.compareProduct)((0,u.createCellSetFromRange)((0,o.gridCell)(e,t)),i)??1)<=0}constructor(e,t,r,i){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,n.isSuccess)(t)&&(this.values=l.buildSparseMatrix(t.value.nonEmptyCells,(e=>e)),this.valueAvailabilitySet=l.unionRanges(t.value.availableRanges)),(0,n.isSuccess)(i)&&(this.formats=l.buildSparseMatrix(i.value.nonEmptyCells,(e=>e)),this.formatAvailabilitySet=l.unionRanges(i.value.availableRanges)),(0,n.isSuccess)(r)&&(this.formulae=l.buildSparseMatrix(r.value.nonEmptyCells,(e=>e)),this.formulaAvailabilitySet=l.unionRanges(r.value.availableRanges))}}t.NaiveLocalSheetGrid=l,(0,n.staticAssertExtends)()},4366:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNotifier=function(e){const t=e.doNotify.bind(e),r=(0,i.functionMapFromDUFunction)(t,u),n=(0,i.bindMethodsUnbox)(r,u),s=(0,i.bindMethodsNullCheck)(n,u);return l={...s,[o.NotificationKind.notifyWorkbookClosing]:()=>n.notifyWorkbookClosing()},c=a.notificationMethodArgumentsConvertorsMap,(0,i.mapFromArrayOfDependantPairs)(u.map((e=>[e,(...t)=>l[e](...c[e](...t))])));var l,c};const n=r(6913),i=r(3713),a=r(8105),o=r(6410);(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)();const s=[o.NotificationKind.conflictResolverEarlyTermination],u=(0,n.strEnumArray)(o.NotificationKind).filter((function(e){return s.findIndex((t=>t===e))<0}))},8105:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notificationMethodArgumentsConvertorsMap=void 0;const n=r(6913),i=r(6592),a=r(6061),o=r(6410),s=(...e)=>e,u=e=>{if("NamedValue"===e?.kind)switch(e.value.kind){case"Number":return{...e,value:e.value.numberValue};case"String":return{...e,value:e.value.stringValue};case"Boolean":return{...e,value:e.value.booleanValue};case"Error":return{...e,value:e.value}}return e},l=[[i.ErrorType.NULL,e=>0===e],[i.ErrorType.DIV0,e=>7===e],[i.ErrorType.VALUE,e=>15===e||53===e],[i.ErrorType.REF,e=>23===e],[i.ErrorType.NAME,e=>29===e],[i.ErrorType.NUM,e=>36===e],[i.ErrorType.NA,e=>42===e],[i.ErrorType.GETTING_DATA,e=>43===e],[i.ErrorType.SPILL,e=>45===e],[i.ErrorType.CONNECT,e=>46===e],[i.ErrorType.BLOCKED,e=>47===e],[i.ErrorType.UNKNOWN,e=>48===e],[i.ErrorType.FIELD,e=>49===e],[i.ErrorType.CALC,e=>50===e],[i.ErrorType.BUSY,e=>51===e||52===e||54===e],[i.ErrorType.EXTERNAL,()=>!1]];function c(e){switch(e.kind){case"error":for(const[t,r]of l)if(r(e.errorValue))return{kind:"error",errorKind:t};return{kind:"error",errorKind:void 0};case"number":return{kind:"number",value:(0,a.createIEEE754Double)(e)};default:return e}}(0,n.staticAssertSame)(),t.notificationMethodArgumentsConvertorsMap={[o.NotificationKind.doNothing]:s,[o.NotificationKind.setActiveCell]:s,[o.NotificationKind.setActiveCellFormat]:s,[o.NotificationKind.setFunctionsInfo]:s,[o.NotificationKind.setDefinedNamesInfo]:s,[o.NotificationKind.notifyWorkbookClosing]:s,[o.NotificationKind.setSchedulerFeatures]:s,[o.NotificationKind.setA1ReferenceStyle]:s,[o.NotificationKind.setWorkbookProps]:s,[o.NotificationKind.updateSheetNames]:s,[o.NotificationKind.writeRange]:(e,t)=>[e,{...t,values:t.values.map((e=>e.map(c)))}],[o.NotificationKind.writeRanges]:(e,t)=>[e,t.map((e=>({...e,values:e.values.map((e=>e.map(c)))})))],[o.NotificationKind.setLocale]:(...e)=>{const[t]=e;return[{...t,specialRefNames:(0,n.partialArray)({[i.SpecialRefId.All]:t.specialRefNames.All,[i.SpecialRefId.Data]:t.specialRefNames.Data,[i.SpecialRefId.Headers]:t.specialRefNames.Headers,[i.SpecialRefId.ThisRow]:t.specialRefNames.ThisRow,[i.SpecialRefId.Totals]:t.specialRefNames.Totals}),currencyFormat:i.CurrencyFormat[t.currencyFormat],dateOrder:i.DateOrder[t.dateOrder],timeAltSeparator:t.timeAltSeparator,ampmSymbols:[t.ampmSymbols.first,t.ampmSymbols.second]}]},[o.NotificationKind.updateNamedObjects]:(...e)=>{const[t,r]=e;return[t,r.map((e=>({...e,scope:e.scope,objects:e.objects?.map((e=>({...e,data:u(e.data??void 0)}))),fromStateId:e.fromStateId})))]},[o.NotificationKind.setNumberFormats]:s}},3315:function(e,t){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.platform=void 0,t.platform=globalThis.__x10_target_platform??"web",["web","win32"].indexOf(t.platform)<0)throw new Error(`Wrong platform id ${t.platform}`);globalThis.__x10_target_platform=t.platform},2937:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPluginFactory=function(e){const t=s[e];if(!t){const t=o.x10Logger.formatLogMessage("getPluginFactory",{description:`${a.PluginFactoryName[e]} has not been registered`});throw o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.PluginAttachmentFailure,failureLevel:i.TraceLevel.Error,path:"pluginFactory.getPluginFactory",description:`${a.PluginFactoryName[e]} has not been registered`}}),new Error(t)}return t},t.registerPluginFactory=function(e){const t=e.factoryName,r=s[t];if(void 0!==r&&r!==e){const e=o.x10Logger.formatLogMessage("registerPluginFactory",{description:`${a.PluginFactoryName[t]} is already registered`});if(o.x10Logger.log({kind:"failure",payload:{failureKind:o.X10FailureKind.PluginAttachmentFailure,failureLevel:i.TraceLevel.Error,path:"pluginFactory.registerPluginFactory",description:`${a.PluginFactoryName[t]} is already registered`}}),!(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(e)}s[t]=e,o.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:t}})};const n=r(6913),i=r(6592),a=r(1633),o=r(4691),s=(0,n.makeStringMap)()},7894:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveScriptLoaderPromise=function(e){o.scriptLoaderPromise.resolve(e)},t.setX10Features=function(e){A.PluginSchedulerSingleton.instance().doNotify(T.NotificationKind.setSchedulerFeatures,[e.map((e=>a.SchedulerFeature[e]))])},t.ensurePluginAttached=M,t.ensureGroupAttached=async function(e){let t=0;const r=A.PluginSchedulerSingleton.instance();for(const i of(n=I[k.platform](r),Object.keys(n).map((e=>parseInt(e,10)))))D(i,e)&&await M(i)&&(t+=1);var n;return t};const n=r(6913),i=r(6592),a=r(1633),o=r(8795),s=r(5233),u=r(4001),l=r(4414),c=r(7068),d=r(8388),m=r(9809),g=r(6067),p=r(5591),h=r(4017),f=r(3592),S=r(4803),v=r(6723),y=r(5722),F=r(5706),b=r(7146),C=r(1210),k=r(3315),E=r(4092),A=r(3948),T=r(6410),R=r(6646),N=r(4691),I={web:()=>({[a.PluginFactoryName.ArgumentAssistancePlugin]:[l.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],[a.PluginFactoryName.AutocompletePlugin]:[v.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],[a.PluginFactoryName.AutocompleteFunctionPlugin]:[d.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[a.PluginFactoryName.ParenthesesCouplingPlugin]:[b.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],[a.PluginFactoryName.ColoredReferencesPlugin]:[F.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],[a.PluginFactoryName.GotoCtrlClickPlugin]:[C.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],[a.PluginFactoryName.AutocompleteLetPlugin]:[m.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[a.PluginFactoryName.AutocompleteRichValuePlugin]:[p.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[a.PluginFactoryName.FormulaCollectionPlugin]:[y.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],[a.PluginFactoryName.AutocompleteNamedObjectsPlugin]:[g.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[a.PluginFactoryName.ParserPerformanceMeasurements]:[v.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],[a.PluginFactoryName.AutocompleteTableHeadersPlugin]:[h.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],[a.PluginFactoryName.ValuePreviewPlugin]:[R.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],[a.PluginFactoryName.SyntaxErrorsPlugin]:[u.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],[a.PluginFactoryName.AutocompleteRangeSuggestionPlugin]:[v.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],[a.PluginFactoryName.AutocompleteWrapperPlugin]:[v.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],[a.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]:[v.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],[a.PluginFactoryName.FormulaRepairShadowEvalPlugin]:[u.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],[a.PluginFactoryName.PythonAutocompletePlugin]:[E.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],[a.PluginFactoryName.PythonSyntaxHighlightingPlugin]:[E.pythonSyntaxHighlightingPluginAttach,"Microsoft.Office.Excel.x10PythonSyntaxHighlightingEnabled"],[a.PluginFactoryName.PythonTooltipPlugin]:[E.pythonTooltipPluginAttach,"Microsoft.Office.Excel.x10PythonTooltipEnabled"],[a.PluginFactoryName.ChatGPTPlugin]:[v.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],[a.PluginFactoryName.FormulaByExamplePlugin]:[u.formulaByExamplePluginAttach,void 0,"OfficeVSO:9683390_FormulaByExamplePlugin"],[a.PluginFactoryName.FormulaCompletionPlugin]:[u.formulaCompletionPluginAttach,"Microsoft.Office.Excel.FormulaCompletionPluginEnabled"],[a.PluginFactoryName.TestPlugin]:[o.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],[a.PluginFactoryName.AutocompleteEnumPlugin]:[f.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],[a.PluginFactoryName.FormulaTranspilerPlugin]:[u.formulaTranspilerPluginAttach,"Microsoft.Office.Excel.FileOptimization"],[a.PluginFactoryName.InCellControlsAutodetectionPlugin]:[u.inCellControlsAutodetectionPluginAttach,"Microsoft.Office.Excel.InCellControlsAutodetection"],[a.PluginFactoryName.ValueErrorHighlightPlugin]:[u.valueErrorHighlightPluginAttach,"Microsoft.Office.Excel.ValueErrorHighlightPlugin"],[a.PluginFactoryName.AutocompleteCopilotPlugin]:[c.autocompleteCopilotPluginDependenciesResolved,void 0,void 0,"CopilotFormulaGeneration"],[a.PluginFactoryName.FormulaAuthoringCopilotIPEPlugin]:[S.formulaAuthoringCopilotIPEPluginDependenciesResolved,void 0,"OfficeVSO:9848728_refactorFormulaCopilotIPERequest","CopilotFormulaGeneration"]}),win32:e=>{const t=(0,s.perWorkbookInitializers)(e);return{[a.PluginFactoryName.FormulaByExamplePlugin]:[t.formulaByExamplePluginAttached,"Microsoft.Office.Excel.X10FBEDesktopPluginEnabled","OfficeVSO:9510546_X10FBEDesktopPluginChangeGate"],[a.PluginFactoryName.FormulaCompletionPlugin]:[t.formulaCompletionPluginAttached,"Microsoft.Office.Excel.FormulaCompletionPluginEnabled"],[a.PluginFactoryName.GetLocalePlugin]:[t.cleanDataPluginAttached,"Microsoft.Office.Excel.GetLocalePluginEnabled"],[a.PluginFactoryName.InCellControlsAutodetectionPlugin]:[t.inCellControlsAutodetectionPluginAttachWin32,"Microsoft.Office.Excel.InCellControlsAutodetectionWin32"]}}},P={[a.PluginAttachGroup.Core]:!0,[a.PluginAttachGroup.Python]:!1,[a.PluginAttachGroup.SmartSuggestionsAutoComplete]:!1};(0,n.staticAssertExtends)();const O={[a.PluginAttachGroup.Core]:{[a.PluginFactoryName.AutocompletePlugin]:!1},[a.PluginAttachGroup.Python]:{},[a.PluginAttachGroup.SmartSuggestionsAutoComplete]:{[a.PluginFactoryName.AutocompletePlugin]:!0}};async function M(e){const t=A.PluginSchedulerSingleton.instance(),r=I[k.platform](t)[e];if(void 0===r)return!1;const o=t.getSchedulerFeatures(),[s,u,l,c]=r;if((void 0===u||(0,n.getTypedFeatureGate)(u))&&(void 0===l||(0,n.isTypedChangeGateEnabled)(l))&&(void 0===c||-1!==o.indexOf(a.SchedulerFeature[c])))try{return await s.getValue(),!0}catch(t){N.x10Logger.log({kind:"failure",payload:{failureKind:N.X10FailureKind.PluginAttachmentFailure,failureLevel:i.TraceLevel.Error,path:"ensurePluginAttached",description:`Failed to ensure plugin "${a.PluginFactoryName[e]}" is attached with exception`,data:t}})}return!1}function D(e,t){return O[t][e]??P[t]}},8795:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoCompletePluginsThread=t.workerThreadInitialized=t.workerThreadSpread=t.dynamicPluginLoaderCreated=t.schedulerWithTableIntelligenceServiceAttached=t.schedulerWithRecalcServiceAttached=t.scriptLoaderPromise=t.FormulaAuthoringStringsOnMainThread=void 0;const n=r(6913),i=r(1633),a=r(4352),o=r(3948),s=r(9615);t.FormulaAuthoringStringsOnMainThread=(0,s.trackableAsyncLazy)((async()=>{const e=await t.dynamicPluginLoaderCreated.getValue();await e.loadPluginScript("formula-authoring-strings",!0)}),"FormulaAuthoringStringsOnMainThread"),t.scriptLoaderPromise=new n.ResolvablePromise,t.schedulerWithRecalcServiceAttached=(0,s.trackableAsyncLazy)((async()=>{const e=o.PluginSchedulerSingleton.instance();return u.getValue()&&await t.FormulaAuthoringStringsOnMainThread.getValue(),await e.recalcServiceAttached(),e}),"schedulerWithRecalcServiceAttached"),t.schedulerWithTableIntelligenceServiceAttached=(0,s.trackableAsyncLazy)((async()=>{const e=o.PluginSchedulerSingleton.instance();return await e.services.TableIntelligence,e}),"schedulerWithTableIntelligenceServiceAttached"),t.dynamicPluginLoaderCreated=(0,s.trackableAsyncLazy)((async()=>{const e=await t.scriptLoaderPromise;return(0,o.createDynamicPluginLoader)(e)}),"dynamicPluginLoaderCreated"),t.workerThreadSpread=(0,s.trackableAsyncLazy)((async()=>(await t.dynamicPluginLoaderCreated.getValue()).createPluginThread("worker")),"workerThreadSpread"),t.workerThreadInitialized=(0,s.trackableAsyncLazy)((async()=>{await t.workerThreadSpread.getValue()}),"workerThreadInitialized"),t.autoCompletePluginsThread=(0,s.trackableAsyncLazy)((async()=>{let e;return e=(0,n.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?await t.dynamicPluginLoaderCreated.getValue():await t.workerThreadSpread.getValue(),e}),"autoCompletePluginsThread");const u=new a.ResettableLazy((()=>{const e=o.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(i.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(i.SchedulerFeature.ArgumentAssistance)}))},5233:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.perWorkbookInitializers=function(e){return{formulaByExamplePluginAttached:new a.TrackableAsyncLazy((async()=>{const t=(0,i.getPluginFactory)(n.PluginFactoryName.FormulaByExamplePlugin);await o.getValue(),e.createAndAttachPlugin(t)}),"win32FormulaByExamplePluginAttached"),formulaCompletionPluginAttached:new a.TrackableAsyncLazy((async()=>{const t=(0,i.getPluginFactory)(n.PluginFactoryName.FormulaCompletionPlugin);e.createAndAttachPlugin(t)}),"win32FormulaCompletionPluginAttached"),cleanDataPluginAttached:new a.TrackableAsyncLazy((async()=>{const t=(0,i.getPluginFactory)(n.PluginFactoryName.GetLocalePlugin);e.createAndAttachPlugin(t)}),"win32CleanDataPluginAttached"),inCellControlsAutodetectionPluginAttachWin32:new a.TrackableAsyncLazy((async()=>{const t=(0,i.getPluginFactory)(n.PluginFactoryName.InCellControlsAutodetectionPlugin);e.createAndAttachPlugin(t)}),"win32InCellControlsAutodetectionPluginAttached")}};const n=r(1633),i=r(2937),a=r(9615),o=new a.TrackableAsyncLazy((async()=>42),"singletonInit")},4001:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorHighlightPluginAttach=t.inCellControlsAutodetectionPluginAttach=t.formulaTranspilerPluginAttach=t.formulaCompletionPluginAttach=t.formulaByExamplePluginAttach=t.formulaRepairShadowEvalPluginDependenciesResolved=t.syntaxErrorsPluginDependenciesResolved=void 0;const n=r(1633),i=r(246),a=r(8795),o=r(9615),s=(0,o.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();return await e.loadPluginScript("excelOnlineX10Plugins",!1),e}),"threadWithExcelOnlineX10PluginsScriptLoaded"),u=(0,o.trackableAsyncLazy)((async()=>{const e=await a.dynamicPluginLoaderCreated.getValue();return await e.loadPluginScript("excelOnlineX10Plugins",!0),e}),"mainThreadWithExcelOnlineX10PluginsScriptLoaded");t.syntaxErrorsPluginDependenciesResolved=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.SyntaxErrorsPlugin)}),"syntaxErrorsPluginDependenciesResolved"),t.formulaRepairShadowEvalPluginDependenciesResolved=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaRepairShadowEvalPlugin)}),"formulaRepairShadowEvalPluginDependenciesResolved"),t.formulaByExamplePluginAttach=(0,o.trackableAsyncLazy)((async()=>{if((0,i.getBooleanFeatureGate)("Microsoft.Office.Excel.FBEPluginOnMainThread",!1)){const e=await u.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),(0,i.isChangeGateEnabled)("OfficeVSO:9674315_FBEGenerateExplanationInPlugin")&&await e.loadPluginScript("excel-formula-by-example-strings",!0),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaByExamplePlugin)}else{const e=await s.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),(0,i.isChangeGateEnabled)("OfficeVSO:9674315_FBEGenerateExplanationInPlugin")&&await e.loadPluginScript("excel-formula-by-example-strings",!0),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaByExamplePlugin)}}),"formulaByExamplePluginAttach"),t.formulaCompletionPluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaCompletionPlugin,(0,i.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaCompletionDebugMode",!1))}),"formulaCompletionPluginAttach"),t.formulaTranspilerPluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();await e.loadPluginScript("excelOnlineFormulaTranspiler",!1),await e.createAndAttachPlugin(n.PluginFactoryName.FormulaTranspilerPlugin)}),"formulaTranspilerPluginAttach"),t.inCellControlsAutodetectionPluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.InCellControlsAutodetectionPlugin)}),"inCellControlsAutodetectionPluginAttach"),t.valueErrorHighlightPluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await a.schedulerWithRecalcServiceAttached.getValue(),await e.createAndAttachPlugin(n.PluginFactoryName.ValueErrorHighlightPlugin)}),"valueErrorHighlightPluginAttach")},6307:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseState=t.ExecutionStopReason=t.FrameExecutionStopReason=t.SchedulerTimelineQueueMessageKind=t.delay=t.recalcNotificationKinds=t.ComputationRequestExecutionType=t.ComputationRequestKind=t.DefaultComputationGroup=void 0,t.typedRequest=c,t.serviceCall=d,t.serviceGeneratorProxy=function(e){return new Proxy({},{get:(t,r,n)=>function*(...t){return yield*d({service:e,method:r,args:t})}})},t.awaitPromise=function*(e){const r=yield{kind:t.ComputationRequestKind.AwaitPromise,promise:e};return(0,n.assertTrue)("Response kind coincides with request kind",r.kind===t.ComputationRequestKind.AwaitPromise),r.result};const n=r(6913),i=r(6700),a=r(3713),o=r(8824),s=r(6410),u=r(1830),l=r(4691);function*c(e,t){const r=yield{kind:e,...t};return(0,n.assertTrue)("Response kind coincides with request kind",r.kind===e),(0,a.staticTypeHint)(r),r}function*d(e){const t=yield*c("InternalService",e);return(0,n.assertTrue)("Service response coincides with actual call",t.service===e.service&&t.method===e.method),(0,a.staticTypeHint)(t),t.response}var m,g,p;t.DefaultComputationGroup="",t.ComputationRequestKind={AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",AwaitBatch:"AwaitBatch",AwaitEvent:"AwaitEvent",AwaitPromise:"AwaitPromise",AwaitTask:"AwaitTask",CloseChatGPTSession:"CloseChatGPTSession",CreateChatGPTSession:"CreateChatGPTSession",CreateTask:"CreateTask",Delay:"Delay",EvalFormula:"EvalFormula",EvalFormulaTree:"EvalFormulaTree",EvalOnClonedModel:"EvalOnClonedModel",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetCell:"GetCell",GetConfig:"GetConfig",GetContainingTable:"GetContainingTable",GetCopilotLicense:"GetCopilotLicense",GetCorrelationId:"GetCorrelationId",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetCultureTag:"GetCultureTag",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",GetEditFormat:"GetEditFormat",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",GetFunctionInfo:"GetFunctionInfo",GetFunctionsInfo:"GetFunctionsInfo",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetIformat:"GetIformat",GetIntersectingTables:"GetIntersectingTables",GetPythonLicense:"GetPythonLicense",GetPythonType:"GetPythonType",GetRange:"GetRange",GetSheetNames:"GetSheetNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetRecognizedRangeTables:"GetRecognizedRangeTables",GetRichValueFieldListContext:"GetRichValueFieldListContext",InternalService:"InternalService",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",LogAshaErrorEvent:"LogAshaErrorEvent",ParseActiveCell:"ParseActiveCell",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",PromiseToTask:"PromiseToTask",ResolveReferences:"ResolveReferences",SendAugLoopSignal:"SendAugLoopSignal",SendChatGPTQuery:"SendChatGPTQuery",SetActiveCell:"SetActiveCell",TriggerEvent:"TriggerEvent",UnsafeGetContainingTable:"UnsafeGetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",UnsafeGetNamedObject:"UnsafeGetNamedObject",UpdateSnapshot:"UpdateSnapshot"},(0,n.staticAssertExtends)(),t.ComputationRequestExecutionType={[t.ComputationRequestKind.AwaitAll]:i.ExecutionType.Async,[t.ComputationRequestKind.AwaitAny]:i.ExecutionType.Async,[t.ComputationRequestKind.AwaitBatch]:i.ExecutionType.Async,[t.ComputationRequestKind.AwaitEvent]:i.ExecutionType.Async,[t.ComputationRequestKind.AwaitPromise]:i.ExecutionType.Async,[t.ComputationRequestKind.AwaitTask]:i.ExecutionType.Async,[t.ComputationRequestKind.CloseChatGPTSession]:i.ExecutionType.Async,[t.ComputationRequestKind.CreateChatGPTSession]:i.ExecutionType.Async,[t.ComputationRequestKind.CreateTask]:i.ExecutionType.NoOp,[t.ComputationRequestKind.Delay]:i.ExecutionType.NoOp,[t.ComputationRequestKind.EvalFormula]:i.ExecutionType.Async,[t.ComputationRequestKind.EvalFormulaTree]:i.ExecutionType.Async,[t.ComputationRequestKind.EvalOnClonedModel]:i.ExecutionType.Async,[t.ComputationRequestKind.GetActiveCell]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetActiveCellFormat]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetAvailableTableHeaders]:i.ExecutionType.Sync,[t.ComputationRequestKind.GetCell]:i.ExecutionType.Async,[t.ComputationRequestKind.GetConfig]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetContainingTable]:i.ExecutionType.Async,[t.ComputationRequestKind.GetCopilotLicense]:i.ExecutionType.Async,[t.ComputationRequestKind.GetCorrelationId]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetCorrespondingSnapshotID]:i.ExecutionType.Async,[t.ComputationRequestKind.GetCultureTag]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetDefinedNamesInfo]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetDefinedNameInfo]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetEditFormat]:i.ExecutionType.Async,[t.ComputationRequestKind.GetFullTableHeadersFromServer]:i.ExecutionType.Async,[t.ComputationRequestKind.GetFunctionInfo]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetFunctionsInfo]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetHiddenRows]:i.ExecutionType.Async,[t.ComputationRequestKind.GetHiddenCols]:i.ExecutionType.Async,[t.ComputationRequestKind.GetIformat]:i.ExecutionType.Async,[t.ComputationRequestKind.GetIntersectingTables]:i.ExecutionType.Async,[t.ComputationRequestKind.GetRange]:i.ExecutionType.Async,[t.ComputationRequestKind.GetSheetNames]:i.ExecutionType.Sync,[t.ComputationRequestKind.GetStructRefColumn]:i.ExecutionType.Sync,[t.ComputationRequestKind.GetStructRefSpecialRef]:i.ExecutionType.Sync,[t.ComputationRequestKind.GetRecognizedRangeTables]:i.ExecutionType.Async,[t.ComputationRequestKind.GetRichValueFieldListContext]:i.ExecutionType.Async,[t.ComputationRequestKind.InternalService]:i.ExecutionType.Internal,[t.ComputationRequestKind.IsSchedulerFeatureEnabled]:i.ExecutionType.NoOp,[t.ComputationRequestKind.LogAshaErrorEvent]:i.ExecutionType.Async,[t.ComputationRequestKind.ParseActiveCell]:i.ExecutionType.Sync,[t.ComputationRequestKind.ParseCellFormula]:i.ExecutionType.Sync,[t.ComputationRequestKind.ParseEdit]:i.ExecutionType.Async,[t.ComputationRequestKind.ParseNumberFormat]:i.ExecutionType.Sync,[t.ComputationRequestKind.PrintFormula]:i.ExecutionType.Sync,[t.ComputationRequestKind.PromiseToTask]:i.ExecutionType.NoOp,[t.ComputationRequestKind.GetPythonLicense]:i.ExecutionType.Async,[t.ComputationRequestKind.GetPythonType]:i.ExecutionType.Async,[t.ComputationRequestKind.ResolveReferences]:i.ExecutionType.Sync,[t.ComputationRequestKind.SendAugLoopSignal]:i.ExecutionType.Async,[t.ComputationRequestKind.SendChatGPTQuery]:i.ExecutionType.Async,[t.ComputationRequestKind.SetActiveCell]:i.ExecutionType.NoOp,[t.ComputationRequestKind.TriggerEvent]:i.ExecutionType.NoOp,[t.ComputationRequestKind.UnsafeGetContainingTable]:i.ExecutionType.Sync,[t.ComputationRequestKind.UnsafeGetContainingTableName]:i.ExecutionType.Sync,[t.ComputationRequestKind.UnsafeGetIntersectingTableNames]:i.ExecutionType.Sync,[t.ComputationRequestKind.UnsafeGetNamedObject]:i.ExecutionType.Sync,[t.ComputationRequestKind.UpdateSnapshot]:i.ExecutionType.Async},(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),t.recalcNotificationKinds=[s.NotificationKind.setA1ReferenceStyle,s.NotificationKind.setLocale,s.NotificationKind.setWorkbookProps,s.NotificationKind.updateSheetNames,s.NotificationKind.updateNamedObjects],t.delay={kind:t.ComputationRequestKind.Delay},function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.InternalRequest=1]="InternalRequest",e[e.AsyncRequest=2]="AsyncRequest",e[e.SyncRequest=3]="SyncRequest",e[e.StepComputation=4]="StepComputation",e[e.StopComputationFrame=5]="StopComputationFrame",e[e.Timeout=6]="Timeout"}(m||(t.SchedulerTimelineQueueMessageKind=m={})),(0,n.staticAssertExtends)(),function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"}(g||(t.FrameExecutionStopReason=g={})),function(e){e.Done="Done",e.Skipped="Skipped",e.Exception="Exception"}(p||(p={})),t.ExecutionStopReason={Unknown:"Unknown",Frame:g,Computation:p},t.ResponseState=class{computationFrame(e){return this._computationFrames.get(e)}get attachedComputations(){return[...this._attachedComputations]}get attachedSyncComputations(){return[...this._attachedSyncComputations]}get numComputations(){return this._attachedComputations.length}get numSyncComputations(){return this._attachedSyncComputations.length}attachComputation(e){this._attachedComputations.push(e)}attachSyncComputation(e){this._attachedSyncComputations.push(e)}createFrame(e,r,a,s,u,l,c,d){const m=new n.ResolvablePromise,g=this.computationKind,p={type:this.computationType,correlationId:e,computationGroup:r,computationInput:s,cache:u,config:l,startTime:c,timeWindow:d,successfulResults:{kind:g,results:[]},resolvable:m,stopReasonRef:new o.Ref(t.ExecutionStopReason.Unknown),numOfComputations:a===i.ExecutionType.Async?this.numComputations:this.numSyncComputations,numFailures:0,numSkippedComputations:0};return this._computationFrames.set(r,p),m}closeFrame(e,r,n){const i=this.computationFrame(e);if(!i)return;this._computationFrames.delete(e),i.stopReasonRef.value=r,i.resolvable.resolve(r===t.ExecutionStopReason.Frame.Superseded?{kind:"Superseded"}:{kind:"Done",payload:i.successfulResults}),i.cache?.close();const{computationKind:a,numComputations:o,numSyncComputations:s}=this,{correlationId:c,startTime:d,numSkippedComputations:m,successfulResults:g}=i,p=g.results.length,h={correlationId:c,type:this.computationType,computationKind:a,computationGroup:e,numComputations:o,numSyncComputations:s,numSent:p,numSkippedComputations:m,stopReason:r,startTime:d,stopTime:n};l.x10Logger.log({kind:"closeComputationFrame",payload:h}),(0,u.sendX10UsedTelemetryEvent)()}stop(e,t,r){void 0!==this.computationFrame(e)&&this.closeFrame(e,t,r)}constructor(e,t){this.computationType=e,this.computationKind=t,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map}}},3385:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefetchingCache=void 0;const n=r(6913),i=r(9668),a=r(9610),o=r(6592),s=r(1159),u=r(1475),l=r(391),c=r(9273),d=r(4691),m=r(8453),g=r(3693);function p({hasHeadersRow:e,hasTotalsRow:t,dataRange:r}){return(0,o.gridRange)(r.row-Number(e),r.col,r.rows+Number(e)+Number(t),r.cols)}function h(e,t,r,i){const{name:a,hasHeadersRow:s,hasTotalsRow:u,dataRange:l,columns:c}=t,d=s?(0,o.gridRange)(l.row-1,l.col,1,l.cols):void 0,m=u?(0,o.gridRange)(l.row+l.rows,l.col,1,l.cols):void 0,g={};let p=n.RedBlackMapTree.create(e.stringCompareCI);for(const e of c)g[e.column]=e,p=p.setValue(e.name,e);return{name:a,sheet:r,dataRange:l,headersRange:d,totalsRange:m,allRange:i,indexToColumn:g,nameToColumn:p,allColumnNamesAvailable:c.length===l.cols}}function f(e,t){return((0,a.compareProduct)((0,m.createCellSetFromRange)(t),e)??1)<=0}const S=(0,n.failure)((0,o.unavailable)(["getCell"])),v=(0,n.failure)((0,o.unavailable)(["getContainingTable"])),y=(0,n.failure)((0,o.unavailable)(["getIntersectingTables"])),F=(0,n.failure)((0,o.unavailable)(["getIntersectingTableNames"])),b=(0,n.failure)((0,o.unavailable)(["getIformats"])),C=(0,n.failure)((0,o.unavailable)(["GetAvailableTableHeaders"])),k=(0,n.failure)((0,o.unavailable)(["GetNamedObject"]));class E{static getOrFetchTile(e,t,r){const n=t.range.row>>>E.tileHeightPow,i=t.range.col>>>E.tileWidthPow;void 0===e[n]&&(e[n]=[]);const a=e[n][i];return void 0===a?r((0,o.sheetGridRange)(t.sheet,(0,o.gridRange)(n<<E.tileHeightPow,i<<E.tileWidthPow,1<<E.tileHeightPow,1<<E.tileWidthPow))).then((t=>e[n][i]=t)):a}static create(e,t,r){return new E(e,t,r)}getSheetContents(e){return this.sheet2contents[e]??(this.sheet2contents[e]={cellTiles:[],tables:(0,o.makeGridRangeTable)(),tableTiles:[],hiddenRows:i.empty,hiddenRowsAvailability:i.empty,hiddenCols:i.empty,hiddenColsAvailability:i.empty})}getCurrentDocumentLoc(){return this.currentDocumentLoc}getSheetNames(){if(void 0===this.sheetNames){const e=[];this.syncDataStore.sheets?.forEachSheet((t=>{e.push({sheetIndex:t.sheetIndex,sheetName:t.name})}));const t={};let r=n.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI);for(let n=0;n<e.length;n+=1){const{sheetIndex:i,sheetName:a}=e[n];t[i.index]=n,r=r.setValue(a,n)}const i=this.getCurrentDocumentLoc();this.sheetNames={document:i,sheets:e,idToIndex:t,nameToIndex:r}}return(0,n.success)(this.sheetNames)}getRangeValues(e){return this.grid.getRangeValues(this.correlationId,e)}getRangeFormulae(e){return this.grid.getRangeFormulae(this.correlationId,e)}getRangeFormats(e){return this.grid.getRangeFormats(this.correlationId,e)}async getHiddenRows(e,t,r){const a=this.getSheetContents(e.index),s=m.bspFactory.row([t,r]),l=(0,i.compare)(s,a.hiddenRowsAvailability);if(0!==l&&-1!==l){const s=await this.grid.getHiddenRows(this.correlationId,e,(0,n.fastMax)(0,t-10),(0,n.fastMin)(o.sheetRows,r+10));a.hiddenRows=s.hidden.reduce(((e,{start:t,end:r})=>(0,i.union)(e,m.bspFactory.row([t,r]))),a.hiddenRows),a.hiddenRowsAvailability=s.available.reduce(((e,{start:t,end:r})=>(0,i.union)(e,m.bspFactory.row([t,r]))),a.hiddenRowsAvailability)}const c=[];(0,m.forEachRow)((0,i.intersect)(a.hiddenRowsAvailability,s),(([e,t])=>(c.push((0,u.interval)(e,t)),!0)));const d=[];return(0,m.forEachRow)((0,i.intersect)(a.hiddenRows,s),(([e,t])=>(d.push((0,u.interval)(e,t)),!0))),{available:c,hidden:d}}async getHiddenCols(e,t,r){const a=this.getSheetContents(e.index),s=m.bspFactory.col([t,r]),l=(0,i.compare)(s,a.hiddenColsAvailability);if(0!==l&&-1!==l){const s=await this.grid.getHiddenCols(this.correlationId,e,(0,n.fastMax)(0,t-10),(0,n.fastMin)(o.sheetCols,r+10));a.hiddenCols=s.hidden.reduce(((e,{start:t,end:r})=>(0,i.union)(e,m.bspFactory.col([t,r]))),a.hiddenCols),a.hiddenColsAvailability=s.available.reduce(((e,{start:t,end:r})=>(0,i.union)(e,m.bspFactory.col([t,r]))),a.hiddenColsAvailability)}const c=[];(0,m.forEachCol)((0,i.intersect)(a.hiddenColsAvailability,s),(([e,t])=>(c.push((0,u.interval)(e,t)),!0)));const d=[];return(0,m.forEachCol)((0,i.intersect)(a.hiddenCols,s),(([e,t])=>(d.push((0,u.interval)(e,t)),!0))),{available:c,hidden:d}}async getRange(e,t){const r=void 0===t||t.indexOf("values")>-1,i=void 0===t||t.indexOf("formulae")>-1,a=void 0===t||t.indexOf("formats")>-1,s=(0,n.failure)((0,o.unavailable)(["getRange"])),[u,l,d]=await Promise.all([r?this.getRangeValues(e):s,i?this.getRangeFormulae(e):s,a?this.getRangeFormats(e):s]);return new c.NaiveLocalSheetGrid(e.sheet,u,l,d)}getCell(e){const t=this.getSheetContents(e.sheet.index),r=E.getOrFetchTile(t.cellTiles,e,(async t=>{const[r,i,a]=[await this.grid.getRangeValues(this.correlationId,t),await this.grid.getRangeFormulae(this.correlationId,t),await this.grid.getRangeFormats(this.correlationId,t)];return(0,n.isSuccess)(r)&&(0,n.isSuccess)(i)&&(0,n.isSuccess)(a)?new c.NaiveLocalSheetGrid(e.sheet,r,i,a):"unavailable"}));return(0,n.bindMaybeThenable)(r,(t=>{if("unavailable"===t)return S;const r=t.getCellValue(e.range.row,e.range.col),i=t.getCellFormula(e.range.row,e.range.col),a=t.getCellFormat(e.range.row,e.range.col);return(0,n.isSuccess)(r)&&(0,n.isSuccess)(i)&&(0,n.isSuccess)(a)?(0,n.success)({value:r.value,formula:i.value,format:a.value}):S}))}getNamedObject(e){const t=this.syncDataStore.nameManager;if(!t)return k;const r=t.getAllDocumentNames().find((t=>t.name===e));if(!r)return k;const i=t.getNameFormula(r,g.NameSource.Plain);return(0,n.success)(i)}getAvailableTableHeaders(e){const t=this.syncDataStore.nameManager;if(!t)return C;const r=t.getAllDocumentNames().find((t=>t.name===e));if(!r)return C;const i=t.getAvailableTableColumns(r);return(0,n.success)(i)}getStructRefColumn(e,t){const r=this.syncDataStore.getStructRefColumn(e,t);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,o.unavailable)(["getStructRefColumn"])):r}getStructRefSpecialRef(e,t){const r=this.syncDataStore.getStructRefSpecialRef(e,t);return r.kind===n.ResultKind.Failure?(0,n.failure)((0,o.unavailable)(["getStructRefSpecialRef"])):r}getContainingTableName(e){const t=this.syncDataStore.getContainingTable(e);return t.kind===n.ResultKind.Failure?(0,n.failure)((0,o.unavailable)(["getContainingTableName"])):t}getContainingTableSync(e){const t=this.syncDataStore.getContainingTable(e);if(t.kind===n.ResultKind.Failure)return(0,n.failure)((0,o.unavailable)(["getContainingTableName"]));if(void 0===t.value||null===t.value)return(0,n.success)(void 0);const r=this.getNamedObject(t.value.name);if(r.kind===n.ResultKind.Failure||r.value.kind===n.ResultKind.Failure)return(0,n.failure)((0,o.unavailable)(["getNamedObject"]));const i=r.value.value?.obj;return void 0!==i&&"NamedTable"!==i.kind?(0,n.failure)((0,o.unavailable)(["getNamedObject"])):(0,n.success)(i)}async getContainingTable(e){const t=this.getSheetContents(e.sheet.index),r=E.getOrFetchTile(t.tableTiles,e,(async r=>{const o=await this.grid.getIntersectingTables(this.correlationId,r);if(!(0,n.isSuccess)(o))return"unavailable";const s=o.value.availableRanges.map(m.createCellSetFromRange).reduce(a.unionProduct,i.empty);for(const r of o.value.tables){const n=p(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,h(this.syncDataStore.config.localeInfo,r,e.sheet,n)))}return s}));return(0,n.bindMaybeThenable)(r,(r=>{if("unavailable"===r)return v;let i;return t.tables.forEachGe(e.range,((e,t)=>(i=t,!1))),void 0!==i||f(r,e.range)?(0,n.success)(i):v}))}async getIntersectingTables(e){const t=this.getSheetContents(e.sheet.index);let r=i.empty;for(let i=e.range.row,s=e.range.row+e.range.rows;i<s;i+=1<<E.tileHeightPow)for(let s=e.range.col,u=e.range.col+e.range.cols;s<u;s+=1<<E.tileWidthPow){const u=E.getOrFetchTile(t.tableTiles,(0,o.sheetGridCell)(e.sheet,(0,o.gridCell)(i,s)),(e=>this.fetchTableTile(e.sheet,t,e))),l=(0,n.isThenable)(u)?await u:u;if("unavailable"===l)return y;r=(0,a.unionProduct)(r,l)}const s=[];return t.tables.forEachMeets(e.range,((e,t)=>(s.push(t),r=(0,a.unionProduct)(r,(0,m.createCellSetFromRange)(e)),!0))),f(r,e.range)?(0,n.success)(s):y}getIntersectingTableNames(e){if(void 0===this.syncDataStore.nameManager)return F;const t=this.syncDataStore.nameManager.getIntersectingTables(e);return t.kind===n.ResultKind.Failure?F:t}async fetchTableTile(e,t,r){const o=await this.grid.getIntersectingTables(this.correlationId,r);if(!(0,n.isSuccess)(o))return"unavailable";const s=o.value.availableRanges.map(m.createCellSetFromRange).reduce(a.unionProduct,i.empty);for(const r of o.value.tables){const n=p(r);t.tables.getValue(n)||(t.tables=t.tables.setValue(n,h(this.syncDataStore.config.localeInfo,r,e,n)))}return s}async getIformat(e,t){const r=t>>>E.formatPagePow,i=r<<E.formatPagePow,a=i+(1<<E.formatPagePow);let o=this.formatPages[r];if(void 0===o){const t=await this.grid.getIformats(this.correlationId,e,i,a);if((0,n.isSuccess)(t)){const e=[];for(const r of t.value.availableFormats)r.iformat<i||r.iformat>=a||(e[r.iformat-i]=r);o=this.formatPages[r]=e}else o=this.formatPages[r]="unavailable"}if("unavailable"===o)return b;const s=o[t-i];return void 0===s?b:(0,n.success)(s)}parseCellFormula(e,t,r){return{result:E.cachedParseFormula(r?this.englishFormulaCache:this.formulaCache,r?this.englishParser:this.parser,r?this.englishAnalyzer:this.analyzer,e,t)}}async parseEdit(e,t){const r=await this.getEditFormat(e)??{valueType:s.FormatValueType.General,bidiDate:void 0,culture:void 0};return this.parseEditInternal(e,t,r)}parseEditSync(e,t,r){const i=this.parseNumberFormat(r.formatString,r.builtIn).result;let a;return a=(0,n.isSuccess)(i)?i.value:{valueType:s.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,a)}resolveReferences(e,t){return t.map((t=>{switch(t.kind){case o.NodeKind.StructRef:return this.resolveStructRefSync(e,t).result;case o.NodeKind.CellRef:return this.resolveCellRefNodeSync(e,t).result}}))}async getCorrespondingSnapshotID(){return-1===this.correspondingSnapshotID&&(this.correspondingSnapshotID=await this.grid.getCorrespondingSnapshotID(this.correlationId)),this.correspondingSnapshotID}async getEditFormat(e){const t=await this.getCell(e);if(!(0,n.isSuccess)(t))return;let r;if("string"==typeof t.value.format)r=this.parseNumberFormat(t.value.format,!1).result;else{const i=await this.getIformat(e.sheet.document,t.value.format);if(!(0,n.isSuccess)(i))return;const{formatString:a,builtIn:o}=i.value;r=this.parseNumberFormat(a,o).result}return(0,n.isSuccess)(r)?r.value:void 0}parseEditInternal(e,t,r){let i=this.formatter.parseEdit(t,r);if(!(0,n.isSuccess)(i))return{result:i};if(i.value.kind===s.EditKind.String&&"="===t&&r.valueType!==s.FormatValueType.Text&&(i=(0,n.success)((0,s.formulaEdit)(t))),i.value.kind!==s.EditKind.Formula)return{result:(0,n.success)(i.value)};const a=E.parseCheckedFormula(this.parser,this.analyzer,e,i.value.fmla,e.range);return(0,n.isSuccess)(a)?{result:(0,n.success)({kind:s.EditKind.Formula,fmla:i.value.fmla,formula:a.value})}:{result:a}}static cachedParseFormula(e,t,r,n,i){const a=e.get(i);if(void 0!==a)return a;const o=E.parseWellFormedFormula(t,r,n,i.formulaBarText,i.origin??n.range);return e.set(i,o),o}static parseWellFormedFormula(e,t,r,i,a){const s=E.parseCheckedFormula(e,t,r,i,a);return(0,n.isSuccess)(s)?(0,o.isWellFormed)(s.value)?(0,n.success)(s.value):(0,n.failure)((0,u.illFormedFormula)("ill-formed formula")):s}static parseCheckedFormula(e,t,r,i,a){const s=e.parseFormula((0,l.parseLocals)(o.LexicalKind.Cell,a),i);if(!(0,n.isSuccess)(s))return s;const u=t.checkFormula((0,l.analyzeLocalsGrid)(o.LexicalKind.Cell,(0,o.sheetGridCell)(r.sheet,a)),s.value);return(0,n.isSuccess)(u)?(0,n.success)(u.value):u}parseNumberFormat(e,t){return{result:this.cachedParseNumberFormat(e,t)}}evalOnClonedModel(e,t,r){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t,r)}evalFormula(e,t,r){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t,r)}evalFormulaTree(e,t,r){return this.grid.evalFormulaTreeOnSnapshot(this.correlationId,e,t,r)}cachedParseNumberFormat(e,t){const r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;const n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n}resolveStructRefSync(e,t){return{result:this.resolver.resolveStructRef(e,t)}}resolveCellRefNodeSync(e,t){return{result:this.resolver.resolveCellRef(e,t)}}close(){this.grid.discardSnapshot(this.correlationId).catch((e=>{d.x10Logger.log({kind:"failure",payload:{failureKind:d.X10FailureKind.GridFailure,failureLevel:o.TraceLevel.Warning,path:"PrefetchingCache.close",description:(0,n.messageFromError)(e)}})}))}constructor(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.correspondingSnapshotID=-1,this.sheet2contents=(0,n.makeStringMap)(),this.currentDocumentLoc=(0,o.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,l.createParser)(t),this.analyzer=(0,l.createAnalyzer)(t),this.formatter=(0,s.createNumberFormatter)(t),this.resolver=(0,o.createResolver)(t);const i={config:{localeInfo:(0,o.getEnglishLocaleInfo)(),get date1904(){return t.config.date1904},get dateCompatibility(){return t.config.dateCompatibility},get datepack(){return t.config.datepack},get mathpack(){return t.config.mathpack},get refStyle(){return t.config.refStyle},get timezone(){return t.config.timezone}},getSheetName:(...e)=>t.getSheetName(...e),getContainingTable:(...e)=>t.getContainingTable(...e),getDocumentLoc:(...e)=>t.getDocumentLoc(...e),getNameLoc:(...e)=>t.getNameLoc(...e),getSheetIndex:(...e)=>t.getSheetIndex(...e),getSheetRangeIndexes:(...e)=>t.getSheetRangeIndexes(...e),getStructRefColumn:(...e)=>t.getStructRefColumn(...e),getStructRefSpecialRef:(...e)=>t.getStructRefSpecialRef(...e),getUserDefinedFuncLoc:(...e)=>t.getUserDefinedFuncLoc(...e)};this.englishParser=(0,l.createParser)(i),this.englishAnalyzer=(0,l.createAnalyzer)(i)}}t.PrefetchingCache=E,E.tileWidthPow=2,E.tileHeightPow=4,E.formatPagePow=6},4092:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pythonSyntaxHighlightingPluginAttach=t.pythonTooltipPluginAttach=t.pythonAutocompletePluginAttach=void 0;const n=r(6913),i=r(1633),a=r(8795),o=r(9615),s=(0,o.trackableAsyncLazy)((async()=>{const e=await a.workerThreadSpread.getValue();return await e.loadPluginScript((0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.X10IntelligentPythonWP5")?"pythonIntelliSense":"pythonIntelliSenseWP5",!1),e}),"threadWithExcelOnlinePythonPluginScriptLoaded");t.pythonAutocompletePluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(i.PluginFactoryName.PythonAutocompletePlugin)}),"pythonAutocompletePluginAttach"),t.pythonTooltipPluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(i.PluginFactoryName.PythonTooltipPlugin)}),"pythonTooltipPluginAttach"),t.pythonSyntaxHighlightingPluginAttach=(0,o.trackableAsyncLazy)((async()=>{const e=await s.getValue();await e.createAndAttachPlugin(i.PluginFactoryName.PythonSyntaxHighlightingPlugin)}),"pythonSyntaxHighlightingPluginAttach")},1546:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepeatedTaskScheduler=t.TaskKind=void 0;const n=r(6913);var i,a;function o(e,t){return{kind:e,handle:t}}function s(e){return void 0!==e?(e.kind=i.NoWorkScheduled,e.handle=void 0,e):o(i.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(i||(i={})),(0,n.staticAssertExtends)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(a||(t.TaskKind=a={}));const u=Promise.resolve();t.RepeatedTaskScheduler=class{runNextSynchronously(){switch(this.handleState.kind){case i.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case i.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()}runNextAsMicrotask(){switch(this.handleState.kind){case i.PromiseScheduled:return;case i.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case i.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=i.PromiseScheduled,e.handle=void 0,e):o(i.PromiseScheduled,void 0),u.then(this.promiseClosure)}runNextAsMacrotask(){switch(this.handleState.kind){case i.ImmediateScheduled:return;case i.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=i.ImmediateScheduled,t.handle=e,t):o(i.ImmediateScheduled,e))}runNextInFuture(e){switch(this.handleState.kind){case i.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case i.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=i.FutureScheduled,r.handle=t,r):o(i.FutureScheduled,t))}clear(){switch(this.handleState.kind){case i.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case i.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=s(this.handleState)}constructor(e,t){this.timer=t,this.handleState=s(),this.clearHandleClosureAndRunBody=()=>{let t;switch(this.handleState.kind){case i.NoWorkScheduled:t=a.Sync;break;case i.PromiseScheduled:t=a.MicroTask;break;case i.ImmediateScheduled:case i.FutureScheduled:t=a.MacroTask;break;default:(0,n.assertNever)("Unknown handle state",this.handleState)}this.handleState=s(this.handleState),e(t)},this.promiseClosure=()=>{this.handleState.kind===i.PromiseScheduled&&this.clearHandleClosureAndRunBody()}}}},1479:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestProcessorMap=void 0,t.processRequest=function(e,t,r,i,a){const{info:{correlationId:o},schedulerState:s,finalizer:u}=r,l=e[t.kind],d={request:t,correlationId:o,cache:i,config:a,schedulerState:s,finalizer:u,handle:r},m=l(d);return(0,n.bindMaybeThenable)(m,(e=>e.kind!==n.ResultKind.Success?c.logSafeFailure.censored(e):(r.schedulerState=d.schedulerState,(0,n.success)({kind:t.kind,...e.value}))))},t.processSyncRequest=function(e,t,r,i,a){const{info:{correlationId:o},schedulerState:s,finalizer:u}=r,l={request:t,correlationId:o,cache:i,config:a,schedulerState:s,finalizer:u,handle:r},d=(0,e[t.kind])(l);return d.kind!==n.ResultKind.Success?c.logSafeFailure.censored(d):(r.schedulerState=l.schedulerState,(0,n.success)({kind:t.kind,...d.value}))};const n=r(6913),i=r(6592),a=r(1159),o=r(4330),s=r(3713),u=r(6307),l=r(8824),c=r(7229),d=r(4691),m=l.X10TaskInternal.createToken();function g(e,t){return e.kind===n.ResultKind.Failure?e:(0,n.success)(t(e.value))}async function p(e){try{return(0,n.success)(await e)}catch(e){return(0,n.failure)(e)}}function h(e){switch(e.kind){case"NamedFailure":case"NamedFormula":case"NamedRange":case"NamedValue":return e;case"NamedTable":return f(e);default:(0,n.assertNever)("ComputationRequestKind.GetNamedObject",e)}}function f(e){const t=[];return e.columnIndexes.forEach(((e,r)=>(t.push({index:e,name:r}),!0))),{kind:e.kind,ranges:{data:e.specialRefRanges[i.SpecialRefId.Data],headers:e.specialRefRanges[i.SpecialRefId.Headers],totals:e.specialRefRanges[i.SpecialRefId.Totals],all:e.specialRefRanges[i.SpecialRefId.All]},columns:t.sort(((e,t)=>e.index-t.index)),allColumnNamesAvailable:e.allColumnNamesAvailable,hasHeadersRow:e.hasHeadersRow,hasTotalsRow:e.hasTotalsRow}}t.requestProcessorMap={[u.ComputationRequestKind.Delay]:()=>(0,n.success)({}),[u.ComputationRequestKind.AwaitPromise]:async({request:{promise:e}})=>{try{const t=await e;return(0,n.success)({result:t})}catch(e){return(0,n.failure)(e)}},[u.ComputationRequestKind.CreateTask]:({request:{request:e},handle:t,schedulerState:r})=>{const i=new l.X10TaskInternal(r.scheduler.processRequest(t,e,{onFulfilled:e=>{if(e.kind!==n.ResultKind.Success)throw{kind:"RequestFailure"};return e.value},onRejected:e=>{throw e}}),m);return(0,n.success)({task:i})},[u.ComputationRequestKind.PromiseToTask]:({request:{promise:e}})=>(0,n.success)({task:new l.X10TaskInternal(e,m)}),[u.ComputationRequestKind.AwaitTask]:async({request:{task:e}})=>(0,n.success)({result:await p(e.resolve(m))}),[u.ComputationRequestKind.AwaitBatch]:async({request:{tasks:e}})=>{const t=[];for(const r of e)t.push(await p(r.resolve(m)));return(0,n.success)({results:t})},[u.ComputationRequestKind.AwaitAll]:async({request:{tasks:e}})=>{const t=n.MaybeThenable.all(e.map((e=>e.resolve(m))));return(0,n.success)({result:await p(t)})},[u.ComputationRequestKind.AwaitAny]:async({request:{tasks:e}})=>{const t=n.MaybeThenable.any(e.map((e=>e.resolve(m))));return(0,n.success)({result:await p(t)})},[u.ComputationRequestKind.InternalService]:async({request:e,schedulerState:{scheduler:t}})=>{const r={service:e.service,method:e.method,response:await t.serviceCall(e.service,e.method,e.args)};return(0,s.staticTypeHint)(r),(0,n.success)(r)},[u.ComputationRequestKind.GetCopilotLicense]:async({schedulerState:{scheduler:e}})=>{const t=await e.getCoPilotLicense();return(0,n.success)({license:void 0!==t?(0,n.success)(t):(0,n.failure)(void 0)})},[u.ComputationRequestKind.GetPythonLicense]:async({schedulerState:{scheduler:e}})=>{const t=await e.getPythonLicense();return(0,n.success)({license:void 0!==t?(0,n.success)(t):(0,n.failure)(void 0)})},[u.ComputationRequestKind.GetPythonType]:async({request:{rangeRef:e,sheetId:t},schedulerState:{serverDataProvider:r}})=>{if(void 0===r)return c.logSafeFailure.failure("serverDataProvider is undefined");const i=await r.getPythonType(e,t);return(0,n.success)({pythonType:i})},[u.ComputationRequestKind.GetCell]:async({request:{cell:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=await t.getCell(e);return(0,n.success)({result:r})},[u.ComputationRequestKind.GetContainingTable]:async({request:{cell:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=await t.getContainingTable(e);return(0,n.success)({result:r})},[u.ComputationRequestKind.UnsafeGetContainingTableName]:({request:{cell:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=t.getContainingTableName(e);return(0,n.success)({result:r})},[u.ComputationRequestKind.UnsafeGetContainingTable]:({request:{cell:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=t.getContainingTableSync(e);return"Failure"===r.kind?r:(0,n.success)({result:(0,n.success)(r.value?f(r.value):void 0)})},[u.ComputationRequestKind.GetAvailableTableHeaders]:({request:{tableName:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=t.getAvailableTableHeaders(e);return(0,n.success)({result:r})},[u.ComputationRequestKind.UnsafeGetNamedObject]:({request:{name:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=t.getNamedObject(e);return"Failure"===r.kind?c.logSafeFailure.failure("getNamedObject failed"):"Failure"===r.value.kind?c.logSafeFailure.failure("getNamedObject returned failure"):void 0===r.value.value?(0,n.success)({result:(0,n.success)(void 0)}):(0,n.success)({result:(0,n.success)(h(r.value.value.obj))})},[u.ComputationRequestKind.GetIntersectingTables]:async({request:{range:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=await t.getIntersectingTables(e);return(0,n.success)({result:r})},[u.ComputationRequestKind.UnsafeGetIntersectingTableNames]:({request:{range:e},cache:t})=>{if(void 0===t)return c.logSafeFailure.failure("Cache is undefined");const r=t.getIntersectingTableNames(e);return(0,n.success)({result:r})},[u.ComputationRequestKind.GetRange]:async({request:{range:e,layers:t},cache:r})=>{if(void 0===r)return c.logSafeFailure.failure("Cache is undefined");const i=await r.getRange(e,t);return(0,n.success)({localSheetGrid:i})},[u.ComputationRequestKind.GetSheetNames]:({cache:e})=>void 0===e?c.logSafeFailure.failure("Cache is undefined"):e.getSheetNames(),[u.ComputationRequestKind.GetStructRefColumn]:({request:{table:e,nameOrCol:t},cache:r})=>{if(void 0===r)return c.logSafeFailure.failure("Cache is undefined");const i=r.getStructRefColumn(e,t);return(0,n.success)({result:i})},[u.ComputationRequestKind.GetStructRefSpecialRef]:({request:{table:e,id:t},cache:r})=>{if(void 0===r)return c.logSafeFailure.failure("Cache is undefined");const i=r.getStructRefSpecialRef(e,t);return(0,n.success)({result:i})},[u.ComputationRequestKind.GetIformat]:async({request:{document:e,iformat:t},cache:r})=>{if(void 0===r)return c.logSafeFailure.failure("Cache is undefined");const i=await r.getIformat(e,t);return(0,n.success)({result:i})},[u.ComputationRequestKind.ParseCellFormula]:({request:{cell:e,formula:t,useEnglishLocaleInfo:r},cache:i})=>void 0===i?c.logSafeFailure.failure("Cache is undefined"):(0,n.success)(i.parseCellFormula(e,t,r)),[u.ComputationRequestKind.ParseEdit]:async({request:{cell:e,formulaBarText:t},cache:r})=>void 0===r?c.logSafeFailure.failure("Cache is undefined"):(0,n.success)(await r.parseEdit(e,t)),[u.ComputationRequestKind.ParseActiveCell]:({request:{formulaText:e},schedulerState:{activeCell:t,activeCellFormat:r},cache:i})=>{if(void 0===i)return c.logSafeFailure.failure("Cache is undefined");if((0,n.isNone)(t))return c.logSafeFailure.failure("Active Cell is undefined");if(void 0===r)return c.logSafeFailure.failure("Active Cell Format is undefined");const a=r??{formatString:"General",builtIn:!0};return(0,n.success)(i.parseEditSync(t,e,a))},[u.ComputationRequestKind.ParseNumberFormat]:({request:{formatString:e,builtIn:t},cache:r})=>void 0===r?c.logSafeFailure.failure("Cache is undefined"):(0,n.success)(r.parseNumberFormat(e,t)),[u.ComputationRequestKind.PrintFormula]:({request:{formula:e,origin:t},config:r})=>{if(void 0===r)return(0,n.failure)([]);const a=(0,i.createPrinter)((0,i.createSimplePrintGlobals)(r)).printFormula((0,i.printLocalsGrid)((0,i.lexicalSourceGrid)(i.LexicalKind.Cell,t),t),e);return(0,n.success)({result:a})},[u.ComputationRequestKind.GetActiveCell]:({schedulerState:{activeCell:e}})=>void 0===e?(i.ulsLogger.ULS.traceTag(512274723,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,d.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),c.logSafeFailure.failure("Active Cell is undefined")):(0,n.success)({activeCell:e}),[u.ComputationRequestKind.GetActiveCellFormat]:({schedulerState:{activeCellFormat:e}})=>void 0===e?c.logSafeFailure.failure("Active Cell Format is undefined"):null===e?(0,n.success)({result:(0,n.failure)((0,i.unavailable)(["unavailableFormat"]))}):(0,n.success)({result:(0,n.success)(e)}),[u.ComputationRequestKind.GetConfig]:({config:e})=>void 0===e?c.logSafeFailure.failure("Config is undefined"):(0,n.success)({config:e}),[u.ComputationRequestKind.GetCultureTag]:({request:{lcid:e}})=>{const t=(0,a.convertKnownLCID)(e).toString();return-1===t.indexOf("-")?c.logSafeFailure.failure(`Culture-Tag '${t}' from LCID '${e}' has an unknown format`):(0,n.success)({cultureTag:t})},[u.ComputationRequestKind.GetFunctionsInfo]:({schedulerState:e})=>{const t=e.functionsInfoMap;if(void 0===t)return i.ulsLogger.ULS.traceTag(512274722,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,d.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),c.logSafeFailure.failure("functionsInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,n.success)({functionsInfo:r})},[u.ComputationRequestKind.GetFunctionInfo]:({request:{functionName:e},schedulerState:t})=>{if(void 0===t.functionsInfoMap)return i.ulsLogger.ULS.traceTag(512274721,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,d.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),c.logSafeFailure.failure("functionsInfoMap is undefined");const r=t.functionsInfoMap[e.toUpperCase()];return void 0===r?c.logSafeFailure.failure("functionsInfo is undefined"):(0,n.success)({functionInfo:r})},[u.ComputationRequestKind.GetDefinedNamesInfo]:({schedulerState:e})=>{const t=e.definedNamesInfoMap;if(void 0===t)return i.ulsLogger.ULS.traceTag(512274720,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,d.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),c.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=Object.keys(t).map((e=>t[e]));return(0,n.success)({definedNamesInfo:r})},[u.ComputationRequestKind.GetDefinedNameInfo]:({request:{definedName:e},schedulerState:t})=>{if(void 0===t.definedNamesInfoMap)return c.logSafeFailure.failure("definedNamesInfoMap is undefined");const r=t.definedNamesInfoMap[e.toUpperCase()];return(0,n.success)({definedNameInfo:r})},[u.ComputationRequestKind.EvalOnClonedModel]:async({cache:e,request:t})=>{const r=await(e?.evalOnClonedModel(t.updates,t.edits,t.formatResults));return void 0===r?c.logSafeFailure.failure("Operation did not return a result"):r.kind!==n.ResultKind.Success?c.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,n.success)({result:r.value})},[u.ComputationRequestKind.EvalFormula]:async({cache:e,request:t})=>{const r=await(e?.evalFormula(t.formula,t.origin,t.format));return void 0===r?c.logSafeFailure.failure("Operation did not return a result"):r.kind!==n.ResultKind.Success?c.logSafeFailure.failure("Operation returned an unsuccessful result"):(0,n.success)({result:r.value})},[u.ComputationRequestKind.EvalFormulaTree]:async({cache:e,request:t})=>{const r=await(e?.evalFormulaTree(t.formula,t.origin,t.format));if(void 0===r)return c.logSafeFailure.failure("Operation did not return a result");if(r.kind!==n.ResultKind.Success)return c.logSafeFailure.failure("Operation returned an unsuccessful result");const i=([[[e,t],r],n])=>({value:{value:r,span:{start:e,end:t}},children:n?.map(i)}),[[,[a]]]=r.value;return(0,n.success)({result:{result:a,evaluationTree:i(r.value)}})},[u.ComputationRequestKind.GetCorrelationId]:({correlationId:e})=>(0,n.success)({correlationId:e}),[u.ComputationRequestKind.SetActiveCell]:e=>(e.schedulerState={...e.schedulerState,activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat},(0,n.success)({})),[u.ComputationRequestKind.GetRichValueFieldListContext]:async({schedulerState:e,request:{rangeToQuery:t,dotNotationPath:r,singleColumn:i,findRange:a}})=>{const o=e.serverDataProvider;if((0,n.isNone)(o))return c.logSafeFailure.failure("serverDataProvider is undefined");const s=await o.getRichValueFieldListContext(t,r,i,a);return(0,n.isTypedChangeGateEnabled)("OfficeVSO:8575821_x10MapGetRichValueFieldListContext")||(0,n.success)({result:s}),(0,n.success)({result:s})},[u.ComputationRequestKind.GetHiddenRows]:async({cache:e,request:t})=>{if(void 0===e)return(0,n.failure)([]);const r=await e.getHiddenRows(t.sheet,t.start,t.endExclusive);return(0,n.success)({result:r})},[u.ComputationRequestKind.GetHiddenCols]:async({cache:e,request:t})=>{if(void 0===e)return(0,n.failure)([]);const r=await e.getHiddenCols(t.sheet,t.start,t.endExclusive);return(0,n.success)({result:r})},[u.ComputationRequestKind.ResolveReferences]:({cache:e,request:{locals:t,nodes:r}})=>{if(void 0===e)return c.logSafeFailure.failure("Cache is undefined");if(void 0===t)return c.logSafeFailure.failure("Locals is undefined");if(void 0===r)return c.logSafeFailure.failure("Nodes is undefined");const i=e.resolveReferences(t,r);return(0,n.success)({resolverResults:i})},[u.ComputationRequestKind.GetCorrespondingSnapshotID]:async({cache:e})=>{if(void 0===e)return c.logSafeFailure.failure("Cache is undefined");const t=await e.getCorrespondingSnapshotID();return(0,n.success)({snapshotID:t})},[u.ComputationRequestKind.GetEditFormat]:async({cache:e,request:{cell:t}})=>{if(void 0===e)return c.logSafeFailure.failure("Cache is undefined");const r=await e.getEditFormat(t);return(0,n.success)({result:void 0===r?(0,n.failure)((0,i.unavailable)(["Unavailable Format"])):(0,n.success)(r)})},[u.ComputationRequestKind.UpdateSnapshot]:async({handle:e,schedulerState:t})=>{const r=await t.scheduler.updatePrefetchingCache(e);return void 0===r?c.logSafeFailure.failure("Cache is undefined"):(0,n.success)({snapshotID:r})},[u.ComputationRequestKind.GetFullTableHeadersFromServer]:async({schedulerState:e,request:{tableName:t}})=>{const r=e.serverDataProvider;if((0,n.isNone)(r))return c.logSafeFailure.failure("serverDataProvider is undefined");const i=await r.getTableColHeaders(t);return(0,n.isNone)(i)?(0,n.success)({result:[]}):(0,n.success)({result:i.filter(n.isDefined)})},[u.ComputationRequestKind.CreateChatGPTSession]:async({schedulerState:{scheduler:e},finalizer:t,request:{options:r}})=>{if(void 0===r)return c.logSafeFailure.failure("Request contained undefined 'options'");const i=await e.createChatGPTSession(r);return i.kind===n.ResultKind.Success&&t.subscribe((()=>e.closeChatGPTSession(i.value))),g(i,(e=>({result:e})))},[u.ComputationRequestKind.CloseChatGPTSession]:async({schedulerState:{scheduler:e},request:{session:t}})=>g(await e.closeChatGPTSession(t),(()=>({result:void 0}))),[u.ComputationRequestKind.SendChatGPTQuery]:async({schedulerState:{scheduler:e},request:{session:t,request:r}})=>g(await e.sendChatGPTQuery(t,r),(e=>({result:e}))),[u.ComputationRequestKind.IsSchedulerFeatureEnabled]:({schedulerState:{scheduler:e},request:{feature:t}})=>{const r=e.isSchedulerFeatureEnabled(t);return(0,n.success)({isFeatureEnabled:r})},[u.ComputationRequestKind.SendAugLoopSignal]:async({schedulerState:{scheduler:e},handle:t,request:{signal:r}})=>g(await e.sendAugLoopSignal(r,t.info.computationIdentifier.factoryName),(e=>({result:e}))),[u.ComputationRequestKind.TriggerEvent]:({schedulerState:{scheduler:e},request:{eventKind:t,event:r}})=>(e.triggerEventImmediate(t,r),(0,n.success)({})),[u.ComputationRequestKind.AwaitEvent]:async({schedulerState:{scheduler:e},request:t})=>{const r=e.catchEvent(t);if((0,o.isALAnnotationEventKind)(t.eventKind)){const r=await e.registerALAnnotation(t.eventKind);if(r.kind!==n.ResultKind.Success)return r}const i=await r;return(0,n.success)({result:i})},[u.ComputationRequestKind.GetRecognizedRangeTables]:async({schedulerState:{scheduler:e},handle:t,request:{sheetId:r,range:i,metadataStates:a,maxRevisions:o}})=>{const s=await e.getRecognizedTablesInfo(r,i,a,t.info.computationIdentifier.factoryName,o);return(0,n.success)({result:s})},[u.ComputationRequestKind.LogAshaErrorEvent]:async({schedulerState:{scheduler:e},request:{params:t}})=>{const r=await e.logAshaErrorEvent(...t);return(0,n.success)({result:r})}}},3948:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderInsideInit=t.PluginSchedulerSingleton=t.GridImportManagerSingleton=void 0,t.createDynamicPluginLoader=function(e){return p().createDynamicPluginLoader(t.GridImportManagerSingleton.instance(),t.PluginSchedulerSingleton.instance(),e)},t.getSchedulerFactories=p;const n=r(6913),i=r(6040),a=r(8127),o=r(8570),s=r(6834),u=r(2041),l=r(3315),c=(0,n.singleton)((()=>{const e=p().createGridProvider((()=>t.PluginSchedulerSingleton.instance().registerAsyncGrid()));return t.GridImportManagerSingleton.instance().onGridImporterCreated(e,"Main-IGrid"),e}));t.GridImportManagerSingleton=(0,n.singleton)((()=>p().createGridImportManager())),t.PluginSchedulerSingleton=(0,n.singleton)((()=>p().createFormulaBarScheduler(c.instance()))),(0,n.staticAssertExtends)();const d=(e,t,...r)=>new s.FormulaBarScheduler((0,a.timelineQueueProcessorFactory)(r[0]),(0,a.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);t.dynamicPluginLoaderInsideInit=(0,a.dynamicPluginLoaderInsideInit)(a.timelineQueueProcessorFactory,a.createPrefetchingCacheFactory);class m extends s.FormulaBarScheduler{set ComputationFinalizerHandlers(e){this.computationFinalizerHandlers=e}get ComputationFinalizerHandlers(){return this.computationFinalizerHandlers}}const g={win32:{createFormulaBarScheduler:d,createExperimentFormulaBarScheduler(){throw new Error("Cannot use Experiment Formula Bar Scheduler in win32 context")},createTestableFormulaBarScheduler(){throw new Error("Cannot use Testable Formula Bar Scheduler in win32 context")},createDynamicPluginLoader(){throw new Error("Cannot use Dynamic Plugin Loader in win32 context")},createGridImportManager:()=>({onGridExporterCreated(){},onGridImporterCreated(){}}),createGridProvider(){const e=new i.CacheGrid;return{getGrid:()=>e,getGridDataSink:()=>e,getSyncDataModel:()=>e,createIGridImportEndpoint(){throw new Error("Cannot use createIGridImportEndpoint in win32 context")},onGridExporterClosed(){throw new Error("Cannot use onGridExporterClosed in win32 context")}}}},web:{createFormulaBarScheduler:d,createDynamicPluginLoader:(...e)=>((e,...t)=>new a.DynamicPluginLoader(e,...t))("excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit",...e),createGridImportManager:e=>new u.GridImportManager(e),createGridProvider:e=>new u.GridProvider(e),createExperimentFormulaBarScheduler:(e,t,...r)=>{let n;const i=new s.FormulaBarScheduler((e=>(n=new o.ExperimentQueueProcessor(e),n)),(0,a.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r);if(void 0===n)throw"not initialized";return[i,n]},createTestableFormulaBarScheduler:(e,t,...r)=>new m((0,a.timelineQueueProcessorFactory)(r[0]),(0,a.createPrefetchingCacheFactory)(e),t,e.getGridDataSink(),e.getSyncDataModel(),...r)}};function p(){return g[l.platform]}if((0,n.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(self.__retries??-1)+1,0===self.__retries))throw""},2547:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalSchedulerResponseKind=void 0,t.createSyncTimelineQueueMessage=u,t.createTimelineQueueMessage=function(e,t){return function(e){return o.ComputationRequestExecutionType[e.kind]===i.ExecutionType.Internal}(e)?{kind:o.SchedulerTimelineQueueMessageKind.InternalRequest,request:e,computation:t}:function(e){return o.ComputationRequestExecutionType[e.kind]===i.ExecutionType.Async}(e)?{kind:o.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:t}:((0,a.staticTypeHint)(t),u(e,t))};const n=r(6913),i=r(6700),a=r(3713),o=r(6307);var s;function u(e,t){return function(e){return o.ComputationRequestExecutionType[e.kind]===i.ExecutionType.NoOp}(e)?{kind:o.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:t}:{kind:o.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:t}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure"}(s||(t.InternalSchedulerResponseKind=s={})),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)(),(0,n.staticAssertExtends)()},7736:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchedulerService=void 0,t.providerProxy=function(e){return e};const n=r(6913),i=r(4691);class a extends n.ResolvablePromiseWithLimitedSubscribers{static fromClass(e,t){return new a(e,(e=>new t(e)))}static fromFunction(e,t){return new a(e,t)}resolve(e){const t=this.serviceConstructor(e);return super.resolve(t),t}constructor(e,t){super(e.subscriberLimit),this.config=e,this.serviceConstructor=t,this.toPromise().catch((e=>{i.x10Logger.log({kind:"provider",payload:{id:this.config.providerId,state:"Rejected",data:{reason:e}}})}))}}t.SchedulerService=a},6866:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataModel=t.MaxStateIdDifferenceForGC=void 0;const n=r(6913),i=r(6592),a=r(6410),o=r(3313),s=r(3512),u=r(4592),l=r(7755),c=r(721),d=()=>{};t.MaxStateIdDifferenceForGC=17,t.SyncDataModel=class{get document(){return this.dataTransformer.document}getStateAsNotifications(){return[...this.configNotifications,...this.getSheetStateAsNotifications(),...this.getNameStateAsNotifications(),...this.getSchedulerFeaturesAsNotifications()]}getSchedulerFeaturesAsNotifications(){return[[a.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]}getSheetStateAsNotifications(){const e=[];return this.sheets.forEachSheet(((t,r)=>{e.push((0,c.sheetName)(r,t.name))})),e.length>0?[[a.NotificationKind.updateSheetNames,[this.stateId,e]]]:[]}getNameStateAsNotifications(){const e=[],t=t=>{const r=[];t.forEachAvailableName(((e,t)=>{const n=(0,o.namedObjectToNamedObjectData)(this.config.mathpack,this.dataTransformer.document,t?.obj);return r.push((0,c.namedObject)(e,n)),!0})),r.length>0&&e.push((0,c.namedObjectsWrite)(t.scope.index,r)),t.allAvailable()&&e.push((0,c.undefinedNamesWrite)(t.scope.index))},r=this.nameManager.getNamesBySheetId(void 0);return(0,n.isSuccess)(r)&&t(r.value),this.nameManager.forEachSheetScope((e=>{t(e)})),e.length>0?[[a.NotificationKind.updateNamedObjects,[this.stateId,e]]]:[]}trySetStateId(e,r){if(r<this.stateId)return!1;if(r>this.stateId){const e=this.stateId;if(this.stateId=r,this.sheets.advanceState(e),this.nameManager.advanceState(e),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=t.MaxStateIdDifferenceForGC){this.stateChangesSinceLastGC=0;const e=this.stateId-t.MaxStateIdDifferenceForGC;this.nameManager.collectGarbage(e)}}return!0}clearCompiledFormulas(){this.nameManager.resetLazyData()}clearCompiledNumberFormats(){}setA1ReferenceStyle(e){this.configNotifications.push([a.NotificationKind.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)}setLocale(e){this.configNotifications.push([a.NotificationKind.setLocale,[e]]),this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})}setWorkbookProps(e){this.configNotifications.push([a.NotificationKind.setWorkbookProps,[e]]),this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})}updateSheetNames(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})}updateNamedObjects(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})}setSchedulerFeatures(e){this.schedulerFeatures=e}setLangConfig(e,t){if(!this.trySetStateId(!0,e))return;const r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}setSheetNames(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))}writeNamedObject(e,t,r,a){if(!this.trySetStateId(!0,e))return;const o=this.nameManager.setNamedObject(!0,(0,i.nameLoc)(t,r),a,d);(0,n.isSuccess)(o)}writeUndefinedNames(e,t){if(!this.trySetStateId(!0,e))return;const r=this.nameManager.setUndefinedNames(t);(0,n.isSuccess)(r)}promoteNamedObjects(e,t,r){if(!this.trySetStateId(!0,e))return;const i=this.nameManager.promoteNamedObjects(t,r);(0,n.isSuccess)(i)&&i.value}getDocumentLoc(e,t){const r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,n.failure)((0,i.unavailable)([(0,i.documentLoc)(e,t)])):(0,n.success)(r)}getSheetIndex(e,t){const r=this.sheets.getSheetByName(t);return(0,n.isSuccess)(r)?void 0===r.value?r:(0,n.success)(r.value.sheetIndex.index):r}getSheetName(e,t){const r=this.sheets.getSheetById(t);return(0,n.isSuccess)(r)?(0,n.success)(r.value.name):r}getNameLoc(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)}getUserDefinedFuncLoc(e,t){return(0,n.failure)((0,i.notImplemented)(["call UDF"]))}getSheetRangeIndexes(e){return this.sheets.getSheetRangeIds(e)}getContainingTable(e){return this.nameManager.getContainingTable(e)}getStructRefColumn(e,t){return this.nameManager.getStructRefColumn(e,t)}getStructRefSpecialRef(e,t){return this.nameManager.getStructRefSpecialRef(e,t)}getTime(){return(0,n.failure)((0,i.unavailable)(["getTime"]))}constructor(){this.dataTransformer=new l.RecalcServiceDataTransformer,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new u.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new s.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}}},8402:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineQueueProcessor=t.defaultTimerInterface=void 0;const n=r(6913),i=r(1546);t.defaultTimerInterface={...n.defaultSetTimeoutInterface,now:n.now},t.TimelineQueueProcessor=class{enqueue(e,t,r=this.maxWitnessedNow){this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()}push(e,t,r=this.maxWitnessedNow){this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()}pop(){return 1===this.queue.getCount()&&this.scheduler.clear(),this.queue.pop()?.payload}peek(){return this.queue.peek()}getCount(){return this.queue.getCount()}continue(){for(this.startTime=this.startTime??this.now();this.totalSyncCost<this.costThreshold;){const e=this.queue.peek();if(void 0===e)return;if(e.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(e.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=e.abstractCost,this.consumeMessage(e.payload)}const e=this.queue.peek();if(void 0===e)return;const t=this.now();t-this.startTime<this.timeThreshold&&e.delayUntil<=t?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(e.delayUntil,t)||this.scheduler.runNextAsMacrotask()}tryRunNextInFuture(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)}now(){return this.maxWitnessedNow=this.timer.now()}constructor(e,r,a,o=t.defaultTimerInterface){this.cmp=e,this.consumeMessage=r,this.timer=o,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new n.PriorityQueue(((t,r)=>{const n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=a?.costThreshold??1,this.timeThreshold=a?.timeThreshold??10,this.scheduler=new i.RepeatedTaskScheduler((e=>{this.totalSyncCost=0,this.lastFutureAbsoluteTime=void 0,e===i.TaskKind.MacroTask&&(this.startTime=void 0),this.continue()}),o)}}},9615:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackableAsyncLazy=void 0,t.trackableAsyncLazy=function(e,t,r=n.now){return new o(e,t,r)};const n=r(6913),i=r(4691),a=r(4352);class o extends a.ResettableLazy{reset(){throw new Error("Resetting a TrackableAsyncLazy is not allowed")}constructor(e,t,r=n.now){super((async()=>{try{const t=r(),a=e(),o=r()-t,s=await a,u=r()-t-o;return i.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,result:(0,n.success)({syncTime:o,asyncTime:u})}}),s}catch(e){throw i.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,result:(0,n.failure)(`${e}`)}}),e}})),this.name=t}}t.TrackableAsyncLazy=o},1830:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS=void 0,t.updateDurationHistogramsWithRequestTimes=function(e,r){return(i=r,Object.entries(i)).forEach((([r,i])=>{if((0,n.isDefined)(i)&&i.numberOfRequests>0){const n=u(i.requestDuration/i.numberOfRequests),a=e[r]??Array(t.histogramBinCount).fill(0);a[n]+=i.numberOfRequests,e[r]=a}})),e;var i},t.getHistogramBinIndexForDuration=u,t.addSampleWithProbability=function(e,t,r){return function(e){return e>=0&&e<=1}(r)&&o.next()<r&&e.push(t),e},t.createX10AggregatedTelemetryEvent=function(e){return{eventName:"Office.Excel.Client.X10.AggregatedTelemetry",eventFlags:l(),dataFields:[(0,a.makeStringDataField)("X10AggregatedTelemetryObject",e)]}},t.createX10RequestPerformanceEvent=function(e){return{eventName:"Office.Excel.Client.X10.RequestPerformance",eventFlags:l(),dataFields:[(0,a.makeStringDataField)("X10RequestPerformanceTelemetryObject",e)]}},t.sendX10UsedTelemetryEvent=function(){s||((0,i.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Excel.Client.X10.X10UsedEvent",eventFlags:l()}),s=!0)};const n=r(6913),i=r(4516),a=r(7377);t.REQUEST_DURATION_THRESHOLDS=[5,10,20,50,100,200],t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS.length+1;const o=new n.JSF32(0);let s=!1;function u(e){for(let r=0;r<t.REQUEST_DURATION_THRESHOLDS.length;r++)if(e<t.REQUEST_DURATION_THRESHOLDS[r])return r;return t.REQUEST_DURATION_THRESHOLDS.length}function l(){return{dataCategories:a.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:a.EnumObjects.SamplingPolicy.Measure,diagnosticLevel:a.EnumObjects.DiagnosticLevel.Optional}}},1529:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10ExceptionComputationTermination=t.X10Exception=void 0;class r extends Error{}t.X10Exception=r,t.X10ExceptionComputationTermination=class extends r{constructor(e){super(`Computation execution was terminated with '${e}'.`),this.stopReason=e}}},4691:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Logger=t.CombinedLogger=t.ImmediateLogger=t.X10FailureKind=t.LoggerKind=void 0;const n=r(6913),i=r(6592),a=r(1633),o=r(4516),s=r(3713),u=r(1830),l="Main";var c,d;!function(e){e.Immediate="Immediate",e.Aggregating="Aggregating"}(c||(t.LoggerKind=c={})),function(e){e.ALFailure="ALFailure",e.AssertionFailure="AssertionFailure",e.CustomConflictResolverFailure="CustomConflictResolverFailure",e.EventCallbacksManagerFailure="EventCallbacksManagerFailure",e.GridFailure="GridFailure",e.NotificationProcessorFailure="NotificationProcessorFailure",e.PluginAttachmentFailure="PluginAttachmentFailure",e.PluginFailure="PluginFailure",e.RequestProcessorFailure="RequestProcessorFailure",e.TableIntelligenceFailure="TableIntelligenceFailure"}(d||(t.X10FailureKind=d={}));const m=(e,t,r)=>`x10arch.[${e}].${t}: ${(0,n.isDefined)(r.description)&&r.description.length?`${r.description}. `:""}${(0,n.isDefined)(r.data)?JSON.stringify(r.data):""}`;(0,n.staticAssertSame)();const g={trackableAsyncLazy:(e,{name:t,result:r})=>n.ulsLogger.ULS.traceTag(507316304,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"trackableAsyncLazy",{data:"Success"===r.kind?{name:t,syncTime:r.value.syncTime,asyncTime:r.value.asyncTime}:{name:t,failure:r.reason}})),provider:(e,{id:t,state:r,data:a})=>n.ulsLogger.ULS.traceTag(505976837,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"provider",{description:`provider ${t} is ${r}`,data:a})),snapshotCreation:(e,t)=>n.ulsLogger.ULS.traceTag(512305240,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"snapshotCreation",{data:t})),beginRequest:(e,t)=>n.ulsLogger.ULS.traceTag(553734792,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"beginRequest",{data:t})),requestSkipped:(e,t)=>n.ulsLogger.ULS.traceTag(553734793,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"requestSkipped",{data:t})),registerPluginFactory:(e,{factoryName:t})=>n.ulsLogger.ULS.traceTag(571246212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"registerPluginFactory",{description:`registered ${a.PluginFactoryName[t]}`})),pluginCompletedInTime:(e,{pluginName:t,logInfo:r})=>n.ulsLogger.ULS.traceTag(553734790,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"pluginCompletedInTime",{description:`plugin completed in time. plugin name:${t}`,data:r})),computationStoppedExecution:(e,{computationName:t,stopReason:r,logInfo:a})=>n.ulsLogger.ULS.traceTag(509109120,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"pluginStoppedExecution",{data:{computationName:t,stopReason:r,...a}})),closeComputationFrame:(e,t)=>n.ulsLogger.ULS.traceTag(553734789,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,m(e,"closeUIMessageFrame",{data:t})),nullCheckViolation:(e,t)=>n.ulsLogger.ULS.traceTag(507803776,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,m(e,"nullCheckViolation",{data:t})),failure:(e,{failureKind:t,failureLevel:r,path:a,description:o,data:s})=>n.ulsLogger.ULS.traceTag(507322970,i.LogCategory.msoulscat_ES_EWAJS,r,m(e,a,{description:o,data:{failureKind:t,failureLevel:r,...s}}))},p={trackableAsyncLazy:{},provider:{},snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{computationsStopReason:{},requestDurationHistograms:{},requestDurationHistogramByComputationKind:{},schedulerTimeSamples:[],computationTimeSamples:[]},closeComputationFrame:{},nullCheckViolation:{},failure:{}},h={trackableAsyncLazy:(e,{name:t,result:r})=>({...e,[t]:{numCalls:(e[t]?.numCalls??0)+1,totalSyncTime:(e[t]?.totalSyncTime??0)+("Success"===r.kind?r.value.syncTime:0),totalAsyncTime:(e[t]?.totalAsyncTime??0)+("Success"===r.kind?r.value.asyncTime:0),totalFailures:(e[t]?.totalAsyncTime??0)+("Failure"===r.kind?1:0)}}),provider:(e,{id:t,state:r})=>({...e,[t]:r}),snapshotCreation:({numSnapshots:e,numFreshSnapshots:t},r)=>({numSnapshots:e+1,numFreshSnapshots:t+(r?1:0)}),beginRequest:(e,{computationKind:t})=>({...e,[t]:(e[t]??0)+1}),requestSkipped:(e,{computationKind:t})=>({...e,[t]:(e[t]??0)+1}),registerPluginFactory:({factories:e},{factoryName:t})=>({factories:[...e,a.PluginFactoryName[t]]}),pluginCompletedInTime:(e,{pluginName:t})=>({...e,[t]:(e[t]??0)+1}),computationStoppedExecution:({computationsStopReason:e,requestDurationHistograms:t,requestDurationHistogramByComputationKind:r,schedulerTimeSamples:n,computationTimeSamples:i},{computationName:a,stopReason:o,logInfo:{computationKind:s,requestTimes:l,computationTime:c,schedulerTime:d}})=>({computationsStopReason:{...e,[`${s}.${a}`]:{...e[`${s}.${a}`],[o]:(e[`${s}.${a}`]?.[o]??0)+1}},requestDurationHistograms:(0,u.updateDurationHistogramsWithRequestTimes)(t,l),requestDurationHistogramByComputationKind:{...r,[`${s}.${a}`]:(0,u.updateDurationHistogramsWithRequestTimes)(r[`${s}.${a}`]??{},l)},schedulerTimeSamples:(0,u.addSampleWithProbability)(n,d,5e-4),computationTimeSamples:(0,u.addSampleWithProbability)(i,c,5e-4)}),closeComputationFrame:(e,t)=>({...e,[t.computationKind]:{...e[t.computationKind],[t.stopReason]:(e[t.computationKind]?.[t.stopReason]??0)+1}}),nullCheckViolation:(e,{requestKind:t,violations:r})=>({...e,[t]:{...e[t],[r.join(";")]:(e[t]?.[r.join(";")]??0)+1}}),failure:(e,{failureKind:t,failureLevel:r})=>({...e,[t]:{...e[t],[r]:(e[t]?.[r]??0)+1}})};class f{log(e,t){this.isMessageForAnotherLogger(t)||((0,n.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")||"failure"===e.kind)&&g[e.kind](this.threadId,e.payload)}flush(){}flushBufferedMessages(){return[]}get threadId(){return this._threadId}set threadId(e){this._threadId=e}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==c.Immediate}constructor(){this._threadId=l,this.formatLogMessage=(e,t)=>m(this.threadId,e,t)}}t.ImmediateLogger=f;class S{log(e,t){this.isMessageForAnotherLogger(t)||(this.shouldBufferLogMessages()?((0,s.staticTypeHint)(e),this.logMessageBuffer.push([e,c.Aggregating])):(this.loggingStates[e.kind]=h[e.kind](this.loggingStates[e.kind],e.payload),this.periodicFlush(e.kind)))}flush(){if(this.shouldBufferLogMessages())return;const{requestDurationHistogramByComputationKind:e}=this.loggingStates.computationStoppedExecution;this.loggingStates.computationStoppedExecution.requestDurationHistogramByComputationKind={};const t=this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}),r=this.formatLogMessage("AgggregationLogger.flush",{description:"request duration histogram by computation kind",data:e});if(this.threadId===l){const e=(0,o.getTelemetryLogger)();e.sendTelemetryEvent((0,u.createX10AggregatedTelemetryEvent)(t)),e.sendTelemetryEvent((0,u.createX10RequestPerformanceEvent)(r))}}periodicFlush(e){"closeComputationFrame"===e&&(this.closeComputationFrameCount++,this.closeComputationFrameCount>=this.nextFlushThreshold&&(this.nextFlushThreshold*=1.33,this.flush()))}flushBufferedMessages(){const e=this.logMessageBuffer;return this.logMessageBuffer=[],e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}shouldBufferLogMessages(){return this.threadId!==l}isMessageForAnotherLogger(e){return(0,n.isDefined)(e)&&e!==c.Aggregating}constructor(){this.loggingStates={...p},this._threadId=l,this.logMessageBuffer=[],this.closeComputationFrameCount=0,this.nextFlushThreshold=4,this.formatLogMessage=(e,t)=>m(this.threadId,e,t)}}class v{log(e,t){this.immediateLogger.log(e,t),this.aggregatingLogger.log(e,t)}flush(){this.immediateLogger.flush(),this.aggregatingLogger.flush()}flushBufferedMessages(){return[...this.immediateLogger.flushBufferedMessages(),...this.aggregatingLogger.flushBufferedMessages()]}get threadId(){return this._threadId}set threadId(e){this._threadId=e,this.immediateLogger.threadId=e,this.aggregatingLogger.threadId=e}constructor(){this._threadId=l,this.immediateLogger=new f,this.aggregatingLogger=new S,this.formatLogMessage=(e,t)=>m(this.threadId,e,t)}}t.CombinedLogger=v,t.x10Logger=new v},4939:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterSuggestionsAccordingToPrefix=t.gridRangeToRange=t.ColoredReferencesVisitor=t.ValuePreviewVisitor=t.VisitorHelpers=t.RangeHelpers=t.TimelineQueueProcessor=t.defaultTimerInterface=t.resolveScriptLoaderPromise=t.setX10Features=t.ensurePluginAttached=t.ensureGroupAttached=t.spanToLSPRange=t.ValuePreviewResultExtractor=t.PluginRegistry=t.ALAnnotationKind=t.EventKind=t.ExecutionType=t.ComputationType=t.NotificationKind=t.RequestKind=t.delay=t.wrapIntoAsync=t.awaitPromise=t.serviceGeneratorProxy=t.serviceCall=t.typedRequest=t.PluginRequestKind=t.ComputationRequestKind=t.stableDynamicPluginLoaderInsideInit=t.DefaultComputationGroup=t.registerPluginFactory=t.PluginFactoryName=t.PluginGroup=t.RecalcSideGrid=t.FormulaKind=t.GridImportManagerSingleton=t.PluginSchedulerSingleton=t.getSchedulerFactories=t.defaultPluginResponseWindows=t.ChatGPTPlugin=t.staticTypeHint=t.platform=void 0;const n=r(6533);var i=r(3315);Object.defineProperty(t,"platform",{enumerable:!0,get:function(){return i.platform}});var a=r(3713);Object.defineProperty(t,"staticTypeHint",{enumerable:!0,get:function(){return a.staticTypeHint}});var o=r(542);Object.defineProperty(t,"ChatGPTPlugin",{enumerable:!0,get:function(){return o.ChatGPTPlugin}});var s=r(9084);Object.defineProperty(t,"defaultPluginResponseWindows",{enumerable:!0,get:function(){return s.defaultPluginResponseWindows}});var u=r(3948);Object.defineProperty(t,"getSchedulerFactories",{enumerable:!0,get:function(){return u.getSchedulerFactories}});var l=r(3948);Object.defineProperty(t,"PluginSchedulerSingleton",{enumerable:!0,get:function(){return l.PluginSchedulerSingleton}});var c=r(3948);Object.defineProperty(t,"GridImportManagerSingleton",{enumerable:!0,get:function(){return c.GridImportManagerSingleton}});var d=r(4563);Object.defineProperty(t,"FormulaKind",{enumerable:!0,get:function(){return d.FormulaKind}});var m=r(438);Object.defineProperty(t,"RecalcSideGrid",{enumerable:!0,get:function(){return m.RecalcSideGrid}});var g=r(1633);Object.defineProperty(t,"PluginGroup",{enumerable:!0,get:function(){return g.PluginGroup}});var p=r(1633);Object.defineProperty(t,"PluginFactoryName",{enumerable:!0,get:function(){return p.PluginFactoryName}});var h=r(2937);Object.defineProperty(t,"registerPluginFactory",{enumerable:!0,get:function(){return h.registerPluginFactory}});var f=r(6307);Object.defineProperty(t,"DefaultComputationGroup",{enumerable:!0,get:function(){return f.DefaultComputationGroup}});var S=r(3948);Object.defineProperty(t,"stableDynamicPluginLoaderInsideInit",{enumerable:!0,get:function(){return S.dynamicPluginLoaderInsideInit}});var v=r(6307);Object.defineProperty(t,"ComputationRequestKind",{enumerable:!0,get:function(){return v.ComputationRequestKind}});var y=r(6307);Object.defineProperty(t,"PluginRequestKind",{enumerable:!0,get:function(){return y.ComputationRequestKind}});var F=r(6307);Object.defineProperty(t,"typedRequest",{enumerable:!0,get:function(){return F.typedRequest}}),Object.defineProperty(t,"serviceCall",{enumerable:!0,get:function(){return F.serviceCall}}),Object.defineProperty(t,"serviceGeneratorProxy",{enumerable:!0,get:function(){return F.serviceGeneratorProxy}});var b=r(6307);Object.defineProperty(t,"awaitPromise",{enumerable:!0,get:function(){return b.awaitPromise}});var C=r(6913);Object.defineProperty(t,"wrapIntoAsync",{enumerable:!0,get:function(){return C.wrapIntoAsync}});var k=r(6307);Object.defineProperty(t,"delay",{enumerable:!0,get:function(){return k.delay}});var E=r(9084);Object.defineProperty(t,"RequestKind",{enumerable:!0,get:function(){return E.RequestKind}});var A=r(6410);Object.defineProperty(t,"NotificationKind",{enumerable:!0,get:function(){return A.NotificationKind}});var T=r(3747);Object.defineProperty(t,"ComputationType",{enumerable:!0,get:function(){return T.ComputationType}});var R=r(6700);Object.defineProperty(t,"ExecutionType",{enumerable:!0,get:function(){return R.ExecutionType}});var N=r(6246);Object.defineProperty(t,"EventKind",{enumerable:!0,get:function(){return N.EventKind}});var I=r(6246);Object.defineProperty(t,"ALAnnotationKind",{enumerable:!0,get:function(){return I.ALAnnotationKind}});var P=r(8708);Object.defineProperty(t,"PluginRegistry",{enumerable:!0,get:function(){return P.PluginRegistry}});var O=r(9702);Object.defineProperty(t,"ValuePreviewResultExtractor",{enumerable:!0,get:function(){return O.ValuePreviewResultExtractor}});var M=r(8049);Object.defineProperty(t,"spanToLSPRange",{enumerable:!0,get:function(){return M.spanToLSPRange}});var D=r(7894);Object.defineProperty(t,"ensureGroupAttached",{enumerable:!0,get:function(){return D.ensureGroupAttached}});var w=r(7894);Object.defineProperty(t,"ensurePluginAttached",{enumerable:!0,get:function(){return w.ensurePluginAttached}});var _=r(7894);Object.defineProperty(t,"setX10Features",{enumerable:!0,get:function(){return _.setX10Features}});var L=r(7894);Object.defineProperty(t,"resolveScriptLoaderPromise",{enumerable:!0,get:function(){return L.resolveScriptLoaderPromise}});var x=r(8402);Object.defineProperty(t,"defaultTimerInterface",{enumerable:!0,get:function(){return x.defaultTimerInterface}});var K=r(8402);Object.defineProperty(t,"TimelineQueueProcessor",{enumerable:!0,get:function(){return K.TimelineQueueProcessor}}),t.RangeHelpers=n.__importStar(r(8723)),t.VisitorHelpers=n.__importStar(r(6398));var B=r(9767);Object.defineProperty(t,"ValuePreviewVisitor",{enumerable:!0,get:function(){return B.ValuePreviewVisitor}});var W=r(5499);Object.defineProperty(t,"ColoredReferencesVisitor",{enumerable:!0,get:function(){return W.ColoredReferencesVisitor}});var U=r(8429);Object.defineProperty(t,"gridRangeToRange",{enumerable:!0,get:function(){return U.gridRangeToRange}});var G=r(9731);Object.defineProperty(t,"filterSuggestionsAccordingToPrefix",{enumerable:!0,get:function(){return G.filterSuggestionsAccordingToPrefix}})},9598:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[n]&&(r[n]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[n]};const r={},n="promises"},5192:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let n=!1;const i="undefined"!=typeof performance?performance:void 0;try{i&&i.now&&i.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(n){t.perfNow=!0;let e=Math.floor(100*i.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},6148:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},5033:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;const n=r(484);t.utils=n;const i=r(2745);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});const a=r(9598);t.browserSupport=a;const o=r(4215);t.perfWatch=o;const s=r(6810);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const u=r(2827);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return u.TelemetryCollector}});var l=r(5192);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var c=r(1003);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var d=r(6148);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return d.replaceChildren}})},2745:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(n||(t.LogCategory=n={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,n)=>t.traceTag(0,e,r,n),traceTag:(e,r,n,i)=>t.traceTag(e,r,n,i),debugTrace:(e,r,n)=>t.debugTraceTag(0,e,r,n),debugTraceTag:(e,r,n,i)=>t.debugTraceTag(e,r,n,i),assert:(e,r,n)=>t.assertTag(0,e,r,n),assertTag:(e,r,n,i)=>t.assertTag(e,r,n,i),shipAssert:(e,r,n)=>t.shipAssertTag(0,e,r,n),shipAssertTag:(e,r,n,i)=>t.shipAssertTag(e,r,n,i),dnmTrace:(e,r,n)=>t.dnmTraceTag(0,e,r,n),dnmTraceTag:(e,r,n,i)=>t.dnmTraceTag(e,r,n,i)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)}assertTag(e,t,r,n){console.assert(r,"assertTag",e,t,n)}traceTag(e,t,r,n){console.log("traceTag",e,n,t,r)}dnmTraceTag(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)}debugTraceTag(e,t,r,n){console.log("debugTraceTag",e,n,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},4215:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),i=e,a=t,o={},s=(e,t,r)=>function(e,t,r,i,a,o){n(e,"end",r);const s={sessionName:t,result:i?"success":"failure",message:o,marks:e};a(JSON.stringify(s))}(o,i,a,e,t,r);return o.start=0,{mark:e=>(e=>n(o,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},1003:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(n||(t.TextAreaInputMode=n={}))},6810:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(n){let i=r(),a=n;return{reset(e){null!=e&&(a=e),i=r()},stop(n){const o=r()-i,s=JSON.stringify({Target:a,Duration:o.toFixed(t),StopInfo:n});e(s)}}}};let r=()=>Date.now()},2827:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},484:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,n)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(n,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(n(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,i).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===i&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===i&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let n=1;n<=t;n+=1)r=r.catch((t=>e(n,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let n=1;n<e.length;n+=1){const i=e[n];r=r.catch((()=>t(i)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const n=e.length;for(let i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));let i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function n(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const i={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(i[t]=e[t])}));const a=Object.getPrototypeOf(e);a&&"object"==typeof a&&Object.keys(a).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(i[t]=e[t])}));const o={};return Object.keys(i).forEach((e=>{o[e]=n(i[e],t+1)})),o}const i="_",a=new RegExp("\\W+","g")},8424:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Mod=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(4471),i=r(7478),a=r(8368),o=new ArrayBuffer(8),s=new Int32Array(o),u=(new Float32Array(o),new Float64Array(o));function l(e){return s[e]}function c(e,t){s[e]=t}function d(){return u[0]}function m(e){u[0]=e}var g,p=new ArrayBuffer(65536),h=(g=new Uint8Array(p),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)g[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)g[e+n]=r[n]});h(1024,"yAwAAAEAAAACAAAAAwAAAAAAAAAE"),h(1056,"AQAAAAsAAAANAAAABwAAAAkAAAADAAAABQAAAA8AAAAAAAEAMAACADkAMQAcAAMAPQA6ADIAKgAmAB0AEQAEAD4ANwA7ACQANQAzACsAFgAtACcAIQAeABgAEgAMAAUAPwAvADgAGwA8ACkAJQAQADYAIwA0ABUALAAgABcACwAuABoAKAAPACIAFAAfAAoAGQAOABMACQANAAgABwAGAJAMAACYDAAAoAwAAKgMAAAfHR8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHR8eHx4fHx4fHh8="),h(1312,"WAwAAHAMAABoDAAAeAw="),h(1359,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),h(1759,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),h(2135,"oAQ="),h(2151,"yAc="),h(2167,"+go="),h(2182,"QJwO"),h(2198,"UMMR"),h(2214,"JPQU"),h(2229,"gJaYGA=="),h(2245,"ILy+Gw=="),h(2261,"KGvuHg=="),h(2277,"+QKVIg=="),h(2292,"QLdDuiU="),h(2308,"EKXU6Cg="),h(2324,"KueEkSw="),h(2339,"gPQg5rUv"),h(2355,"oDGpX+My"),h(2371,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//w=="),h(3126,"kEEYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),h(3182,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQAAsOlNYnBCBAQAABAE"),h(3904,"4E8=");var f=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int16Array(r),a=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),g=new e.Uint32Array(r),p=(new e.Float32Array(r),new e.Float64Array(r)),h=e.Math.imul,f=(e.Math.fround,e.Math.abs),S=e.Math.clz32,v=e.Math.min,y=(e.Math.max,e.Math.floor),F=e.Math.ceil,b=e.Math.sqrt,C=t.abort,k=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),E=t.Base_LocaleGetOrdinal,A=t.Base_LocaleDecimalSeparator,T=t.Math_log10,R=t.Math_log,N=(b=t.Math_sqrt,t.Math_sin),I=t.Math_cos,P=t.Math_tan,O=t.Math_atan,M=t.Math_exp,D=t.proc_exit,w=t.getTempRet0,_=20288,L=0;function x(){}function K(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function B(e,t){var r,s,c=0,d=0,g=0,h=0;if(d=3856,_=r=_-48|0,a[r+40>>2]=0,i[r+30>>1]=0,i[r+32>>1]=0,p[482]=e,s=z(e),p[482]=s,Fe(s,r+40|0,r,15),u[r+42>>1]){c=(0|(c=me(t)<<16))<0?100:c>>16,m(+t),g=0|l(1),l(0),(h=-65536&g)&&(2146435072!=(2146435072&g)?c=(0|h)<1?0-c|0:c:a[966]=1);e:{if(!((0|(c=i[r+40>>1]+c|0))>=i[r+42>>1])){if((0|c)<1){d=3168;break e}(255&c)>>>0>=o[r+30|0]||(n[r+30|0]=c)}ye(3276,3856,r)}e=p[d>>3]}return _=r+48|0,e}function W(e,t){var r,n=0,i=0,o=0;if(p[482]=e,m(+e),i=0|l(1),l(0),o=i,i=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?i=(0|n)<1:(a[966]=1,i=0)),a[965]=2147483647&o,re(p[395]),n=-65536&(o=a[965]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return Q(8),0}else a[966]=1;r=ne(p[395],e),ke(p[393],r),ie(r),he();e:{t:{if((n=a[965])>>>0>=65536){if(2146435072!=(2146435072&n))break t;a[966]=1}if(t){if(a[964]=0,a[965]=0,!i)break e;return t=a[783],a[964]=a[782],a[965]=t,p[482]}if(n=a[789],a[964]=a[788],a[965]=n,t=n,1^i|n>>>0<65536)break e;return a[965]=-2147483648^t,p[482]}Te(e),fe(),t&&(p[482]=ne(p[394],p[482]))}return p[482]}function U(e,t,r,n){var s,l=0,c=0,d=0,m=0,g=0,p=0,f=0;if(l=a[e+4>>2],g=-2146827284,!((0|(s=(c=u[e>>1])+(e=(0|(d=i[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+h(e,-12)<<16>>16)-1&65535)>>>0>11|(!l|1900==(0|s)&2==(0|d)&29==(0|l)?!r:0))){if(p=(0|(e=(m=(0|(c=s+1e4|0))/4|0)<<2))%100|0,f=(0|e)%400|0,l=(((m=h(m,1461)+l|0)+((0|(l=e+-1|0))/-100|0)|0)+((0|l)/400|0)|0)-1|0,c=(h(c-e|0,12)+d|0)-1|0)for(c=c+(e=f?p?0:12:0)|0;l=o[e+1232|0]+l|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=l+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=l+-4346384|0}else e=l+-4346384|0;e>>>0>2958465||(a[n>>2]=e,g=0)}return g}function G(e,t,r){var n,s,u,l=0,c=0,d=0;c=d=Oe(e,t,711573504,201),a[r+28>>2]=(c+1>>>0)%7,l=c+h(n=(c>>>0)/146097|0,-146097)|0,s=(h(l,100)+75>>>0)/3652425|0,l=((u=h(s,-36524)+l|0)>>>0)/1461|0,c=(((c+(((l=((h(s,100)+h(n,400)|0)+(l<<2)|0)+((h(u+h(l,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(l>>>2)|0)-((l>>>0)/400|0)|0)+h(l,-365)|0,d=Pe(d,L,-864e5,-1),e=Oe(e,t,1e4,0)+d|0,d=!(((t=l+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?2096+((t=o[c+1728|0])<<1)|0:1696+((t=o[c+1328|0])<<1)|0,a[r+12>>2]=(e>>>0)/36e5,a[r+4>>2]=t+1,a[r>>2]=l+1601,t=(e>>>0)/1e3|0,a[r+20>>2]=(t>>>0)%60,a[r+16>>2]=((e>>>0)/6e4>>>0)%60,a[r+24>>2]=e-h(t,1e3),a[r+8>>2]=1+(c-i[d>>1]|0)}function j(e,t){var r=0,n=0,o=0,s=0,u=0,l=0,c=0,d=0,m=0,g=0,p=0,f=0;return(0|(s=a[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=a[e>>2])+-1601|0)>>>0>29226||(0|(u=a[e+8>>2]))<1||(o=1696,((l=65535&r)>>>0)%400&&(o=3&r?2096:(l>>>0)%100|0?1696:2096),(m=a[e+24>>2])>>>0>999||(l=a[e+20>>2])>>>0>59||(g=a[e+16>>2])>>>0>59||(p=a[e+12>>2])>>>0>23||(u=u+-1|0)>>>0>=i[o+(s<<1)>>1]-i[o+(d<<1)>>1]>>>0||(o=n>>>2,s=h(n,365),n=((e=65535&n)>>>0)/400|0,f=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=2096,!((c>>>0)%100)|3&r)||(e=1696),c=1,r=(r=h(h(h(p,60)+g|0,60)+l|0,1e3)+m|0)+(n=Pe(e=i[(d<<1)+e>>1]+(n+((u+(s+o|0)|0)-f|0)|0)|0,e>>31,864e5,0))|0,e=L,a[t>>2]=Pe(r,r>>>0<n>>>0?e+1|0:e,1e4,0),a[t+4>>2]=L)),c}function V(e,t,r,n){var i,o=0,s=0,u=0,l=0;_=i=_-112|0,G(r,n,i+80|0);e:{if(a[e>>2]){if(!j(e,t))break e}else{if((0|(s=a[e+8>>2]))>5|!s)break e;if(r=a[e+4>>2],n=a[e+28>>2],o=a[i+80>>2],a[i+56>>2]=1,a[i+52>>2]=r,a[i+48>>2]=o,a[i+60>>2]=a[e+12>>2],a[i+64>>2]=a[e+16>>2],a[i+68>>2]=a[e+20>>2],e=a[e+24>>2],a[i+76>>2]=0,a[i+72>>2]=e,!j(i+48|0,i+8|0)){o=0;break e}e=n+8|0,r=n+1|0,u=(0|s)<2,G(a[i+8>>2],a[i+12>>2],i+16|0),l=i;t:{if((0|n)<(0|(o=a[i+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}a[l+56>>2]=e}t:if(!u&&(r=e+7|0,a[i+56>>2]=r,o=1,j(i+48|0,i+8|0)))for(;;){if(G(a[i+8>>2],a[i+12>>2],i+16|0),e=a[i+24>>2],(0|s)==(0|(o=o+1|0)))break t;if(r=r+7|0,a[i+56>>2]=r,!j(i+48|0,i+8|0))break}if(a[i+56>>2]=e,!j(i+48|0,i+8|0)){o=0;break e}e=a[i+12>>2],a[t>>2]=a[i+8>>2],a[t+4>>2]=e}o=1}return _=i+112|0,o}function H(e,t,r){var n,o=0,s=0,l=0,c=0,d=0;if(_=n=_-16|0,r&&(l=r>>31,l^=l+r))for(r=(0|r)>0?2112:2608;(o=15&l)&&(s=i[8+(o=(o<<4)+r|0)>>1],d=q(p[e>>3],p[o>>3],n),t=t+s|0,i[n+14>>1]<=0?(o=u[n+6>>1],s=u[n+8>>1]):(s=a[n+4>>2],o=u[n+6>>1]<<1,i[n+6>>1]=o,c=a[n+8>>2],a[n+12>>2]=a[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,a[n+8>>2]=s,t=t+-1|0),(65535&o|1&s|0!=(0|d))>>>0<32769||(s=(o=a[n+8>>2])+1|0,a[n+8>>2]=s,s>>>0>=o>>>0||(s=(o=a[n+12>>2])+1|0,a[n+12>>2]=s,s>>>0>=o>>>0||(a[n+12>>2]=-2147483648,t=t+1|0))),o=a[n+12>>2],a[e>>2]=a[n+8>>2],a[e+4>>2]=o),r=r+240|0,l>>=4;);return _=n+16|0,t}function q(e,t,r){var n,a,o,s=0,u=0,c=0,d=0,g=0,p=0,f=0,S=0,v=0,y=0,F=0,b=0;return m(+t),d=0|l(1),g=65535&(u=0|l(0)),m(+e),y=0|l(1),s=0|l(0),c=y,a=h(S=65535&s,g),i[r>>1]=a,o=((65535&(F=h(v=s>>>16,g)))+(a>>>16)|0)+(65535&(f=h(u>>>=16,S)))|0,i[r+2>>1]=o,F=(((p=((65535&(s=h(n=65535&c,g)))+(F>>>16)|0)+(f>>>16)|0)+(65535&(f=h(u,v)))|0)+(65535&(b=h(y=65535&d,S)))|0)+(o>>>16)|0,i[r+4>>1]=F,f=(((((((65535&(p=h(d>>>=16,S)))+(s>>>16)|0)+(65535&(c=h(s=c>>>16,g)))|0)+(f>>>16)|0)+(b>>>16)|0)+(65535&(g=h(y,v)))|0)+(65535&(S=h(u,n)))|0)+(F>>>16)|0,i[r+6>>1]=f,v=((((((b=(c>>>16)+(p>>>16)|0)+(65535&(c=h(d,v)))|0)+(g>>>16)|0)+(S>>>16)|0)+(65535&(p=h(s,u)))|0)+(65535&(u=h(y,n)))|0)+(f>>>16)|0,i[r+8>>1]=v,p=((u=(((65535&(g=h(d,n)))+(c>>>16)|0)+(p>>>16)|0)+(u>>>16)|0)+(65535&(c=h(s,y)))|0)+(v>>>16)|0,i[r+10>>1]=p,s=(((65535&(d=h(s,d)))+(g>>>16)|0)+(c>>>16)|0)+(p>>>16)|0,i[r+12>>1]=s,i[r+14>>1]=(s>>>16)+(d>>>16),65535&(a|o|F)}function z(e){var t,r,n=0,i=0,o=0,s=0,u=0,c=0;return _=t=_-16|0,p[t+8>>3]=e,m(+e),n=0|l(1),i=0|l(0),r=n,(n&=2146435072)&&(a[t+8>>2]=i<<11,a[t+12>>2]=r<<11|i>>>21|-2147483648,s=(n=h(i=(n>>>20)-1022|0,39457)>>17)-14|0,o=H(t+8|0,i,14-n|0),i=a[t+8>>2],(0|o)>=(0|(g[t+12>>2]<(i>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=H(t+8|0,o,1),i=a[t+8>>2],s=n+-15|0),n=s,s=(s=i)+(i=-2147483648>>>(31&o))|0,a[t+8>>2]=s,s>>>0>=i>>>0||(c=(u=a[t+12>>2])+1|0,a[t+12>>2]=c,c>>>0>=u>>>0||(a[t+12>>2]=-2147483648,o=o+1|0)),a[t+8>>2]=s&0-(i<<1),o=H(t+8|0,o,n),3071&(n=a[t+8>>2])?(i=n+1024|0,a[t+8>>2]=i,n>>>0<4294966272||(s=(n=a[t+12>>2])+1|0,a[t+12>>2]=s,o=(s>>>0<n>>>0)+o|0)):i=n,(0|o)<=-1023?(a[t+8>>2]=0,a[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=a[t+12>>2],a[t+8>>2]=o<<21|i>>>11,a[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=p[t+8>>3]),_=t+16|0,e}function Q(e){var t;return t=a[966],a[966]=e,t}function $(){var e,t,r;return e=a[964],t=a[965],ee(1048576),ee(2146435072),i[1931]<0?(a[964]=e,a[965]=t,-2147483648):(r=de(),a[964]=e,a[965]=t,-2147483648^r)}function Y(e){var t,r=0,n=0,i=0,a=0;if(m(+e),r=0|l(1),t=0|l(0),a=r,i=0,!((r=2047&(n=r>>>20))>>>0<1023||(i=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|a),+d();a&=n,c(0,0),c(1,0|a),i=+d()}return i}function J(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return a[964]=0,a[965]=-2147483648,n=H(3856,1,e),r=a[964],e=a[965],3071&r&&(t=a[965],(e=a[964]+1024|0)>>>0<1024&&(t=t+1|0),a[964]=e,a[965]=t,r=e,e=t),a[964]=e<<21|r>>>11,void(a[965]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(a[966]=1),a[964]=0,a[965]=0}function X(e,t,r,n){var o=0,s=0,l=0;e:{t:{r:{n:{if(!n){if(u[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return a[t>>2]=1,void(a[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break e;for(;;){if(l=u[(s=((o=n+-1|0)<<1)+e|0)>>1]+1|0,i[s>>1]=l,58!=(65535&l))break e;if(!(n=o))break}}return i[e>>1]=49,a[t>>2]=a[t>>2]+1,void(a[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);a[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=a[964],t=-65536&(e=a[965])){if(2146435072==(2146435072&e))return a[966]=1,void Se();if((0|t)<1)break e}return void Se()}Se(),(0|r)==a[964]&&a[965]==(0|e)||re(1)}function ee(e){p[482]=te(p[482],e)}function te(e,t){var r;return m(+(e+=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(a[966]=1,e=p[396]),e}function re(e){p[482]=ne(p[482],e)}function ne(e,t){var r;return m(+(e-=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(a[966]=1,e=p[396]),e}function ie(e){p[482]=ae(p[482],e)}function ae(e,t){var r,n=0,i=0,o=0;return m(+e*t),n=0|l(1),r=0|l(0),0|2146435072!=(0|(i=2146435072&n))?(o=(i=!(i|o))?a[792]:r,n=i?a[793]:n,c(0,0|o),c(1,0|n),+d()):(a[966]=1,n=a[793],c(0,a[792]),c(1,0|n),+d())}function oe(e){p[482]=se(p[482],e)}function se(e,t){var r=0,n=0,i=0,o=0;if(m(+t),r=0|l(1),l(0),2146435072&r){if(n=1,m(+e/t),r=0|l(1),i=0|l(0),!(!0&2146435072==(0|(o=2146435072&r))))return i=(n=!(0|o))?a[792]:i,r=n?a[793]:r,c(0,0|i),c(1,0|r),+d()}else n=4;return a[966]=n,r=a[793],c(0,a[792]),c(1,0|r),+d()}function ue(e){p[482]=e>>>0}function le(e){p[482]=0|e}function ce(){var e,t;e=+R(+p[482]),p[482]=e,m(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}function de(){return me(p[482])}function me(e){var t,r=0,n=0,i=0,a=0;return m(+e),a=1106247680==(0|(i=2146435072&(r=0|l(1))))&a>>>0<0|i>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|l(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(i=f(e)>=1?e>0?~~v(y(e/4294967296),4294967295)>>>0:~~F((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(i=0,r=0),n=a?r:n,!(r=a?i:t)&n>>>0<4294967295|r>>>0<0?n:-1}function ge(){return pe(p[482])}function pe(e){var t=0,r=0;return m(+e),t=0|l(1),l(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=f(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function he(){var e,t;e=+b(+p[482]),p[482]=e,m(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}function fe(){var e,t;e=+O(+p[482]),p[482]=e,m(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}function Se(){p[482]=Y(p[482])}function ve(){var e,t;e=+M(+p[482]),p[482]=e,m(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=1)}function ye(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=o[r+30|0]){for(s=r;d=10*d+ +(0|we[a[a[e>>2]+4>>2]](e,u[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(m(+d),n=0|l(1),e=0|l(0),a[t>>2]=e<<11,a[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=H(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(s=a[t>>2])?(e=s+1024|0,a[t>>2]=e,s>>>0<4294966272||(c=(s=a[t+4>>2])+1|0,a[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=a[t+4>>2],a[t>>2]=n<<21|e>>>11,a[t+4>>2]=-2147483648&i[r+32>>1]|s|n>>>11&1048575,0)}return a[t>>2]=0,a[t+4>>2]=0,0}(e,t,r)}function Fe(e,t,r,o){!function(e,t,r,o){var s,c,d=0,g=0,f=0,S=0,v=0,y=0,F=0,b=0,C=0,k=0;_=s=_-16|0,p[s+8>>3]=e,c=t,m(+e),g=0|l(1),f=0|l(0),S=d=g;e:if(g=2146435072&d){if(g=h(v=(g>>>20)-1022|0,39457)>>17,i[r+32>>1]=g+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+g|0)|0))<=-1){n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(a[s+8>>2]=f<<11,a[s+12>>2]=S<<11|f>>>21|-2147483648,(0|(d=H(s+8|0,v,-1^g)))>=1)for(f=r+32|0;g=u[f>>1],i[f>>1]=g+1&32767|32768&g,(0|(d=H(s+8|0,d,-1)))>0;);if(d?(g=(f=a[s+12>>2])>>>(S=0-d|0),a[s+12>>2]=g,d=f<<d+32|a[s+8>>2]>>>S,a[s+8>>2]=d):(d=a[s+8>>2],g=a[s+12>>2]),d=(f=g>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,a[s+8>>2]=d,d>>>0<f>>>0&&(g=g+1|0,a[s+12>>2]=g),(0|o)<1)f=r;else{for(y=d>>>16,F=u[s+14>>1],b=r+32|0,k=15==(0|o),f=r,S=1;;){v=o;t:{r:{for(;;){if(o=h(y,10)+(h(65535&d,10)>>>16)>>>16,C=h(F,10)+(o+h(65535&g,10)>>>16)>>>16|48,i[f>>1]=C,F=(g=o+h(g,10)|0)>>>16,y=(d=h(d,10))>>>16,1&(-1^S|48!=(0|C)))break r;if(o=u[b>>1],i[b>>1]=o+-1&32767|32768&o,!k)break}S=1;break t}f=f+2|0,S=0}if(o=v+-1|0,!((0|v)>1))break}a[s+12>>2]=g,a[s+8>>2]=d}d=(o=f-r|0)>>1;t:{if((0|o)<=29){if((0|g)<=-1){i[f>>1]=57,g=d+1|0;break t}i[f>>1]=48}for(;;){if(g=d,(0|d)<1)break t;if(d=g+-1|0,48!=u[(f=f+-2|0)>>1])break}}n[r+30|0]=g,i[t+2>>1]=g,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;i[c>>1]=t,_=s+16|0}(e,t,r,o)}function be(e,t,r,n){var i,o=0,s=0,u=0,l=0,c=0,d=0,m=0;c=a[t+4>>2],i=a[t>>2],l=u,u=a[e>>2],e=Pe(i,l,o=a[e+4>>2],t=0),s=L,o=Pe(l=c,c=0,o,t),t=L+d|0,t=(s=s+o|0)>>>0<o>>>0?t+1|0:t,o=s,d=t,t=Pe(l,c,s=u,0),l=(u=o)+(o=L)|0,u=d,u=l>>>0<o>>>0?u+1|0:u,o=0,d=Pe(i,m,s,c),e=(s=(m=L)+e|0)>>>0<m>>>0?o+1|0:o,c=t,s=t+s|0,t=e,e=l,l=t=s>>>0<c>>>0?t+1|0:t,(t=e+t|0)>>>0<l>>>0&&(u=u+1|0),a[r>>2]=t,a[r+4>>2]=u,a[n>>2]=d,a[n+4>>2]=s}function Ce(e){return ne(p[482],e)}function ke(e,t){p[482]=ne(e,t)}function Ee(e){return ae(p[482],e)}function Ae(e){return se(p[482],e)}function Te(e){p[482]=se(e,p[482])}function Re(e,t){p[482]=se(e,t)}function C(){D(1),C()}function Ne(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Ie(e,t,r,n){var i=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,m=0,g=0;e:{t:{r:{n:{i:{a:{o:{s:{u:{l:{if(o=t){if(!(i=r))break l;if(!(a=n))break u;if((i=S(a)-S(o)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ne(e-h(t=(e>>>0)/(r>>>0)|0,r)|0,0),L=0,t}if(i=n,!e)break o;if(!i)break a;if((a=i+-1|0)&i)break a;return Ne(e,o&a),e=o>>>(31&De(i)),L=0,e}if(!((a=i+-1|0)&i))break i;l=0-(u=(S(i)+33|0)-S(o)|0)|0;break r}u=i+1|0,l=63-i|0;break r}return Ne(0,o-h(e=(o>>>0)/(i>>>0)|0,i)|0),L=0,e}if((i=S(i)-S(o)|0)>>>0<31)break n;break t}if(Ne(e&a,0),1==(0|i))break e;return n=e,e=31&(r=De(i)),32<=(63&r)>>>0?(i=0,e=t>>>e):(i=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),L=i,e}u=i+1|0,l=63-i|0}if(a=t,m=e,o=31&(i=63&u),32<=(63&i)>>>0?(i=0,s=a>>>o):(i=a>>>o,s=((1<<o)-1&a)<<32-o|m>>>o),a=i,o=e,e=31&(i=63&l),32<=(63&i)>>>0?(i=o<<e,e=0):(i=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=i,u)for(i=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(i=i+1|0),l=i;i=a<<1|s>>>31,a=s<<1,m=i,i=(s=l-((o>>>0<(a|=t>>>31)>>>0)+i|0)|0)>>31,s=(d=a)-(a=r&(c=s>>31))|0,a=m-((n&i)+(d>>>0<a>>>0)|0)|0,i=t<<1|e>>>31,e=g|e<<1,t=0|i,d=0,g=c&=1,u=u+-1|0;);return Ne(s,a),L=(i=t<<1|e>>>31)|d,c|e<<1}Ne(e,t),e=0,t=0}return L=t,e}function Pe(e,t,r,n){return e=function(e,t,r,n){var i,a,o,s,u=0,l=0;return s=h(u=r>>>16,l=e>>>16),u=(65535&(l=((o=h(i=65535&r,a=65535&e))>>>16)+h(l,i)|0))+h(u,a)|0,e=(((h(t,r)+s|0)+h(e,n)|0)+(l>>>16)|0)+(u>>>16)|0,L=e,65535&o|u<<16}(e,t,r,n),e}function Oe(e,t,r,n){return e=function(e,t,r,n){var i=0,a=0;return r=Ie((e^=i=t>>31)-i|0,a=((a=t>>31)^t)-((e>>>0<i>>>0)+a|0)|0,(r^=e=n>>31)-e|0,((i=n>>31)^n)-((r>>>0<e>>>0)+i|0)|0),L=((e=(t^=n)>>31)^L)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,r-t|0}(e,t,r,n),e}function Me(e,t,r,n){return Ie(e,t,r,n),t=0|("function"==typeof setTempRet0&&setTempRet0(s[1]),s[0]),e=0|w(),L=e,0|t}function De(e){return e?31-S(e+-1^e)|0:32}var we=[null,function(e,t){return 0!=(0|k(0|(t|=0)))|0},function(e,t){return 0|E(0|(t|=0))},function(e){return 0|A()},function(e,t){return(t|=0)-48|0},x];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3280},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1232+(((h(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=h(r|=0,20)+3792|0,i[r>>1]=0,t=function(e,t,r,n,s){var g=0,f=0,S=0,v=0,y=0,F=0,b=0,C=0,k=0;e:if(!u[e>>1]){if(p[482]=t,m(+t),g=0|l(1),S=0|l(0),F=g,k=-65536&g)if(2146435072!=(2146435072&g)){if(!((0|k)>=1))return-2147467259}else a[966]=1;y=a[812],v=-1;t:{if(!((0|g)<(0|(f=b=a[813]))||(v=1,(0|g)>(0|f)))){if((0|y)==(0|(f=S)))break t;v=f>>>0<y>>>0?-1:1}if(f=-2147467259,1==(0|((F&b)>-1?v:0-v|0)))break e}t:{if(y=a[814],b=f=a[815],v=-1,!((0|g)<(0|f)||(v=1,(0|g)>(0|b)))){if((0|S)==(0|y))break t;v=S>>>0<y>>>0?-1:1}if(y=v,-1==(0|((f&F)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(s|!k))if(2146435072!=(2146435072&g)){if((0|k)<1)break r}else a[966]=1;ee(p[a[1216+(r<<2)>>2]>>3]),C=p[482];break t}Z(),re(t),S=F=a[965],c(0,0|(g=a[964])),c(1,0|S),C=+d(),a[792]==(0|g)&&a[793]==(0|S)||(f=a[965])>>>0<65536||(a[965]=-2147483648^f,m(+(C=p[482])),S=0|l(1),g=0|l(0)),F=S,y=S,S=a[1216+(r<<2)>>2],b=a[S+4>>2],f=a[S>>2],v=-1;r:{if(!((0|y)<(0|(S=b))||(v=1,(0|y)>(0|S)))){if((0|g)==(0|f)){p[482]=t;break r}v=g>>>0<f>>>0?-1:1}if(y=v,p[482]=t,-1==(0|((F&b)>-1?y:0-y|0)))break t}re(p[395])}if(i[e+18>>1]=r,g=ge(),f=-2147467259,!Q(0)){if(n){if((0|g)>2957003)break e;g=g+1462|0}else if(g+4346018>>>0>7304483)break e;if(i[e+14>>1]=1+((g+6|0)%7|0),!s|g)if(g){if((0|g)<=-1?(S=-4-((n=(-1^g)/1461|0)<<2)|0,f=1461+(h(n,1461)+g|0)|0):(S=(n=(g+-1|0)/1461|0)<<2,f=h(n,-1461)+g|0),!(s&&(0|S)<=199))if((0|(f=(((0|(n=S+-101|0))/100|0)-((0|n)/400|0)|0)+f|0))>=1462){g=3&(n=S+1900|0);t:if(s){if(g|(0|S)<200)break t;g=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else g||(g=!((0|n)%100)&0!=((0|n)%400|0));S=S+4|0,f=(12==(0|h(g,12))?-1460:-1461)+f|0}else(0|f)>0||(S=S+-4|0,f=f+1461|0);g=3&(n=S+1900|0);t:if(s){if(g|(0|S)<200)break t;g=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else g||(g=!((0|n)%100)&0!=((0|n)%400|0));for(g=F=h(g,12);s=g,g=g+1|0,(0|(f=(n=f)-o[s+1232|0]|0))>0;);s=((f=s)-((0|F)<(0|(s=s+-11|0))?F:s)>>>0)/12|0,i[e>>1]=1900+(s+S|0),i[e+2>>1]=(h(s,-12)+g|0)-F}else a[e>>2]=788331,n=30;else a[e>>2]=67436;if(a[e+4>>2]=n,p[482]=C,Se(),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(C),ie(p[400]),t=p[482],n=de(),i[e+8>>1]=n,ue(n<<16>>16),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),ie(p[401]),t=p[482],n=de(),i[e+10>>1]=n,ue(n<<16>>16),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),ie(p[401]),!r)return r=de(),i[e+16>>1]=0,i[e+12>>1]=r,0;t=p[482],n=de(),i[e+12>>1]=n,ue(n<<16>>16),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),ie(p[a[1312+(r<<2)>>2]>>3]),p[482]=z(p[482]),i[e+16>>1]=de(),f=0}}return f}(r,e,t,0!=(0|n),0!=(0|s)),a[966]=0,0|t},Dtr_Yr:function(e){return i[h(e|=0,20)+3792>>1]},Dtr_Mon:function(e){return i[h(e|=0,20)+3794>>1]},Dtr_DOM:function(e){return a[h(e|=0,20)+3796>>2]},Dtr_Hour:function(e){return i[h(e|=0,20)+3800>>1]},Dtr_Min:function(e){return i[h(e|=0,20)+3802>>1]},Dtr_Sec:function(e){return i[h(e|=0,20)+3804>>1]},Dtr_Wdy:function(e){return i[h(e|=0,20)+3806>>1]},Dtr_FracSec:function(e){return i[h(e|=0,20)+3808>>1]},Dtr_Rounding:function(e){return i[h(e|=0,20)+3810>>1]},Dtr_Write:function(e,t,r,n,o,s,u,l,c,d){e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,u|=0,l|=0,c|=0,d=h(d|=0,20),i[d+3810>>1]=c,i[d+3808>>1]=l,i[d+3806>>1]=u,i[d+3804>>1]=s,i[d+3802>>1]=o,i[d+3800>>1]=n,a[d+3796>>2]=r,i[d+3794>>1]=t,i[d+3792>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,a[964]=0,a[965]=0,function(e,t,r){var n,o=0;_=n=_-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){if(i[e+18>>1]>=1?(le(i[e+16>>1]),o=Ae(p[a[1312+(i[e+18>>1]<<2)>>2]>>3]),le(i[e+12>>1]),ee(o)):le(i[e+12>>1]),o=Ae(p[401]),le(i[e+10>>1]),ee(o),o=Ae(p[401]),le(i[e+8>>1]),ee(o),o=Ae(p[400]),!((0|U(e,t,r,n+12|0))<0)){if(e=a[n+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=a[965])))break t;if(2146435072==(2146435072&e)){a[966]=1;break t}if((0|t)>=1)break t}}a[964]=0,a[965]=0}a[964]=0,a[965]=0,Q(8);break e}ue(e)}ee(o)}_=n+16|0}(h(e,20)+3792|0,0!=(0|t),0!=(0|r)),+p[482]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,a[964]=0,a[965]=0,function(e,t,r,n,o){var s,l=0;_=s=_-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){n:if(i[e+18>>1]>=1){if(le(i[e+16>>1]),oe(p[a[1312+(i[e+18>>1]<<2)>>2]>>3]),l=p[482],2==(0|o)){p[482]=n,ee(l);break n}le(i[e+12>>1]),ee(l)}else 2!=(0|o)?le(i[e+12>>1]):p[482]=n;if(oe(p[401]),l=p[482],1!=(0|o)?le(i[e+10>>1]):p[482]=n,ee(l),oe(p[401]),l=p[482],o?le(i[e+8>>1]):p[482]=n,ee(l),oe(p[400]),n=p[482],!((0|U(e,t,r,s+12|0))<0)){if(e=a[s+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(!(t=-65536&(e=a[965])))break t;if(2146435072==(2146435072&e)){a[966]=1;break t}if((0|t)>=1)break t}}a[964]=0,a[965]=0}a[964]=0,a[965]=0,Q(8);break e}ue(e)}ee(n)}_=s+16|0}(h(e,20)+3792|0,0!=(0|t),0!=(0|r),+(0|o),n),+p[482]},Dtr_Days:function(){return a[963]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|U(h(e|=0,20)+3792|0,0!=(0|t),0!=(0|r),3852)},Dtr_ToTime:function(e,t,r){return function(e,t,r){p[482]=e,ee(p[a[1216+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ie(p[401]);ie(p[401])}ie(p[400]),Se()}(e=+e,t|=0,r|=0),+p[482]},Dtr_UtcToLocal:function(e,t,r,n,o,s,l,c){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,l|=0,c|=0,_=d=_-32|0,a[d+24>>2]=s,a[d+16>>2]=n,a[d+8>>2]=t,a[d+20>>2]=(0|o)>-1?h(o,20)+3792|0:0,a[d+12>>2]=(0|r)>-1?h(r,20)+3792|0:0,e=function(e,t,r,n){var o,s=0;return _=o=_-32|0,function(e,t,r){var n,o=0,s=0,l=0,c=0,d=0,m=0,g=0,p=0,f=0,S=0,v=0,y=0;if(_=n=_-96|0,a[n+64>>2]=i[t>>1],a[n+68>>2]=i[t+2>>1],a[n+72>>2]=a[t+4>>2],a[n+76>>2]=i[t+8>>1],a[n+80>>2]=i[t+10>>1],a[n+84>>2]=i[t+12>>1],a[n+92>>2]=i[t+14>>1]+-1,(o=i[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=h(i[t+16>>1],100);break e;case 1:o=h(i[t+16>>1],10);break e;case 2:break t;default:break e}o=i[t+16>>1]}a[n+88>>2]=o}t=0;e:if(j(n- -64|0,n+40|0)){if(l=Pe(l=h(a[e>>2],60),l>>31,1e7,0),d=L,(s=a[e+4>>2])&&(c=a[e+12>>2])){if(a[n+64>>2]=i[s>>1],a[n+68>>2]=i[s+2>>1],a[n+72>>2]=a[s+4>>2],a[n+76>>2]=i[s+8>>1],a[n+80>>2]=i[s+10>>1],a[n+84>>2]=i[s+12>>1],a[n+92>>2]=i[s+14>>1]+-1,(o=i[s+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=h(i[s+16>>1],100);break t;case 1:o=h(i[s+16>>1],10);break t;case 2:break r;default:break t}o=i[s+16>>1]}a[n+88>>2]=o}if(a[n+8>>2]=i[c>>1],a[n+12>>2]=i[c+2>>1],a[n+16>>2]=a[c+4>>2],a[n+20>>2]=i[c+8>>1],a[n+24>>2]=i[c+10>>1],a[n+28>>2]=i[c+12>>1],a[n+36>>2]=i[c+14>>1]+-1,(o=i[c+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=h(i[c+16>>1],100);break t;case 1:o=h(i[c+16>>1],10);break t;case 2:break r;default:break t}o=i[c+16>>1]}a[n+32>>2]=o}if(c=s=a[n+44>>2],!V(n- -64|0,n+56|0,o=a[n+40>>2],s))break e;if(!V(n+8|0,n+48|0,o,c))break e;f=a[n+40>>2],g=a[n+44>>2],S=l,v=e+16|0,y=e+8|0,p=(c=d)+a[n+52>>2]|0,(m=(o=l)+a[n+48>>2]|0)>>>0<o>>>0&&(p=p+1|0),s=m,m=Pe(o=h(a[e+8>>2],60),o>>31,1e7,0),o=L+p|0,p=s=s+m|0,m=o=s>>>0<m>>>0?o+1|0:o,s=d+a[n+60>>2]|0,(d=l+a[n+56>>2]|0)>>>0<l>>>0&&(s=s+1|0),l=Pe(e=h(a[e+16>>2],60),e>>31,1e7,0),e=L+s|0,e=(d=l+d|0)>>>0<l>>>0?e+1|0:e,l=d,e=Pe(e=h(a[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(p>>>0>=l>>>0)?((0|g)<(0|e)?1:(0|g)<=(0|e)?f>>>0>=l>>>0?0:1:0)&((0|g)>(0|m)?1:(0|g)>=(0|m)?f>>>0<p>>>0?0:1:0):((0|g)<(0|e)?1:(0|g)<=(0|e)?f>>>0>=l>>>0?0:1:0)|((0|g)>(0|m)?1:(0|g)>=(0|m)?f>>>0<p>>>0?0:1:0))?v:y)>>2],60),e>>31,1e7,0),o=L+c|0,d=o=(l=S+e|0)>>>0<e>>>0?o+1|0:o}e=a[n+40>>2],o=a[n+44>>2]-(d+(e>>>0<l>>>0)|0)|0,l=e-l|0,(0|(e=o))<0||(0|e)<=0&&!(l>>>0>=0)||(G(l,e,n- -64|0),i[r>>1]=a[n+64>>2],i[r+2>>1]=a[n+68>>2],a[r+4>>2]=a[n+72>>2],t=1,i[r+14>>1]=u[n+92>>1]+1,i[r+8>>1]=a[n+76>>2],i[r+10>>1]=a[n+80>>2],i[r+12>>1]=a[n+84>>2],e=a[n+88>>2],i[r+18>>1]=3,i[r+16>>1]=e)}return _=n+96|0,t}(n,e,o+8|0)&&(n=a[o+12>>2],a[e>>2]=a[o+8>>2],a[e+4>>2]=n,a[e+16>>2]=a[o+24>>2],n=a[o+20>>2],a[e+8>>2]=a[o+16>>2],a[e+12>>2]=n,n=e,(0|U(e,t,r,o+28|0))>=0?e=1+((a[o+28>>2]+6|0)%7|0)|0:(a[o+28>>2]=-1,e=6),i[n+14>>1]=e,s=1),_=o+32|0,s}(h(e,20)+3792|0,0!=(0|l),0!=(0|c),d+8|0),_=d+32|0,0|e},Mathpack_Zero:function(){return+p[396]},Mathpack_One:function(){return+p[395]},Mathpack_Pi:function(){return+p[391]},Mathpack_Div:function(e,t){return+se(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+ne(e=+e,t=+t)},Mathpack_Add:function(e,t){return+te(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,s=0;p[482]=t,m(+t),r=0|l(1),l(0),o=r,a[965]=2147483647&r,t=p[482];e:{if(m(+Ce(p[392])),65535==(0|(r=0|l(1)))&(n=0|l(0))>>>0<=4294967295|r>>>0<65535)p[482]=e,he();else if(Se(),m(+Ce(t)),65535==(0|(r=0|l(1)))&(n=0|l(0))>>>0>4294967295|r>>>0>65535||-1==(0|(r=de()))){if(p[482]=e,m(+e),n=0|l(1),l(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ie(t),ve();else if(!((0|n)>-1)){if(Re(p[395],t),s=z(p[482]),p[482]=s,Se(),m(+Ce(s)),65535==(0|(n=0|l(1)))&l(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=ge()))|!(1&n))break e;p[482]=e,a[965]=2147483647&r,ce(),ie(t),ve(),(r=a[965])>>>0<65536||(a[965]=-2147483648^r)}}else p[482]=e,function(e){var t,r=0;if((t=i[1931])|e){if(!((0|t)<1)&&10==(0|de())){if(r=p[482],Se(),re(r),!u[1931])return void J(e);p[482]=r}for(r=1;1&e&&(r=Ee(r)),e>>>=1;)ie(p[482]);p[482]=r}else a[966]=4&a[966]?4:64}(r);if(o>>>16<<16>>16<=-1){if(1&(o=a[966]))return a[964]=0,a[965]=0,a[966]=-2&o,p[482];Te(p[395])}return p[482]}return a[966]=8,p[482]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return m(+(e=+e)),t=0|l(1),l(0),(r=-65536&t)?2146435072==(2146435072&t)?(a[966]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,i,a,o=0,s=0,u=0;m(+(e=+e)),o=0|l(1),r=0|l(0),n=o,a=o,m(+t),i=0|l(1),o=0|l(0),u=-1;e:{if(!((0|n)<(0|(s=i))||(u=1,(0|a)>(0|s)))){if(s=0,(0|o)==(0|r))break e;u=r>>>0<o>>>0?-1:1}o=u,s=(i&n)>-1?o:0-o|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=a[966],a[966]=0,0|e},Mathpack_Trunc:function(e){return+Y(e=+e)},Mathpack_Ceil:function(e){return e=+e,p[482]=e,function(){var e=0,t=0,r=0;e:{if(r=a[964],t=-65536&(e=a[965])){if(2146435072==(2146435072&e))return a[966]=1,void Se();if((0|t)>0)break e}return void Se()}Se(),(0|r)==a[964]&&a[965]==(0|e)||ee(1)}(),+p[482]},Mathpack_Floor:function(e){return e=+e,p[482]=e,Z(),+p[482]},Mathpack_Abs:function(e){var t=0;return m(+(e=+e)),t=0|l(1),t&=2147483647,c(0,0|l(0)),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,i;return m(+(e=+e)),n=-2147483648^(t=0|l(1)),c(0,0|(r=0|l(0))),c(1,0|n),i=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?i:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|me(e=+e)},Mathpack_LFix:function(e){return 0|pe(e=+e)},Mathpack_SFix:function(e){return e=+e,p[482]=e,0|$()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,s=0,c=0,d=0;_=r=_+-64|0,a[r+56>>2]=0,i[r+46>>1]=0,i[r+48>>1]=0,p[482]=e,m(+e),o=0|l(1),l(0);e:if(s=-65536&o)if(2146435072!=(2146435072&o)){(0|s)>0||(d=32768,o>>>0<65536||(a[965]=-2147483648^o,e=p[482])),Fe(e,r+56|0,r+16|0,15),u[r+58>>1]||(i[r+56>>1]=1),p[482]=t,o=(0|(o=$()))<0?100:o;t:{if(c=-65536&(s=a[965]))if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((o=a[965])>>>0>=65536&&(a[965]=-2147483648^o),(0|(o=$()))<=-1)break t;o=0-o|0}}else a[966]=1;(0|(c=o+(s=i[r+56>>1])|0))<(0|(o=i[r+58>>1]))&&(a[r+12>>2]=o,a[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),o=a[r+12>>2],i[r+58>>1]=o,s=a[r+8>>2],i[r+56>>1]=s),n[r+46|0]=o,i[r+48>>1]=s+16384&32767|d,ye(3276,3856,r+16|0),e=p[482];break e}e=p[396]}else a[966]=1;return _=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,i=0,o=0,s=0;if(m(+e),r=0|l(1),l(0),(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:a[966]=1),i=B(e,t),p[482]=e,p[482]=z(e),re(i),(r=a[965])>>>0>=65536){if(2146435072==(2146435072&r))return a[966]=1,i;if(r=(0|(r=me(t)<<16))<0?309:r>>16,m(+t),n=0|l(1),l(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:a[966]=1),(0|r)<=-309)return Q(8),0;J(0-r|0),(0|s)>-1||(r=a[965])>>>0<65536||(a[965]=-2147483648^r),ee(i),i=p[482]}return i}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return m(+(e=B(e=+e,t=+t))),r=0|l(1),l(0),2146435072==(2146435072&r)&&(a[966]=1,e=-1),+e},Mathpack_TenTo:function(e){return J(e|=0),+p[482]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,i=0,o=0,s=0,u=0;_=r=_-16|0,p[r+8>>3]=e,p[r>>3]=t,m(+e),n=0|l(1),i=0|l(0),o=n,m(+t),u=n=0|l(1);e:{if((0|i)!=(0|(s=0|l(0)))||(0|o)!=(0|n)){if((u+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=z(e),p[r+8>>3]=e,m(+e),n=0|l(1),l(0),o=n,e=z(t),p[r>>3]=e,m(+e),n=0|l(1),l(0),u=n),n=1,(0|(o=a[(s=(i=(u&o)>-1)?r+8|0:r)+4>>2]))>(0|(u=a[(i=i?r:r+8|0)+4>>2])))break e;if((0|o)<(0|u)){n=-1;break e}if((s=a[s>>2])>>>0>(i=a[i>>2])>>>0)break e;if(n=-1,s>>>0<i>>>0)break e}n=0}return _=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return m(+(e=+e)),t=0|l(1),l(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,i=0;return m(+(e=+e)),i=0|l(1),r=0|l(0),m(+t),n=0|l(1),0|((0|r)==(0|l(0))?(0|i)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return m(+(e=+e)),t=0|l(1),l(0),2146435072==(2146435072&t)?(a[966]=1,-1):+z(e)},Mathpack_Sqrt:function(e){return e=+e,p[482]=e,he(),+p[482]},Mathpack_Exp:function(e){return e=+e,p[482]=e,ve(),+p[482]},Mathpack_Ln:function(e){return e=+e,p[482]=e,ce(),+p[482]},Mathpack_Log:function(e){return e=+e,p[482]=e,function(){var e,t;e=+T(+p[482]),p[482]=e,m(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}(),+p[482]},Mathpack_Sin:function(e){return e=+e,p[482]=e,function(){var e=0,t=0;m(+(t=p[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+N(+t),p[482]=t,m(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(a[966]=8)}(),+p[482]},Mathpack_Cos:function(e){return e=+e,p[482]=e,function(){var e=0,t=0;m(+(t=p[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),p[482]=t,m(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(a[966]=8)}(),+p[482]},Mathpack_Tan:function(e){return e=+e,p[482]=e,function(){var e=0,t=0,r=0;r=8,m(+(t=p[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+P(+t),p[482]=t,r=4,m(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(a[966]=r)}(),+p[482]},Mathpack_Asin:function(e){return+W(e=+e,0)},Mathpack_Acos:function(e){return+W(e=+e,1)},Mathpack_Atan:function(e){return e=+e,p[482]=e,fe(),+p[482]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,i=0,o=0,s=0;p[482]=e;e:{if(m(+e),r=0|l(1),l(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;a[966]=1}p[482]=t;t:{if(m(+t),r=0|l(1),l(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;a[966]=1}return Q(4),0}return le((0|n)<1?-1:1),ie(p[391]),oe(p[393]),p[482]}e:if((0|r)<=-1){m(+t),r=0|l(1),l(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else a[966]=1;i=p[391];break e}m(+(i=p[391])),o=-2147483648^(r=0|l(1)),c(0,0|(n=0|l(0))),c(1,0|o),s=+d(),i=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:i}else i=p[396];return Re(t,e),fe(),ee(i),p[482]}(e=+e,t=+t)},Mathpack_Mod:function(e,t){return+function(e,t){var r,n=0,i=0,o=0,s=0,g=0,f=0,S=0,v=0,y=0,F=0,b=0,C=0,k=0,E=0,A=0,T=0,R=0,N=0,I=0,P=0,O=0,M=0,D=0,w=0,x=0,K=0,B=0,W=0;_=r=_+-64|0,p[482]=e,m(+e),n=0|l(1),l(0),(E=-65536&n)&&(2146435072!=(2146435072&n)?B=(0|E)<1?-1:1:a[966]=1),a[965]=2147483647&n,m(+t),n=0|l(1),E=0|l(0),o=n;e:{t:{if(P=-65536&n){if(2146435072!=(2146435072&n))break t;a[966]=1}Q(4),e=0;break e}g=n=2147483647&o,c(0,0|E),c(1,0|n),e=+d(),m(+(t=p[482])),n=0|l(1),i=0|l(0),b=n;t:{r:{f=n,D=g;n:if(!((0|n)<(0|g))){i:{if((0|f)<=(0|D)){if((0|(n=i))==(0|(f=E)))break i;if(n>>>0<f>>>0)break n}if(ke(O=Y(Ae(e)),p[390]),(f=-65536&(n=a[965]))&&(2146435072!=(2146435072&n)?s=(0|f)<1:a[966]=1),a[966]){Q(0);break r}if(!s)break r;if(n=2147483647&o,c(0,-134217728&E),c(1,0|n),ke(e,w=+d()),(n=a[965])|a[964]&&!(2146435072&n))break r;W=Ee(O),p[482]=ae(O,w),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),re(W);break n}a[964]=0,a[965]=0}if(n=a[964],o=a[792],v=s=a[965],i=-1,!((0|s)<(0|(g=f=a[793]))||(i=1,(0|v)>(0|g)))){if((0|n)==(0|o))break t;i=n>>>0<o>>>0?-1:1}if(-1!=(0|((s&f)>-1?i:0-i|0)))break t;ee(e);break t}Re(t,e),a[965]=2147483647&a[965];r:{if(n=a[964],f=a[816],T=F=a[965],y=v=a[817],s=-1,!((0|F)<(0|v)||(s=1,(0|T)>(0|y)))){if((0|n)==(0|f))break r;s=n>>>0<f>>>0?-1:1}if(-1==(0|((v&F)>-1?s:0-s|0))){if(f=0,s=0,F=n=E,Pe(0-n&n,0-((0<n>>>0)+(o=v=1048575&o|1048576)|0)&o,-1261761911,66559345),v=31&(n=T=u[1088+(L>>>26<<1)>>1]),32<=(63&n)>>>0?(n=0,v=o>>>v):(n=o>>>v,v=((1<<v)-1&o)<<32-v|F>>>v),F=n,o=i,n=1048575&b|1048576,(0|(R=T-(C=(b>>>20&2047)-(x=g>>>20)|0)|0))>=1&&(y=31&(i=64-R|0),b=o,32<=(63&i)>>>0?(i=0,y=-1>>>y):(i=-1>>>y,y=(1<<y)-1<<32-y|-1>>>y),o=(A=o)-(y=N=y&o)|0,n=(g=n)-((M=n&i)+(b>>>0<y>>>0)|0)|0),b=r,A=r,g=i=(g=(g=a[1056+((i=v)<<1&28)>>2])-h(g,h(i,g)+-1&240)&255)|0-h(g,h(i,g)+-1&65280)&65280,y=Pe(v,F,i,0),S=L+-1|0,(y=y+-1|0)>>>0<4294967295&&(S=S+1|0),g=Pe(-65536&y,S,i=0-i|0,i>>31)|g,S=Pe(g,y=L,v,F),i=L+-1|0,I=(i=Pe(0,S+-1>>>0<4294967295?i+1|0:i,g,y))-g|0,a[A+56>>2]=I,y=L-((i>>>0<g>>>0)+y|0)|0,a[b+60>>2]=y,a[r+48>>2]=v,a[r+52>>2]=F,be(r+56|0,r+48|0,r+8|0,r+40|0),S=a[r+12>>2],(g=a[r+8>>2]+1|0)>>>0<1&&(S=S+1|0),a[r+8>>2]=g,a[r+12>>2]=S,g=Me(0-(i=v)|0,0-((0<i>>>0)+F|0)|0,i,F),b=L,S=31&(i=(0|(C=(C-T|0)- -64|0))%64|0),32<=(63&i)>>>0?(i=1<<S,A=0):(i=(1<<S)-1&1>>>32-S,A=1<<S),S=i,a[r+32>>2]=o,a[r+36>>2]=n,n|o)for(;a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=g,a[r+52>>2]=b,be(r+56|0,r+48|0,r+32|0,r+40|0),o=a[r+32>>2],n=a[r+36>>2],i=s+(k=a[r+44>>2])|0,(s=f+(K=a[r+40>>2])|0)>>>0<f>>>0&&(i=i+1|0),f=s,s=i,(0|k)==(0|i)&f>>>0<K>>>0|i>>>0<k>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),a[r+32>>2]=o,a[r+36>>2]=n),o|n;);if(a[r+56>>2]=Me(f,s,v,F),a[r+60>>2]=L,a[r+48>>2]=A,a[r+52>>2]=S,be(r+56|0,r+48|0,r+16|0,r+40|0),o=a[r+44>>2],i=a[r+40>>2],a[r+56>>2]=i,a[r+60>>2]=o,a[r+48>>2]=I,a[r+52>>2]=y,be(r+56|0,r+48|0,r+24|0,r+40|0),n=a[r+44>>2],a[r+56>>2]=a[r+40>>2],a[r+60>>2]=n,a[r+48>>2]=v,a[r+52>>2]=F,f=0,s=0,be(r+56|0,r+48|0,r+32|0,r+40|0),k=a[r+36>>2],S=a[r+20>>2],(i=(o=0!=(0|i)|0!=(0|o))+a[r+16>>2]|0)>>>0<o>>>0&&(S=S+1|0),A=i,o=i+a[r+32>>2]|0,i=S+k|0,a[r>>2]=o,a[r+4>>2]=o>>>0<A>>>0?i+1|0:i,a[r+32>>2]=g,a[r+36>>2]=b,g|b)for(o=g,n=b;a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=g,a[r+52>>2]=b,be(r+56|0,r+48|0,r+32|0,r+40|0),o=a[r+32>>2],n=a[r+36>>2],i=s+(S=a[r+44>>2])|0,(s=f+(k=a[r+40>>2])|0)>>>0<f>>>0&&(i=i+1|0),f=s,s=i,(0|S)==(0|i)&f>>>0<k>>>0|i>>>0<S>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),a[r+32>>2]=o,a[r+36>>2]=n),o|n;);if((0|C)>=64)for(o=Me(f,s,v,F),n=L,s=C>>>6;1&s&&(i=a[r+4>>2],a[r+56>>2]=a[r>>2],a[r+60>>2]=i,a[r+48>>2]=o,a[r+52>>2]=n,be(r+56|0,r+48|0,r+16|0,r+40|0),S=i=a[r+44>>2],C=a[r+40>>2],a[r+56>>2]=C,a[r+60>>2]=i,a[r+48>>2]=I,a[r+52>>2]=y,be(r+56|0,r+48|0,r+24|0,r+40|0),i=a[r+44>>2],a[r+56>>2]=a[r+40>>2],a[r+60>>2]=i,a[r+48>>2]=v,a[r+52>>2]=F,be(r+56|0,r+48|0,r+32|0,r+40|0),k=a[r+36>>2],i=a[r+20>>2],(C=(S=0!=(0|C)|0!=(0|S))+a[r+16>>2]|0)>>>0<S>>>0&&(i=i+1|0),S=C+a[r+32>>2]|0,i=i+k|0,a[r>>2]=S,a[r+4>>2]=S>>>0<C>>>0?i+1|0:i),a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=o,a[r+52>>2]=n,be(r+56|0,r+48|0,r+16|0,r+40|0),o=a[r+44>>2],i=a[r+40>>2],a[r+56>>2]=i,a[r+60>>2]=o,a[r+48>>2]=I,a[r+52>>2]=y,be(r+56|0,r+48|0,r+24|0,r+40|0),n=a[r+44>>2],a[r+56>>2]=a[r+40>>2],a[r+60>>2]=n,a[r+48>>2]=v,a[r+52>>2]=F,be(r+56|0,r+48|0,r+32|0,r+40|0),f=a[r+36>>2],n=a[r+20>>2],(i=(o=0!=(0|i)|0!=(0|o))+a[r+16>>2]|0)>>>0<o>>>0&&(n=n+1|0),n=n+f|0,n=(o=i+a[r+32>>2]|0)>>>0<i>>>0?n+1|0:n,s>>>=1;);if(n=a[r+8>>2],o=a[r+12>>2],i=a[r+4>>2],a[r+56>>2]=a[r>>2],a[r+60>>2]=i,a[r+48>>2]=n,a[r+52>>2]=o,be(r+56|0,r+48|0,r,r+40|0),f=a[r+40>>2],s=a[r+44>>2],n=a[r+4>>2],o=a[r>>2],a[r+32>>2]=o,a[r+36>>2]=n,n|o)for(;a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=g,a[r+52>>2]=b,be(r+56|0,r+48|0,r+32|0,r+40|0),o=a[r+32>>2],n=a[r+36>>2],i=s+(y=a[r+44>>2])|0,(s=f+(S=a[r+40>>2])|0)>>>0<f>>>0&&(i=i+1|0),f=s,s=i,(0|y)==(0|i)&f>>>0<S>>>0|i>>>0<y>>>0&&(i=n,(n=o+1|0)>>>0<1&&(i=i+1|0),o=n,a[r+32>>2]=n,n=i,a[r+36>>2]=n),o|n;);if(o=Me(f,s,v,F),n=i=L,a[r>>2]=o,a[r+4>>2]=n,s=(T+x|0)-52|0,N|M&&(g=o,v=31&(o=R),32<=(63&o)>>>0?(i=g<<v,n=0):(i=(1<<v)-1&g>>>32-v|n<<v,n=g<<v),i=i+M|0,o=n=n+N|0,a[r>>2]=n,n=n>>>0<N>>>0?i+1|0:i,a[r+4>>2]=n,s=s-R|0),!(n|o)){a[964]=0,a[965]=0;break t}if((0|n)>=1?(ue(n),n=a[964],f=a[965],ue(o),i=f+33554432|0,i=2146435072&(n>>>0<0?i+1|0:i)|-2146435073&f,c(0,n|(o=0)),c(1,0|i),ee(+d())):ue(o),o=n=a[965],i=a[964],(0|(n=(n>>>20&2047)+s|0))<=1023){a[964]=0,a[965]=0,a[966]=2;break t}a[964]=i,a[965]=-2146435073&o|(n+1025&2047)<<20;break t}}Q(2),e=0;break e}(((0|P)<1?-2147483648:1)^B)>-1||((n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(e),a[965]!=(0|D)|(0|E)!=a[964]||(a[964]=0,a[965]=0)),(0|P)>=1?s=a[965]:(s=a[965])>>>0<65536||(s^=-2147483648,a[965]=s),!(a[964]|s)|2146435072&s||(a[966]=2),e=p[482]}return _=r- -64|0,e}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,s=0,c=0;return m(+(e=+e)),r=0|l(1),o=0|l(0),2146435072==(2146435072&r)?(a[966]=1,-1):(p[482]=e,s=3280,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3280,(0|n)>0||(c>>>0>=65536&&(a[965]=-2147483648^c),s=3280,!o&-2147483648==(0|r)||(i[1640]=45,s=3282))):(a[966]=1,s=3280)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;_=o=_-16|0,e=0|we[a[a[e>>2]+8>>2]](e),a[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;i[t>>1]=0}else Fe(p[482],o+8|0,t,15),t=function(e,t,r,n,o,s){var l,c,d,m=0,g=0,p=0,f=0,S=0;_=c=_-16|0,l=(t<<1)+e|0,d=c+12|0;t:{r:{n:{i:if(!(p=(0|r)<5&(g=o?n:1)+3>>>0<8)){a:if(!((0|g)>(0|r))){if((0|(n=r+g|0))>=3){if((0|r)<5|(0|g)>-4)break i;if((n+-2|0)<(0|o))break a;break i}if((0|r)<5)break i}if(f=1,n=1,(0|r)<7)break n;n=r-(g+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,g))&&(n=r-((0|g)<(0|r)?(0|g)<1?2-g|0:1:0)|0)}n:{if((0|n)<(0|o)){m=1,o=0;i:if(!((0|t)<1)){a:{o:{if(!n){if(u[e>>1]>52)break o;break i}if((0|n)<1|(0|n)>=(0|t))break i;if(u[(n<<1)+e>>1]<=52)break a;for(;;){if(S=u[(m=((o=n+-1|0)<<1)+e|0)>>1]+1|0,i[m>>1]=S,58!=(65535&S))break a;if(n=o,!o)break}}i[e>>1]=49,o=1,m=g+1|0;break i}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);m=g}if((-1^p)&(0|m)>(0|r)|f)break n;break r}if(m=g,!f)break r}if(a[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=l>>>0?n=r:(o=o+-1|0,a[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&C(),K(e,r,o<<1),i[r>>1]=s),n>>>0<l>>>0&&(i[n>>1]=69,n=n+2|0),n>>>0>=l>>>0?o=n:(o=n+2|0,(0|m)<=0?(i[n>>1]=45,m=1-m|0):(i[n>>1]=43,m=m+-1|0)),(0|m)<100|o>>>0>=l>>>0||(e=(m>>>0)/100|0,i[o>>1]=e+48,m=m-h(e,100)|0,o=o+2|0),o>>>0<l>>>0&&(i[o>>1]=48+((0|m)/10|0),o=o+2|0),o>>>0>=l>>>0)break t;i[o>>1]=48+((0|m)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|m))if(r=o-m|0,a[d>>2]=r,(0|m)>=1){if(!((r=(n=((p=(r=(g=(0|m)>(0|t)?t:m)<<1)+e|0)+(o<<1)|0)-r|0)-2|0)>>>0<e>>>0|n>>>0>=l>>>0))for(;i[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=p>>>0;);(0|m)<(0|t)&&(i[p>>1]=s),o=p+(((0|(e=l-p>>1))>(0|(t=o-g|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(m<<1)|0)+(o<<1)|0)|0)>>>0>=l>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;i[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(i[e>>1]=48,e=e+2|0),e>>>0<l>>>0&&(i[e>>1]=s,e=e+2|0),n=l-e>>1,m&&(t=(0|n)<(0|(t=0-m|0))?n:t))for(o=0;i[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|m)>(0|t)?t:m)-o|0)for(t=(o<<1)+e|0,o=0;i[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return _=c+16|0,o}(t,r,n,i[o+8>>1],i[o+10>>1],e);return _=o+16|0,t}(a[256],c,3790-c>>1,(0|t)>0?t:0),a[964]=0,a[965]=0,t-3280>>1)},Mathpack_FormatGetExponent:function(){return a[968]},Mathpack_FormatGetSign:function(){return a[969]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,s=0;return _=n=_+-64|0,m(+(e=+e)),o=0|l(1),l(0),2146435072!=(2146435072&o)?(a[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Fe(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),s=i[n+56>>1],o=i[n+58>>1],a[n+8>>2]=o,t=t+s|0,a[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=a[n+8>>2]),o?((0|(r=r+(t=a[n+12>>2])|0))<(0|o)&&(a[n+8>>2]=r,o=r),(0|o)>-1||(a[966]=1)):(o=0,a[n+12>>2]=0,t=0),a[968]=t,a[969]=u[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(C(),r=a[n+8>>2]),K(3280,n+16|0,o<<1)):(a[966]=1,r=-1),_=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,s=0,c=0;if(_=n=_+-64|0,m(+(e=+e)),s=0|l(1),l(0),2146435072!=(2146435072&s)){if(a[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Fe(e,n+56|0,n+16|0,15),c=i[n+56>>1],a[n+12>>2]=c,s=i[n+58>>1],a[n+8>>2]=s,(0|(o=t))>=2&&(o=(0|c)%(0|t)|0,o=((0|c)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(s=a[n+8>>2]))?o:s;s=o,(0|o)>=1&&48==u[(n+16|0)+((o=s+-1|0)<<1)>>1];);a[n+8>>2]=s,(0|t)<2||(0|(o=a[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|s)||(C(),s=a[n+8>>2]))}(0|s)<=-1&&(a[966]=1),a[968]=a[n+12>>2],a[969]=u[n+48>>1]>>>15^1,(o=s)>>>0>=256&&(C(),o=a[n+8>>2]),K(3280,n+16|0,s<<1)}else a[966]=1,o=-1;return _=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,_=o=_-48|0,n[o+39|0]=0,K(o+8|0,3280,(r=(0|r)<15?r:15)<<1),i[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,a[o>>2]=0,a[o+4>>2]=0,ye(a[256],o,o+8|0)&&(a[966]=1),_=o+48|0,+p[o>>3]},_start:x,__errno_location:function(){return 3888},setThrew:function(e,t){e|=0,t|=0,a[970]||(a[971]=t,a[970]=e)},stackSave:function(){return 0|_},stackAlloc:function(e){return _=e=_-(e|=0)&-16,0|e},stackRestore:function(e){_=e|=0},__growWasmMemory:function(e){return 0|C()}}}({Math:n.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:i.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:i.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:i.Base_LocaleDecimalSeparator,Math_log10:i.Math_log10,Math_log:i.Math_log,Math_sqrt:i.Math_sqrt,Math_sin:i.Math_sin,Math_cos:i.Math_cos,Math_tan:i.Math_tan,Math_atan:i.Math_atan,Math_exp:i.Math_exp,proc_exit:a.proc_exit,getTempRet0:i.getTempRet0},p),S=f.memory;t.memory=S;var v=f.Base_StrBuf;t.Base_StrBuf=v;var y=f.Base_StrBufSize;t.Base_StrBufSize=y;var F=f.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=F;var b=f.Dtr_FromNum;t.Dtr_FromNum=b;var C=f.Dtr_Yr;t.Dtr_Yr=C;var k=f.Dtr_Mon;t.Dtr_Mon=k;var E=f.Dtr_DOM;t.Dtr_DOM=E;var A=f.Dtr_Hour;t.Dtr_Hour=A;var T=f.Dtr_Min;t.Dtr_Min=T;var R=f.Dtr_Sec;t.Dtr_Sec=R;var N=f.Dtr_Wdy;t.Dtr_Wdy=N;var I=f.Dtr_FracSec;t.Dtr_FracSec=I;var P=f.Dtr_Rounding;t.Dtr_Rounding=P;var O=f.Dtr_Write;t.Dtr_Write=O;var M=f.Dtr_ToNum;t.Dtr_ToNum=M;var D=f.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=D;var w=f.Dtr_Days;t.Dtr_Days=w;var _=f.Dtr_ToDays;t.Dtr_ToDays=_;var L=f.Dtr_ToTime;t.Dtr_ToTime=L;var x=f.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var K=f.Mathpack_Zero;t.Mathpack_Zero=K;var B=f.Mathpack_One;t.Mathpack_One=B;var W=f.Mathpack_Pi;t.Mathpack_Pi=W;var U=f.Mathpack_Div;t.Mathpack_Div=U;var G=f.Mathpack_Mul;t.Mathpack_Mul=G;var j=f.Mathpack_Sub;t.Mathpack_Sub=j;var V=f.Mathpack_Add;t.Mathpack_Add=V;var H=f.Mathpack_Power;t.Mathpack_Power=H;var q=f.Mathpack_Cond;t.Mathpack_Cond=q;var z=f.Mathpack_Cond2;t.Mathpack_Cond2=z;var Q=f.Mathpack_TakeMathError;t.Mathpack_TakeMathError=Q;var $=f.Mathpack_Trunc;t.Mathpack_Trunc=$;var Y=f.Mathpack_Ceil;t.Mathpack_Ceil=Y;var J=f.Mathpack_Floor;t.Mathpack_Floor=J;var X=f.Mathpack_Abs;t.Mathpack_Abs=X;var Z=f.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=f.Mathpack_Float;t.Mathpack_Float=ee;var te=f.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=f.Mathpack_Fix;t.Mathpack_Fix=re;var ne=f.Mathpack_LFix;t.Mathpack_LFix=ne;var ie=f.Mathpack_SFix;t.Mathpack_SFix=ie;var ae=f.Mathpack_Round;t.Mathpack_Round=ae;var oe=f.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var se=f.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var ue=f.Mathpack_TenTo;t.Mathpack_TenTo=ue;var le=f.Mathpack_Compare;t.Mathpack_Compare=le;var ce=f.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=f.Mathpack_Equal;t.Mathpack_Equal=de;var me=f.Mathpack_ViewRound;t.Mathpack_ViewRound=me;var ge=f.Mathpack_Sqrt;t.Mathpack_Sqrt=ge;var pe=f.Mathpack_Exp;t.Mathpack_Exp=pe;var he=f.Mathpack_Ln;t.Mathpack_Ln=he;var fe=f.Mathpack_Log;t.Mathpack_Log=fe;var Se=f.Mathpack_Sin;t.Mathpack_Sin=Se;var ve=f.Mathpack_Cos;t.Mathpack_Cos=ve;var ye=f.Mathpack_Tan;t.Mathpack_Tan=ye;var Fe=f.Mathpack_Asin;t.Mathpack_Asin=Fe;var be=f.Mathpack_Acos;t.Mathpack_Acos=be;var Ce=f.Mathpack_Atan;t.Mathpack_Atan=Ce;var ke=f.Mathpack_Atan2;t.Mathpack_Atan2=ke;var Ee=f.Mathpack_Mod;t.Mathpack_Mod=Ee;var Ae=f.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Ae;var Te=f.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Te;var Re=f.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Re;var Ne=f.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ne;var Ie=f.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ie;var Pe=f.Mathpack_Pack;t.Mathpack_Pack=Pe;var Oe=f._start;t._start=Oe;var Me=f.__errno_location;t.__errno_location=Me;var De=f.setThrew;t.setThrew=De;var we=f.stackSave;t.stackSave=we;var _e=f.stackAlloc;t.stackAlloc=_e;var Le=f.stackRestore;t.stackRestore=Le;var xe=f.__growWasmMemory;t.__growWasmMemory=xe},7478:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0,t.getTempRet0=function(){return m},t.setTempRet0=function(e){m=e};var n=r(8106);const i=Math.sqrt;t.Math_sqrt=i;const a=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=a;const o=Math.log;t.Math_log=o;const s=Math.exp;t.Math_exp=s;const u=Math.sin;t.Math_sin=u;const l=Math.cos;t.Math_cos=l;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d;let m=0},4471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const r=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=r},8368:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},4558:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeDivision=t.Rounding=void 0,t.daysPerMonth=function(e,t,r){return(0,n.Dtr_DaysPerMonth)(e,t,r?1:0)},t.dtr=s,t.fromNum=function(e,t,r,i){const a=t;return 0===(0,n.Dtr_FromNum)(e,a,0,r?1:0,i?1:0)&&u(0)},t.toNum=function(e,t,r){l(0,e);const a=(0,n.Dtr_ToNum)(0,t?1:0,r?1:0),o=(0,n.Mathpack_TakeMathError)();return o===i.MathErrorNum.None?a:(0,i.mathError)(o)},t.toNumWithDuration=function(e,t,r,a,o){l(0,e);const s=a,u=(0,n.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,s,o),c=(0,n.Mathpack_TakeMathError)();return c===i.MathErrorNum.None?u:(0,i.mathError)(c)},t.toDays=function(e,t,r){return l(0,e),0===(0,n.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,n.Dtr_Days)()},t.toTime=function(e,t,r){const a=t,o=r,s=(0,n.Dtr_ToTime)(e,a,o);return(0,n.Mathpack_TakeMathError)()===i.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,i){return l(0,e),null!=t.standardDate&&l(1,t.standardDate),null!=t.daylightDate&&l(2,t.daylightDate),0!==(0,n.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,i?1:0)&&u(0)};const n=r(8424),i=r(5645);var a,o;function s(e,t,r,n,i,a,o,s,u){return{yr:e,mon:t,dom:r,hour:n,min:i,sec:a,wdy:o,fracSec:s,rounding:u}}function u(e){return s((0,n.Dtr_Yr)(e),(0,n.Dtr_Mon)(e),(0,n.Dtr_DOM)(e),(0,n.Dtr_Hour)(e),(0,n.Dtr_Min)(e),(0,n.Dtr_Sec)(e),(0,n.Dtr_Wdy)(e),(0,n.Dtr_FracSec)(e),(0,n.Dtr_Rounding)(e))}function l(e,t){(0,n.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}!function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(a||(t.Rounding=a={})),function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(o||(t.TimeDivision=o={}))},5984:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;const n=r(6533),i=n.__importStar(r(5645));t.mathpack=i;const a=n.__importStar(r(4558));t.dtr=a;const o=r(8106);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return o.isSupported}}),(0,r(8424)._start)()},5645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mod=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.exp32=t.pi=t.one=t.zero=t.MathErrorNum=void 0,t.mathError=c,t.equal=function(e,t){return 0!==(0,n.Mathpack_Equal)(e,t)},t.float=function(e){return e<0?(0,n.Mathpack_SFloat)(e):(0,n.Mathpack_Float)(e)},t.fix=function(e){return(0,n.Mathpack_Fix)(e)>>>0},t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return c(s.Over);if(!isFinite(e))return c(s.Over);const t=(0,n.Mathpack_TenTo)(e),r=(0,n.Mathpack_TakeMathError)();return r===s.None?t:c(r)},t.cond=function(e){const t=(0,n.Mathpack_Cond)(e),r=(0,n.Mathpack_TakeMathError)();return r===s.None?t:c(r)},t.formatGeneral=function(e,t,r){try{(0,i.setLocale)(e);const a=(0,n.Mathpack_FormatGeneral)(t,r);return a<0?c((0,n.Mathpack_TakeMathError)()):o((0,n.Base_StrBuf)(),a)}finally{(0,i.setLocale)(void 0)}},t.formatFixed=function(e,t,r){const i=(0,n.Mathpack_FormatFixed)(e,t,r);if(i<0)return(0,n.Mathpack_TakeMathError)();const a=o((0,n.Base_StrBuf)(),i),s=(0,n.Mathpack_FormatGetExponent)();return{sign:0!==(0,n.Mathpack_FormatGetSign)(),mantissa:a,exponent:s}},t.formatScientific=function(e,t,r){const i=(0,n.Mathpack_FormatScientific)(e,t,r);if(i<0)return(0,n.Mathpack_TakeMathError)();const a=o((0,n.Base_StrBuf)(),i),s=(0,n.Mathpack_FormatGetExponent)();return{sign:0!==(0,n.Mathpack_FormatGetSign)(),mantissa:a,exponent:s}},t.pack=function(e,t,r,o){try{(0,i.setLocale)(e);const u=(0,i.fastMin)(o.length,(0,n.Base_StrBufSize)());!function(e,t){const r=new Uint16Array(a.memory.buffer);for(let n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,n.Base_StrBuf)(),o.substring(0,u));const l=(0,n.Mathpack_Pack)(!!t,r,u),d=(0,n.Mathpack_TakeMathError)();return d!==s.None?c(d):isNaN(l)?c(s.Over):l}finally{(0,i.setLocale)(void 0)}};const n=r(8424),i=r(8106),a=r(8424);function o(e,t){const r=new Uint16Array(a.memory.buffer);let n="";for(let i=0;i<t;i+=1)n+=String.fromCharCode(r[e+(i<<1)>>1]);return n}var s;function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(s||(t.MathErrorNum=s={}));const l={[s.Over]:u(s.Over),[s.Under]:u(s.Under),[s.DivBy0]:u(s.DivBy0),[s.Trans]:u(s.Trans)};function c(e){return l[e]??u(e)}function d(e){return t=>{const r=e(t),i=(0,n.Mathpack_TakeMathError)();return i===s.None?r:c(i)}}function m(e){return(t,r)=>{const i=e(t,r),a=(0,n.Mathpack_TakeMathError)();return a===s.None?i:c(a)}}t.zero=n.Mathpack_Zero,t.one=n.Mathpack_One,t.pi=n.Mathpack_Pi,t.exp32=n.Mathpack_GetExp32,t.trunc=n.Mathpack_Trunc,t.ceil=d(n.Mathpack_Ceil),t.floor=d(n.Mathpack_Floor),t.abs=n.Mathpack_Abs,t.neg=n.Mathpack_Neg,t.lfix=n.Mathpack_LFix,t.sfix=d(n.Mathpack_SFix),t.round=m(n.Mathpack_Round),t.roundUp=m(n.Mathpack_RoundUp),t.roundDown=m(n.Mathpack_RoundDown),t.compare=n.Mathpack_Compare,t.div=m(n.Mathpack_Div),t.mul=m(n.Mathpack_Mul),t.sub=m(n.Mathpack_Sub),t.add=m(n.Mathpack_Add),t.power=m(n.Mathpack_Power),t.cond2=n.Mathpack_Cond2,t.viewRound=d(n.Mathpack_ViewRound),t.sqrt=d(n.Mathpack_Sqrt),t.exp=d(n.Mathpack_Exp),t.ln=d(n.Mathpack_Ln),t.log=d(n.Mathpack_Log),t.sin=d(n.Mathpack_Sin),t.cos=d(n.Mathpack_Cos),t.tan=d(n.Mathpack_Tan),t.asin=d(n.Mathpack_Asin),t.acos=d(n.Mathpack_Acos),t.atan=d(n.Mathpack_Atan),t.atan2=m(n.Mathpack_Atan2),t.mod=m(n.Mathpack_Mod)},8106:function(e,t){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.setLocale=function(e){r=e},t.Base_LocaleIsNumeral=function(e){return r.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return r.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){const e=r.decimalSeparator;return 0===e.length?n:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){const e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]};const n=46},3314:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5696:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(6533).__exportStar(r(3314),t)},2237:function(e,t){"use strict";var r,n,i,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(i||(t.PictureSpecial=i={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(a||(t.PictureColor=a={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(o||(t.PictureDbnum=o={}))},150:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2424:function(e,t){"use strict";var r,n,i,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PictureDbnum=t.PictureColor=t.PictureSpecial=t.PictureSingle=t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(r||(t.Rounding=r={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(n||(t.PictureSingle=n={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(i||(t.PictureSpecial=i={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(a||(t.PictureColor=a={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(o||(t.PictureDbnum=o={}))},7246:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8329:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(r||(t.DefinedNameInfoType=r={}))},611:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(r||(t.MajorityDataType=r={}))},9344:function(e,t){"use strict";var r,n,i,a,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Text=1]="Text",e[e.Method=2]="Method",e[e.Function=3]="Function",e[e.Constructor=4]="Constructor",e[e.Field=5]="Field",e[e.Variable=6]="Variable",e[e.Class=7]="Class",e[e.Interface=8]="Interface",e[e.Module=9]="Module",e[e.Property=10]="Property",e[e.Unit=11]="Unit",e[e.Value=12]="Value",e[e.Enum=13]="Enum",e[e.Keyword=14]="Keyword",e[e.Snippet=15]="Snippet",e[e.Color=16]="Color",e[e.File=17]="File",e[e.Reference=18]="Reference",e[e.Folder=19]="Folder",e[e.EnumMember=20]="EnumMember",e[e.Constant=21]="Constant",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther",e[e.Copilot=111]="Copilot"}(r||(t.CompletionItemKind=r={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(n||(t.SuggestionKind=n={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(i||(t.DiagnosticSeverity=i={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(a||(t.DiagnosticTag=a={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(o||(t.CodeActionKind=o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(s||(t.RepairItemPartType=s={}))},9244:function(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(r||(t.IncompatibilityType=r={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(n||(t.ReferenceMode=n={}))},1399:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3984:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1747:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9559:function(e,t){"use strict";var r,n,i,a,o,s,u,l,c,d,m,g,p,h,f;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.FormulaCopilotIPEMode=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(r||(t.EditorMessageType=r={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(n||(t.MessageType=n={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.InCellControlsAutodetectionPlugin=23]="InCellControlsAutodetectionPlugin",e[e.GetLocalePlugin=24]="GetLocalePlugin",e[e.ValueErrorHighlightPlugin=25]="ValueErrorHighlightPlugin",e[e.AutocompleteCopilotPlugin=26]="AutocompleteCopilotPlugin",e[e.FormulaAuthoringCopilotIPEPlugin=27]="FormulaAuthoringCopilotIPEPlugin",e[e.FormulaCompletionPlugin=28]="FormulaCompletionPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.PythonTooltipPlugin=1011]="PythonTooltipPlugin",e[e.PythonSyntaxHighlightingPlugin=1012]="PythonSyntaxHighlightingPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(i||(t.PluginFactoryName=i={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(a||(t.PluginGroup=a={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(o||(t.PluginAttachGroup=o={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(s||(t.PerCharacterExperimentResultKind=s={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses",e[e.comment=4]="comment",e[e.keyword=5]="keyword",e[e.operator_kind=6]="operator_kind",e[e.string=7]="string",e[e.number=8]="number",e[e.regexp=9]="regexp",e[e.type=10]="type",e[e.class_kind=11]="class_kind",e[e.interface_kind=12]="interface_kind",e[e.enum_kind=13]="enum_kind",e[e.enumMember=14]="enumMember",e[e.typeParameter=15]="typeParameter",e[e.function=16]="function",e[e.method=17]="method",e[e.property=18]="property",e[e.variable=19]="variable",e[e.parameter=20]="parameter",e[e.module=21]="module",e[e.intrinsic=22]="intrinsic",e[e.selfParameter=23]="selfParameter",e[e.clsParameter=24]="clsParameter",e[e.magicFunction=25]="magicFunction",e[e.builtinConstant=26]="builtinConstant",e[e.parenthesis=27]="parenthesis",e[e.curlybrace=28]="curlybrace",e[e.bracket=29]="bracket",e[e.colon=30]="colon",e[e.semicolon=31]="semicolon",e[e.arrow=32]="arrow"}(u||(t.HighlightKind=u={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(l||(t.PositionKind=l={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(c||(t.ValuePreviewResultKind=c={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"}(d||(t.GotoCtrlClickResultKind=d={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete",e[e.CopilotFormulaGeneration=9]="CopilotFormulaGeneration"}(m||(t.SchedulerFeature=m={})),function(e){e[e.Create=0]="Create",e[e.Modify=1]="Modify"}(g||(t.FormulaCopilotIPEMode=g={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(p||(t.ColumnFormulaSuggestionUpdateKind=p={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(h||(t.RecognizedTablesMetadataState=h={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(f||(t.TableOrientation=f={}))},1633:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=void 0;const n=r(6533);n.__exportStar(r(8329),t),n.__exportStar(r(611),t),n.__exportStar(r(9344),t),n.__exportStar(r(7246),t),n.__exportStar(r(9244),t),n.__exportStar(r(1747),t),n.__exportStar(r(1399),t),n.__exportStar(r(2424),t),n.__exportStar(r(9559),t),n.__exportStar(r(3984),t);var i=r(2237);Object.defineProperty(t,"PictureColor",{enumerable:!0,get:function(){return i.PictureColor}}),Object.defineProperty(t,"PictureDbnum",{enumerable:!0,get:function(){return i.PictureDbnum}}),Object.defineProperty(t,"PictureSingle",{enumerable:!0,get:function(){return i.PictureSingle}}),Object.defineProperty(t,"PictureSpecial",{enumerable:!0,get:function(){return i.PictureSpecial}}),n.__exportStar(r(3516),t),n.__exportStar(r(2664),t),n.__exportStar(r(150),t),n.__exportStar(r(5696),t)},1345:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3516:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6533);n.__exportStar(r(1345),t),n.__exportStar(r(8069),t)},8069:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2664:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5509:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AshaError=void 0,function(e){e.Service_Error_Augloop="Service Error (AugLoop)",e.Multiple_Suggestion_Declines="Multiple Suggestion Declines"}(r||(t.AshaError=r={}))},6925:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logStandardizedAshaErrorEvent=function(e,t,r,n=!1){(0,i.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Voice.Copilot.Chat",eventFlags:s,dataFields:o(e,t,r,n)})};const n=r(8260),i=r(4516),a=r(7377);function o(e,t,r,i=!1){const o=function(e){switch(e){case n.TelemetryStandardizedFeature.CleanData:return a.Copilot.Verb.Analyze;case n.TelemetryStandardizedFeature.FormulaByExample:return a.Copilot.Verb.Create;default:throw new Error("Missing verb map.")}}(r);return e&&t?[...a.Asha.getFields({eventType:a.Asha.EventType.Error,veto:o+" "+r+" "+e,error:t,inStaging:i??!0,scenario:r})]:[]}const s={dataCategories:a.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:a.EnumObjects.SamplingPolicy.CriticalCensus,diagnosticLevel:a.EnumObjects.DiagnosticLevel.RequiredServiceData}},5774:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AshaVeto=void 0,function(e){e.Unable_To_Complete_Task="Unable to Complete Task",e.User_Dissatisfied_With_Suggestions="User dissatisfied with suggestions"}(r||(t.AshaVeto=r={}))},8260:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryStandardizedFeature=void 0,t.logCopilotEnabledEvent_Deprecated=function(e,t,r){u({featureName:e,actionType:n.Copilot.FeatureActionType.IsEnabled,eventFlags:o,entryPoint:t,interactionId:void 0,uiLanguage:r})},t.logCopilotEnabledEvent=function(e,t){u({featureName:e,actionType:n.Copilot.FeatureActionType.IsEnabled,eventFlags:o,entryPoint:void 0,interactionId:void 0,uiLanguage:t})},t.logCopilotSeenEvent=function(e,t,r){u({featureName:e,actionType:n.Copilot.FeatureActionType.IsSeen,eventFlags:s,entryPoint:t,interactionId:void 0,uiLanguage:r})},t.logCopilotTriedEvent=function(e,t,r,i){u({featureName:e,actionType:n.Copilot.FeatureActionType.IsTried,eventFlags:o,entryPoint:t,interactionId:r,uiLanguage:i})},t.logCopilotKeptEvent=function(e,t,r,i){u({featureName:e,actionType:n.Copilot.FeatureActionType.IsKept,eventFlags:o,entryPoint:t,interactionId:r,uiLanguage:i})},t.logCopilotRejectedEvent=function(e,t,r,i){u({featureName:e,actionType:n.Copilot.FeatureActionType.IsRejected,eventFlags:o,entryPoint:t,interactionId:r,uiLanguage:i})};const n=r(7377),i=r(4516);var a;!function(e){e.AnalyzeData="AnalyzeData",e.CleanData="CleanData",e.FormulaByExample="FormulaByExample",e.FormulaGeneration="FormulaGeneration",e.CalculatedColumns="CalculatedColumns",e.Commanding="Commanding",e.CopilotChat="CopilotChat",e.ExcelChatHelper="ExcelChatHelper",e.OfficeScripts="OfficeScripts",e.Python="Python",e.Search="Search",e.TableGeneration="Table Generation"}(a||(t.TelemetryStandardizedFeature=a={}));const o={dataCategories:n.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:n.EnumObjects.SamplingPolicy.CriticalUsage,diagnosticLevel:n.EnumObjects.DiagnosticLevel.RequiredServiceData},s={dataCategories:n.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:n.EnumObjects.SamplingPolicy.CriticalUsage,diagnosticLevel:n.EnumObjects.DiagnosticLevel.Optional};function u(e){const{featureName:t,actionType:r,eventFlags:a,entryPoint:o,interactionId:s="",uiLanguage:u=""}=e;(0,i.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Voice.Copilot.Chat",eventFlags:a,dataFields:[...n.Copilot.getFields({featureActionType:r,isUserInitiated:!1,featureName:t,entryPoint:o,interactionId:s}),...u?[(0,n.makeStringDataField)("UiLanguage",u)]:[]]})}},1617:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryUsageEventKeys=t.TelemetryUsageSource=t.TelemetryUsageActionType=void 0,t.logCopilotUsageEvent=function(e,t,r,a,o,u){const l={eventName:"Office.Voice.ActionAI.Usage",eventFlags:{dataCategories:n.EnumObjects.DataCategories.ProductServicePerformance|n.EnumObjects.DataCategories.ProductServiceUsage,diagnosticLevel:n.EnumObjects.DiagnosticLevel.RequiredServiceData},dataFields:[(0,n.makeStringDataField)(s.FeatureName,e),(0,n.makeStringDataField)(s.ActionType,t),(0,n.makeStringDataField)(s.Source,r),(0,n.makeStringDataField)(s.InteractionId,o??""),(0,n.makeStringDataField)(s.UiLanguage,a??""),...u??[]]};(0,i.getTelemetryLogger)().sendTelemetryEvent(l)};const n=r(7377),i=r(4516);var a,o,s;!function(e){e.SendPrompt="SendPrompt",e.PromptBoxShown="PromptBoxShown"}(a||(t.TelemetryUsageActionType=a={})),function(e){e.FormulaAutocompletePromptBox="FormulaAutocompletePromptBox"}(o||(t.TelemetryUsageSource=o={})),function(e){e.FeatureName="FeatureName",e.ActionType="ActionType",e.Source="Source",e.InteractionId="InteractionId",e.UiLanguage="UiLanguage",e.Duration="Duration"}(s||(t.TelemetryUsageEventKeys=s={}))},6537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6533);n.__exportStar(r(5509),t),n.__exportStar(r(6925),t),n.__exportStar(r(5774),t),n.__exportStar(r(8260),t),n.__exportStar(r(1617),t)},1142:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},3341:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const n=r(e),i=r(t);let a=[];for(let e=0;e<=i.length;++e)a[e]=e;for(let e=1;e<=n.length;++e){const t=[e];for(let r=1;r<=i.length;++r)t[r]=n[e-1]===i[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[i.length]}},3862:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=o,t.getBooleanFeatureGate=function(e,t){const r=o(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=o(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=o(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const n=r(3341),i={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?i:globalThis.__get_feature_gate_dictionary_variable()}function o(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const i=globalThis.__office_online_feature_gates_verbose_log_callback;i(`Failed lookup for FeatureGate ${e}...`);const o=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,n.editDistance)(e.toLowerCase(),s)<=4&&o.push(e);return o.length>0&&i(`Potential candidates found (edit distance <= 4, case-insensitive): [${o.join(", ")}]`),i(`FeatureGate override not found, returning default: ${t}`),t}},246:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6533);n.__exportStar(r(3862),t),n.__exportStar(r(457),t),n.__exportStar(r(1142),t),n.__exportStar(r(8954),t),n.__exportStar(r(3998),t),n.__exportStar(r(9406),t)},457:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const n=r(3862)},8954:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)};const n=r(1142)},3998:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)};const n=r(1142);function i(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},9406:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)};const n=r(3862);function i(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},2959:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTelemetryLogger=function(e){globalThis[i]=e},t.getTelemetryLogger=function(){var e;return(e=globalThis)[i]??(e[i]=new n.TelemetryLogger)};const n=r(7377),i=Symbol.for("otel_util_telemetry_logger")},7970:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDataFields=function(e){let t=!0;const r=[];return e.forEach((e=>{const i=e.classification;if(i===n.EnumObjects.DataClassification.SystemMetadata||i===n.EnumObjects.DataClassification.EssentialServiceMetadata){const t={name:e.name,bool:null,string:null,double:null,int64:null,date:null,contract:null};switch(e.dataType){case n.EnumObjects.DataFieldType.Boolean:t.bool=e.value;break;case n.EnumObjects.DataFieldType.Double:t.double=e.value;break;case n.EnumObjects.DataFieldType.Int64:t.int64=e.value;break;case n.EnumObjects.DataFieldType.String:t.string=e.value;break;case n.EnumObjects.DataFieldType.Guid:default:return}r.push(t)}else t=!1})),t?r:[]};const n=r(6533).__importStar(r(7377))},4516:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6533);n.__exportStar(r(7970),t),n.__exportStar(r(2959),t)},7882:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,i(r(7328),t);var a=r(634);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return a.createWorker}})},7328:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var n=r(1680);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return n.WorkerError}});var i=r(2384);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return i.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return i.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return i.dispatchWorkerError}});var a=r(4060);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return a.paramInsideDef}});var o=r(4159);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return o.Endpoint}});var s=r(7037);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var u=r(9721);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return u.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return u.workerName}})},2384:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=s,t.setConfig=function(e){if(u)throw new TypeError("setConfig has already been called");u=e},t.getSafeParams=function(){const e=u??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??u?.createTimeout??i},t.getCreateMode=function(e){const t=e?.createMode??u?.createMode??a;return"ThreadOrLocal"===t?s()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(u?.onWorkerError??d)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(u?.onCreateWorker??m)(e)}catch(e){l(e)}};const n=r(8150),i=3e5,a="Thread";var o;function s(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let u;function l(e){setTimeout((()=>{throw e}))}function c(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function d(e){const t=c();if(void 0!==t){const r={kind:o.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function m(e){const t=c();if(void 0!==t){const r={kind:o.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(o||(t.ThreadMessageKind=o={}))},634:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=v;const s=r(2384),u=r(4159),l=r(3226),c=r(4060),d=r(5551),m=r(8758),g=r(1680),p={...o(r(7328)),createWorker:v};function h(e,t,r,n,i){const{port1:a,port2:o}=new MessageChannel;let s;return Promise.all([n({port:a,options:e,createMode:t}),(0,d.timePromise)(r.createOutside=(0,d.startStopwatch)(),(()=>u.Endpoint.createOutside({port:o,options:e,createMode:t},(e=>i(s=e)))))]).then((()=>s),(e=>(s?s.close("Force"):o.close(),Promise.reject(e))))}function f(e,t,r,n){return h(e,"Local",t,(e=>function(e,t,r){const{def:n,args:i}="def"in r?r:(0,c.paramInsideDef)(r);if("function"!=typeof n){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new g.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,d.timePromise)(t.insideInit=(0,d.startStopwatch)(),(()=>n({config:(0,s.getSafeParams)(),importTypedWorkers:()=>p,connection:e},...i).then((()=>{}))))))}(e,t,r)),n)}function S(e,t,r,n){let i;t.createThread=(0,d.startStopwatch)();try{i=new m.Thread(e,r)}catch(e){return(0,d.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,d.stopStopwatch)(t.createThread,"Success"),h(e,"Thread",t,(e=>i.createInside(e,t)),n).then((e=>(e.hasBeenClosed()?i.terminate():e._onClose=i.terminate.bind(i),e)),(e=>(i.terminate(),Promise.reject(e))))}function v(e,t,r=(()=>{})){const n=(0,s.getCreateMode)(e),i="local"in t?"Local"===n?t.local:t.thread:t,a="Local"===n?f:S,o={id:e.id,createMode:n,createWorker:(0,d.startStopwatch)()},c=(0,d.timePromise)(o.createWorker,(()=>a((0,u.getSafeOptions)(e),o,i,r)));return(0,l.promiseFinally)(c,(()=>{const e=(0,d.createWorkerStats)(o);e&&(0,s.dispatchCreateWorker)(e)}))}},4159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=void 0,t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}};const n=r(2384),i=r(278),a=r(8150),o=r(3226),s=r(1680);class u{static _create(e,t,r){const{port:a,options:l,createMode:c}=t,d={type:"Endpoint",side:e,id:l?.id};let m,g;try{m=new i.EndpointState(d,a),g=new u(d,m,c)}catch(e){return Promise.reject(e)}return new Promise(((t,i)=>{m.getCallTimeout=()=>g.callTimeout,m.getOnPostMessageError=()=>g.onPostMessageError,m.onImports=(e,t)=>{Object.defineProperties(g,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),u.resolve()},m.onClose=()=>g.close("Force");const a=(0,n.getCreateTimeout)(l),u=(0,o.setCallbacksTimeout)(a,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:d,timeout:a},n=new s.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);u.reject(n)}),{resolve:t,reject:i});let c;g._closedDuringCreate=()=>{u.resolve()};try{c=r(g)}catch(e){return u.reject(e)}g._state?.setExports(c)})).then((()=>(g._closedDuringCreate=void 0,g)),(e=>(g._closedDuringCreate=void 0,g.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new s.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,a.asError)(e)};(0,n.dispatchWorkerError)(new s.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=i.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const n=t=>()=>{const r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new s.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,n)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}}t.Endpoint=u,u.createOutside=(e,t=(()=>{}))=>u._create("Outside",e,t),u.createInside=(e,t)=>u._create("Inside",e,t)},278:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=void 0,t.throwWorkerError=u;const n=r(2384),i=r(8150),a=r(3226),o=r(1680);var s;function u(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(s||(s={}));let l=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,a.haveNativeProxy)()?void 0:(0,a.getFunctionPropertyNames)(e),r={kind:s.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:s.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],n={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new o.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,n))}}onInvoke({callId:e,funcName:t,args:r}){const a=Promise.resolve().then((()=>{const n=this.exports[t];if(n)return n.apply(this.exports,r);const i=e>=0?"call":"post",a={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new o.WorkerError(`Exporting Endpoint received a ${i} to unknown function ${t}`,a)}));e>=0?a.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):a.catch((r=>{const a=(0,i.asError)(r),s={cause:"UnhandledError",idInfo:this.idInfo,error:a,callId:e,funcName:t};(0,n.dispatchWorkerError)(new o.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,s))}))}sendResult(e,t,r,n){const a=(0,i.encodeResultValue)(n),o={kind:s.Result,callId:e,funcName:t,isFulfilled:r,resultValue:a};try{this.port.postMessage(o,void 0)}catch(e){this.onSendResultFailed(o,(0,i.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},i){const a=i?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,s={cause:"MessageError",idInfo:this.idInfo,error:i,callId:e,funcName:t},u=new o.WorkerError(a,s);r.isError?(0,n.dispatchWorkerError)(u):this.sendResult(e,t,!1,u)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,n){return r>a.maxTimeout?n:(0,a.setCallbacksTimeout)(r,(()=>{const n=this.takeCallbacks(e);if(n){const i={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};n.reject(new o.WorkerError(`Importing Endpoint's call to ${t} timed out`,i))}}),n)}sendCall(e,t,r,n){return new Promise(((a,u)=>{const c=l+=1,d={kind:s.Invoke,callId:c,funcName:e,args:t};this.unresolvedCalls[c]={...this.setCallTimeout(c,e,r,{resolve:a,reject:u}),funcName:e};try{this.port.postMessage(d,n)}catch(t){const r=this.takeCallbacks(c);if(r){const n=(0,i.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:n,callId:c,funcName:e};r.reject(new o.WorkerError(`Importing Endpoint failed to send call to ${e}`,a))}}}))}sendPost(e,t,r,n){const a={kind:s.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,n)}catch(t){const n=(0,i.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:n,callId:-1,funcName:e};r(new o.WorkerError(`Importing Endpoint failed to post to ${e}`,a))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",i={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},a=new o.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,i),s=e>=0?this.takeCallbacks(e):void 0;(s?.reject??n.dispatchWorkerError)(a)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:i}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,o.decodeResultValue)(i))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,n.dispatchWorkerError)(new o.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...n)=>{if(this.isClosed)return;const i=t.onPostMessageError??this.getOnPostMessageError?.()??u;this.sendPost(e,n,i,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...n)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new o.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const i=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,n,i,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,a.createEmptyRecord)();const r=()=>this.onClose?.(),n={[s.Invoke]:this.onInvoke.bind(this),[s.Result]:this.onResult.bind(this),[s.Names]:({funcNames:e})=>{this.onImports?.((0,a.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,a.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[s.Close]:r},i={[s.Invoke]:this.onSendInvokeFailed.bind(this),[s.Result]:this.onSendResultFailed.bind(this),[s.Names]:r,[s.Close]:r};this.port.onmessage=({data:e})=>n[e.kind](e),this.port.onmessageerror=({data:e})=>i[e.kind](e)}}},8150:function(e,t){"use strict";function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function i(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?i(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=i,t.encodeError=a,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},3226:function(e,t){"use strict";function r(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let n;Object.defineProperty(t,"__esModule",{value:!0}),t.maxTimeout=void 0,t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.setCallbacksTimeout=function(e,r,n){if(e>t.maxTimeout)return n;const i=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(i),n.resolve(e)},reject:e=>{clearTimeout(i),n.reject(e)}}},t.createEmptyRecord=r,t.getFunctionPropertyNames=function(e){const t=r();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch{}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return n??(n=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch{return!1}}())},t.createObjectFromFunction=function(e,t){const n=r(),i=(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r));return t?(t.forEach((e=>i(n,e))),n):new Proxy(n,{get:i})},t.maxTimeout=1<<30},7037:function(e,t){"use strict";function r(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const i=e.slice(0,n+1),a=e.slice(n+1).split("&");let o=0;for(;o<a.length&&("="!==a[o][t.length]||a[o].slice(0,t.length)!==t);o+=1);return a[o]=`${t}=${r}`,i+a.join("&")}function n(e,t){let n;for(let i=0;i<=t;i+=1)try{return void importScripts(i>0?r(e,"retries",String(i)):e)}catch(e){n=e}throw n}Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)n(r,t);else importScripts(...e)}},4060:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch{return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},5551:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:i()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:i,createOutside:a,createThread:s}=e,{status:l,start:c,end:d}=n;if("Pending"!==l&&void 0!==d)return{id:t,createMode:r,createWorker:{status:l,absStart:c,duration:o(d-c)},createThread:"Thread"===r?u(s,c,d):void 0,createOutside:u(a,c,d),insideInit:u(i,c,d)}};const n=r(8150),i="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??i()))}function o(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function u(e,t,r){const n=s(e?.start??1/0,t,r),i=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:o(n-t),end:o(i-t),duration:o(i-n)}}},8758:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const i=r(246),a=r(2384),o=r(3226),s=r(4060),u=n(r(9082)),l=r(1680);let c=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:n}=e,s={type:"Thread",side:"Outside",id:n.id},u=this.worker,c=new Promise(((e,o)=>{this.createCallbacks={resolve:e,reject:o};const c={config:(0,a.getSafeParams)(),port:r,options:n,script:this.script,args:this.args,featureGateDictionary:(0,i.getFeatureGateDictionary)(),changeGateDictionary:(0,i.getChangeGateDictionary)()};u.postMessage(c,[r,...this.transferables]),u.onerror=e=>{e.preventDefault();const t=(0,l.getErrorEventWorkerError)(s,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,a.dispatchWorkerError)(t)},u.onmessage=({data:e})=>{switch(e.kind){case a.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,l.decodeResultValue)(e.error));case a.ThreadMessageKind.WorkerError:return(0,a.dispatchWorkerError)((0,l.decodeResultValue)(e.error));case a.ThreadMessageKind.CreateWorker:return(0,a.dispatchCreateWorker)(e.stats)}}}));return(0,o.promiseFinally)(c,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:n}="def"in e?e:(0,s.paramInsideDef)(e);if("function"!=typeof t)return[t,r,n,void 0];const i=`__generatedInsideInit${c+=1}`;return[{scriptUrl:void 0,insideInitName:i},r,n,`var ${i} = ${t.toString()};`]}(t);const n=void 0===r?[u.default]:[r,"\n\n",u.default];this.blobUrl=URL.createObjectURL(new Blob(n,{type:"application/javascript"}));const i={};null!=e.id&&(i.name=e.id),this.worker=new Worker(this.blobUrl,i)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},9082:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{"use strict";var e={216:(e,t)=>{function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},87:(e,t)=>{function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const n=r(e),o=r(t);let a=[];for(let e=0;e<=o.length;++e)a[e]=e;for(let e=1;e<=n.length;++e){const t=[e];for(let r=1;r<=o.length;++r)t[r]=n[e-1]===o[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[o.length]}},448:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if("true"===r)return!0;if("false"===r)return!1;return t},t.getNumberFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=i(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const n=r(87);const o={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?o:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const o=globalThis.__office_online_feature_gates_verbose_log_callback;o(`Failed lookup for FeatureGate ${e}...`);const i=[],c=e.toLowerCase();for(const e of Object.keys(r))(0,n.editDistance)(e.toLowerCase(),c)<=4&&i.push(e);return i.length>0&&o(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),o(`FeatureGate override not found, returning default: ${t}`),t}},400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(533);n.__exportStar(r(448),t),n.__exportStar(r(187),t),n.__exportStar(r(216),t),n.__exportStar(r(340),t),n.__exportStar(r(56),t),n.__exportStar(r(96),t)},187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const n=r(448)},340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)};const n=r(216)},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)};const n=r(216);function o(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},96:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)};const n=r(448);function o(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=c,t.setConfig=function(e){if(s)throw new TypeError("setConfig has already been called");s=e},t.getSafeParams=function(){const e=s??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??s?.createTimeout??o},t.getCreateMode=function(e){const t=e?.createMode??s?.createMode??a;return"ThreadOrLocal"===t?c()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(s?.onWorkerError??l)(e)}catch(t){console.warn(e),u(t)}},t.dispatchCreateWorker=function(e){try{(s?.onCreateWorker??d)(e)}catch(e){u(e)}};const n=r(739),o=3e5,a="Thread";var i;function c(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let s;function u(e){setTimeout((()=>{throw e}))}function f(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function l(e){const t=f();if(void 0!==t){const r={kind:i.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function d(e){const t=f();if(void 0!==t){const r={kind:i.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(i||(t.ThreadMessageKind=i={}))},739:(e,t)=>{function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?o(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=o,t.encodeError=a,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},762:(e,t)=>{function r(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const o=e.slice(0,n+1),a=e.slice(n+1).split("&");let i=0;for(;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]=`${t}=${r}`,o+a.join("&")}function n(e,t){let n;for(let o=0;o<=t;o+=1)try{return void importScripts(o>0?r(e,"retries",String(o)):e)}catch(e){n=e}throw n}Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0===t)return void importScripts(...e);for(const r of e)n(r,t)}},619:(e,t)=>{function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch{return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:o()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:o,createOutside:a,createThread:c}=e,{status:u,start:f,end:l}=n;if("Pending"===u||void 0===l)return;return{id:t,createMode:r,createWorker:{status:u,absStart:f,duration:i(l-f)},createThread:"Thread"===r?s(c,f,l):void 0,createOutside:s(a,f,l),insideInit:s(o,f,l)}};const n=r(739),o="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??o()))}function i(e){return Math.round(1e3*e)/1e3}function c(e,t,r){return e<t?t:e>r?r:e}function s(e,t,r){const n=c(e?.start??1/0,t,r),o=c(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:i(n-t),end:i(o-t),duration:i(o-n)}}},533:(e,t,r)=>{r.r(t),r.d(t,{__addDisposableResource:()=>C,__assign:()=>a,__asyncDelegator:()=>T,__asyncGenerator:()=>j,__asyncValues:()=>k,__await:()=>S,__awaiter:()=>_,__classPrivateFieldGet:()=>x,__classPrivateFieldIn:()=>D,__classPrivateFieldSet:()=>W,__createBinding:()=>h,__decorate:()=>c,__disposeResources:()=>F,__esDecorate:()=>u,__exportStar:()=>b,__extends:()=>o,__generator:()=>y,__importDefault:()=>M,__importStar:()=>G,__makeTemplateObject:()=>P,__metadata:()=>p,__param:()=>s,__propKey:()=>l,__read:()=>g,__rest:()=>i,__runInitializers:()=>f,__setFunctionName:()=>d,__spread:()=>m,__spreadArray:()=>O,__spreadArrays:()=>w,__values:()=>v,default:()=>I});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=n.kind,u="getter"===s?"get":"setter"===s?"set":"value",f=!t&&e?n.static?e:e.prototype:null,l=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var _={};for(var y in n)_[y]="access"===y?{}:n[y];for(var y in n.access)_.access[y]=n.access[y];_.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[p])("accessor"===s?{get:l.get,set:l.set}:l[u],_);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=i(h.get))&&(l.get=c),(c=i(h.set))&&(l.set=c),(c=i(h.init))&&o.unshift(c)}else(c=i(h))&&("field"===s?o.unshift(c):l[u]=c)}f&&Object.defineProperty(f,n.name,l),d=!0}function f(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function _(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{s(n.next(e))}catch(e){a(e)}}function c(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,c)}s((n=n.apply(e,t||[])).next())}))}function y(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}var h=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function b(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function j(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=o[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,u):f(a[0][2],r)}catch(e){f(a[0][3],e)}var r}function s(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:o?o(t):t}:o}}function k(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var E=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function G(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return E(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function W(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function C(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function F(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const I={__extends:o,__assign:a,__rest:i,__decorate:c,__param:s,__metadata:p,__awaiter:_,__generator:y,__createBinding:h,__exportStar:b,__values:v,__read:g,__spread:m,__spreadArrays:w,__spreadArray:O,__await:S,__asyncGenerator:j,__asyncDelegator:T,__asyncValues:k,__makeTemplateObject:P,__importStar:G,__importDefault:M,__classPrivateFieldGet:x,__classPrivateFieldSet:W,__classPrivateFieldIn:D,__addDisposableResource:C,__disposeResources:F}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=r(400),o=r(691),a=r(739),i=r(762),c=r(619),s=r(506);self.onmessage=({data:{config:e,port:r,options:n,script:u,args:f,featureGateDictionary:l,changeGateDictionary:d}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,t.setFeatureGateDictionaryGetter)((()=>l)),(0,t.setChangeGateDictionaryGetter)((()=>d));const p=n.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let _;function y(){if(_)return _;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,i.importScriptsWithRetry)([e.typedWorkersUrl],p),_=(0,c.indexObject)(self,e.typedWorkersName??"typedWorkers"),_.setConfig(e),_}const h=(0,s.startStopwatch)();function b(e,t){const r=e?void 0:(0,a.encodeResultValue)((0,a.asError)(t)),n={kind:o.ThreadMessageKind.InitResult,error:r,stopwatch:h};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(0,s.timePromise)(h,(()=>{(0,i.importScriptsWithRetry)([...n?.importScriptUrls??e.importScriptUrls??[],...void 0!==u.scriptUrl?[u.scriptUrl]:[]],p);return(0,c.indexObject)(self,u.insideInitName)({config:e,importTypedWorkers:y,connection:{port:r,options:n,createMode:"Thread"}},...f)})).then((()=>b(!0)),(e=>b(!1,e)))}catch(e){b(!1,e)}}})(),threadBootstrap=n})();})()'},1680:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownErrorClasses=t.WorkerError=void 0,t.getErrorEventWorkerError=function(e,t,r){if((0,n.isError)(r.error)){if((0,n.isWorkerError)(r.error))return r.error;const a={cause:"UnhandledError",idInfo:e,error:r.error};return new i(`${t} received an unhandled error`,a)}if(null==r.message)return new i(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const a={cause:"UnhandledError",idInfo:e},o=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new i(`${t} received an unhandled error: ${o}`,a)},t.decodeError=a,t.decodeWorkerErrorInfo=o,t.decodeResultValue=function(e){return e.isError?a(e.value):e.value};const n=r(8150);class i extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function a(e){let r;if("WorkerError"===e.name)r=new i(e.message,o(e.info));else{const n=t.knownErrorClasses[e.name];n?r=new n(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function o(e){return{...e,error:e.error?a(e.error):void 0}}t.WorkerError=i,i.isWorkerError=n.isWorkerError,t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError}},9721:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return self.name}},6533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return w},__assign:function(){return a},__asyncDelegator:function(){return A},__asyncGenerator:function(){return E},__asyncValues:function(){return T},__await:function(){return k},__awaiter:function(){return p},__classPrivateFieldGet:function(){return O},__classPrivateFieldIn:function(){return D},__classPrivateFieldSet:function(){return M},__createBinding:function(){return f},__decorate:function(){return s},__disposeResources:function(){return L},__esDecorate:function(){return l},__exportStar:function(){return S},__extends:function(){return i},__generator:function(){return h},__importDefault:function(){return P},__importStar:function(){return I},__makeTemplateObject:function(){return R},__metadata:function(){return g},__param:function(){return u},__propKey:function(){return d},__read:function(){return y},__rest:function(){return o},__runInitializers:function(){return c},__setFunctionName:function(){return m},__spread:function(){return F},__spreadArray:function(){return C},__spreadArrays:function(){return b},__values:function(){return v},default:function(){return x}});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function l(e,t,r,n,i,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,u=n.kind,l="getter"===u?"get":"setter"===u?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),m=!1,g=r.length-1;g>=0;g--){var p={};for(var h in n)p[h]="access"===h?{}:n[h];for(var h in n.access)p.access[h]=n.access[h];p.addInitializer=function(e){if(m)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var f=(0,r[g])("accessor"===u?{get:d.get,set:d.set}:d[l],p);if("accessor"===u){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(s=o(f.get))&&(d.get=s),(s=o(f.set))&&(d.set=s),(s=o(f.init))&&i.unshift(s)}else(s=o(f))&&("field"===u?i.unshift(s):d[l]=s)}c&&Object.defineProperty(c,n.name,d),m=!0}function c(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function m(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function S(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function F(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function C(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function k(e){return this instanceof k?(this.v=e,this):new k(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof k?Promise.resolve(r.value.v).then(u,l):c(a[0][2],r)}catch(e){c(a[0][3],e)}var r}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function A(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:k(e[n](t)),done:!1}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function R(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return N(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function M(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function w(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var _="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function L(e){function t(t){e.error=e.hasError?new _(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var i=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(i).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const x={__extends:i,__assign:a,__rest:o,__decorate:s,__param:u,__metadata:g,__awaiter:p,__generator:h,__createBinding:f,__exportStar:S,__values:v,__read:y,__spread:F,__spreadArrays:b,__spreadArray:C,__await:k,__asyncGenerator:E,__asyncDelegator:A,__asyncValues:T,__makeTemplateObject:R,__importStar:I,__importDefault:P,__classPrivateFieldGet:O,__classPrivateFieldSet:M,__classPrivateFieldIn:D,__addDisposableResource:w,__disposeResources:L}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};!function(){"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.syntaxSubpackage=e.runtimeSubpackage=e.recalcSubpackage=e.numfmtSubpackage=e.langSubpackage=e.commonSubpackage=e.ConsistentAnonymizer=e.isTypedChangeGateEnabled=e.getTypedFeatureGate=e.sheetName=e.ResettableLazy=e.asyncLazy=e.ResolvablePromiseWithLimitedSubscribers=e.FormulaAuthoringHelperSingletonGlobal=e.PluginSchedulerSingletonGlobal=e.x10=e.style=e.funcs=e.calc=e.runtime=e.numfmt=e.analyze=e.parse=e.date=e.math=e.config=e.util=e.signature=e.value=e.formula=e.location=e.common=e.packageVersion=void 0;const t=r(6533),i=r(4776),a=r(3948);var o=r(896);Object.defineProperty(e,"packageVersion",{enumerable:!0,get:function(){return o.packageVersion}}),e.common=t.__importStar(r(5779)),e.location=t.__importStar(r(3693)),e.formula=t.__importStar(r(5874)),e.value=t.__importStar(r(9691)),e.signature=t.__importStar(r(5858)),e.util=t.__importStar(r(5848)),e.config=t.__importStar(r(7433)),e.math=t.__importStar(r(3622)),e.date=t.__importStar(r(224)),e.parse=t.__importStar(r(6013)),e.analyze=t.__importStar(r(8968)),e.numfmt=t.__importStar(r(5753)),e.runtime=t.__importStar(r(7752)),e.calc=t.__importStar(r(8263)),e.funcs=t.__importStar(r(2333)),e.style=t.__importStar(r(2199)),e.x10=t.__importStar(r(4939)),e.PluginSchedulerSingletonGlobal=new a.PluginSchedulerSingleton,e.FormulaAuthoringHelperSingletonGlobal=new i.FormulaAuthoringHelperSingleton;var s=r(6913);Object.defineProperty(e,"ResolvablePromiseWithLimitedSubscribers",{enumerable:!0,get:function(){return s.ResolvablePromiseWithLimitedSubscribers}});var u=r(4352);Object.defineProperty(e,"asyncLazy",{enumerable:!0,get:function(){return u.asyncLazy}}),Object.defineProperty(e,"ResettableLazy",{enumerable:!0,get:function(){return u.ResettableLazy}});var l=r(721);Object.defineProperty(e,"sheetName",{enumerable:!0,get:function(){return l.sheetName}});var c=r(6913);Object.defineProperty(e,"getTypedFeatureGate",{enumerable:!0,get:function(){return c.getTypedFeatureGate}});var d=r(6913);Object.defineProperty(e,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return d.isTypedChangeGateEnabled}});var m=r(6471);Object.defineProperty(e,"ConsistentAnonymizer",{enumerable:!0,get:function(){return m.ConsistentAnonymizer}}),e.commonSubpackage=t.__importStar(r(6913)),e.langSubpackage=t.__importStar(r(6592)),e.numfmtSubpackage=t.__importStar(r(1159)),e.recalcSubpackage=t.__importStar(r(1764)),e.runtimeSubpackage=t.__importStar(r(1475)),e.syntaxSubpackage=t.__importStar(r(391))}(),excelOnlineCalc=n}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/excelOnlineCalc.min.js.map/a3da01018b7dfd1935c3bf225e225e28/excelOnlineCalc.min.js.map