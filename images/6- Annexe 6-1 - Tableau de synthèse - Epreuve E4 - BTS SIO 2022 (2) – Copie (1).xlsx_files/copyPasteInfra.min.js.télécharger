var copyPasteInfra;!function(){"use strict";var e={544:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[o]&&(r[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[o]};const r={},o="promises"},842:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let o=!1;const n="undefined"!=typeof performance?performance:void 0;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*n.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},726:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},135:function(e,t,r){t.TZ=t.nh=t.kp=t.Hv=t.Wp=void 0;const o=r(690);t.Wp=o;const n=r(487);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return n.LogCategory}}),r(544);const a=r(17);t.TZ=a;r(92),r(281);r(842),r(265),r(726)},487:function(e,t){var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,n)=>t.traceTag(e,r,o,n),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,n)=>t.debugTraceTag(e,r,o,n),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,n)=>t.assertTag(e,r,o,n),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,n)=>t.shipAssertTag(e,r,o,n),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,n)=>t.dnmTraceTag(e,r,o,n)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},17:function(e,t){function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,o){e[t]=r()-o}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),n=e,a=t,i={},s=(e,t,r)=>function(e,t,r,n,a,i){o(e,"end",r);const s={sessionName:t,result:n?"success":"failure",message:i,marks:e};a(JSON.stringify(s))}(i,n,a,e,t,r);return i.start=0,{mark:e=>(e=>o(i,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},265:function(e,t){var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},92:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(o){let n=r(),a=o;return{reset(e){null!=e&&(a=e),n=r()},stop(o){const i=r()-n,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:o});e(s)}}}};let r=()=>Date.now()},281:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},690:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,o)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(o,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(o(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,n).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===n&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===n&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch((t=>e(o,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const n=e[o];r=r.catch((()=>t(n)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));let n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function o(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const n={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const a=Object.getPrototypeOf(e);a&&"object"==typeof a&&Object.keys(a).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const i={};return Object.keys(n).forEach((e=>{i[e]=o(n[e],t+1)})),i}const n="_",a=new RegExp("\\W+","g")},928:function(e,t){function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},679:function(e,t){function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let a=[];for(let e=0;e<=n.length;++e)a[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[n.length]}},640:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=i(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(679),n={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const i=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),s)<=4&&i.push(e);return i.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},392:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const o=r(533);o.__exportStar(r(640),t),o.__exportStar(r(235),t),o.__exportStar(r(928),t),o.__exportStar(r(4),t),o.__exportStar(r(472),t),o.__exportStar(r(408),t)},235:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(640)},4:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(928)},472:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(928);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},408:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(640);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},533:function(e,t,r){r.r(t),r.d(t,{__addDisposableResource:function(){return k},__assign:function(){return a},__asyncDelegator:function(){return I},__asyncGenerator:function(){return _},__asyncValues:function(){return T},__await:function(){return P},__awaiter:function(){return h},__classPrivateFieldGet:function(){return L},__classPrivateFieldIn:function(){return M},__classPrivateFieldSet:function(){return W},__createBinding:function(){return m},__decorate:function(){return s},__disposeResources:function(){return D},__esDecorate:function(){return c},__exportStar:function(){return y},__extends:function(){return n},__generator:function(){return f},__importDefault:function(){return x},__importStar:function(){return F},__makeTemplateObject:function(){return v},__metadata:function(){return g},__param:function(){return l},__propKey:function(){return p},__read:function(){return C},__rest:function(){return i},__runInitializers:function(){return d},__setFunctionName:function(){return u},__spread:function(){return b},__spreadArray:function(){return E},__spreadArrays:function(){return w},__values:function(){return S},default:function(){return O}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function l(e,t){return function(r,o){t(r,o,e)}}function c(e,t,r,o,n,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=o.kind,c="getter"===l?"get":"setter"===l?"set":"value",d=!t&&e?o.static?e:e.prototype:null,p=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),u=!1,g=r.length-1;g>=0;g--){var h={};for(var f in o)h[f]="access"===f?{}:o[f];for(var f in o.access)h.access[f]=o.access[f];h.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var m=(0,r[g])("accessor"===l?{get:p.get,set:p.set}:p[c],h);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=i(m.get))&&(p.get=s),(s=i(m.set))&&(p.set=s),(s=i(m.init))&&n.unshift(s)}else(s=i(m))&&("field"===l?n.unshift(s):p[c]=s)}d&&Object.defineProperty(d,o.name,p),u=!0}function d(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))}function f(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var m=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(C(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function E(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function P(e){return this instanceof P?(this.v=e,this):new P(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof P?Promise.resolve(r.value.v).then(l,c):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function l(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function I(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:P(e[o](t)),done:!1}:n?n(t):t}:n}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function v(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function F(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return A(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function W(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function k(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var $="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function D(e){function t(t){e.error=e.hasError?new $(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const O={__extends:n,__assign:a,__rest:i,__decorate:s,__param:l,__metadata:g,__awaiter:h,__generator:f,__createBinding:m,__exportStar:y,__values:S,__read:C,__spread:b,__spreadArrays:w,__spreadArray:E,__await:P,__asyncGenerator:_,__asyncDelegator:I,__asyncValues:T,__makeTemplateObject:v,__importStar:F,__importDefault:x,__classPrivateFieldGet:L,__classPrivateFieldSet:W,__classPrivateFieldIn:M,__addDisposableResource:k,__disposeResources:D}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};r.r(o),r.d(o,{BaseError:function(){return A},CCPError:function(){return j},CancelError:function(){return N},CancelErrorTypes:function(){return P},ClipboardPlatformError:function(){return H},ClipboardPlatformErrorTypes:function(){return b},ClipboardStorageType:function(){return Re},ClipboardStrategyBase:function(){return Ot},ClipboardStrategyType:function(){return C},CopyClipboardCommand:function(){return se},CopyClipboardEvent:function(){return de},CopyContext:function(){return mr},CopyError:function(){return J},CopyErrorTypes:function(){return w},CopyStatus:function(){return Sr},CutClipboardCommand:function(){return le},CutClipboardEvent:function(){return pe},CutCopyPasteFlags:function(){return Ne},InfraInitializationErrorTypes:function(){return He},InvalidArgumentError:function(){return L},InvalidOperationError:function(){return W},LocalStorageChangedEventFlagPostfix:function(){return pr},LocalStorageClipboardStorage:function(){return Er},LocalStorageClipboardStrategy:function(){return _r},LocalStorageKeyChangeTracker:function(){return Ir},MessageDestinationConst:function(){return Lt},MismatchVersionError:function(){return k},MissingArgumentError:function(){return x},NoUserHash:function(){return _t},NoValidKeyError:function(){return F},PasteClipboardCommand:function(){return ce},PasteClipboardEvent:function(){return ue},PasteContext:function(){return yr},PasteError:function(){return R},PasteErrorTypes:function(){return E},SharedClipboardError:function(){return z},TTLClipboardDataError:function(){return $},UnexpectedError:function(){return O},UnsupportedError:function(){return M},UserHashMismatchError:function(){return D},WindowRPCBase:function(){return Qt},addEventListener:function(){return ge},cloneMetadata:function(){return br},createClipboardItems:function(){return Me},createClipboardOperationMessage:function(){return xt},createClipboardOperationResultMessage:function(){return kt},createContextId:function(){return vt},createCopyPasteInfra:function(){return uo},createDeferredPromise:function(){return jt},createDeferredPromiseCache:function(){return zt},createDisposableImplementationExtension:function(){return Dt},createLocalStorageClipboardStorage:function(){return wr},createLocalStorageClipboardStrategy:function(){return Pr},createMessageDeserializer:function(){return Bt},createMessageId:function(){return Tt},createMessageSerializer:function(){return Gt},createWindowRPCClientReceiver:function(){return rr},createWindowRPCClientSender:function(){return ir},createWindowRPCServerReceiver:function(){return tr},createWindowRPCServerSender:function(){return ar},defaultClipboardDataFormat:function(){return he},defaultIEClipboardDataFormat:function(){return fe},emptyString:function(){return h},getCanonicalValidatedMessageId:function(){return At},getClipboardItem:function(){return Oe},getClipboardItemContent:function(){return ke},getClipboardItemsCount:function(){return We},getClipboardItemsDataCount:function(){return Le},getDefaultClipboardData:function(){return Ue},getDeferredClipboardItemContent:function(){return $e},getEmptyClipboardItemsData:function(){return Ae},getEmptyMetadata:function(){return Cr},getImmutableEmptyClipboardItems:function(){return xe},getItemsFromClipboardItems:function(){return je},getLocalStorageDataKey:function(){return gr},getLocalStorageMetadataKey:function(){return hr},getLocalStorageMetadataKeyToWatch:function(){return fr},getSharedClipboardValidatedOrigin:function(){return yt},getStringifiedError:function(){return ho.getStringifiedError},getValidatedRemoteWindow:function(){return Zt},getWindowLocation:function(){return at},getWindowMessaging:function(){return ae},htmlClipboardItem:function(){return a},imageClipboardDataFormat:function(){return ye},init:function(){return q},initLogger:function(){return g},initMessageIdPrefix:function(){return Kt},isChromiumEdge:function(){return ne},isClipboardPlatformErrorType:function(){return _},isClipboardPlatformErrorTypes:function(){return I},isEdge:function(){return te},isEdgeVersionWithTextHtmlWrapperSupport:function(){return oe},isEdgeWithTextHtmlClipboardSupport:function(){return re},isIE:function(){return ee},isLocalStorageInaccessible:function(){return T},isLocalStorageSupported:function(){return ur},isValidClipboardOperationCode:function(){return Wt},metadataAdditionalSignatureDataAttributes:function(){return Ie},metadataChromeExtensionId:function(){return Ee},metadataCopyContextClipboardDataFormat:function(){return Te},metadataCopyContextWebCustomDataFormat:function(){return ve},metadataCopyId:function(){return _e},metadataInfraVersionFormat:function(){return Pe},metadataIsLastCopyWasExternal:function(){return be},metadataIsLastCopyWasExternalXLOSource:function(){return we},metadataLastCopyWasExternal:function(){return y},metadataLastCopyWasExternalXLOSource:function(){return S},oneDot:function(){return m},oneSpace:function(){return f},queryStringBulsEndpointUrlParameter:function(){return ze},queryStringCreatorOriginParameter:function(){return Xt},queryStringSessionIdParameter:function(){return Be},queryStringWacClusterParameter:function(){return Ve},rethrowAfterAllActions:function(){return V},setCopyPasteInfraFeatureGateManager:function(){return fo},shadowWorkbookClipboardDataFormat:function(){return Se},shadowWorkbookClipboardWebCustomDataFormat:function(){return Ce},sharedClipboardSettings:function(){return n},shouldClearClipboard:function(){return It},textHtmlClipboardDataFormat:function(){return me},ulsLogger:function(){return u},unknownMessageId:function(){return qt},validateClipboardOperationMessage:function(){return Mt},validateClipboardOperationResultMessage:function(){return $t},validateRemoteWindowOrigin:function(){return St}});var n={};r.r(n),r.d(n,{createEmptySharedClipboardSettings:function(){return nt},defaultPromiseTimeoutInMinutes:function(){return Ze},getSharedClipboardSettings:function(){return et},initializeSharedClipboardSettings:function(){return rt},initializeSharedClipboardSettingsFromWindow:function(){return tt},sharedClipboardSettingsVariableName:function(){return Ke}});var a={};let i;r.r(a),r.d(a,{addClipboardWrapperForEdge:function(){return no},ccpTimestampHtmlCustomAttributeName:function(){return qr},createHtmlItemFromTextPlain:function(){return eo},createPlainTextFromHtml:function(){return to},createTextHtmlFromTextPlain:function(){return Yr},divTagName:function(){return Dr},encodeAngleBrackets:function(){return lo},ensureOneLFPerNewLine:function(){return Zr},getCcpTimestampHtmlCustomAttributeFromWrappingTag:function(){return io},getExternalSource:function(){return so},getFragmentFromTextHtml:function(){return ao},isContainsTimestampWrapper:function(){return oo},minCcpTimestampHtmlCustomAttributeValue:function(){return Xr},preTagName:function(){return Or},tableTagName:function(){return Ur},tdTagName:function(){return Jr},trTagName:function(){return jr},trimToLength:function(){return Qr},wrapContentWithTagAndAttributes:function(){return co}});const s=e=>{i=e},l=(e,t=!1)=>i?i.getBooleanFeatureGate(e,t):t;class c{static setFeatureGateManager(e){s(e)}}var d=r(135);let p;function u(){return p}function g(e){if(!e)throw new Error("The 'logger' argument is missing");p=d.Hv.getFromExternalLogger(e)}const h="",f=" ",m=".",y="1",S="1";var C,b,w,E,P;function _(e,t){return I(e,[t])}function I(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function T(e){if(e&&"object"==typeof e){if(v(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(v(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(v(JSON.parse(e).reason))return!0}catch{}return!1}function v(e){return e===b.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(C||(C={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(b||(b={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(w||(w={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(E||(E={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(P||(P={}));class A extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():h}constructor(e,t,r){const o=A.augmentParameterValue(e);if(super(o),this.name=A.augmentParameterValue(t),this.errorName=this.name,this.name?u().ULS.traceTag(596456211,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Error '${this.name}': ${o}`):u().ULS.traceTag(596456212,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Error message: ${o}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=A.augmentParameterValue(e);t.length>0&&u().ULS.traceTag(596456213,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class F extends A{constructor(e,t){super(e,"NoValidKeyError",t)}}class x extends A{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=A.augmentParameterValue(t),n=x.getDefaultMessage(o);let a=A.augmentParameterValue(e);0===a.length&&(a=n),super(a,"MissingArgumentError",r),this.name=o}}class L extends A{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const n=A.augmentParameterValue(t);let a=r;a||(a=h);const i=L.getDefaultMessage(n,a);let s=A.augmentParameterValue(e);0===e.length&&(s=i),super(s,"InvalidArgumentError",o),this.name=n,this.value=a}}class W extends A{constructor(e,t){super(e,"InvalidOperationError",t)}}class M extends A{constructor(e,t){super(e,"UnsupportedError",t)}}class k extends A{constructor(e,t,r,o,n){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${o}`,"MismatchVersionError",n)}}class $ extends A{constructor(e,t,r,o){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",o)}}class D extends A{constructor(e,t,r,o){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",o)}}class O extends A{constructor(e,t){super(e,"UnexpectedError",t)}}function U(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:h}class j extends A{constructor(e,t,r,o,n){super(t||`reason=${e}`,r,o),this.reason=e,n&&(this.errorName=n)}}class J extends j{constructor(e,t,r){super(e,t,"CopyError",r,U(e,w))}}class R extends j{constructor(e,t,r){super(e,t,"PasteError",r,U(e,E))}}class N extends j{constructor(e,t,r){super(e,t,"CancelError",r,U(e,P))}}class H extends j{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,U(e,b))}}class z extends j{constructor(e,t,r){super(e,t,"SharedClipboardError",r,U(e,b))}}function V(e){if(!e||!Array.isArray(e)||0===e.length)return void u().ULS.traceTag(596456214,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){u().ULS.traceTag(596456216,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new W(e.message,e))}else u().ULS.traceTag(596456215,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}function B(){return G}const G={userAgent:()=>window&&window.navigator?window.navigator.userAgent:h,appVersion:()=>window&&window.navigator?window.navigator.appVersion:h};let K={};function q(){K={}}const X=new RegExp("(\\bTrident/| MSIE )"),Z=16.16299,Q=17.17123,Y=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function ee(){if(void 0===K.isIEProperty){K.isIEProperty=!1;const e=B();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(X);e&&2===e.length&&(K.isIEProperty=!0)}}}return K.isIEProperty}function te(){if(void 0===K.isEdgeProperty){K.isEdgeProperty=!1,K.isEdgeWithTextHtmlClipboardSupportProperty=!1,K.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=B();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(Y);if(e&&2===e.length){K.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=Z&&(K.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=Q&&(K.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return K.isEdgeProperty}function re(){return te()&&K.isEdgeWithTextHtmlClipboardSupportProperty}function oe(){return te()&&K.isEdgeVersionWithTextHtmlWrapperSupportProperty}function ne(){const e=B();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function ae(){return ie}const ie={postMessage:(e,t,r,o)=>{e.postMessage(t,r,o)}},se="copy",le="cut",ce="paste",de="copy",pe="cut",ue="paste",ge=(e,t,r,o=!1)=>(e.addEventListener(t,r,o),()=>{e.removeEventListener(t,r,o)}),he="text/plain",fe="Text",me="text/html",ye="image/png",Se="data/shadow-workbook",Ce="web data/shadow-workbook",be="metadata/is-last-copy-was-external",we="metadata/is-last-copy-was-external-XLO-source",Ee="metadata/chrome-extension-id",Pe="metadata/ccp-infra-version",_e="copyId",Ie="metadata/additional-signature-data-attributes",Te="metadata/copy-context",ve="web metadata/copy-context";function Ae(){return{items:{}}}const Fe=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new W(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":h}empty)`)},setDeferredItem:(e,t)=>{throw new W(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>Je(void 0)}}();function xe(){return Fe}function Le(e){return e&&e.items?Object.keys(e.items).length:0}function We(e){return Le(e&&e.getData())}function Me(e=void 0){let t=e;return t||(t={items:{}}),{getItem:e=>ke(t,e),setItem:(e,r)=>{De(t,e,r)},setDeferredItem:(e,r)=>{De(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>$e(t,e),getData:()=>t,get:()=>Je(t)}}function ke(e,t){if(!e)throw new x(h,"clipboardItemsData");if(!e.items)throw new L(h,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function $e(e,t){if(!e)throw new x(h,"clipboardItemsData");if(!e.items)throw new L(h,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:he}))}function De(e,t,r){if(!e)throw new x(h,"clipboardItemsData");if(!e.items)throw new L(h,"clipboardItemsData.items");e.items[t]=r}function Oe(e,t){if(!e||0===e.length||!t||!t.trim())return h;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||h}function Ue(e){return Oe(e,he)}function je(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:he,data:h}),t}function Je(e){const t=[];if(0===Le(e))return t;for(const r in e.items){let o=e.items[r];o||(o=h);const n={clipboardDataFormat:r,data:o,deferred:o instanceof Promise};t.push(n)}return t}var Re,Ne,He;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(Re||(Re={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths"}(Ne||(Ne={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(He||(He={}));const ze="BulsEndpointUrl",Ve="WacCluster",Be="usid",Ge="-",Ke="sharedClipboardSettings",qe=1,Xe=3600,Ze=2;let Qe=nt(),Ye=!1;function et(){if(!Ye)throw new W("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return Qe}function tt(){Ye=!1,function(){if(!window||!(Ke in window))return Qe=nt(),void(Ye=!0);const e=window[Ke];if(!e||"object"!=typeof e)return Qe=nt(),void(Ye=!0);ot(e)}()}function rt(e){Ye=!1,ot(e)}function ot(e){if(!e)throw new x(h,"sharedClipboardSettingsCandidate");const t=nt();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return Qe=t,void(Ye=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return u().ULS.traceTag(596124181,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),Qe=t,void(Ye=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf(Ge);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{u().ULS.traceTag(579737680,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return u().ULS.traceTag(596124182,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=h,t.sharedClipboardHostingApps=[],Qe=t,void(Ye=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{u().ULS.traceTag(579737681,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return u().ULS.traceTag(596124183,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=h,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Qe=t,void(Ye=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return u().ULS.traceTag(596124184,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=h,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Qe=t,void(Ye=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return u().ULS.traceTag(596124185,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=h,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Qe=t,void(Ye=!0)}t.whitelistOriginComponents=!0,Qe=t,Ye=!0}function nt(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:h,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:qe,sharedClipboardExpirationInMinutes:Xe,clipboardPromiseTimeoutInMinutes:Ze,remoteLoggerPath:h}}function at(){let e=h;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=h)):(u().ULS.traceTag(595932950,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const it="://",st="http",lt="https",ct=".",dt="/",pt=":",ut=new RegExp("^\\d+$");let gt,ht,ft=!1;function mt(e){if(!e)throw new x(h,"origin");const t=e.trim().toLowerCase();let r=h,o=t.split(it,3);if(!o||0===o.length||!o[0]||o[0]!==st&&o[0]!==lt)throw new L("Missing protocol","origin",e);if(1===o.length)throw new L("Missing domain","origin",e);if(o.length>2)throw new L(`'${it}' should appear once`,"origin",e);let n=o[1];if(!n)throw new L("Missing domain","origin",e);if(r=o[0]+it,n=n.trim(),o=n.trim().split(dt,3),!o||0===o.length||!o[0]||!o[0].trim())throw new L("Missing domain","origin",e);if(o.length>2)throw new L("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new L("The last part of the origin should be the domain","origin",e);if(o=n.split(pt,3),!o||0===o.length||!o[0]||!o[0].trim())throw new L("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new L("The last part of the origin should be the domain and an optional port number","origin",e);if(n=o[0].trim(),r+=n,2===o.length){const t=o[1].trim(),n=ut.exec(t);if(!n||1!==n.length)throw new L("Invalid port number","origin",e);const a=Number(t);if(isNaN(a))throw new L("Invalid port number","origin",e);r+=pt+t}return u().ULS.traceTag(596452423,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function yt(e){Et();const t=mt(e);let r=t.split(it);if(!r||2!==r.length||!r[0]||!r[1])throw new L("Invalid origin","parentOrigin",e);const o=et();let n=h;if(o.whitelistOriginComponents){const t=r[0]+it;if(r=r[1].split(ct),!r||r.length<2||!r[0])throw new L("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=t+r.join(ct)}else n=t;return u().ULS.traceTag(596452424,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${n}' components=${JSON.stringify(r)}`),n}function St(e){Et();const t=mt(e),r=mt(at().origin);if(t===r)return t;if(!et().whitelistOriginComponents)throw new W(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=Ct(t),n=Ct(r);if(o.protocol!==n.protocol)throw new W(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${n.protocol}'`);if(o.environment!==n.environment)throw new W(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${n.environment}'`);return t}function Ct(e){Et();const t=e.split(it,2),r=t[0],o=bt(t[1]),n={protocol:r};if(n.environment=wt(e,o,ht),o.length<=n.environment.length+1)throw new L("Missing app component","origin",e);if(o.charAt(n.environment.length)!==ct)throw new L("Missing a domain separator after the environment component","origin",e);const a=o.substr(n.environment.length+ct.length);if(n.app=wt(e,a,gt),n.app.length<a.length&&a.charAt(n.app.length)!==Ge)throw new L(`When the Office Online app name is not the domain prefix, '${Ge}' should precede it`,"origin",e);return n}function bt(e){if(!e)throw new x(h,"stringToReverse");const t=e.length;let r=h;for(let o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function wt(e,t,r){if(!t)throw new x(h,"reversedValidatedHostname");if(!r)throw new x(h,"reversedStringsToLengthMap");const o=t.length,n=Object.keys(r).filter((e=>{const n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return bt(n[0]);throw new L("Invalid origin","validatedOrigin",e)}function Et(){if(ft)return;const e=et();e.whitelistOriginComponents&&(gt=Pt(e.sharedClipboardHostingApps),ht=Pt(e.sharedClipboardHostingEnvironments),ft=!0)}function Pt(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[bt(e)]=e.length})),t):t}const _t=1;function It(e,t){return null==e||e===_t||null==t||e!==t}function Tt(){return Ft()}function vt(){return Ft()}function At(e){if(!e)throw new x(h,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new L(h,"id");return t}function Ft(){return(Math.random()+1).toString(36).substring(7)}function xt(e,t,r,o,n){const a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return Mt(a),a}class Lt{}function Wt(e){return"get"===e||"set"===e||"init"===e}Lt.localStorageData="localStorage/data",Lt.localStorageMetadata="localStorage/metadata",Lt.initIframe="initIframe";const Mt=function(e){if(!e)throw new x(h,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new x(h,"id");if(!e.operationCode)throw new x(h,"operationCode");if(!e.destination)throw new x(h,"destination");if(!Wt(e.operationCode))throw new L(h,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new L(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function kt(e,t,r,o,n){const a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return $t(a),a}const $t=function(e){if(!e)throw new x(h,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new F("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw u().ULS.traceTag(553747865,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new x(h,"id");if(!e.operationCode)throw new x(h,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new L(h,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new L(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new L(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new L(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new L(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new L(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new L(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function Dt(e){if(!e||0===e.trim().length)throw new L(h,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&u().ULS.traceTag(596456217,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new W(r(e))}}})()}class Ot{initialize(e){return e.then((e=>(this.clipboardStorage=e,u().ULS.traceTag(596453007,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(u().ULS.traceTag(596453008,d.nh.msoulscat_ES_EWAJS,T(e)?d.kp.Info:d.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${d.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return u().ULS.shipAssertTag(596121485,d.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new H(b.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new H(b.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return u().ULS.shipAssertTag(596121486,d.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new H(b.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw u().ULS.traceTag(507848131,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${d.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new H(b.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(xe(),e):(u().ULS.shipAssertTag(595882508,d.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new H(b.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new H(b.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=Dt(`${e}`)}}const Ut=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function jt(e){let t=e;return t&&0!==t.trim().length||(t=Tt()),new Ht(t)}function Jt(){return Ut?window.performance.now():Date.now()}function Rt(e){return Ut?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Nt(e,t,r){if(!r)throw new x(h,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Jt()-r}ms`}class Ht{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):u().ULS.traceTag(596456257,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):u().ULS.traceTag(596456260,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Jt(),u().ULS.traceTag(596456261,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${Nt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return u().ULS.traceTag(596456258,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&u().ULS.traceTag(596456259,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${Rt(this.fulfillmentTimestamp)}. ${Nt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=At(e),Ht.sequenceId+=1,this.sequenceId=Ht.sequenceId,this.creationTimestamp=Jt(),u().ULS.traceTag(596456225,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${Rt(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{u().ULS.traceTag(596456226,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${Rt(Jt())}`),this.internalResolve=e,this.internalReject=t}))}}function zt(){return new Vt}Ht.sequenceId=0;class Vt{getDeferredPromise(e){const t=At(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return u().ULS.traceTag(596456218,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;u().ULS.traceTag(596456219,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=jt(e);if(this.getDeferredPromise(t.id))throw new L("A deferred promise already exists in the cache for the specified id","id",t.id);const r=At(t.id);return this.deferredResultMessagePromiseCache[r]=t,u().ULS.traceTag(596456220,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void u().ULS.traceTag(596456221,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=At(e);delete this.deferredResultMessagePromiseCache[t],u().ULS.traceTag(596456222,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(u().ULS.traceTag(596456223,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){u().ULS.traceTag(596456224,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}function Bt(e){if(!e)throw new x(h,"validator");const t={deserialize:t=>function(e,t){if(!e)throw new x(h,"incomingMessage");if(!t)throw new x(h,"validator");if(0===e.length)throw new L("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new L("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new L("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new L("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)};return t}function Gt(e){if(!e)throw new x(h,"validator");const t={serialize:t=>function(e,t){if(!e)throw new x(h,"outgoingMessage");if(!t)throw new x(h,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new L("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return u().ULS.traceTag(596452375,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)};return t}const Kt="initmessageid",qt="unknownmessageid",Xt="CreatorOrigin";function Zt(e){if(!e)throw new x(h,"remoteWindow");if(!("window"in e)||!e.window)throw new x(h,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new x(h,"remoteWindow.windowOrigin");const t=St(e.windowOrigin);return{window:e.window,windowOrigin:t}}class Qt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(V([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new x(h,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw u().ULS.shipAssertTag(596121484,d.nh.msoulscat_ES_EWAJS,!1,e),new W(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=Dt(o)}}function Yt(){return er}const er={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};function tr(e,t,r){return new nr(e,t,r)}function rr(e,t,r){return new nr(e,t,r)}const or="message";class nr{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Yt().removeEventListener(or,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return u().ULS.traceTag(596452370,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return u().ULS.traceTag(596452371,d.nh.msoulscat_ES_EWAJS,d.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return u().ULS.traceTag(596452372,d.nh.msoulscat_ES_EWAJS,d.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return u().ULS.traceTag(596452373,d.nh.msoulscat_ES_EWAJS,d.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){u().ULS.traceTag(596452374,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${d.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){u().ULS.traceTag(596452184,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${d.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{u().ULS.traceTag(595985880,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`Window RPC Receiver: unable to process incoming message. ${d.Wp.getStringifiedError(e)}`)}))}catch(e){u().ULS.traceTag(596452186,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`Window RPC Receiver: unable to process incoming message. ${d.Wp.getStringifiedError(e)}`)}else u().ULS.traceTag(596452185,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new x(h,"deserializer");if(!t)throw new x(h,"handler");if(!r)throw new x(h,"windowRPC");this.disposableImplementationExtension=Dt("WindowRPCReceiverInternal"),this.remoteWindow=Zt(r.remoteWindow),Yt().addEventListener(or,this.windowMessageHandler)}}function ar(e,t){return new sr(e,t)}function ir(e,t){return new sr(e,t)}class sr{postMessage(e){if(!e)throw new x(h,"outgoingMessage");if(!this.remoteWindow.window)throw new W("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new W("The remote window does not support postMessage");const t=this.serializer.serialize(e);ae().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new x(h,"serializer");if(!t)throw new x(h,"windowRPC");this.disposableImplementationExtension=Dt("WindowRPCSenderInternal"),this.remoteWindow=Zt(t.remoteWindow)}}const lr="OfficeOnlineCCP_",cr=lr+"Metadata_",dr=lr+"Data_",pr="_LocalStorageChangedFlag";function ur(){try{const e="XLO_CCP",t="1";return localStorage.setItem(e,t),localStorage.getItem(e)===t}catch{return!1}}function gr(e){return dr+e}function hr(e){return cr+e}function fr(e){return hr(e)+pr}class mr{constructor(){this.copyStatus=Sr.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class yr{profilingMessage(e){const t=d.TZ.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=d.TZ.timeStamp()}}var Sr;function Cr(){return{}}function br(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}function wr(e){try{u().ULS.traceTag(595716237,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Attempting to create clipboard storage type '${Re.LocalStorage}'`);const t=new Er(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Sr||(Sr={}));class Er{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),u().ULS.traceTag(595716238,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:h}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(xe());try{const e=JSON.parse(t);if(!e||0===Le(e))return Promise.resolve(xe());const r=Me(e);return Promise.resolve(r)}catch(e){return Promise.resolve(xe())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),u().ULS.traceTag(595716239,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`localStorageClipboardStorage.set: item count=${We(e)}'; commandParameters.id='${t?t.id:h}'`),0===We(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+pr}`,o=Tt();return u().ULS.traceTag(595654546,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[he,me,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new H(b.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new H(b.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=Re.LocalStorage,this.disposableImplementationExtension=Dt("LocalStorageClipboardStorage")}}function Pr(e){return u().ULS.traceTag(595716236,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`Attempting to create clipboard strategy type '${C.LocalStorage}' with localStorageKey: '${e}'`),(new _r).initialize(wr(e))}class _r extends Ot{constructor(e){super(C.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Ir{onStorageChanged(e){u().ULS.shipAssertTag(595716249,d.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),u().ULS.traceTag(595716288,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),u().ULS.traceTag(595716289,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{u().ULS.traceTag(595716295,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return u().ULS.traceTag(595715525,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),u().ULS.traceTag(595716232,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{u().ULS.traceTag(595716233,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return u().ULS.traceTag(595715526,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(u().ULS.traceTag(595715527,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return u().ULS.traceTag(595715528,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=jt(),r=new Date,o=setInterval((()=>{const n=(new Date).getTime()-r.getTime();u().ULS.traceTag(595715529,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),u().ULS.traceTag(595716234,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):n>e&&(clearInterval(o),u().ULS.traceTag(595716235,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}const Tr="\t",vr="\n",Ar="\r",Fr=new RegExp(`(${vr}${Ar})|(${Ar}${vr})|(${Ar})`,"g"),xr=new RegExp(`(${Tr})`,"g"),Lr=10240,Wr=new RegExp("<","g"),Mr="&lt;",kr=new RegExp(">","g"),$r="&gt;",Dr="div",Or="pre",Ur="table",jr="tr",Jr="td",Rr="\x3c!--StartFragment--\x3e",Nr="\x3c!--EndFragment--\x3e",Hr=Rr.length,zr=Nr.length,Vr=`Version:0.9${vr}StartHTML:0000000100${vr}EndHTML:{EndHTML0}${vr}StartFragment:0000000134${vr}EndFragment:{EndFragm}${vr}<html>${vr}<body>${vr}${Rr}${vr}`,Br=`${Nr}${vr}</body>${vr}</html>`,Gr="0000000000",Kr=7,qr="data-ccp-timestamp",Xr=0;function Zr(e){return e?e.replace(Fr,vr):e}function Qr(e){return e?e.length<=Lr?e:e.substr(0,Lr):h}function Yr(e){var t;const r=function(e){return e?e.replace(Fr,`</${Jr}></${jr}><${jr}><${Jr}>`):e}((t=lo(e))?t.replace(xr,`</${Jr}><${Jr}>`):t);return`<${Ur}><${jr}><${Jr}>${r}</${Jr}></${jr}></${Ur}>`}function eo(e,t,r){if(r!==Xr&&!r)throw new x(h,"timestamp");if(isNaN(r))throw new L(h,"timestamp",r.toString());const o=function(e,t,r){return`<${e} ${qr}='${r}'>${t}</${e}>`}(e,Yr(t),r);return no(o)}function to(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=ro(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(Ar),t.push(vr);const o=ro(r[e]);t.push(o)}}return t.join("")}function ro(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push(Tr),t.push(r[e].innerText)}return t.join("")}function oo(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(qr)}function no(e){if(!te()||oe())return e;const t=Gr.length,r=Vr.length+e.length+Br.length;let o=(r-Br.length).toString();if(o.length<t&&(o=Gr.substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be ${t}`;throw u().ULS.shipAssertTag(596128536,d.nh.msoulscat_ES_EWAJS,!1,e),new H(b.UnexpectedClipboardTextHtmlContentLength,e)}let n=(r-Kr).toString();if(n.length<t&&(n=Gr.substr(0,t-n.length)+n),n.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${n.length} but it should be ${t}`;throw u().ULS.shipAssertTag(596128537,d.nh.msoulscat_ES_EWAJS,!1,e),new H(b.UnexpectedClipboardTextHtmlContentLength,e)}const a=Vr.replace("{EndHTML0}",n).replace("{EndFragm}",o)+e+Br;return u().ULS.shipAssertTag(596128538,d.nh.msoulscat_ES_EWAJS,a.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${a.length} differs from the expected length of ${r}`),a}function ao(e){if(!e)return h;if(!e.trim())return e;const t=e.indexOf(Rr),r=e.indexOf(Nr);if(t<0||r<0||t>r)return e;const o=t+Hr,n=r-o,a=e.indexOf(Rr,o),i=e.indexOf(Nr,r+zr);return a>=0||i>=0?e:e.substr(o,n)}function io(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new x(h,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,qr);if(!t||!t.trim())return;const r=Number(t);return!r&&r!==Xr||isNaN(r)?void 0:r}function so(e){if(!e||!e.trim())return;const t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void u().ULS.shipAssertTag(595683460,d.nh.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";u().ULS.traceTag(595683457,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(t);if(void 0!==r)return r;const o=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(t);return void 0!==o?o:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(t)?"Google Docs":void 0}function lo(e){return e?e.replace(Wr,Mr).replace(kr,$r):h}function co(e,t,r){let o="";return r&&(o=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${o}>${e}</${t}>`}var po=r(392);function uo(e,t,r){return new go(e,t,r)}class go{get clipboardStrategy(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new W("clipboardPlatformEnvironment is missing")}onCopy(e){if(!e)return Promise.reject(new J(w.MissingArgumentError,"Missing commandParameters argument",new x(h,"commandParameters")));let t,r;this.isCircuitBreakerClipboardStrategyEnabled&&(this.initialClipboardStrategyType=e.dataClipboardStrategyType),t=new mr;try{t.id=vt(),u().ULS.traceTag(595937123,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCopy: copy ${t.id} started.`),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;const o=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(o,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(o,t),u().ULS.traceTag(595937152,d.nh.msoulscat_ES_EWAJS,d.kp.Verbose,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after serialize.`),this.isLocalstorageDepsInAsyncClipboardAPIRemoved(e.dataClipboardStrategyType)&&r&&r.synchronousResult&&r.synchronousResult.setItem(Te,this.metadataManager.serializeMetadata({lastCopy:{...t,copyStatus:t.isFromCache?Sr.Completed:Sr.SynchronousPhaseCompleted}})),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?u().ULS.traceTag(595734742,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCopy: catching error for copy id ${t.id} during serialize.`):u().ULS.traceTag(595734743,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"CopyPasteFlowManager.onCopy: catching error and no copy context during serialize."),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return this.writeClipboardItems(e,t,r).then((()=>this.rejectIfCopyCancelled(t))).then((()=>(this.copyCompleteCleanup(t,e),t)),(r=>{u().ULS.traceTag(595734747,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCopy: got error for copy id ${t.id}.`);let o=r;return this.copyCompleteCleanup(t,e),o||(u().ULS.shipAssertTag(595854806,d.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onCopy: promise rejected without error"),o=new J(w.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),o.copyContext=t,Promise.reject(o)}))}catch(r){return this.copyCompleteCleanup(t,e),u().ULS.traceTag(596456160,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. Exception: ${d.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(new J(w.SaveToTheClipboardFailed,`Failed to store content in the clipboard (with an exception): ${r.message}`,r))}}onPaste(e){const t=new yr;try{if(!e)return Promise.reject(new R(E.MissingArgumentError,"Missing commandParameters argument",new x(h,"commandParameters")));this.isCircuitBreakerClipboardStrategyEnabled&&(this.initialClipboardStrategyType=e.dataClipboardStrategyType),e.isTimestampStoredInSystemClipboard=!0,t.id=Tt(),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e,t.clipboardItems=xe(),t.isClipboardInaccessible=!1,u().ULS.traceTag(595685636,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("start"));const r=this.metadataManager.getCachedMetadata();t.copyContextSnapshot=r.lastCopy,this.applicationHost.initializePasteContext(t),t.copyContextSnapshot?u().ULS.traceTag(595937154,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onPaste: paste started for copy id ${t.copyContextSnapshot.id}`):u().ULS.traceTag(595730637,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");let o,n=!1;return e.skipClipboardAccess?(u().ULS.traceTag(595685637,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("skipClipboardAccess")),o=Promise.resolve()):o=this.readFromClipboard(t,e).then((r=>{if(u().ULS.traceTag(595685638,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("readFromClipboard_then")),e.isAsyncClipboardAPI&&this.isLocalstorageDepsInAsyncClipboardAPIRemoved(e.dataClipboardStrategyType)){let e={lastCopy:void 0};if(!this.isEmptyClipboard(r)){const o=r.getItem(Te);o&&(e=this.metadataManager.deserializeMetadata(o),(!t?.copyContextSnapshot||t.copyContextSnapshot.id!==e?.lastCopy?.id||t?.copyContextSnapshot?.id===e?.lastCopy?.id&&t?.copyContextSnapshot?.copyStatus!==Sr.Completed&&e?.lastCopy?.copyStatus===Sr.Completed)&&(t.copyContextSnapshot=e?.lastCopy,this.metadataManager.updateMetadata(e)))}e?.lastCopy||(t.copyContextSnapshot=void 0,this.metadataManager.updateMetadata({lastCopy:void 0}),r.setItem(be,y))}return t.clipboardItems=r,Promise.resolve()}),(e=>e&&e.reason&&e.reason===E.ClipboardIsInaccessible?(t.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e))),o.then((()=>e.isAsyncClipboardAPI&&this.isLocalstorageDepsInAsyncClipboardAPIRemoved(e.dataClipboardStrategyType)?t:this.readClipboardItemsAgainIfMetadataNotSync(t,e))).then((()=>(u().ULS.traceTag(595685639,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("getPasteFlowHandler")),this.getPasteFlowHandler(t)))).then((e=>(n||e.beforePaste&&e.beforePaste(t),e))).then((r=>{u().ULS.traceTag(595685640,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("getPasteFlowHandler_then"));let o=!1;if(this.isCopyPasteFixesEnabled&&(o=!(t.clipboardItems?.getItem(be)===y||t.isSameSession)),(!this.isPasteStuckFixEnabled||o)&&(!e.isAsyncClipboardAPI||!this.isLocalstorageDepsInAsyncClipboardAPIRemoved(e.dataClipboardStrategyType))&&t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus!==Sr.Completed&&r.shouldWaitForCopyToComplete(t)){u().ULS.traceTag(595937155,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (${t.copyContextSnapshot.id}) to complete. current status ${t.copyContextSnapshot.copyStatus}. copy session id is ${t.copyContextSnapshot.sessionId}`),u().ULS.traceTag(595683427,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("onDeferredPasteStarted")),r.onDeferredPasteStarted(t);const o=this.continueWhenCopyComplete(e,t).then((e=>(u().ULS.traceTag(595685642,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("onDeferredPasteCompleted")),r.onDeferredPasteCompleted(t),t.copyContextSnapshot=this.metadataManager.getCachedMetadata().lastCopy,t.clipboardItems=e,r)),(e=>(r.onDeferredPasteCompleted(t),u().ULS.traceTag(595882504,d.nh.msoulscat_ES_EWAJS,d.kp.Error,`CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [${e}]`),Promise.reject(e))));return u().ULS.traceTag(595685643,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("continueWhenCopyComplete")),this.testHook("continueWhenCopyComplete"),o}return u().ULS.traceTag(595940941,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onPaste: not wait for copy(${t.copyContextSnapshot&&t.copyContextSnapshot.id}) to complete. is copyContextSnapshot defined: ${void 0!==t.copyContextSnapshot}. copyStatus: ${t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus}`),r})).then((e=>this.deserialize(e,t))).then((()=>{u().ULS.traceTag(595685644,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("deserialize_then")),t.clipboardItems&&t.clipboardItems.getItem(be)===y&&(u().ULS.traceTag(595685645,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("onSystemClipboardChangedExternally")),this.onSystemClipboardChangedExternally())})).then((()=>{const e=t.clipboardItems;if(void 0===e)return;const r=e.getItem(me);if(void 0!==r){const e=so(r);void 0!==e&&(t.externalAppSource=e)}})).then((()=>t)).catch((e=>{let r=e;return r||(u().ULS.shipAssertTag(595858762,d.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),r=new R(E.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),r.pasteContext=t,Promise.reject(r)}))}catch(e){return u().ULS.shipAssertTag(596456161,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ${d.Wp.getStringifiedError(e)}`),Promise.reject(new R(E.FailedToReadFromClipboard,`Failed to read data from the clipboard (with an exception): ${e.message}`,e,t))}}onCancelCopy(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,u().ULS.traceTag(595734748,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ${this.inProgressCopyContext.id}.`)):u().ULS.traceTag(595734749,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();const t=xe(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:Ne.Copy};return this.clipboardStrategy.set(t,r).catch((e=>(u().ULS.traceTag(596456162,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new N(P.FailedToClearClipboard,`Failed to clear the clipboard: ${e.message}`,e)))))}catch(e){return u().ULS.traceTag(596456163,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ${d.Wp.getStringifiedError(e)}`),Promise.reject(new N(P.FailedToClearClipboard,`Failed to clear the clipboard (with an exception): ${e.message}`,e))}}isLocalstorageDepsInAsyncClipboardAPIRemoved(e){return this.isLocalstorageDepsRemovalInAsyncClipboardFGEnabled&&e===C.AsyncSystemClipboard}async onSystemClipboardChangedExternally(){this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0});const e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:Ne.Copy};await this.clipboardStrategy.onSystemClipboardChangedExternally(e)}readClipboardItemsAgainIfMetadataNotSync(e,t){let r=!1;return this.metadataManager.getMetadataSyncPromise().then((t=>{t&&t.lastCopy?(e.copyContextSnapshot&&(r=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,u().ULS.traceTag(595937158,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ${e.copyContextSnapshot.id}. copy status = ${e.copyContextSnapshot.copyStatus}. isMetadataChanged = ${r}`)):u().ULS.traceTag(595937025,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((()=>r?this.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems))).then((t=>(e.clipboardItems=t,e)))}getCopyFlowHandler(e){let t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw u().ULS.shipAssertTag(596456192,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ${d.Wp.getStringifiedError(e)}`),new J(w.FetchCopyFlowHandlerFailed,`applicationHost.getCopyFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw u().ULS.shipAssertTag(596456193,d.nh.msoulscat_ES_EWAJS,!1,e),new J(w.CopyFlowHandlerNotFound,e)}return t}getSourceItem(e,t){try{return e.getSourceItem(t)}catch(e){throw u().ULS.shipAssertTag(596456194,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ${d.Wp.getStringifiedError(e)}`),new J(w.FetchSourceItemFailed,`applicationHost.getSourceItem failed with an exception: ${e.message}`,e)}}serialize(e,t){try{e.beforeSerialize(t)}catch(e){throw u().ULS.shipAssertTag(596456195,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception: ${d.Wp.getStringifiedError(e)}`),new J(w.BeforeSerializeFailed,`copyFlowHandler.beforeSerialize failed with an exception: ${e.message}`,e)}let r;try{r=e.serialize(t)}catch(e){throw u().ULS.shipAssertTag(596456196,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize failed with an exception: ${d.Wp.getStringifiedError(e)}`),new J(w.SerializeFailed,`copyFlowHandler.serialize failed with an exception: ${e.message}`,e)}if(!r)throw u().ULS.shipAssertTag(596456197,d.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize should return a non null result"),new J(w.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return r}setClipboardSync(e,t,r){try{r?u().ULS.traceTag(595734750,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ${r.id}.`):u().ULS.traceTag(595734751,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");let o=e;return o||(o=xe()),this.clipboardStrategy.set(o,t).catch((e=>{if(u().ULS.traceTag(596456198,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ${t.isKeyboardEvent}, Error: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason){const t=e;if(t.reason===b.ClipboardIsInaccessible)return Promise.reject(new J(w.ClipboardIsInaccessible,t.message,t));if(t.reason===b.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new J(w.SuccessiveCutCopyOverridingPendingCutCopy,`A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ${t.message}`,t));if(t.reason===b.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new J(w.BlockedSynchronousCutCopy,`In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ${t.message}`,t))}return Promise.reject(new J(w.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard: ${e.message}`,e))})).then((()=>{r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return u().ULS.shipAssertTag(596456199,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new J(w.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard (with an exception): ${e.message}`,e))}}setClipboardAsync(e,t,r){return u().ULS.traceTag(595734752,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ${r.id}.`),e?e.then((e=>{try{if(this.isPasteStuckFixEnabled&&u().ULS.traceTag(505794970,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.setClipboardAsync: clipboardItemsPromise resolved for copy id ${r?.id}.`),this.isEmptyClipboard(e))return Promise.resolve();this.isLocalstorageDepsInAsyncClipboardAPIRemoved(t.dataClipboardStrategyType)&&e.setItem(Te,this.metadataManager.serializeMetadata({lastCopy:{...r,copyStatus:Sr.Completed}}));const o=t.stopwatch;t.stopwatch=void 0;const n={...t};return n.isTimestampStoredInSystemClipboard=!1,t.isAsyncSystemClipboardEnabled&&this.isLocalstorageDepsInAsyncClipboardAPIRemoved(t.dataClipboardStrategyType)&&(n.stopwatch=o),t.stopwatch=o,t.isKeyboardEvent&&(n.isKeyboardEvent=!1,n.silentClipboardAccessFailures=!0),this.clipboardStrategy.set(e,n).catch((e=>(u().ULS.traceTag(596456200,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason&&e.reason===b.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new J(w.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard: ${e&&e.message}`,e))))).then((()=>{this.isPasteStuckFixEnabled&&u().ULS.traceTag(505794969,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.setClipboardAsync: setClipboardAsync completed for copy id ${r.id}.`),r.succeededPopulatingSystemClipboardAsync=n.isTimestampStoredInSystemClipboard}))}catch(e){return u().ULS.shipAssertTag(596456201,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard. Exception: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new J(w.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard (with an exception): ${e.message}`,e))}}),(e=>(r.isAsyncSerializeFailed=!0,u().ULS.traceTag(596456202,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. Error: ${d.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`),Promise.reject(new J(w.AsyncSerializeFailed,`Failed to asynchronously serialize the content. Error: ${e?e.message:"..."}`,e))))):(u().ULS.traceTag(595734753,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ${r.id}.`),Promise.resolve())}isEmptyClipboard(e){return e?0===We(e)&&(u().ULS.traceTag(596456204,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(u().ULS.traceTag(596456203,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)}writeClipboardItems(e,t,r){return e.isAsyncSystemClipboardEnabled&&l("Microsoft.Office.Excel.EnableAsyncClipboardApiByDefault",!1)?this.writeClipboardItemsInSyncPhase(e,t,r).then((()=>this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t))))):Promise.all([this.writeClipboardItemsInSyncPhase(e,t,r),this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t)))])}writeClipboardItemsInSyncPhase(e,t,r){return this.setClipboardSync(r.synchronousResult,e,t).then((()=>this.rejectIfCopyCancelled(t))).then((()=>{t.copyStatus=Sr.SynchronousPhaseCompleted,u().ULS.traceTag(595937153,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after status changed to SynchronousPhaseCompleted.`),this.metadataManager.updateMetadata({lastCopy:t})})).catch((e=>{if(t?u().ULS.traceTag(595734744,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCopy: catch error for copy id ${t.id}.`):u().ULS.traceTag(595734745,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"CopyPasteFlowManager.onCopy: no copy context."),e&&e.reason){const t=e.reason;if(t===w.SuccessiveCutCopyOverridingPendingCutCopy||t===w.BlockedSynchronousCutCopy||t===w.CopyOperationCancelled||this.isCircuitBreakerClipboardStrategyEnabled&&this.initialClipboardStrategyType===C.AsyncSystemClipboard&&t===w.ClipboardIsInaccessible)return u().ULS.traceTag(595734746,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Rejecting the promise: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(e)}return u().ULS.traceTag(596456159,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),this.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}))}readFromClipboard(e,t){u().ULS.traceTag(595685646,d.nh.msoulscat_ES_EWAJS,d.kp.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);const r=this.clipboardStrategy.get(t);return u().ULS.traceTag(595685647,d.nh.msoulscat_ES_EWAJS,d.kp.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((t=>(u().ULS.traceTag(595685648,d.nh.msoulscat_ES_EWAJS,d.kp.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(u().ULS.traceTag(596456206,d.nh.msoulscat_ES_EWAJS,d.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new R(E.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new R(E.ClipboardIsEmpty,h)))))),(e=>{if(u().ULS.traceTag(596456207,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ${d.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return u().ULS.traceTag(577249542,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);const r=e;return _(e,b.ClipboardIsInaccessible)?Promise.reject(new R(E.ClipboardIsInaccessible,r.message,r)):_(e,b.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new R(E.SuccessivePasteOverridingPendingPaste,`A successive Paste user event occurred before the last Paste browser event fired: ${r.message}`,r)):_(e,b.AsyncClipboardReadFailure)?Promise.reject(new R(E.FailedToReadFromAsyncClipboard,r.message,r)):Promise.reject(new R(E.FailedToReadFromClipboard,`Failed to read data from the clipboard: ${e.message}`,e))})):(u().ULS.shipAssertTag(596456205,d.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new R(E.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new R(E.ReadFromClipboardReturnNullOrUndefined,h))))}getPasteFlowHandler(e){let t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw u().ULS.shipAssertTag(596456208,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ${d.Wp.getStringifiedError(e)}`),new R(E.FetchPasteFlowHandlerFailed,`applicationHost.getPasteFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw u().ULS.shipAssertTag(596456209,d.nh.msoulscat_ES_EWAJS,!1,e),new R(E.PasteFlowHandlerNotFound,e)}return t}deserialize(e,t){return u().ULS.traceTag(595683456,d.nh.msoulscat_ES_EWAJS,d.kp.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((e=>{const t=d.Wp.getStringifiedError(e);return u().ULS.traceTag(596456210,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ${t}.`),Promise.reject(new R(E.DeserializeOperationFailed,`Deserialization failed: ${t}`,e))}))}copyCompleteCleanup(e,t){e?(u().ULS.traceTag(595734754,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ${e.id}.`),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=Sr.Completed,u().ULS.traceTag(595937159,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ${e.id} after copy completed.`),this.metadataManager.updateMetadata({lastCopy:e})):u().ULS.traceTag(595734755,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ${e.id}.`)):u().ULS.traceTag(595734784,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"CopyPasteFlowManager.copyCompleteCleanup: no copy context.")}readRichClipboardOnly(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((e=>(u().ULS.traceTag(595937160,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e)),(e=>(u().ULS.traceTag(595940942,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,`CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ${d.Wp.getStringifiedError(e)}. use clipboard items from the first read as fallback.`),Promise.resolve(r))))}continueWhenCopyComplete(e,t){if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===Sr.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(u().ULS.shipAssertTag(595937161,d.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(${this.deferredPasteData.copyContextId} !== ${t.copyContextSnapshot.id}) exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)`),this.rejectDeferredPasteData(E.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){const r=this.metadataManager.getCachedMetadata();if(r&&r.lastCopy&&r.lastCopy.copyStatus===Sr.Completed&&r.lastCopy.id===t.copyContextSnapshot.id)return u().ULS.traceTag(595937162,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: copy ${r.lastCopy.id} already completed, not need for waiting any longer, reading the rich clipboard items`),this.readRichClipboardOnly(t,e,t.clipboardItems);const o=jt(),n=o.promise.then((()=>this.readRichClipboardOnly(t,e,t.clipboardItems)));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:o,readClipboardPromise:n,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,u().ULS.traceTag(595937163,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}`),this.deferredPasteData.readClipboardPromise}rejectDeferredPasteData(e){if(this.deferredPasteData){u().ULS.traceTag(595937164,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new R(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}}resolveDeferredPasteData(){if(this.deferredPasteData){u().ULS.traceTag(595937165,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}}rejectIfCopyCancelled(e){return e?u().ULS.traceTag(595734785,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ${e.id}.`):u().ULS.traceTag(595734786,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(u().ULS.traceTag(595734787,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ${e.id}.`),Promise.reject(new J(w.CopyOperationCancelled,`CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ${e.id} is marked for cancellation`))):(e&&u().ULS.traceTag(595734788,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ${e.id}.`),Promise.resolve())}clearInProgressCopyIfNeeded(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(u().ULS.traceTag(595937166,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ${this.inProgressCopyContext.id}) as new copy started (${e.id})`),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)}onMetadataChanged(e){e&&e.lastCopy?(u().ULS.traceTag(595937167,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onMetadataChanged: the status of copy id ${e.lastCopy.id} from session ${e.lastCopy.sessionId} changed to ${e.lastCopy.copyStatus}`),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(u().ULS.traceTag(595734789,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ${e.lastCopy.id} is not equal to ${this.deferredPasteData.copyContextId}`),this.rejectDeferredPasteData(E.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===Sr.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(u().ULS.traceTag(595734790,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(u().ULS.traceTag(595724049,d.nh.msoulscat_ES_EWAJS,d.kp.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(E.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))}onCopyCompletedSuccessfully(e){e?u().ULS.traceTag(595734791,d.nh.msoulscat_ES_EWAJS,d.kp.Info,`CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ${e.id}.`):u().ULS.traceTag(595734792,d.nh.msoulscat_ES_EWAJS,d.kp.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===Sr.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()}testHook(e){}constructor(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,this.isLocalstorageDepsRemovalInAsyncClipboardFGEnabled=!1,this.isPasteStuckFixEnabled=!1,this.isCopyPasteFixesEnabled=!1,this.isCircuitBreakerClipboardStrategyEnabled=!1,!r)throw new x(h,"logger");g(r),u().ULS.shipAssertTag(596456157,d.nh.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),u().ULS.shipAssertTag(596456158,d.nh.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),u().ULS.shipAssertTag(596456156,d.nh.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid"),this.isLocalstorageDepsRemovalInAsyncClipboardFGEnabled=l("Microsoft.Office.Excel.RemoveLocalstorageDepsInAsyncClipboardAPI",!1),this.isPasteStuckFixEnabled=l("Microsoft.Office.Excel.FixPasteStuckIssue",!1),this.isCopyPasteFixesEnabled=(0,po.isChangeGateEnabled)("OfficeVSO:9970901_CopyPasteFixes"),this.isCircuitBreakerClipboardStrategyEnabled=(0,po.isChangeGateEnabled)("OfficeVSO:10043998_EnableCircuitBreakerClipboardStrategyV2")}}var ho=r(690);function fo(e){c.setFeatureGateManager(e)}copyPasteInfra=o}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/copyPasteInfra.min.js.map/a2cc441a8edc761b7eab6cd4f2f691e5/copyPasteInfra.min.js.map